
from distutils.command.clean import clean
from py2neo import Graph,Node,Relationship
import json
import os
from py2neo.matching import *

KGraph = Graph(
    "http://nju.csuncle.com:7474", 
    auth=("neo4j","wlm94929")
)

matcher = NodeMatcher(KGraph)
Entity_Dict={}
CVE_entity = matcher.match('CVE',name="CVE-2021-44228").first()
relationship_matcher=RelationshipMatcher(KGraph)
CVE2CWE=relationship_matcher.match({CVE_entity}, r_type='hasWeaknees').all()
CWE2CAPEC_list=[]
for cwe in CVE2CWE:
    CWE2CAPEC=relationship_matcher.match({cwe.nodes[1]}, r_type='CWE2CAPEC').all()
    CWE2CAPEC_list.extend(CWE2CAPEC)

for capec in CWE2CAPEC:
    print(capec)


# CAPEC2ATTACK=relationship_matcher.match(None, r_type='CAPEC2ATTACK').all()
