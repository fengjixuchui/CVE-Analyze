import email
from idna import valid_contextj
import xlrd  
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
import time
from selenium.webdriver.support.ui import Select
import json




# with open('./data.json', 'r') as fp:
#     data = json.load(fp)


chrome_options = Options()
chrome_options.add_experimental_option("debuggerAddress", "127.0.0.1:9222")

driver = webdriver.Chrome(chrome_options=chrome_options)
# print(driver.title)
# driver.find_element(by=By.ID,value="person").click()
driver.switch_to.frame("iframe_content")

Select(driver.find_element(by=By.ID,value='pagerSelect')).select_by_visible_text("50 条/页")
time.sleep(3)


data_info={}
index=1

for pagei in  range(6):
    handles = driver.window_handles
    driver.switch_to.window(handles[-1])
    driver.switch_to.frame("iframe_content")

    table=driver.find_element(by=By.TAG_NAME,value="table")
    trs=table.find_element(by=By.TAG_NAME,value="tbody").find_elements(by=By.TAG_NAME,value="tr")[0:-3]

    for tr in trs:
        tr_info=tr.find_elements(by=By.TAG_NAME,value="td")
        tr_sn=index
        tr_name=tr_info[5].text
        tr_id=tr_info[2].text.split("：")[1].strip()
        data_info[tr_name+"#"+tr_id]=tr_sn
        index+=1

    driver.find_element(by=By.CLASS_NAME,value="layui-laypage-next").click()


with open('./data.json', 'w') as fp:
    json.dump(data_info, fp)









