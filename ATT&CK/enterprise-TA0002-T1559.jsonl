{"TTP_id": "enterprise-TA0002-T1559", "TTP_name": "Inter-Process Communication", "Description": "Adversaries may abuse inter-process communication (IPC) mechanisms for local code or command execution. IPC is typically used by processes to share data, communicate with each other, or synchronize execution. IPC is also commonly used to avoid situations such as deadlocks, which occurs when processes are stuck in a cyclic waiting pattern.Adversaries may abuse IPC to execute arbitrary code or commands. IPC mechanisms may differ depending on OS, but typically exists in a form accessible through programming languages/libraries or native interfaces such as Windows Dynamic Data Exchange or Component Object Model. Linux environments support several different IPC mechanisms, two of which being sockets and pipes.[1] Higher level execution mediums, such as those of Command and Scripting Interpreters, may also leverage underlying IPC mechanisms. Adversaries may also use Remote Services such as Distributed Component Object Model to facilitate remote IPC execution.[2]", "Property": {"ID": "T1559", "Sub-techniques": "T1559.001, T1559.002, T1559.003", "Tactic": "Execution", "Platforms": "Linux, Windows, macOS", "Permissions Required": "Administrator, SYSTEM, User", "Supports Remote": "Yes", "Version": "1.2", "Created": "12 February 2020", "Last Modified": "11 March 2022"}, "Examples": {"S0687": ["https://attack.mitre.org/software/S0687", "Cyclops Blink", "Cyclops Blink has the ability to create a pipe to enable inter-process communication.[3]"], "S0537": ["https://attack.mitre.org/software/S0537", "HyperStack", "HyperStack can connect to the IPC$ share on remote machines.[4]"]}, "Mitigation": {"M1013": ["https://attack.mitre.org/mitigations/M1013", "Application Developer Guidance", "Enable the Hardened Runtime capability when developing applications. Do not include the com.apple.security.get-task-allow entitlement with the value set to any variation of true."], "M1048": ["https://attack.mitre.org/mitigations/M1048", "Application Isolation and Sandboxing", "Ensure all COM alerts and Protected View are enabled.[5]"], "M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.[6][7]"], "M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Registry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution. [8][9][10] Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel.[11]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Modify Registry settings (directly or using Dcomcnfg.exe) in HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Classes\\\\AppID\\\\{AppID_GUID} associated with the process-wide security of individual COM applications.[12]Modify Registry settings (directly or using Dcomcnfg.exe) in HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Ole associated with system-wide security defaults for all COM applications that do no set their own process-wide security.[13] [14]"], "M1054": ["https://attack.mitre.org/mitigations/M1054", "Software Configuration", "Consider disabling embedded files in Office programs, such as OneNote, that do not work with Protected View.[7][10]"]}, "Detection": {"Module Load": ["Monitor DLL/PE file events, specifically creation of these binary files as well as the loading of DLLs into processes. Look for DLLs that are not recognized or not normally loaded into a process.", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "Process Access": ["Monitor for processes making abnormal calls to higher privileged processes, such as a user application connecting to a VPN service.[15]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for newly executed processes that are associated with abuse of IPC mechanisms", "", "", ""], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
