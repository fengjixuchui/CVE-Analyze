{"TTP_id": "enterprise-TA0002-T1559-T1559.002", "TTP_name": "Dynamic Data Exchange", "Description": "Adversaries may use Windows Dynamic Data Exchange (DDE) to execute arbitrary commands. DDE is a client-server protocol for one-time and/or continuous inter-process communication (IPC) between applications. Once a link is established, applications can autonomously exchange transactions consisting of strings, warm data links (notifications when a data item changes), hot data links (duplications of changes to a data item), and requests for command execution.Object Linking and Embedding (OLE), or the ability to link data between documents, was originally implemented through DDE. Despite being superseded by Component Object Model, DDE may be enabled in Windows 10 and most of Microsoft Office 2016 via Registry keys.[1][2][3]Microsoft Office documents can be poisoned with DDE commands, directly or through embedded files, and used to deliver execution via Phishing campaigns or hosted Web content, avoiding the use of Visual Basic for Applications (VBA) macros.[4][5][6][7] Similarly, adversaries may infect payloads to execute applications and/or commands on a victim device by way of embedding DDE formulas within a CSV file intended to be opened through a Windows spreadsheet program.[8][9]DDE could also be leveraged by an adversary operating on a compromised machine who does not have direct access to a Command and Scripting Interpreter. DDE execution can be invoked remotely via Remote Services such as Distributed Component Object Model (DCOM).[10]", "Property": {"ID": "T1559.002", "Sub-technique of": "T1559", "Tactic": "Execution", "Platforms": "Windows", "Permissions Required": "User", "Supports Remote": "Yes", "Version": "1.2", "Created": "12 February 2020", "Last Modified": "22 February 2022"}, "Examples": {"G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has delivered JHUHUGIT and Koadic by executing PowerShell commands through DDE in Word documents.[11][12][13]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 has used Windows DDE for execution of commands and a malicious VBS.[14]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has sent malicious Word OLE compound documents to victims.[15]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 spear phishing campaigns have included malicious Word documents with DDE execution.[16]"], "G0084": ["https://attack.mitre.org/groups/G0084", "Gallmaker", "Gallmaker attempted to exploit Microsoft’s DDE protocol in order to gain access to victim machines and for execution.[17]"], "S0237": ["https://attack.mitre.org/software/S0237", "GravityRAT", "GravityRAT has been delivered via Word documents using DDE for execution.[18]"], "S0391": ["https://attack.mitre.org/software/S0391", "HAWKBALL", "HAWKBALL has used an OLE object that uses Equation Editor to drop the embedded shellcode.[19]"], "S0387": ["https://attack.mitre.org/software/S0387", "KeyBoy", "KeyBoy uses the Dynamic Data Exchange (DDE) protocol to download remote payloads.[20]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has utilized OLE as a method to insert malicious content inside various phishing documents. [21]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used malware that can execute PowerShell scripts via DDE.[22]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork leveraged the DDE protocol to deliver their malware.[23]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT was delivered with documents using DDE to execute malicious code.[24]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS can use DDE to execute additional payloads on compromised hosts.[25]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay has been delivered using OLE objects in malicious documents.[26]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM can search for specific strings within browser tabs using a Dynamic Data Exchange mechanism.[27]"], "G0104": ["https://attack.mitre.org/groups/G0104", "Sharpshooter", "Sharpshooter has sent malicious Word OLE documents to victims.[28]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has used the ActiveXObject utility to create OLE objects to obtain execution through Internet Explorer.[29][30]"], "G0092": ["https://attack.mitre.org/groups/G0092", "TA505", "TA505 has leveraged malicious Word documents that abused DDE.[31]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak can execute tasks via OLE.[32]"]}, "Mitigation": {"M1048": ["https://attack.mitre.org/mitigations/M1048", "Application Isolation and Sandboxing", "Ensure Protected View is enabled.[33]"], "M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.[34][6]"], "M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Registry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution. [3][1][35] Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel.[2]"], "M1054": ["https://attack.mitre.org/mitigations/M1054", "Software Configuration", "Consider disabling embedded files in Office programs, such as OneNote, that do not work with Protected View.[6][35]"]}, "Detection": {"Module Load": ["Monitor processes for abnormal behavior indicative of DDE abuse, such as Microsoft Office applications loading DLLs and other modules not typically associated with the application or these applications spawning unusual processes (such as cmd.exe).", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "Process Creation": ["Monitor for newly executed processes that may use Windows Dynamic Data Exchange (DDE) to execute arbitrary commands.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. OLE and Office Open XML files can be scanned for ‘DDEAUTO', ‘DDE’, and other strings indicative of DDE execution.https://blog.nviso.be/2017/10/11/detecting-dde-in-ms-office-documents/", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
