{"TTP_id": "enterprise-TA0007-T1614", "TTP_name": "System Location Discovery", "Description": "Adversaries may gather information in an attempt to calculate the geographical location of a victim host. Adversaries may use the information from System Location Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.Adversaries may attempt to infer the location of a system using various system checks, such as time zone, keyboard layout, and/or language settings.[1][2][3] Windows API functions such as GetLocaleInfoW can also be used to determine the locale of the host.[1] In cloud environments, an instance's availability zone may also be discovered by accessing the instance metadata service from the instance.[4][5]Adversaries may also attempt to infer the location of a victim host using IP addressing, such as via online geolocation IP-lookup services.[6][2]", "Property": {"ID": "T1614", "Sub-techniques": "T1614.001", "Tactic": "Discovery", "Platforms": "IaaS, Linux, Windows, macOS", "Permissions Required": "User", "Contributors": "Hiroki Nagahama, NEC Corporation; Katie Nickels, Red Canary; Manikantan Srinivasan, NEC Corporation India; Pooja Natarajan, NEC Corporation India; Wes Hurd", "Version": "1.0", "Created": "01 April 2021", "Last Modified": "15 October 2021"}, "Examples": {"S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson can identify the geographical location of a victim host.[7]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can identity the OS locale of a compromised host.[8]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can identify the country code on a compromised host.[9]"], "S0481": ["https://attack.mitre.org/software/S0481", "Ragnar Locker", "Before executing malicious code, Ragnar Locker checks the Windows API GetLocaleInfoW and doesn't encrypt files if it finds a former Soviet country.[1]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may gather information in an attempt to calculate the geographical location of a victim host.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "OS API Execution": ["Remote access tools with built-in features may interact directly with the Windows API, such as calling GetLocaleInfoW to gather information.[1]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor newly executed processes that may gather information in an attempt to calculate the geographical location of a victim host.", "", "", ""]}}
