{"TTP_id": "enterprise-TA0006-T1552-T1552.002", "TTP_name": "Credentials in Registry", "Description": "Adversaries may search the Registry on compromised systems for insecurely stored credentials. The Windows Registry stores configuration information that can be used by the system or other programs. Adversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services. Sometimes these credentials are used for automatic logons.Example commands to find Registry keys related to password information: [1]", "Property": {"ID": "T1552.002", "Sub-technique of": "T1552", "Tactic": "Credential Access", "Platforms": "Windows", "System Requirements": "Ability to query some Registry locations depends on the adversary's level of access. User permissions are usually limited to access of user-related Registry keys.", "Permissions Required": "Administrator, User", "Contributors": "Sudhanshu Chauhan, @Sudhanshu_C", "Version": "1.0", "Created": "04 February 2020", "Last Modified": "07 February 2020"}, "Examples": {"S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla has the ability to extract credentials from the Registry.[2]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 used Outlook Credential Dumper to harvest credentials stored in Windows registry.[3][4]"], "S0194": ["https://attack.mitre.org/software/S0194", "PowerSploit", "PowerSploit has several modules that search the Windows Registry for stored credentials: Get-UnattendedInstallFile, Get-Webconfig, Get-ApplicationHost, Get-SiteListPassword, Get-CachedGPPPassword, and Get-RegistryAutoLogon.[1]"], "S0075": ["https://attack.mitre.org/software/S0075", "Reg", "Reg may be used to find credentials in the Windows Registry.[1]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot has retrieved PuTTY credentials by querying the Software\\SimonTatham\\Putty\\Sessions registry key [5]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak can use the clientgrabber module to steal e-mail credentials from the Registry.[6]"]}, "Mitigation": {"M1047": ["https://attack.mitre.org/mitigations/M1047", "Audit", "Proactively search for credentials within the Registry and attempt to remediate the risk."], "M1027": ["https://attack.mitre.org/mitigations/M1027", "Password Policies", "Do not store credentials within the Registry."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "If it is necessary that software must store credentials in the Registry, then ensure the associated accounts have limited permissions so they cannot be abused if obtained by an adversary."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may search the Registry on compromised systems for insecurely stored credentials.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes for applications that can be used to query the Registry, such as Reg, and collect command parameters that may indicate credentials are being searched. Correlate activity with related suspicious behavior that may indicate an active intrusion to reduce false positives.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Windows Registry Key Access": ["Monitor for unexpected windows registry key being accessed that may search the Registry on compromised systems for insecurely stored credentials.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
