{"TTP_id": "enterprise-TA0001-T1566-T1566.001", "TTP_name": "Spearphishing Attachment", "Description": "Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon User Execution to gain execution. Spearphishing may also involve social engineering techniques, such as posing as a trusted source.There are many options for the attachment such as Microsoft Office documents, executables, PDFs, or archived files. Upon opening the attachment (and potentially clicking past protections), the adversary's payload exploits a vulnerability or directly executes on the user's system. The text of the spearphishing email usually tries to give a plausible reason why the file should be opened, and may explain how to bypass system protections in order to do so. The email may also contain instructions on how to decrypt an attachment, such as a zip file password, in order to evade email boundary defenses. Adversaries frequently manipulate file extensions and icons in order to make attached executables appear to be document files, or files exploiting one application appear to be a file for a different one.", "Property": {"ID": "T1566.001", "Sub-technique of": "T1566", "Tactic": "Initial Access", "Platforms": "Linux, Windows, macOS", "CAPEC ID": "CAPEC-163", "Contributors": "Philip Winther", "Version": "2.2", "Created": "02 March 2020", "Last Modified": "18 October 2021"}, "Examples": {"G0018": ["https://attack.mitre.org/groups/G0018", "admin@338", "admin@338 has sent emails with malicious Microsoft Office documents attached.[1]"], "S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "The primary delivered mechaism for Agent Tesla is through email phishing messages.[2]"], "G0130": ["https://attack.mitre.org/groups/G0130", "Ajax Security Team", "Ajax Security Team has used personalized spearphishing attachments.[3]"], "G0138": ["https://attack.mitre.org/groups/G0138", "Andariel", "Andariel has conducted spearphishing campaigns that included malicious Word or Excel attachments.[4][5]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed has been distributed to victims through malicious e-mail attachments.[6]"], "G0099": ["https://attack.mitre.org/groups/G0099", "APT-C-36", "APT-C-36 has used spearphishing emails with password protected RAR attachment to avoid being detected by the email gateway.[7]"], "G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 has sent spearphishing emails containing malicious attachments.[8]"], "G0005": ["https://attack.mitre.org/groups/G0005", "APT12", "APT12 has sent emails with malicious Microsoft Office documents and PDFs attached.[9][10]"], "G0073": ["https://attack.mitre.org/groups/G0073", "APT19", "APT19 sent spearphishing emails with malicious attachments in RTF and XLSM formats to deliver initial exploits.[11]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 sent spearphishing emails containing malicious Microsoft Office and RAR attachments.[12][13][14][15][16][17][18][19]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used spearphishing emails with an attachment to deliver files with exploits to initial victims.[20][21][22][23][24][25]"], "G0013": ["https://attack.mitre.org/groups/G0013", "APT30", "APT30 has used spearphishing emails with malicious DOC attachments.[26]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has sent spearphishing emails with a malicious executable disguised as a document or spreadsheet.[27][28][29][30][31][32]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has sent spearphishing e-mails with archive attachments.[33]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 delivers malware using spearphishing emails with malicious HWP attachments.[34][35][36]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has conducted spearphishing campaigns using malicious email attachments.[37]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 leveraged spearphishing emails with malicious attachments to initially compromise victims.[38][39][40]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 sent spearphishing emails with attachments such as compiled HTML (.chm) files to initially compromise their victims.[41]"], "S0642": ["https://attack.mitre.org/software/S0642", "BADFLICK", "BADFLICK has been distributed via spearphishing campaigns containing malicious Microsoft Word documents.[42]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook is delivered via a malicious Word document inside a zip file.[43]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has been delivered as malicious email attachments.[44]"], "G0098": ["https://attack.mitre.org/groups/G0098", "BlackTech", "BlackTech has used spearphishing e-mails with malicious password-protected archived files (ZIP or RAR) to deliver malware.[45][46]"], "S0520": ["https://attack.mitre.org/software/S0520", "BLINDINGCAN", "BLINDINGCAN has been delivered by phishing emails containing malicious Microsoft Office documents.[47]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER used spearphishing emails with malicious Microsoft Word attachments to infect victims.[48][49]"], "S0631": ["https://attack.mitre.org/software/S0631", "Chaes", "Chaes has been delivered by sending victims a phishing email containing a malicious .docx file.[50]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling has been delivered to victim's machines through malicious e-mail attachments.[51]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has sent spearphishing emails with various attachment types to corporate and personal email accounts of victim organizations. Attachment types have included .rtf, .doc, .xls, archives containing LNK files, and password protected archives containing .exe and .scr executables.[52][53][54][55][56][57][58][59]"], "G0142": ["https://attack.mitre.org/groups/G0142", "Confucius", "Confucius has crafted and sent victims malicious attachments to gain initial access.[60]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel has sent spearphishing emails with malicious RAR and .LNK attachments.[61][62]"], "G0079": ["https://attack.mitre.org/groups/G0079", "DarkHydrus", "DarkHydrus has sent spearphishing emails with password-protected RAR archives containing malicious Excel Web Query files (.iqy). The group has also sent spearphishing emails that contained malicious Microsoft Office documents that use the \"attachedTemplate\" technique to load a template from a remote server.[63][64][65]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman has been delivered via spearphishing emails that contain a malicious zip file.[66]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has sent emails with malicious attachments to gain initial access.[67]"], "G0066": ["https://attack.mitre.org/groups/G0066", "Elderwood", "Elderwood has delivered zero-day exploits and malware to victims via targeted emails containing malicious attachments.[68][69]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet has been delivered by phishing emails containing attachments. [70][71][72][73][74][75][76][77][78]"], "S0634": ["https://attack.mitre.org/software/S0634", "EnvyScout", "EnvyScout has been distributed via spearphishing as an email attachment.[79]"], "G0137": ["https://attack.mitre.org/groups/G0137", "Ferocious Kitten", "Ferocious Kitten has conducted spearphishing campaigns containing malicious documents to lure victims to open the attachments.[80]"], "G0085": ["https://attack.mitre.org/groups/G0085", "FIN4", "FIN4 has used spearphishing emails containing attachments (which are often stolen, legitimate documents sent from compromised accounts) with embedded malicious macros.[81][82]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has targeted victims with e-mails containing malicious attachments.[83]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 sent spearphishing emails with either malicious Microsoft Documents or RTF files attached.[84][85][86][87][88]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has distributed targeted emails containing Word documents with embedded malicious macros.[89][90][91]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro has been distributed via spearphishing as an email attachment.[46]"], "G0101": ["https://attack.mitre.org/groups/G0101", "Frankenstein", "Frankenstein has used spearphishing emails to send trojanized Microsoft Word documents.[92]"], "G0084": ["https://attack.mitre.org/groups/G0084", "Gallmaker", "Gallmaker sent emails with malicious Microsoft Office documents attached.[93]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has delivered spearphishing emails with malicious attachments to targets.[94][95][96][97][98][99]"], "G0078": ["https://attack.mitre.org/groups/G0078", "Gorgon Group", "Gorgon Group sent emails to victims with malicious Microsoft Office documents attached.[100]"], "S0499": ["https://attack.mitre.org/software/S0499", "Hancitor", "Hancitor has been delivered via phishing emails with malicious attachments.[101]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa has sent spearphishing emails containing malicious attachments.[102][103]"], "S0483": ["https://attack.mitre.org/software/S0483", "IcedID", "IcedID has been delivered via phishing e-mails with malicious attachments.[104]"], "G0100": ["https://attack.mitre.org/groups/G0100", "Inception", "Inception has used weaponized documents attached to spearphishing emails for reconnaissance and initial compromise.[105][106][107][108]"], "G0136": ["https://attack.mitre.org/groups/G0136", "IndigoZebra", "IndigoZebra sent spearphishing emails containing malicious password-protected RAR attachments.[109][110]"], "S0528": ["https://attack.mitre.org/software/S0528", "Javali", "Javali has been delivered as malicious e-mail attachments.[111]"], "S0648": ["https://attack.mitre.org/software/S0648", "JSS Loader", "JSS Loader has been delivered by phishing emails containing malicious Microsoft Excel attachments.[87]"], "S0585": ["https://attack.mitre.org/software/S0585", "Kerrdown", "Kerrdown has been distributed through malicious e-mail attachments.[32]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used emails containing Word, Excel and/or HWP (Hangul Word Processor) documents in their spearphishing campaigns.[112][113][114][115][116][6][117][118]"], "S0669": ["https://attack.mitre.org/software/S0669", "KOCTOPUS", "KOCTOPUS has been distributed via spearphishing emails with malicious attachments.[119]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has been delivered via spearphishing campaigns through a malicious Word document.[120]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has targeted victims with spearphishing emails containing malicious Microsoft Word documents.[121][122][123][124][125]"], "G0140": ["https://attack.mitre.org/groups/G0140", "LazyScripter", "LazyScripter has used spam emails weaponized with archive or document files as its initial infection vector.[119]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has sent spearphishing emails with malicious attachments, including .rtf, .doc, and .xls files.[126][127]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot is delivered via a malicious XLS attachment contained within a spearhpishing email.[128]"], "G0095": ["https://attack.mitre.org/groups/G0095", "Machete", "Machete has delivered spearphishing emails that contain a zipped file with malicious contents.[129][130][131]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has sent malicious Office documents via email as part of spearphishing campaigns as well as executables disguised as documents.[132][133][134][135]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has been delivered to victims via emails with malicious HTML attachments.[136][137]"], "G0103": ["https://attack.mitre.org/groups/G0103", "Mofang", "Mofang delivered spearphishing emails with malicious documents, PDFs, or Excel files attached.[138]"], "G0021": ["https://attack.mitre.org/groups/G0021", "Molerats", "Molerats has sent phishing emails with malicious Microsoft Word and PDF attachments.[139][140][141]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has compromised third parties and used compromised accounts to send spearphishing emails with targeted attachments to recipients.[142][143][144][145][146][147]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has used spearphishing attachments to deliver initial access payloads.[148][149][150]"], "G0019": ["https://attack.mitre.org/groups/G0019", "Naikon", "Naikon has used malicious e-mail attachments to deliver malware.[151]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE has been spread via e-mail campaigns utilizing malicious attachments.[152][153]"], "G0133": ["https://attack.mitre.org/groups/G0133", "Nomadic Octopus", "Nomadic Octopus has targeted victims with spearphishing emails containing malicious attachments.[154][155]"], "S0346": ["https://attack.mitre.org/software/S0346", "OceanSalt", "OceanSalt has been delivered via spearphishing emails with Microsoft Office attachments.[156]"], "S0340": ["https://attack.mitre.org/software/S0340", "Octopus", "Octopus has been delivered via spearsphishing emails.[155]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has sent spearphising emails with malicious attachments to potential victims using compromised and/or spoofed email accounts.[157][158][159]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork has used spearphishing with an attachment to deliver files with exploits to initial victims.[160][161][162][163]"], "G0068": ["https://attack.mitre.org/groups/G0068", "PLATINUM", "PLATINUM has sent spearphishing emails with attachments to victims as its primary initial access vector.[164]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT was distributed via malicious Word documents.[165]"], "S0453": ["https://attack.mitre.org/software/S0453", "Pony", "Pony has been delivered via spearphishing attachments.[166]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot has spread through emails with malicious attachments.[167][168][169][170][171][172][173]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay has been distributed through spearphishing emails with malicious attachments.[174]"], "G0075": ["https://attack.mitre.org/groups/G0075", "Rancor", "Rancor has attached a malicious document to an email to gain initial access.[175]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil has been distributed via malicious e-mail attachments including MS Word Documents.[176][177][178][179][180]"], "S0433": ["https://attack.mitre.org/software/S0433", "Rifdoor", "Rifdoor has been distributed in e-mails with malicious Excel or Word documents.[181]"], "S0240": ["https://attack.mitre.org/software/S0240", "ROKRAT", "ROKRAT has been delivered via spearphishing emails that contain a malicious Hangul Office or Microsoft Word document.[182]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM has been delivered via spearphishing attachments disguised as PDF documents.[183]"], "G0048": ["https://attack.mitre.org/groups/G0048", "RTM", "RTM has used spearphishing attachments to distribute its malware.[184]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has delivered malicious Microsoft Office attachments via spearphishing emails.[185][186][187][188]"], "G0104": ["https://attack.mitre.org/groups/G0104", "Sharpshooter", "Sharpshooter has sent malicious attachments via emails to targets.[189]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has sent e-mails with malicious attachments often crafted for specific targets.[190]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has sent emails with malicious DOCX, CHM, LNK and ZIP attachments. [191][192][193]"], "G0062": ["https://attack.mitre.org/groups/G0062", "TA459", "TA459 has targeted victims using spearphishing emails with malicious Microsoft Word attachments.[194]"], "G0092": ["https://attack.mitre.org/groups/G0092", "TA505", "TA505 has used spearphishing emails with malicious attachments to initially compromise victims.[195][196][197][198][199][200][201][202][203]"], "G0127": ["https://attack.mitre.org/groups/G0127", "TA551", "TA551 has sent spearphishing attachments with password protected ZIP files.[204][205][206]"], "S0011": ["https://attack.mitre.org/software/S0011", "Taidoor", "Taidoor has been delivered through spearphishing emails.[207]"], "G0089": ["https://attack.mitre.org/groups/G0089", "The White Company", "The White Company has sent phishing emails with malicious Microsoft Word attachments to victims.[208]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used e-mail to deliver malicious attachments to victims.[51]"], "S0665": ["https://attack.mitre.org/software/S0665", "ThreatNeedle", "ThreatNeedle has been distributed via a malicious Word document within a spearphishing email.[122]"], "G0131": ["https://attack.mitre.org/groups/G0131", "Tonto Team", "Tonto Team has delivered payloads via spearphishing attachments.[209]"], "G0134": ["https://attack.mitre.org/groups/G0134", "Transparent Tribe", "Transparent Tribe has sent spearphishing e-mails with attachments to deliver malicious payloads.[210][211][212][213][214]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot has used an email with an Excel sheet containing a malicious macro to deploy the malware[215]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper sent spearphishing emails that contained malicious Microsoft Office and fake installer file attachments.[216][217][218][219][220]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak has been delivered via spearphishing e-mails with password protected ZIP files.[204]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT has been distributed as a malicious attachment within an email.[221][60]"], "G0112": ["https://attack.mitre.org/groups/G0112", "Windshift", "Windshift has sent spearphishing emails with attachment to harvest credentials and deliver malware.[222]"], "G0090": ["https://attack.mitre.org/groups/G0090", "WIRTE", "WIRTE has sent emails to intended victims with malicious MS Word and Excel attachments.[223]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used spearphishing attachments to deliver Microsoft documents containing macros or PDFs containing malicious links to download either Emotet, Bokbot, TrickBot, or Bazar.[224][225]"]}, "Mitigation": {"M1049": ["https://attack.mitre.org/mitigations/M1049", "Antivirus/Antimalware", "Anti-virus can also automatically quarantine suspicious files."], "M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion prevention systems and systems designed to scan and remove malicious email attachments can be used to block activity."], "M1021": ["https://attack.mitre.org/mitigations/M1021", "Restrict Web-Based Content", "Block unknown or unused attachments by default that should not be transmitted over email as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some email scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious attachments."], "M1054": ["https://attack.mitre.org/mitigations/M1054", "Software Configuration", "Use anti-spoofing and email authentication mechanisms to filter messages based on validity checks of the sender domain (using SPF) and integrity of messages (using DKIM). Enabling these mechanisms within an organization (through policies such as DMARC) may enable recipients (intra-org and cross domain) to perform similar message filtering and validation.[226][227]"], "M1017": ["https://attack.mitre.org/mitigations/M1017", "User Training", "Users can be trained to identify social engineering techniques and spearphishing emails."]}, "Detection": {"Application Log Content": ["Monitor for third-party application logging, messaging, and/or other artifacts that may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Filtering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.[226][227] Anti-virus can potentially detect malicious documents and attachments as they're scanned to be stored on the email server or on the user's computer. Monitor for suspicious descendant process spawning from Microsoft Office and other productivity software.[228]", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "File Creation": ["Monitor for newly constructed files from a spearphishing emails with a malicious attachment in an attempt to gain access to victim systems.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Network Traffic Content": ["Monitor and analyze SSL/TLS traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)). Filtering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed.[226][227]", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
