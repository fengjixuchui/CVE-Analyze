{"TTP_id": "enterprise-TA0007-T1069-T1069.001", "TTP_name": "Local Groups", "Description": "Adversaries may attempt to find local system groups and permission settings. The knowledge of local system permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as the users found within the local administrators group.Commands such as net localgroup of the Net utility, dscl . -list /Groups on macOS, and groups on Linux can list local groups.", "Property": {"ID": "T1069.001", "Sub-technique of": "T1069", "Tactic": "Discovery", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Version": "1.0", "Created": "12 March 2020", "Last Modified": "26 March 2020"}, "Examples": {"G0018": ["https://attack.mitre.org/groups/G0018", "admin@338", "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to list local groups: net localgroup administrator >> %temp%\\download[1]"], "S0521": ["https://attack.mitre.org/software/S0521", "BloodHound", "BloodHound can collect information about local groups and members.[2]"], "S0572": ["https://attack.mitre.org/software/S0572", "Caterpillar WebShell", "Caterpillar WebShell can obtain a list of local groups of users from a system.[3]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used net localgroup administrators to identify accounts with local administrative rights.[4]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can use net localgroup to list local groups on a system.[5]"], "S0082": ["https://attack.mitre.org/software/S0082", "Emissary", "Emissary has the capability to execute the command net localgroup administrators.[6]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic gathers information on local group names.[7]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro has been used to execute the net localgroup administrators command on a targeted system.[8]"], "S0381": ["https://attack.mitre.org/software/S0381", "FlawedAmmyy", "FlawedAmmyy enumerates the privilege level of the victim during the initial infection.[9]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "Helminth has checked the local administrators group.[10]"], "S0201": ["https://attack.mitre.org/software/S0201", "JPIN", "JPIN can obtain the permissions of the victim user.[11]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar gathers information about local groups and members.[12]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs collects a list of users belonging to the local users and administrators groups with the commands net localgroup administrators and net localgroup users.[13]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "Commands such as net group and net localgroup can be used in Net to gather information about and manipulate groups.[14]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used net localgroup administrators to find local administrators on compromised systems.[15]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used the command net localgroup administrators to list all administrators part of a local group.[16]"], "S0165": ["https://attack.mitre.org/software/S0165", "OSInfo", "OSInfo has enumerated the local administrators group.[17]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 contains modules, such as Get-LocAdm for enumerating permission groups.[18]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER may collect local group information by running net localgroup administrators or a series of other commands on a victim.[19]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use net localgroup to enable discovery of local groups.[20]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can obtain a list of local groups and members.[21]"], "S0060": ["https://attack.mitre.org/software/S0060", "Sys10", "Sys10 collects the group name of the logged-in user and sends it to the C2.[22]"], "G0131": ["https://attack.mitre.org/groups/G0131", "Tonto Team", "Tonto Team has used the ShowLocalGroupDetails command to identify administrator, user, and guest accounts on a compromised host.[23]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has used net localgroup and net localgroup Administrators to enumerate group information, including members of the local administrators group.[24]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor for executed commands and arguments that may attempt to find local system groups and permission settings.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes that may attempt to find local system groups and permission settings.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
