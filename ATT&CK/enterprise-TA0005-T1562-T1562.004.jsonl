{"TTP_id": "enterprise-TA0005-T1562-T1562.004", "TTP_name": "Disable or Modify System Firewall", "Description": "Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.Modifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed.", "Property": {"ID": "T1562.004", "Sub-technique of": "T1562", "Tactic": "Defense Evasion", "Platforms": "Linux, Windows, macOS", "Defense Bypassed": "Firewall", "Version": "1.0", "Created": "21 February 2020", "Last Modified": "29 March 2020"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 used netsh to configure firewall rules that limited certain UDP outbound packets.[1]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 have created firewall exemptions on specific ports, including ports 443, 6443, 8443, and 9443.[2]"], "S0031": ["https://attack.mitre.org/software/S0031", "BACKSPACE", "The \"ZR\" variant of BACKSPACE will check to see if known host-based firewalls are installed on the infected systems. BACKSPACE will attempt to establish a C2 channel, then will examine open windows to identify a pop-up from the firewall software and will simulate a mouse-click to allow the connection to proceed.[3]"], "S0245": ["https://attack.mitre.org/software/S0245", "BADCALL", "BADCALL disables the Windows firewall before binding to a port.[4]"], "G0008": ["https://attack.mitre.org/groups/G0008", "Carbanak", "Carbanak may use netsh to add local firewall rule exceptions.[5]"], "S0492": ["https://attack.mitre.org/software/S0492", "CookieMiner", "CookieMiner has checked for the presence of \"Little Snitch\", macOS network monitoring and application firewall software, stopping and exiting if it is found.[6]"], "S0687": ["https://attack.mitre.org/software/S0687", "Cyclops Blink", "Cyclops Blink can modify the Linux iptables firewall to enable C2 communication via a stored list of port numbers.[7][8]"], "S0334": ["https://attack.mitre.org/software/S0334", "DarkComet", "DarkComet can disable Security Center functions like the Windows Firewall.[9][10]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has disabled host-based firewalls. The group has also globally opened port 3389.[11]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can block the Deibold Warsaw GAS Tecnologia security tool at the firewall level.[12]"], "S0132": ["https://attack.mitre.org/software/S0132", "H1N1", "H1N1 kills and disables services for Windows Firewall.[13]"], "S0246": ["https://attack.mitre.org/software/S0246", "HARDRAIN", "HARDRAIN opens the Windows Firewall to modify incoming connections.[14]"], "S0376": ["https://attack.mitre.org/software/S0376", "HOPLIGHT", "HOPLIGHT has modified the firewall using netsh.[15]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole has a command to disable routing and the Firewall on the victim’s machine.[16]"], "S0088": ["https://attack.mitre.org/software/S0088", "Kasidet", "Kasidet has the ability to change firewall settings to allow a plug-in to be downloaded.[17]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has been observed disabling the system firewall.[18]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Various Lazarus Group malware modifies the Windows firewall to allow incoming connections or disable it entirely using netsh. [19][20][21]"], "S0336": ["https://attack.mitre.org/software/S0336", "NanoCore", "NanoCore can modify the victim's firewall.[22][23]"], "S0108": ["https://attack.mitre.org/software/S0108", "netsh", "netsh can be used to disable local firewall settings.[24][25]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT has modified the Windows firewall to allow itself to communicate through the firewall.[26][27]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used PowerShell to add and delete rules in the Windows firewall.[28]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec can add or remove applications or ports on the Windows firewall or disable it entirely.[29]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke used scripts which killed processes and added firewall rules to block traffic related to other cryptominers.[30]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has disabled iptables.[31]"], "S0263": ["https://attack.mitre.org/software/S0263", "TYPEFRAME", "TYPEFRAME can open the Windows Firewall on the victim’s machine to allow incoming connections.[32]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell can disable the firewall by modifying the registry key HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile.[33]"]}, "Mitigation": {"M1022": ["https://attack.mitre.org/mitigations/M1022", "Restrict File and Directory Permissions", "Ensure proper process and file permissions are in place to prevent adversaries from disabling or modifying firewall settings."], "M1024": ["https://attack.mitre.org/mitigations/M1024", "Restrict Registry Permissions", "Ensure proper Registry permissions are in place to prevent adversaries from disabling or modifying firewall settings."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Ensure proper user permissions are in place to prevent adversaries from disabling or modifying firewall settings."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments associated with disabling or the modification of system firewalls such as netsh advfirewall firewall set rule group=\"file and printer sharing\" new enable=Yes,ufw disable, and ufw logging off.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Firewall Disable": ["Monitor for changes in the status of the system firewall such as Windows Security Auditing events 5025 (The Windows firewall service has been stopped) and 5034 (The Windows firewall driver was stopped).", "DS0018", "https://attack.mitre.org/datasources/DS0018", "Firewall"], "Firewall Rule Modification": ["Monitor for changes made to firewall rules that might allow remote communication over protocols such as SMD and RDP. Modification of firewall rules might also consider opening local ports and services for different network profiles such as public and domain.", "", "", ""], "Windows Registry Key Modification": ["Monitor for changes made to windows Registry keys and/or values that adversaries might use to disable or modify System Firewall settings such as HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
