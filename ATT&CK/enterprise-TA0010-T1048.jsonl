{"TTP_id": "enterprise-TA0010-T1048", "TTP_name": "Exfiltration Over Alternative Protocol", "Description": "Adversaries may steal data by exfiltrating it over a different protocol than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel. Different protocol channels could also include Web services such as cloud storage. Adversaries may also opt to encrypt and/or obfuscate these alternate channels.Exfiltration Over Alternative Protocol can be done using various common operating system utilities such as Net/SMB or FTP.[1] On macOS and Linux curl may be used to invoke protocols such as HTTP/S or FTP/S to exfiltrate data from a system.[2]", "Property": {"ID": "T1048", "Sub-techniques": "T1048.001, T1048.002, T1048.003", "Tactic": "Exfiltration", "Platforms": "Linux, Windows, macOS", "Contributors": "Alfredo Abarca; William Cain", "Version": "1.3", "Created": "31 May 2017", "Last Modified": "15 October 2021"}, "Examples": {"S0482": ["https://attack.mitre.org/software/S0482", "Bundlore", "Bundlore uses the curl -s -L -o command to exfiltrate archived data to a URL.[2]"], "S0631": ["https://attack.mitre.org/software/S0631", "Chaes", "Chaes has exfiltrated its collected data from the infected machine to the C2, sometimes using the MIME protocol.[3]"], "S0503": ["https://attack.mitre.org/software/S0503", "FrameworkPOS", "FrameworkPOS can use DNS tunneling for exfiltration of credit card data.[4]"], "S0203": ["https://attack.mitre.org/software/S0203", "Hydraq", "Hydraq connects to a predefined domain on port 443 to exfil gathered information.[5]"], "S0641": ["https://attack.mitre.org/software/S0641", "Kobalos", "Kobalos can exfiltrate credentials over the network via UDP.[6]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT has used a .NET tool named dog.exe to exiltrate information over an e-mail account.[7]"]}, "Mitigation": {"M1057": ["https://attack.mitre.org/mitigations/M1057", "Data Loss Prevention", "Data loss prevention can detect and block sensitive data being uploaded via web browsers."], "M1037": ["https://attack.mitre.org/mitigations/M1037", "Filter Network Traffic", "Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network."], "M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.[8]"]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may steal data by exfiltrating it over a different protocol than that of the existing command and control channel.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor for suspicious files (i.e. .pdf, .docx, .jpg, etc.) viewed in isolation that may steal data by exfiltrating it over a different protocol than that of the existing command and control channel.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Network Connection Creation": ["Monitor for newly constructed network connections that are sent or received by untrusted hosts.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
