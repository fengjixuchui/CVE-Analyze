{"TTP_id": "enterprise-TA0007-T1046", "TTP_name": "Network Service Discovery", "Description": "Adversaries may attempt to get a listing of services running on remote hosts and local network infrastructure devices, including those that may be vulnerable to remote software exploitation. Common methods to acquire this information include port and/or vulnerability scans using tools that are brought onto a system.[1]Within cloud environments, adversaries may attempt to discover services running on other cloud hosts. Additionally, if the cloud environment is connected to a on-premises environment, adversaries may be able to identify services running on non-cloud systems as well.Within macOS environments, adversaries may use the native Bonjour application to discover services running on other macOS hosts within a network. The Bonjour mDNSResponder daemon automatically registers and advertises a hostâ€™s registered services on the network. For example, adversaries can use a mDNS query (such as dns-sd -B _ssh._tcp .) to find other systems broadcasting the ssh service.[2][3]", "Property": {"ID": "T1046", "Sub-techniques": "No sub-techniques", "Tactic": "Discovery", "Platforms": "Containers, IaaS, Linux, Network, Windows, macOS", "CAPEC ID": "CAPEC-300", "Contributors": "Praetorian", "Version": "3.0", "Created": "31 May 2017", "Last Modified": "20 April 2022"}, "Examples": {"G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 performed network scanning on the network to search for open ports, services, OS finger-printing, and other vulnerabilities.[4]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used CrackMapExec and a custom port scanner known as BLUETORCH for network scanning.[5][6]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used a malware variant called WIDETONE to conduct port scans on specified subnets.[7]"], "S0093": ["https://attack.mitre.org/software/S0093", "Backdoor.Oldrea", "Backdoor.Oldrea can use a network scanning module to identify ICS-related ports.[8]"], "G0135": ["https://attack.mitre.org/groups/G0135", "BackdoorDiplomacy", "BackdoorDiplomacy has used SMBTouch, a vulnerability scanner, to determine whether a target is vulnerable to EternalBlue malware.[9]"], "S0089": ["https://attack.mitre.org/software/S0089", "BlackEnergy", "BlackEnergy has conducted port scans on a host.[10]"], "G0098": ["https://attack.mitre.org/groups/G0098", "BlackTech", "BlackTech has used the SNScan tool to find other potential targets on victim networks.[11]"], "S0572": ["https://attack.mitre.org/software/S0572", "Caterpillar WebShell", "Caterpillar WebShell has a module to use a port scanner on a system.[12]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used the get -b -e -p command for network scanning as well as a custom Python tool packed into a Windows executable named Get.exe to scan IP ranges for HTTP.[13]"], "S0020": ["https://attack.mitre.org/software/S0020", "China Chopper", "China Chopper's server component can spider authentication portals.[14]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group leveraged an open-source tool called SoftPerfect Network Scanner to perform network scanning.[15][16][17]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can perform port scans from an infected host.[18][19][20]"], "S0608": ["https://attack.mitre.org/software/S0608", "Conficker", "Conficker scans for other machines to infect.[21]"], "G0132": ["https://attack.mitre.org/groups/G0132", "CostaRicto", "CostaRicto employed nmap and pscan to scan target environments.[22]"], "G0105": ["https://attack.mitre.org/groups/G0105", "DarkVishnya", "DarkVishnya performed port scanning to obtain the list of active services.[23]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can perform port scans from an infected host.[24]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS.[25]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used tools including NMAP to conduct broad scanning to identify open ports.[26][27]"], "S0061": ["https://attack.mitre.org/software/S0061", "HDoor", "HDoor scans to identify open ports on the victim.[28]"], "S0698": ["https://attack.mitre.org/software/S0698", "HermeticWizard", "HermeticWizard has the ability to scan ports on a compromised network.[29]"], "S0601": ["https://attack.mitre.org/software/S0601", "Hildegard", "Hildegard has used masscan to look for kubelets in the internal Kubernetes network.[30]"], "S0604": ["https://attack.mitre.org/software/S0604", "Industroyer", "Industroyer uses a custom port scanner to map out a network.[31]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can scan the network for open ports and vulnerable instances of RDP and SMB protocols.[32]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can scan for open TCP ports on the target network.[33]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used nmap from a router VM to scan ports on systems within the restricted segment of an enterprise network.[34]"], "G0077": ["https://attack.mitre.org/groups/G0077", "Leafminer", "Leafminer scanned network services to search for vulnerabilities in the victim system.[35]"], "S0532": ["https://attack.mitre.org/software/S0532", "Lucifer", "Lucifer can scan for open ports including TCP ports 135 and 1433.[36]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used tcping.exe, similar to Ping, to probe port status on systems of interest.[37]"], "S0233": ["https://attack.mitre.org/software/S0233", "MURKYTOP", "MURKYTOP has the capability to scan for open ports on hosts in a connected network.[14]"], "G0019": ["https://attack.mitre.org/groups/G0019", "Naikon", "Naikon has used the LadonGo scanner to scan target networks.[38]"], "S0590": ["https://attack.mitre.org/software/S0590", "NBTscan", "NBTscan can be used to scan IP networks.[39][40]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used the publicly available tool SoftPerfect Network Scanner as well as a custom tool called GOLDIRONY to conduct network scanning.[41]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has scanned for open ports and used nbtscan to find NETBIOS nameservers.[42]"], "S0598": ["https://attack.mitre.org/software/S0598", "P.A.S. Webshell", "P.A.S. Webshell can scan networks for open ports and listening services.[43]"], "S0683": ["https://attack.mitre.org/software/S0683", "Peirates", "Peirates can initiate a port scan against a given IP address.[44]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 can perform port scans from an infected host.[45]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy has a built-in module for port scanning.[46]"], "S0583": ["https://attack.mitre.org/software/S0583", "Pysa", "Pysa can perform network reconnaissance using the Advanced Port Scanner tool.[47]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can scan for systems that are vulnerable to the EternalBlue exploit.[48][49]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec has a plugin that can perform ARP scanning as well as port scanning.[50]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke conducted scanning for exposed TCP port 7001 as well as SSH and Redis servers.[51][52]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can scan for open ports on a compromised machine.[53]"], "S0374": ["https://attack.mitre.org/software/S0374", "SpeakUp", "SpeakUp checks for availability of specific ports on servers.[54]"], "G0039": ["https://attack.mitre.org/groups/G0039", "Suckfly", "Suckfly the victim's internal network for hosts with ports 8080, 5900, and 40 open.[55]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has used masscan to search for open Docker API ports.[56][30] TeamTNT has also used malware that utilizes zmap and zgrab to search for vulnerable services in cloud environments.[57]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 actors use the Hunter tool to conduct network service discovery for vulnerable systems.[58][59]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper used pr and an openly available tool to scan for open ports on target systems.[60][61]"], "S0341": ["https://attack.mitre.org/software/S0341", "Xbash", "Xbash can perform port scanning of TCP and UDP ports.[62]"], "S0117": ["https://attack.mitre.org/software/S0117", "XTunnel", "XTunnel is capable of probing the network for open ports.[63]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell can launch port scans.[7][64]"]}, "Mitigation": {"M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Ensure that unnecessary ports and services are closed to prevent risk of discovery and potential exploitation."], "M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Use network intrusion detection/prevention systems to detect and prevent remote service scans."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Ensure proper network segmentation is followed to protect critical servers and devices."]}, "Detection": {"Cloud Service Enumeration": ["Cloud service discovery techniques will likely occur throughout an operation where an adversary is targeting cloud-based systems and services. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.Normal, benign system and network events that look like cloud service discovery may be uncommon, depending on the environment and how they are used. Monitor cloud service usage for anomalous behavior that may indicate adversarial presence within the environment.", "DS0025", "https://attack.mitre.org/datasources/DS0025", "Cloud Service"], "Command Execution": ["Monitor executed commands and arguments that may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"]}}
