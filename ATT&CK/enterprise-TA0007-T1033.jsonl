{"TTP_id": "enterprise-TA0007-T1033", "TTP_name": "System Owner/User Discovery", "Description": "Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using OS Credential Dumping. The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.Various utilities and commands may acquire this information, including whoami. In macOS and Linux, the currently logged in user can be identified with w and who. On macOS the dscl . list /Users | grep -v '_' command can also be used to enumerate user accounts. Environment variables, such as %USERNAME% and $USER, may also be used to access this information.", "Property": {"ID": "T1033", "Sub-techniques": "No sub-techniques", "Tactic": "Discovery", "Platforms": "Linux, Windows, macOS", "CAPEC ID": "CAPEC-577", "Version": "1.3", "Created": "31 May 2017", "Last Modified": "20 April 2022"}, "Examples": {"S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla can collect the username from the victim’s machine.[1][2][3]"], "S0092": ["https://attack.mitre.org/software/S0092", "Agent.btz", "Agent.btz obtains the victim username and saves it to a file.[4]"], "G0073": ["https://attack.mitre.org/groups/G0073", "APT19", "APT19 used an HTTP malware variant and a Port 22 malware variant to collect the victim’s username.[5]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "An APT3 downloader uses the Windows command \"cmd.exe\" /C whoami to verify that it is running with the elevated privileges of \"System.\"[6]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 collected the victim's username and executed the whoami command on the victim's machine. APT32 executed shellcode to collect the username on the victim's machine. [7][8][9]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 identifies the victim username.[10]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has identified primary users, currently logged in users, sets of users that commonly use a system, or inactive users.[11]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 used Remexi to collect usernames from the system.[12]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used the WMIEXEC utility to execute whoami commands on remote machines.[13]"], "S0456": ["https://attack.mitre.org/software/S0456", "Aria-body", "Aria-body has the ability to identify the username on a compromised host.[14]"], "S0344": ["https://attack.mitre.org/software/S0344", "Azorult", "Azorult can collect the username from the victim’s machine.[15]"], "S0414": ["https://attack.mitre.org/software/S0414", "BabyShark", "BabyShark has executed the whoami command.[16]"], "S0093": ["https://attack.mitre.org/software/S0093", "Backdoor.Oldrea", "Backdoor.Oldrea collects the current username from the victim.[17]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can identify the username of the infected user.[18]"], "S0017": ["https://attack.mitre.org/software/S0017", "BISCUIT", "BISCUIT has a command to gather the username from the system.[19]"], "S0521": ["https://attack.mitre.org/software/S0521", "BloodHound", "BloodHound can collect information on user sessions.[20]"], "S0657": ["https://attack.mitre.org/software/S0657", "BLUELIGHT", "BLUELIGHT can collect the username on a compromised host.[21]"], "S0486": ["https://attack.mitre.org/software/S0486", "Bonadan", "Bonadan has discovered the username of the user running the backdoor.[22]"], "S0635": ["https://attack.mitre.org/software/S0635", "BoomBox", "BoomBox can enumerate the username on a compromised host.[23]"], "S0351": ["https://attack.mitre.org/software/S0351", "Cannon", "Cannon can gather the username from the system.[24]"], "S0348": ["https://attack.mitre.org/software/S0348", "Cardinal RAT", "Cardinal RAT can collect the username from a victim machine.[25]"], "S0572": ["https://attack.mitre.org/software/S0572", "Caterpillar WebShell", "Caterpillar WebShell can obtain a list of user accounts from a victim's machine.[26]"], "S0631": ["https://attack.mitre.org/software/S0631", "Chaes", "Chaes has collected the username and UID from the infected machine.[27]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used the quser command to show currently logged on users.[28]"], "S0667": ["https://attack.mitre.org/software/S0667", "Chrommme", "Chrommme can retrieve the username from a targeted system.[29]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling can identify the username on a compromised host.[30][31]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson can identify the user on a targeted system.[32][33]"], "S0498": ["https://attack.mitre.org/software/S0498", "Cryptoistic", "Cryptoistic can gather data on the user of a compromised host.[34]"], "S0334": ["https://attack.mitre.org/software/S0334", "DarkComet", "DarkComet gathers the username from the victim’s machine.[35]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman has collected the username from a victim machine.[36]"], "S0354": ["https://attack.mitre.org/software/S0354", "Denis", "Denis enumerates and collects the username from the victim’s machine.[37][9]"], "S0021": ["https://attack.mitre.org/software/S0021", "Derusbi", "A Linux version of Derusbi checks if the victim user ID is anything other than zero (normally used for root), and the malware will not execute if it does not have root privileges. Derusbi also gathers the username of the victim.[38]"], "S0659": ["https://attack.mitre.org/software/S0659", "Diavol", "Diavol can collect the username from a compromised host.[39]"], "S0186": ["https://attack.mitre.org/software/S0186", "DownPaper", "DownPaper collects the victim username and sends it to the C2 server.[40]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly used the command query user on victim hosts.[41]"], "S0694": ["https://attack.mitre.org/software/S0694", "DRATzarus", "DRATzarus can obtain a list of users from an infected machine.[42]"], "S0024": ["https://attack.mitre.org/software/S0024", "Dyre", "Dyre has the ability to identify the users on a compromised host.[43]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor has used tools to gather information about users.[44]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic collects the user name from the victim’s machine.[45]"], "S0568": ["https://attack.mitre.org/software/S0568", "EVILNUM", "EVILNUM can obtain the username from the victim's machine.[46]"], "S0401": ["https://attack.mitre.org/software/S0401", "Exaramel for Linux", "Exaramel for Linux can run whoami to identify the system owner.[47]"], "S0569": ["https://attack.mitre.org/software/S0569", "Explosive", "Explosive has collected the username from the infected host.[48]"], "S0171": ["https://attack.mitre.org/software/S0171", "Felismus", "Felismus collects the current username and sends it to the C2 server.[49]"], "S0267": ["https://attack.mitre.org/software/S0267", "FELIXROOT", "FELIXROOT collects the username from the victim’s machine.[50][51]"], "G0051": ["https://attack.mitre.org/groups/G0051", "FIN10", "FIN10 has used Meterpreter to enumerate users on remote systems.[52]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro has been used to run the whoami command on the system.[53]"], "S0381": ["https://attack.mitre.org/software/S0381", "FlawedAmmyy", "FlawedAmmyy enumerates the current user during the initial infection.[54]"], "G0101": ["https://attack.mitre.org/groups/G0101", "Frankenstein", "Frankenstein has enumerated hosts, gathering username, machine name, and administrative permissions information.[55]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used whoami and query user to obtain information about the victim user.[56]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "A Gamaredon Group file stealer can gather the victim's username to send to a C2 server.[57]"], "S0168": ["https://attack.mitre.org/software/S0168", "Gazer", "Gazer obtains the current user's security identifier.[58]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium has the ability to distinguish between a standard user and an administrator on a compromised host.[29]"], "S0460": ["https://attack.mitre.org/software/S0460", "Get2", "Get2 has the ability to identify the current username of an infected host.[59]"], "S0249": ["https://attack.mitre.org/software/S0249", "Gold Dragon", "Gold Dragon collects the endpoint victim's username and uses it as a basis for downloading additional components from the C2 server.[60]"], "S0477": ["https://attack.mitre.org/software/S0477", "Goopy", "Goopy has the ability to enumerate the infected system's user name.[9]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can collect the username from the victim's machine.[61]"], "S0237": ["https://attack.mitre.org/software/S0237", "GravityRAT", "GravityRAT collects the victim username along with other account information (account type, description, full name, SID and status).[62]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can identify the user id on a target machine.[63]"], "S0214": ["https://attack.mitre.org/software/S0214", "HAPPYWORK", "can collect the victim user name.[64]"], "S0391": ["https://attack.mitre.org/software/S0391", "HAWKBALL", "HAWKBALL can collect the user name of the system.[65]"], "S0431": ["https://attack.mitre.org/software/S0431", "HotCroissant", "HotCroissant has the ability to collect the username on the infected host.[66]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole lists local users and session information.[67]"], "S0015": ["https://attack.mitre.org/software/S0015", "Ixeshe", "Ixeshe collects the username from the victim’s machine.[68]"], "S0201": ["https://attack.mitre.org/software/S0201", "JPIN", "JPIN can obtain the victim user name.[69]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar gathers information on users.[70]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has used implants capable of collecting the signed-in username.[71]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can identify logged in users across the domain and views user sessions.[72][73]"], "S0162": ["https://attack.mitre.org/software/S0162", "Komplex", "The OsInfo function in Komplex collects the current running username.[74]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI can collect the username from the victim’s machine.[75]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs collects registered owner details by using the commands systeminfo and net config workstation.[76]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Various Lazarus Group malware enumerates logged-on users.[77][78][79][80][81][34][82]"], "S0362": ["https://attack.mitre.org/software/S0362", "Linux Rabbit", "Linux Rabbit opens a socket on port 22 and if it receives a response it attempts to obtain the machine's hostname and Top-Level Domain. [83]"], "S0513": ["https://attack.mitre.org/software/S0513", "LiteDuke", "LiteDuke can enumerate the account name on a targeted system.[84]"], "S0680": ["https://attack.mitre.org/software/S0680", "LitePower", "LitePower can determine if the current user has admin privileges.[85]"], "S0681": ["https://attack.mitre.org/software/S0681", "Lizar", "Lizar can collect the username from the system.[86]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot has the ability to discover the username on the infected host.[87]"], "S0532": ["https://attack.mitre.org/software/S0532", "Lucifer", "Lucifer has the ability to identify the username on a compromised host.[88]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound malware has obtained the victim username and sent it to the C2 server.[89]"], "S0652": ["https://attack.mitre.org/software/S0652", "MarkiRAT", "MarkiRAT can retrieve the victim’s username.[90]"], "S0459": ["https://attack.mitre.org/software/S0459", "MechaFlounder", "MechaFlounder has the ability to identify the username and hostname on a compromised host.[91]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has collected the username from the victim's machine.[92]"], "S0339": ["https://attack.mitre.org/software/S0339", "Micropsia", "Micropsia collects the username from the victim’s machine.[93]"], "S0280": ["https://attack.mitre.org/software/S0280", "MirageFox", "MirageFox can gather the username from the victim’s machine.[94]"], "S0084": ["https://attack.mitre.org/software/S0084", "Mis-Type", "Mis-Type runs tests to determine the privilege level of the compromised user.[95]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind obtains the victim username.[96]"], "S0284": ["https://attack.mitre.org/software/S0284", "More_eggs", "More_eggs has the capability to gather the username from the victim's machine.[97][98]"], "S0256": ["https://attack.mitre.org/software/S0256", "Mosquito", "Mosquito runs whoami on the victim’s machine.[99]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used malware that can collect the victim’s username.[100][101]"], "S0228": ["https://attack.mitre.org/software/S0228", "NanHaiShu", "NanHaiShu collects the username from the victim.[102]"], "S0590": ["https://attack.mitre.org/software/S0590", "NBTscan", "NBTscan can list active users on the system.[103][104]"], "S0272": ["https://attack.mitre.org/software/S0272", "NDiskMonitor", "NDiskMonitor obtains the victim username and encrypts the information to send over its C2 channel.[105]"], "S0691": ["https://attack.mitre.org/software/S0691", "Neoichor", "Neoichor can collect the user name from a victim's machine.[71]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT enumerates the current user during the initial infection.[106]"], "S0353": ["https://attack.mitre.org/software/S0353", "NOKKI", "NOKKI can collect the username from the victim’s machine.[107]"], "S0644": ["https://attack.mitre.org/software/S0644", "ObliqueRAT", "ObliqueRAT can check for blocklisted usernames on infected endpoints.[108]"], "S0340": ["https://attack.mitre.org/software/S0340", "Octopus", "Octopus can collect the username from the victim’s machine.[109]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has run whoami on a victim.[110][111][112]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum can collect the victim username.[113]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has enumerated sessions and users on a remote host, and identified privileged users logged into a targeted system.[114]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork collected the victim username and whether it was running as admin, then sent the information to its C2 server.[115][105]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT sent username, computer name, and the previously generated UUID in reply to a \"who\" command from C2.[116]"], "S0139": ["https://attack.mitre.org/software/S0139", "PowerDuke", "PowerDuke has commands to get the current user's name and SID.[117]"], "S0441": ["https://attack.mitre.org/software/S0441", "PowerShower", "PowerShower has the ability to identify the current user on the infected host.[118]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS has the ability to identify the username on the compromised host.[119]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER may collect information about the currently logged in user by running whoami on a victim.[120]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "A module in Prikormka collects information from the victim about the current user name.[121]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy can enumerate local information for Linux hosts and find currently logged on users for Windows hosts.[122]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can identify the user name on a compromised system.[123]"], "S0269": ["https://attack.mitre.org/software/S0269", "QUADAGENT", "QUADAGENT gathers the victim username.[124]"], "S0241": ["https://attack.mitre.org/software/S0241", "RATANKBA", "RATANKBA runs the whoami and query user commands.[125]"], "S0662": ["https://attack.mitre.org/software/S0662", "RCSession", "RCSession can gather system owner information, including user and administrator privileges.[126]"], "S0172": ["https://attack.mitre.org/software/S0172", "Reaver", "Reaver collects the victim's username.[127]"], "S0153": ["https://attack.mitre.org/software/S0153", "RedLeaves", "RedLeaves can obtain information about the logged on user both locally and for Remote Desktop sessions.[128]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec can obtain information about the current user.[129]"], "S0379": ["https://attack.mitre.org/software/S0379", "Revenge RAT", "Revenge RAT gathers the username from the system.[130]"], "S0258": ["https://attack.mitre.org/software/S0258", "RGDoor", "RGDoor executes the whoami on the victim’s machine.[131]"], "S0433": ["https://attack.mitre.org/software/S0433", "Rifdoor", "Rifdoor has the ability to identify the username on the compromised host.[66]"], "S0448": ["https://attack.mitre.org/software/S0448", "Rising Sun", "Rising Sun can detect the username of the infected host.[132]"], "S0270": ["https://attack.mitre.org/software/S0270", "RogueRobin", "RogueRobin collects the victim’s username and whether that user is an admin.[133]"], "S0240": ["https://attack.mitre.org/software/S0240", "ROKRAT", "ROKRAT can collect the username from a compromised host.[134]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM can obtain the victim username and permissions.[135]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has collected the username from a compromised host.[136]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has the ability to identify the user on a compromised host.[59]"], "S0382": ["https://attack.mitre.org/software/S0382", "ServHelper", "ServHelper will attempt to enumerate the username of the victim.[137]"], "S0596": ["https://attack.mitre.org/software/S0596", "ShadowPad", "ShadowPad has collected the username of the victim system.[138]"], "S0450": ["https://attack.mitre.org/software/S0450", "SHARPSTATS", "SHARPSTATS has the ability to identify the username on the compromised host.[119]"], "S0610": ["https://attack.mitre.org/software/S0610", "SideTwist", "SideTwist can collect the username on a targeted system.[112]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has used tools to identify the user of a compromised host.[139]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can gather a list of logged on users.[140]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA has collected the username from a victim machine.[141]"], "S0649": ["https://attack.mitre.org/software/S0649", "SMOKEDHAM", "SMOKEDHAM has used whoami commands to identify system owners.[142]"], "S0627": ["https://attack.mitre.org/software/S0627", "SodaMaster", "SodaMaster can identify the username on a compromised host.[143]"], "S0615": ["https://attack.mitre.org/software/S0615", "SombRAT", "SombRAT can execute getinfo to identify the username on a compromised host.[144][145]"], "S0543": ["https://attack.mitre.org/software/S0543", "Spark", "Spark has run the whoami command and has a built-in command to identify the user logged in.[146]"], "S0374": ["https://attack.mitre.org/software/S0374", "SpeakUp", "SpeakUp uses the whoami command. [147]"], "S0058": ["https://attack.mitre.org/software/S0058", "SslMM", "SslMM sends the logged-on username to its hard-coded C2.[148]"], "G0038": ["https://attack.mitre.org/groups/G0038", "Stealth Falcon", "Stealth Falcon malware gathers the registered user and primary owner name via WMI.[149]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST collected the username from a compromised host.[150][151]"], "S0242": ["https://attack.mitre.org/software/S0242", "SynAck", "SynAck gathers user names from infected hosts.[152]"], "S0060": ["https://attack.mitre.org/software/S0060", "Sys10", "Sys10 collects the account name of the logged-in user and sends it to the C2.[148]"], "S0098": ["https://attack.mitre.org/software/S0098", "T9000", "T9000 gathers and beacons the username of the logged in account during installation. It will also gather the username of running processes to determine if it is running as SYSTEM.[153]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used whoami to collect system user information.[30]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot can identify the user and groups the user belongs to on a compromised host.[154]"], "S0094": ["https://attack.mitre.org/software/S0094", "Trojan.Karagany", "Trojan.Karagany can gather information about the user on a compromised host.[155]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper used letmein to scan for saved usernames on the target system.[156]"], "S0647": ["https://attack.mitre.org/software/S0647", "Turian", "Turian can retrieve usernames.[157]"], "S0130": ["https://attack.mitre.org/software/S0130", "Unknown Logger", "Unknown Logger can obtain information about the victim usernames.[158]"], "S0275": ["https://attack.mitre.org/software/S0275", "UPPERCUT", "UPPERCUT has the capability to collect the current logged on user’s username from a machine.[159]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak can gather information regarding the user.[160]"], "S0257": ["https://attack.mitre.org/software/S0257", "VERMIN", "VERMIN gathers the username from the victim’s machine.[161]"], "S0515": ["https://attack.mitre.org/software/S0515", "WellMail", "WellMail can identify the current username on the victim system.[162]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess can collect the username on the victim machine to send to C2.[163]"], "S0155": ["https://attack.mitre.org/software/S0155", "WINDSHIELD", "WINDSHIELD can gather the victim user name.[164]"], "G0112": ["https://attack.mitre.org/groups/G0112", "Windshift", "Windshift has used malware to identify the username on a compromised host.[165]"], "S0219": ["https://attack.mitre.org/software/S0219", "WINERACK", "WINERACK can gather information on the victim username.[64]"], "S0059": ["https://attack.mitre.org/software/S0059", "WinMM", "WinMM uses NetUser-GetInfo to identify that it is running under an \"Admin\" account on the local system.[148]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used \"whoami\" to identify the local user and their privileges.[166]"], "S0161": ["https://attack.mitre.org/software/S0161", "XAgentOSX", "XAgentOSX contains the getInfoOSX function to return the OS X version as well as the current user.[167]"], "S0248": ["https://attack.mitre.org/software/S0248", "yty", "yty collects the victim’s username.[168]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy gets the username from the system.[169][170]"], "G0128": ["https://attack.mitre.org/groups/G0128", "ZIRCONIUM", "ZIRCONIUM has used a tool to capture the username on a compromised host in order to register it with C2.[171]"], "S0350": ["https://attack.mitre.org/software/S0350", "zwShell", "zwShell can obtain the name of the logged-in user on the victim.[172]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell can collect the owner and organization information from the target workstation.[173]"]}, "Mitigation": {}, "Detection": {"Active Directory Object Access": ["Monitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync. [174] [175] [176] Note: Domain controllers may not log replication requests originating from the default domain controller account. [177]. Monitor for replication requests [178] from IPs not associated with known domain controllers. [179]", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"], "Command Execution": ["Monitor executed commands and arguments that may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software. Look for command-lines that invoke AuditD or the Security Accounts Manager (SAM). Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module, [180] which may require additional logging features to be configured in the operating system to collect necessary information for analysis.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor for hash dumpers opening the Security Accounts Manager (SAM) on the local file system (%SystemRoot%/system32/config/SAM). Some hash dumpers will open the local file system as a device and parse to the SAM table to avoid file access defenses. Others will make an in-memory copy of the SAM table before reading hashes. Detection of compromised Valid Accounts in-use by adversaries may help as well.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""], "OS API Execution": ["Monitor for API calls that may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Access": ["Monitor for unexpected processes interacting with lsass.exe.[181] Common credential dumpers such as Mimikatz access the LSA Subsystem Service (LSASS) process by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored. Credential dumpers may also use methods for reflective Process Injection to reduce potential indicators of malicious activity.To obtain the passwords and hashes stored in memory, processes must open a maps file in the /proc filesystem for the process being analyzed. This file is stored under the path /proc/<pid>/maps, where the <pid> directory is the unique pid of the program being interrogated for such authentication data. The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes opening this file in the proc file system, alerting on the pid, process name, and arguments of such programs.", "", "", ""], "Process Creation": ["Monitor for newly executed processes that may be indicative of credential dumping. On Windows 8.1 and Windows Server 2012 R2, monitor Windows Logs for LSASS.exe creation to verify that LSASS started as a protected process.", "", "", ""], "Windows Registry Key Access": ["Monitor for the SAM registry key being accessed that may attempt to dump credentials to obtain account login and credential material, normally in the form of a hash or a clear text password, from the operating system and software.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
