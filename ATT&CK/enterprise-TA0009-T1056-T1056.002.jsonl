{"TTP_id": "enterprise-TA0009-T1056-T1056.002", "TTP_name": "GUI Input Capture", "Description": "Adversaries may mimic common operating system GUI components to prompt users for credentials with a seemingly legitimate prompt. When programs are executed that need additional privileges than are present in the current user context, it is common for the operating system to prompt the user for proper credentials to authorize the elevated privileges for the task (ex: Bypass User Account Control).Adversaries may mimic this functionality to prompt users for credentials with a seemingly legitimate prompt for a number of reasons that mimic normal usage, such as a fake installer requiring additional access or a fake malware removal suite.[1] This type of prompt can be used to collect credentials via various languages such as AppleScript[2][3][4] and PowerShell.[2][5][4] On Linux systems adversaries may launch dialog boxes prompting users for credentials from malicious shell scripts or the command line (i.e. Unix Shell).[4]", "Property": {"ID": "T1056.002", "Sub-technique of": "T1056", "Tactics": "Collection, Credential Access", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "CAPEC ID": "CAPEC-659", "Contributors": "Matthew Molyett, @s1air, Cisco Talos", "Version": "1.2", "Created": "11 February 2020", "Last Modified": "08 March 2022"}, "Examples": {"S0482": ["https://attack.mitre.org/software/S0482", "Bundlore", "Bundlore prompts the user for their credentials.[6]"], "S0274": ["https://attack.mitre.org/software/S0274", "Calisto", "Calisto presents an input prompt asking for the user's login and password.[7]"], "S0281": ["https://attack.mitre.org/software/S0281", "Dok", "Dok prompts the user for credentials.[8]"], "G0085": ["https://attack.mitre.org/groups/G0085", "FIN4", "FIN4 has presented victims with spoofed Windows Authentication prompts to collect their credentials.[9][10]"], "S0278": ["https://attack.mitre.org/software/S0278", "iKitten", "iKitten prompts the user for their credentials.[8]"], "S0276": ["https://attack.mitre.org/software/S0276", "Keydnap", "Keydnap prompts the users for credentials.[11]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has displayed fake forms on top of banking sites to intercept credentials from victims.[12]"], "S0279": ["https://attack.mitre.org/software/S0279", "Proton", "Proton prompts users for their credentials.[8]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY's credphisher.py module can prompt a current user for their credentials.[13]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET prompts the user to input credentials using a native macOS dialog box leveraging the system process /Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment.[14]"]}, "Mitigation": {"M1017": ["https://attack.mitre.org/mitigations/M1017", "User Training", "Use user training as a way to bring awareness and raise suspicion for potentially malicious events and dialog boxes (ex: Office documents prompting for credentials)."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments, such as requests for credentials and/or strings related to creating password prompts that may be malicious.[4]", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor for newly executed processes", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
