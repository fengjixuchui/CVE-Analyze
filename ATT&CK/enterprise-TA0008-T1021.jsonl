{"TTP_id": "enterprise-TA0008-T1021", "TTP_name": "Remote Services", "Description": "Adversaries may use Valid Accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user.In an enterprise environment, servers and workstations can be organized into domains. Domains provide centralized identity management, allowing users to login using one set of credentials across the entire network. If an adversary is able to obtain a set of valid domain credentials, they could login to many different machines using remote access protocols such as secure shell (SSH) or remote desktop protocol (RDP).[1][2]Legitimate applications (such as Software Deployment Tools and other administrative programs) may utilize Remote Services to access remote hosts. For example, Apple Remote Desktop (ARD) on macOS is native software used for remote management. ARD leverages a blend of protocols, including VNC to send the screen and control buffers and SSH for secure file transfer.[3][4][5] Adversaries can abuse applications such as ARD to gain remote code execution and perform lateral movement. In versions of macOS prior to 10.14, an adversary can escalate an SSH session to an ARD session which enables an adversary to accept TCC (Transparency, Consent, and Control) prompts without user interaction and gain access to data.[6][7][4]", "Property": {"ID": "T1021", "Sub-techniques": "T1021.001, T1021.002, T1021.003, T1021.004, T1021.005, T1021.006", "Tactic": "Lateral Movement", "Platforms": "Linux, Windows, macOS", "System Requirements": "Active remote service accepting connections and valid credentials", "CAPEC ID": "CAPEC-555", "Contributors": "Dan Borges, @1njection", "Version": "1.2", "Created": "31 May 2017", "Last Modified": "28 March 2022"}, "Examples": {"S0437": ["https://attack.mitre.org/software/S0437", "Kivars", "Kivars has the ability to remotely trigger keyboard input and mouse clicks. [8]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet can propagate via peer-to-peer communication and updates using RPC.[9]"]}, "Mitigation": {"M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Use multi-factor authentication on remote service logons where possible."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Limit the accounts that may use remote services. Limit the permissions for accounts that are at higher risk of compromise; for example, configure SSH so users can only run specific programs."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may use Valid Accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Logon Session Creation": ["Monitor for user accounts logged into systems they would not normally access or abnormal access patterns, such as multiple systems over a relatively short period of time. Correlate use of login activity related to remote services with unusual behavior or other malicious or suspicious activity. Adversaries will likely need to learn about an environment and the relationships between systems through Discovery techniques prior to attempting Lateral Movement. For example, in macOS you can review logs for \"screensharingd\" and \"Authentication\" event messages. [7][10]", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "Module Load": ["Monitor DLL/PE file events, specifically creation of these binary files as well as the loading of DLLs into processes, that may use Valid Accounts to log into a service specifically designed to accept remote connections, such as telnet, SSH, and VNC. The adversary may then perform actions as the logged-on user.", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "Network Share Access": ["Monitor interactions with network shares, such as reads or file transfers, using remote services such as Server Message Block (SMB).", "DS0033", "https://attack.mitre.org/datasources/DS0033", "Network Share"], "Network Connection Creation": ["Monitor for newly constructed network connections that may use Valid Accounts to log into a service specifically designed to accept remote connections, such as RDP, telnet, SSH, and VNC. Monitor network connections involving common remote management protocols, such as ports tcp:3283 and tcp:5900, as well as ports tcp: 3389 and tcp:22 for remote login.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data for uncommon data flows that may be related to abuse of /techniques/T1078 to log into a service specifically designed to accept remote connections, such as RDP, telnet, SSH, and VNC.", "", "", ""], "Process Creation": ["Monitor for newly executed processes that may use Valid Accounts to log into a service specifically designed to accept remote connections, such as RDP, telnet, SSH, and VNC. The adversary may then perform actions that spawn additional processes as the logged-on user.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
