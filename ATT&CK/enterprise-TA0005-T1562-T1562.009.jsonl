{"TTP_id": "enterprise-TA0005-T1562-T1562.009", "TTP_name": "Safe Mode Boot", "Description": "Adversaries may abuse Windows safe mode to disable endpoint defenses. Safe mode starts up the Windows operating system with a limited set of drivers and services. Third-party security software such as endpoint detection and response (EDR) tools may not start after booting Windows in safe mode. There are two versions of safe mode: Safe Mode and Safe Mode with Networking. It is possible to start additional services after a safe mode boot.[1][2]Adversaries may abuse safe mode to disable endpoint defenses that may not start with a limited boot. Hosts can be forced into safe mode after the next reboot via modifications to Boot Configuration Data (BCD) stores, which are files that manage boot application settings.[3]Adversaries may also add their malicious applications to the list of minimal services that start in safe mode by modifying relevant Registry values (i.e. Modify Registry). Malicious Component Object Model (COM) objects may also be registered and loaded in safe mode.[2][4][5][6]", "Property": {"ID": "T1562.009", "Sub-technique of": "T1562", "Tactic": "Defense Evasion", "Platforms": "Windows", "Permissions Required": "Administrator", "Defense Bypassed": "Anti-virus, Host Intrusion Prevention Systems", "Contributors": "Jorell Magtibay, National Australia Bank Limited; Kiyohito Yamamoto, RedLark, NTT Communications; Yusuke Kubo, RedLark, NTT Communications", "Version": "1.0", "Created": "23 June 2021", "Last Modified": "31 August 2021"}, "Examples": {"S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil can force a reboot in safe mode with networking.[6]"]}, "Mitigation": {"M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Restrict administrator accounts to as few individuals as possible, following least privilege principles, that may be abused to remotely boot a machine in safe mode.[4]"], "M1054": ["https://attack.mitre.org/mitigations/M1054", "Software Configuration", "Ensure that endpoint defenses run in safe mode.[4]"]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments associated with making configuration changes to boot settings, such as bcdedit.exe and bootcfg.exe.[3][7][2]", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes that may abuse Windows safe mode to disable endpoint defenses.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Windows Registry Key Creation": ["Monitor Registry creation for services that may start on safe mode. For example, a program can be forced to start on safe mode boot by adding a * in front of the \"Startup\" value name: HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run[\"*Startup\"=\"{Path}\"] or by adding a key to HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal.[6][2]", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"], "Windows Registry Key Modification": ["Monitor modifications to Registry data associated with enabling safe mode. For example, a service can be forced to start on safe mode boot by adding a * in front of the \"Startup\" value name: HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run[\"*Startup\"=\"{Path}\"] or by adding a key to HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal.[6][2]", "", "", ""]}}
