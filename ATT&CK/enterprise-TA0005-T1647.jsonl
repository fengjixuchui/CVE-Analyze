{"TTP_id": "enterprise-TA0005-T1647", "TTP_name": "Plist File Modification", "Description": "Adversaries may modify property list files (plist files) to enable other malicious activity, while also potentially evading and bypassing system defenses. macOS applications use plist files, such as the info.plist file, to store properties and configuration settings that inform the operating system how to handle the application at runtime. Plist files are structured metadata in key-value pairs formatted in XML based on Apple's Core Foundation DTD. Plist files can be saved in text or binary format.[1]Adversaries can modify key-value pairs in plist files to influence system behaviors, such as hiding the execution of an application (i.e. Hidden Window) or running additional commands for persistence (ex: Launch Agent/Launch Daemon or Re-opened Applications).For example, adversaries can add a malicious application path to the ~/Library/Preferences/com.apple.dock.plist file, which controls apps that appear in the Dock. Adversaries can also modify the LSUIElement key in an applicationâ€™s info.plist file to run the app in the background. Adversaries can also insert key-value pairs to insert environment variables, such as LSEnvironment, to enable persistence via Dynamic Linker Hijacking.[2][3]", "Property": {"ID": "T1647", "Sub-techniques": "No sub-techniques", "Tactic": "Defense Evasion", "Platforms": "macOS", "Version": "1.0", "Created": "09 April 2022", "Last Modified": "20 April 2022"}, "Examples": {"S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET uses the plutil command to modify the LSUIElement, DFBundleDisplayName, and CFBundleIdentifier keys in the /Contents/Info.plist file to change how XCSSET is visible on the system.[4]"]}, "Mitigation": {"M1013": ["https://attack.mitre.org/mitigations/M1013", "Application Developer Guidance", "Ensure applications are using Apple's developer guidance which enables hardened runtime.[5]"]}, "Detection": {"Command Execution": ["Monitor for commands with arguments (such as opening common command-line editors) used to modify plist files, especially commonly abused files such as those in \\~/LaunchAgents, \\~/Library/Application Support/com.apple.backgroundtaskmanagementagent/backgrounditems.btm, and an application's Info.plist.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Modification": ["Monitor for plist file modification, especially if immediately followed by other suspicious events such as code execution from \\~/Library/Scripts or \\~/Library/Preferences. Also, monitor for significant changes to any path pointers in a modified plist.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Process Creation": ["Monitor for newly executed processes with arguments that can modify property list (plist) files.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
