{"TTP_id": "enterprise-TA0005-T1218-T1218.013", "TTP_name": "Mavinject", "Description": "Adversaries may abuse mavinject.exe to proxy execution of malicious code. Mavinject.exe is the Microsoft Application Virtualization Injector, a Windows utility that can inject code into external processes as part of Microsoft Application Virtualization (App-V).[1]Adversaries may abuse mavinject.exe to inject malicious DLLs into running processes (i.e. Dynamic-link Library Injection), allowing for arbitrary code execution (ex. C:\\Windows\\system32\\mavinject.exe PID /INJECTRUNNING PATH_DLL).[2][3] Since mavinject.exe may be digitally signed by Microsoft, proxying execution via this method may evade detection by security products because the execution is masked under a legitimate process.In addition to Dynamic-link Library Injection, Mavinject.exe can also be abused to perform import descriptor injection via its /HMODULE command-line parameter (ex. mavinject.exe PID /HMODULE=BASE_ADDRESS PATH_DLL ORDINAL_NUMBER). This command would inject an import table entry consisting of the specified DLL into the module at the given base address.[4]", "Property": {"ID": "T1218.013", "Sub-technique of": "T1218", "Tactic": "Defense Evasion", "Platforms": "Windows", "Version": "2.0", "Created": "22 September 2021", "Last Modified": "19 April 2022"}, "Examples": {}, "Mitigation": {"M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Consider removing mavinject.exe if Microsoft App-V is not used within a given environment."], "M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Use application control configured to block execution of mavinject.exe if it is not required for a given system or network to prevent potential misuse by adversaries."]}, "Detection": {"Command Execution": ["Adversaries may rename abusable binaries to evade detections, but the argument INJECTRUNNING is required for mavinject.exe to perform Dynamic-link Library Injection and may therefore be monitored to alert malicious activity.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor the execution and arguments of mavinject.exe. Compare recent invocations of mavinject.exe with prior history of known good arguments and injected DLLs to determine anomalous and potentially adversarial activity.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
