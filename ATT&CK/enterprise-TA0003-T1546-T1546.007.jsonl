{"TTP_id": "enterprise-TA0003-T1546-T1546.007", "TTP_name": "Netsh Helper DLL", "Description": "Adversaries may establish persistence by executing malicious content triggered by Netsh Helper DLLs. Netsh.exe (also referred to as Netshell) is a command-line scripting utility used to interact with the network configuration of a system. It contains functionality to add helper DLLs for extending functionality of the utility.[1] The paths to registered netsh.exe helper DLLs are entered into the Windows Registry at HKLM\\SOFTWARE\\Microsoft\\Netsh.Adversaries can use netsh.exe helper DLLs to trigger execution of arbitrary code in a persistent manner. This execution would take place anytime netsh.exe is executed, which could happen automatically, with another persistence technique, or if other software (ex: VPN) is present on the system that executes netsh.exe as part of its normal functionality.[2][3]", "Property": {"ID": "T1546.007", "Sub-technique of": "T1546", "Tactics": "Privilege Escalation, Persistence", "Platforms": "Windows", "Permissions Required": "Administrator, SYSTEM", "Contributors": "Matthew Demaske, Adaptforward", "Version": "1.0", "Created": "24 January 2020", "Last Modified": "20 April 2022"}, "Examples": {"S0108": ["https://attack.mitre.org/software/S0108", "netsh", "netsh can be used as a persistence proxy technique to execute a helper DLL when netsh.exe is executed.[3]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may establish persistence by executing malicious content triggered by Netsh Helper DLLs.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Module Load": ["Monitor DLL/PE file events, specifically creation of these binary files as well as the loading of DLLs into processes. Look for DLLs that are not recognized or not normally loaded into a process.", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "Process Creation": ["It is likely unusual for netsh.exe to have any child processes in most environments. Monitor process executions and investigate any child processes spawned by netsh.exe for malicious behavior.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Windows Registry Key Modification": ["Monitor the HKLM\\SOFTWARE\\Microsoft\\Netsh registry key for any new or suspicious entries that do not correlate with known system files or benign software. [3]", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
