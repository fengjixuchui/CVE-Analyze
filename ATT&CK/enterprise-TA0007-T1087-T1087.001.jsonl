{"TTP_id": "enterprise-TA0007-T1087-T1087.001", "TTP_name": "Local Account", "Description": "Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.Commands such as net user and net localgroup of the Net utility and id and groupson macOS and Linux can list local users and groups. On Linux, local users can also be enumerated through the use of the /etc/passwd file. On macOS the dscl . list /Users command can be used to enumerate local accounts.", "Property": {"ID": "T1087.001", "Sub-technique of": "T1087", "Tactic": "Discovery", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Contributors": "Daniel Stepanic, Elastic", "Version": "1.2", "Created": "21 February 2020", "Last Modified": "28 July 2021"}, "Examples": {"G0018": ["https://attack.mitre.org/groups/G0018", "admin@338", "admin@338 actors used the following commands following exploitation of a machine with LOWBALL malware to enumerate user accounts: net user >> %temp%\\download net user /domain >> %temp%\\download[1]"], "S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla can collect account information from the victim’s machine.[2]"], "G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 used the commands net localgroup,net user, and net group to find accounts on the system.[3]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has used a tool that can obtain info about local and global group users, power users, and administrators.[4]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 enumerated administrative users using the commands net localgroup administrators.[5]"], "S0239": ["https://attack.mitre.org/software/S0239", "Bankshot", "Bankshot gathers domain and account names/information through process monitoring.[6]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can identify administrator accounts on an infected host.[7]"], "S0570": ["https://attack.mitre.org/software/S0570", "BitPaymer", "BitPaymer can enumerate the sessions for each user logged onto the infected host.[8]"], "S0521": ["https://attack.mitre.org/software/S0521", "BloodHound", "BloodHound can identify users with local administrator rights.[9]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used net user for account discovery.[10]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie uses the net user command.[11]"], "S0038": ["https://attack.mitre.org/software/S0038", "Duqu", "The discovery modules used with Duqu can collect information on accounts and permissions.[12]"], "S0081": ["https://attack.mitre.org/software/S0081", "Elise", "Elise executes net user after initial communication is made to the remote server.[13]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can acquire local and domain user account information.[14]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic gathers a list of all user accounts, privilege classes, and time of last logon.[15]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has accessed ntuser.dat and UserClass.dat on compromised hosts.[16]"], "S0049": ["https://attack.mitre.org/software/S0049", "GeminiDuke", "GeminiDuke collects information on local user accounts from the victim.[17]"], "S0537": ["https://attack.mitre.org/software/S0537", "HyperStack", "HyperStack can enumerate all account names on a remote share.[18]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole has a command to list account information on the victim’s machine.[19]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar gathers information on local groups and members on the victim’s machine.[20]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang performs account discovery using commands such as net localgroup administrators and net group \"REDACTED\" /domain on specific permissions groups.[21]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs collects a list of accounts with the command net users.[22]"], "S0084": ["https://attack.mitre.org/software/S0084", "Mis-Type", "Mis-Type may create a file containing the results of the command cmd.exe /c net user {Username}.[23]"], "S0233": ["https://attack.mitre.org/software/S0233", "MURKYTOP", "MURKYTOP has the capability to retrieve information about users on remote hosts.[24]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "Commands under net user can be used in Net to gather information about and manipulate user accounts.[25]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has run net user, net user /domain, net group \"domain admins\" /domain, and net group \"Exchange Trusted Subsystem\" /domain to get account listings on a victim.[26]"], "S0165": ["https://attack.mitre.org/software/S0165", "OSInfo", "OSInfo enumerates local and domain users[4]"], "S0598": ["https://attack.mitre.org/software/S0598", "P.A.S. Webshell", "P.A.S. Webshell can display the /etc/passwd file on a compromised host.[27]"], "S0453": ["https://attack.mitre.org/software/S0453", "Pony", "Pony has used the NetUserEnum function to enumerate local accounts.[28]"], "G0033": ["https://attack.mitre.org/groups/G0033", "Poseidon Group", "Poseidon Group searches for administrator accounts on both the local victim machine and the network.[29]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 can enumerate local and domain user account information.[30]"], "S0194": ["https://attack.mitre.org/software/S0194", "PowerSploit", "PowerSploit's Get-ProcessTokenGroup Privesc-PowerUp module can enumerate all SIDs associated with its current token.[31][32]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS can retrieve usernames from compromised hosts.[33]"], "S0196": ["https://attack.mitre.org/software/S0196", "PUNCHBUGGY", "PUNCHBUGGY can gather user names.[34]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy uses PowerView and Pywerview to perform discovery commands such as net user, net group, net local group, etc.[35]"], "S0241": ["https://attack.mitre.org/software/S0241", "RATANKBA", "RATANKBA uses the net user command.[36]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec can obtain a list of users.[37]"], "S0085": ["https://attack.mitre.org/software/S0085", "S-Type", "S-Type runs the command net user on a victim. S-Type also runs tests to determine the privilege level of the compromised user.[23]"], "S0063": ["https://attack.mitre.org/software/S0063", "SHOTPUT", "SHOTPUT has a command to retrieve information about connected users.[38]"], "S0649": ["https://attack.mitre.org/software/S0649", "SMOKEDHAM", "SMOKEDHAM has used net.exe user and net.exe users to enumerate local accounts on a compromised host.[39]"], "S0516": ["https://attack.mitre.org/software/S0516", "SoreFang", "SoreFang can collect usernames from the local system via net.exe user.[40]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet enumerates user accounts of the local host.[41]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used net user to conduct internal discovery of systems.[42]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot collects the users of the system.[43][44]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has used net user to enumerate local accounts on the system.[45][46]"], "S0452": ["https://attack.mitre.org/software/S0452", "USBferry", "USBferry can use net user to gather information about local accounts.[47]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak has the ability to enumerate local admin accounts.[48]"]}, "Mitigation": {"M1028": ["https://attack.mitre.org/mitigations/M1028", "Operating System Configuration", "Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located at HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts on elevation.[49]"]}, "Detection": {"Command Execution": ["Monitor for execution of commands and arguments associated with enumeration or information gathering of local accounts and groups such as net user, net account, net localgroup, Get-LocalUser, and dscl.System and network discovery techniques normally occur throughout an operation as an adversary learns the environment, and also to an extent in normal network operations. Therefore discovery data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor access to file resources that contain local accounts and groups information such as /etc/passwd, /Users directories, and the Windows SAM database.If access requires high privileges, look for non-admin objects (such as users or processes) attempting to access restricted file resources.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "OS API Execution": ["Monitor for API calls (such as NetUserEnum()) that may attempt to gather local accounts information such as type of user, privileges and groups.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for processes that can be used to enumerate user accounts and groups such as net.exe and net1.exe, especially when executed in quick succession.[50] Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.", "", "", ""]}}
