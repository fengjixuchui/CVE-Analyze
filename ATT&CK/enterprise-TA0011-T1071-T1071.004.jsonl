{"TTP_id": "enterprise-TA0011-T1071-T1071.004", "TTP_name": "DNS", "Description": "Adversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.The DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.[1][2]", "Property": {"ID": "T1071.004", "Sub-technique of": "T1071", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Contributors": "Jan Petrov, Citi", "Version": "1.0", "Created": "15 March 2020", "Last Modified": "21 October 2020"}, "Examples": {"S0504": ["https://attack.mitre.org/software/S0504", "Anchor", "Variants of Anchor can use DNS tunneling to communicate with C2.[3][4]"], "G0026": ["https://attack.mitre.org/groups/G0026", "APT18", "APT18 uses DNS for C2 communications.[5]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used remote access tools that leverage DNS in communications with C2.[6]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used DNS for C2 communications.[7][8]"], "S0360": ["https://attack.mitre.org/software/S0360", "BONDUPDATER", "BONDUPDATER can use DNS and TXT records within its DNS tunneling protocol for command and control.[9]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used Cobalt Strike to encapsulate C2 in DNS traffic.[10]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has used DNS tunneling for C2.[11][12][13]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can use a custom command and control protocol that can be encapsulated in DNS. All protocols use their standard assigned ports.[14][15][16]"], "S0338": ["https://attack.mitre.org/software/S0338", "Cobian RAT", "Cobian RAT uses DNS for C2.[17]"], "S0354": ["https://attack.mitre.org/software/S0354", "Denis", "Denis has used DNS tunneling for C2 communications.[18][19][20]"], "S0377": ["https://attack.mitre.org/software/S0377", "Ebury", "Ebury has used DNS requests over UDP port 53 for C2.[21]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 has performed C2 using DNS via A, OPT, and TXT records.[22]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium has the ability to use DNS in communication with C2.[23]"], "S0477": ["https://attack.mitre.org/software/S0477", "Goopy", "Goopy has the ability to communicate with its C2 over DNS.[20]"], "S0690": ["https://attack.mitre.org/software/S0690", "Green Lambert", "Green Lambert can use DNS for C2 communications.[24][25]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "Helminth can use DNS for C2.[26]"], "S0070": ["https://attack.mitre.org/software/S0070", "HTTPBrowser", "HTTPBrowser has used DNS for command and control.[27][28]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole has used a custom implementation of DNS tunneling to embed C2 communications in DNS requests and replies.[29]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang malware RoyalDNS has used DNS for C2.[30]"], "G0140": ["https://attack.mitre.org/groups/G0140", "LazyScripter", "LazyScripter has leveraged dynamic DNS providers for C2 communications.[31]"], "S0167": ["https://attack.mitre.org/software/S0167", "Matryoshka", "Matryoshka uses DNS for C2.[32][33]"], "S0699": ["https://attack.mitre.org/software/S0699", "Mythic", "Mythic supports DNS-based C2 profiles.[34]"], "S0228": ["https://attack.mitre.org/software/S0228", "NanHaiShu", "NanHaiShu uses DNS for the C2 communications.[35]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used DNS for C2 including the publicly available requestbin.net tunneling service.[36][37][38][39]"], "S0124": ["https://attack.mitre.org/software/S0124", "Pisloader", "Pisloader uses DNS as its C2 protocol.[40]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX can be configured to use DNS for command and control.[27]"], "S0145": ["https://attack.mitre.org/software/S0145", "POWERSOURCE", "POWERSOURCE uses DNS TXT records for C2.[41][42]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER can use DNS for C2 communications.[43][37]"], "S0269": ["https://attack.mitre.org/software/S0269", "QUADAGENT", "QUADAGENT uses DNS for C2 communications.[44]"], "S0495": ["https://attack.mitre.org/software/S0495", "RDAT", "RDAT has used DNS to communicate with the C2.[45]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec is capable of using DNS for C2.[46][47][48]"], "S0596": ["https://attack.mitre.org/software/S0596", "ShadowPad", "ShadowPad has used DNS tunneling for C2 communications.[49]"], "S0633": ["https://attack.mitre.org/software/S0633", "Sliver", "Sliver can support C2 communications over DNS.[50][51][52]"], "S0615": ["https://attack.mitre.org/software/S0615", "SombRAT", "SombRAT can communicate over DNS with the C2 server.[53][54]"], "S0157": ["https://attack.mitre.org/software/S0157", "SOUNDBITE", "SOUNDBITE communicates via DNS for C2.[55]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST used DNS for C2 traffic designed to mimic normal SolarWinds API communications.[56]"], "S0146": ["https://attack.mitre.org/software/S0146", "TEXTMATE", "TEXTMATE uses DNS TXT records for C2.[41]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper's backdoor has communicated to the C2 over the DNS protocol.[57]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess has the ability to use DNS tunneling for C2 communications.[58][59]"]}, "Mitigation": {"M1037": ["https://attack.mitre.org/mitigations/M1037", "Filter Network Traffic", "Consider filtering DNS requests to unknown, untrusted, or known bad domains and resources. Resolving DNS requests with on-premise/proxy servers may also disrupt adversary attempts to conceal data within DNS packets."], "M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."]}, "Detection": {"Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for DNSSEC traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor for DNS traffic to/from known-bad or suspicious domains and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""]}}
