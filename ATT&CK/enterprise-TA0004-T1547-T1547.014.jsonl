{"TTP_id": "enterprise-TA0004-T1547-T1547.014", "TTP_name": "Active Setup", "Description": "Adversaries may achieve persistence by adding a Registry key to the Active Setup of the local machine. Active Setup is a Windows mechanism that is used to execute programs when a user logs in. The value stored in the Registry key will be executed after a user logs into the computer.[1] These programs will be executed under the context of the user and will have the account's associated permissions level.Adversaries may abuse Active Setup by creating a key under HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\ and setting a malicious value for StubPath. This value will serve as the program that will be executed when a user logs into the computer.[2][3][4][5][6]Adversaries can abuse these components to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use Masquerading to make the Registry entries look as if they are associated with legitimate programs.", "Property": {"ID": "T1547.014", "Sub-technique of": "T1547", "Tactics": "Persistence, Privilege Escalation", "Platforms": "Windows", "Permissions Required": "Administrator", "Contributors": "Bencherchali Nasreddine, @nas_bench, ELIT Security Team (DSSD)", "Version": "1.0", "Created": "18 December 2020", "Last Modified": "05 March 2021"}, "Examples": {"S0012": ["https://attack.mitre.org/software/S0012", "PoisonIvy", "PoisonIvy creates a Registry key in the Active Setup pointing to a malicious executable.[7][6][8]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may achieve persistence by adding a Registry key to the Active Setup of the local machine.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes that may achieve persistence by adding a Registry key to the Active Setup of the local machine.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Windows Registry Key Creation": ["Monitor Registry key additions to HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\.Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the Active Setup Registry locations and startup folders.[9] Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"], "Windows Registry Key Modification": ["Monitor Registry key modifications to HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\.Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the Active Setup Registry locations and startup folders.[9] Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.", "", "", ""]}}
