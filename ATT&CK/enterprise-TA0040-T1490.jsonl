{"TTP_id": "enterprise-TA0040-T1490", "TTP_name": "Inhibit System Recovery", "Description": "Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.[1][2] This may deny access to available backups and recovery options.Operating systems may contain features that can help fix corrupted systems, such as a backup catalog, volume shadow copies, and automatic repair features. Adversaries may disable or delete system recovery features to augment the effects of Data Destruction and Data Encrypted for Impact.[1][2]A number of native Windows utilities have been used by adversaries to disable or delete system recovery features:", "Property": {"ID": "T1490", "Sub-techniques": "No sub-techniques", "Tactic": "Impact", "Platforms": "Linux, Windows, macOS", "Impact Type": "Availability", "Contributors": "Yonatan Gotlib, Deep Instinct", "Version": "1.1", "Created": "02 April 2019", "Last Modified": "19 April 2022"}, "Examples": {"S0640": ["https://attack.mitre.org/software/S0640", "Avaddon", "Avaddon deletes backups and shadow copies using native system tools.[3][4]"], "S0638": ["https://attack.mitre.org/software/S0638", "Babuk", "Babuk has the ability to delete shadow volumes using vssadmin.exe delete shadows /all /quiet.[5][6]"], "S0570": ["https://attack.mitre.org/software/S0570", "BitPaymer", "BitPaymer attempts to remove the backup shadow files from the host using vssadmin.exe Delete Shadows /All /Quiet.[7]"], "S0611": ["https://attack.mitre.org/software/S0611", "Clop", "Clop can delete the shadow volumes with vssadmin Delete Shadows /all /quiet and can use bcdedit to disable recovery options.[8]"], "S0608": ["https://attack.mitre.org/software/S0608", "Conficker", "Conficker resets system restore points and deletes backup files.[9]"], "S0575": ["https://attack.mitre.org/software/S0575", "Conti", "Conti can delete Windows Volume Shadow Copies using vssadmin.[10]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can delete shadow volumes using vssadmin.exe.[11]"], "S0616": ["https://attack.mitre.org/software/S0616", "DEATHRANSOM", "DEATHRANSOM can delete volume shadow copies on compromised hosts.[12]"], "S0659": ["https://attack.mitre.org/software/S0659", "Diavol", "Diavol can delete shadow copies using the IVssBackupComponents COM object to call the DeleteSnapshots method.[13]"], "S0605": ["https://attack.mitre.org/software/S0605", "EKANS", "EKANS removes backups of Volume Shadow Copies to disable any restoration capabilities.[14][15]"], "S0618": ["https://attack.mitre.org/software/S0618", "FIVEHANDS", "FIVEHANDS has the ability to delete volume shadow copies on compromised hosts.[12][16]"], "S0132": ["https://attack.mitre.org/software/S0132", "H1N1", "H1N1 disable recovery options and deletes shadow copies from the victim.[17]"], "S0617": ["https://attack.mitre.org/software/S0617", "HELLOKITTY", "HELLOKITTY can delete volume shadow copies on compromised hosts.[12]"], "S0697": ["https://attack.mitre.org/software/S0697", "HermeticWiper", "HermeticWiper can disable the VSS service on a compromised host using the service control manager.[18][19][20]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can can remove all system restore points.[21]"], "S0389": ["https://attack.mitre.org/software/S0389", "JCry", "JCry has been observed deleting shadow copies to ensure that data cannot be restored easily.[22]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "Maze has attempted to delete the shadow volumes of infected machines, once before and once after the encryption process.[23][24]"], "S0576": ["https://attack.mitre.org/software/S0576", "MegaCortex", "MegaCortex has deleted volume shadow copies using vssadmin.exe.[25]"], "S0688": ["https://attack.mitre.org/software/S0688", "Meteor", "Meteor can use bcdedit to delete different boot identifiers on a compromised host; it can also use vssadmin.exe delete shadows /all /quiet and C:\\\\Windows\\\\system32\\\\wbem\\\\wmic.exe shadowcopy delete.[26]"], "S0457": ["https://attack.mitre.org/software/S0457", "Netwalker", "Netwalker can delete the infected system's Shadow Volumes to prevent recovery.[27][28]"], "S0365": ["https://attack.mitre.org/software/S0365", "Olympic Destroyer", "Olympic Destroyer uses the native Windows utilities vssadmin, wbadmin, and bcdedit to delete and disable operating system recovery features such as the Windows backup catalog and Windows Automatic Repair.[1]"], "S0654": ["https://attack.mitre.org/software/S0654", "ProLock", "ProLock can use vssadmin.exe to remove volume shadow copies.[29]"], "S0583": ["https://attack.mitre.org/software/S0583", "Pysa", "Pysa has the functionality to delete shadow copies.[30]"], "S0481": ["https://attack.mitre.org/software/S0481", "Ragnar Locker", "Ragnar Locker can delete volume shadow copies using vssadmin delete shadows /all /quiet.[31]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil can use vssadmin to delete volume shadow copies and bcdedit to disable recovery features.[32][33][34][35][36][37][38][39][40]"], "S0400": ["https://attack.mitre.org/software/S0400", "RobbinHood", "RobbinHood deletes shadow copies to ensure that all the data cannot be restored easily.[41]"], "S0446": ["https://attack.mitre.org/software/S0446", "Ryuk", "Ryuk has used vssadmin Delete Shadows /all /quiet to to delete volume shadow copies and vssadmin resize shadowstorage to force deletion of shadow copies created by third-party applications.[42]"], "S0366": ["https://attack.mitre.org/software/S0366", "WannaCry", "WannaCry uses vssadmin, wbadmin, bcdedit, and wmic to delete and disable operating system recovery features.[43][2][44]"], "S0612": ["https://attack.mitre.org/software/S0612", "WastedLocker", "WastedLocker can delete shadow volumes.[45][46][47]"]}, "Mitigation": {"M1053": ["https://attack.mitre.org/mitigations/M1053", "Data Backup", "Consider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data.[48] Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery."], "M1028": ["https://attack.mitre.org/mitigations/M1028", "Operating System Configuration", "Consider technical controls to prevent the disabling of services or deletion of files involved in system recovery."]}, "Detection": {"Command Execution": ["Use process monitoring to monitor the execution and command line parameters of binaries involved in inhibiting system recovery, such as vssadmin, wbadmin, and bcdedit.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Deletion": ["The Windows event logs, ex. Event ID 524 indicating a system catalog was deleted, may contain entries associated with suspicious activity.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Process Creation": ["Use process monitoring to monitor the execution and command line parameters of binaries involved in inhibiting system recovery, such as vssadmin, wbadmin, and bcdedit.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Service Metadata": ["Monitor the status of services involved in system recovery.", "DS0019", "https://attack.mitre.org/datasources/DS0019", "Service"], "Windows Registry Key Modification": ["Monitor the registry for changes associated with system recovery features (ex: the creation of HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\PreviousVersions\\DisableLocalPage).", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
