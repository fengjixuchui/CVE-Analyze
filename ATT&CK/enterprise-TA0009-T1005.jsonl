{"TTP_id": "enterprise-TA0009-T1005", "TTP_name": "Data from Local System", "Description": "Adversaries may search local system sources, such as file systems and configuration files or local databases, to find files of interest and sensitive data prior to Exfiltration.Adversaries may do this using a Command and Scripting Interpreter, such as cmd as well as a Network Device CLI, which have functionality to interact with the file system to gather information. Adversaries may also use Automated Collection on the local system.", "Property": {"ID": "T1005", "Sub-techniques": "No sub-techniques", "Tactic": "Collection", "Platforms": "Linux, Network, Windows, macOS", "System Requirements": "Privileges to access certain files and directories", "Contributors": "Austin Clark, @c2defense; William Cain", "Version": "1.4", "Created": "31 May 2017", "Last Modified": "20 May 2022"}, "Examples": {"G0138": ["https://attack.mitre.org/groups/G0138", "Andariel", "Andariel has collected large numbers of files from compromised network systems for later extraction.[1]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed can collect data on a compromised host.[2][3]"], "G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 has collected files from a local victim.[4]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has retrieved internal documents from machines inside victim environments, including by using Forfiles to stage documents before exfiltration.[5][6][7][8]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has extracted files from compromised networks.[9]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 will identify Microsoft Office documents on the victim's computer.[10]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 has collected data from victims' local systems.[11]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has collected data from a compromised host.[12]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used various tools to steal files from the compromised host.[13][14]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 has uploaded files and data from a compromised host.[15]"], "G0001": ["https://attack.mitre.org/groups/G0001", "Axiom", "Axiom has collected data from a compromised network.[16]"], "S0642": ["https://attack.mitre.org/software/S0642", "BADFLICK", "BADFLICK has uploaded files from victims' machines.[17]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "When it first starts, BADNEWS crawls the victim's local drives and collects documents with the following extensions: .doc, .docx, .pdf, .ppt, .pptx, and .txt.[18][19]"], "S0337": ["https://attack.mitre.org/software/S0337", "BadPatch", "BadPatch collects files from the local system that have the following extensions, then prepares them for exfiltration: .xls, .xlsx, .pdf, .mdb, .rar, .zip, .doc, .docx.[20]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook can collect local files from the system .[21]"], "S0239": ["https://attack.mitre.org/software/S0239", "Bankshot", "Bankshot collects files from the local system.[22]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can retrieve information from the infected machine.[23]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has collected information from a compromised host.[24]"], "S0564": ["https://attack.mitre.org/software/S0564", "BlackMould", "BlackMould can copy files on a compromised host.[25]"], "S0520": ["https://attack.mitre.org/software/S0520", "BLINDINGCAN", "BLINDINGCAN has uploaded files from victim machines.[26]"], "S0651": ["https://attack.mitre.org/software/S0651", "BoxCaon", "BoxCaon can upload files from a compromised host.[27]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has exfiltrated files stolen from local systems.[28]"], "S0274": ["https://attack.mitre.org/software/S0274", "Calisto", "Calisto can collect data from user directories.[29]"], "S0572": ["https://attack.mitre.org/software/S0572", "Caterpillar WebShell", "Caterpillar WebShell has a module to collect information from the local database.[30]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower can collect data and files from a compromised host.[31]"], "S0020": ["https://attack.mitre.org/software/S0020", "China Chopper", "China Chopper's server component can upload local files.[32][33][34]"], "S0667": ["https://attack.mitre.org/software/S0667", "Chrommme", "Chrommme can collect data from a local system.[35]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling can collect information from a compromised host.[36]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can collect data from a local system.[37][38]"], "S0492": ["https://attack.mitre.org/software/S0492", "CookieMiner", "CookieMiner has retrieved iPhone text messages from iTunes phone backup files.[39]"], "S0050": ["https://attack.mitre.org/software/S0050", "CosmicDuke", "CosmicDuke steals user files from local hard drives with file extensions that match a predefined list.[40]"], "S0538": ["https://attack.mitre.org/software/S0538", "Crutch", "Crutch can exfiltrate files from compromised systems.[41]"], "S0498": ["https://attack.mitre.org/software/S0498", "Cryptoistic", "Cryptoistic can retrieve files from the local file system.[42]"], "S0687": ["https://attack.mitre.org/software/S0687", "Cyclops Blink", "Cyclops Blink can upload files from a compromised host.[43]"], "G0070": ["https://attack.mitre.org/groups/G0070", "Dark Caracal", "Dark Caracal collected complete contents of the 'Pictures' folder from compromised Windows systems.[44]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can collect files from a compromised host.[45]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has collected data from local victim systems.[46]"], "S0694": ["https://attack.mitre.org/software/S0694", "DRATzarus", "DRATzarus can collect information from a compromised host.[47]"], "S0502": ["https://attack.mitre.org/software/S0502", "Drovorub", "Drovorub can transfer files from the victim machine.[48]"], "S0567": ["https://attack.mitre.org/software/S0567", "Dtrack", "Dtrack can collect a variety of information from victim machines.[49]"], "G0031": ["https://attack.mitre.org/groups/G0031", "Dust Storm", "Dust Storm has used Android backdoors capable of exfiltrating specific files directly from the infected devices.[50]"], "S0634": ["https://attack.mitre.org/software/S0634", "EnvyScout", "EnvyScout can collect sensitive NTLM material from a compromised host.[51]"], "S0404": ["https://attack.mitre.org/software/S0404", "esentutl", "esentutl can be used to collect data from local file systems.[52]"], "S0512": ["https://attack.mitre.org/software/S0512", "FatDuke", "FatDuke can copy files and directories from a compromised host.[53]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has collected and exfiltrated payment card data from compromised systems.[54][55][56]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 has collected files and other sensitive information from a compromised network.[57]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro can collect data from a compromised host, including Windows authentication information.[58]"], "S0036": ["https://attack.mitre.org/software/S0036", "FLASHFLOOD", "FLASHFLOOD searches for interesting files (either a default or customized set of file extensions) on the local system. FLASHFLOOD will scan the My Recent Documents, Desktop, Temporary Internet Files, and TEMP directories. FLASHFLOOD also collects information stored in the Windows Address Book.[59]"], "S0661": ["https://attack.mitre.org/software/S0661", "FoggyWeb", "FoggyWeb can retrieve configuration data from a compromised AD FS server.[60]"], "S0193": ["https://attack.mitre.org/software/S0193", "Forfiles", "Forfiles can be used to act on (ex: copy, move, etc.) files/directories in a system during (ex: copy files into a staging area before).[5]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has searched local system resources to access sensitive documents.[61]"], "S0503": ["https://attack.mitre.org/software/S0503", "FrameworkPOS", "FrameworkPOS can collect elements related to credit card data from process memory.[62]"], "G0101": ["https://attack.mitre.org/groups/G0101", "Frankenstein", "Frankenstein has enumerated hosts via Empire, gathering various local system information.[63]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM collected data from the victim's local system, including password hashes from the SAM hive in the Registry.[64]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has collected files from infected systems and uploaded them to a C2 server.[65]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium can collect data from a compromised host.[35]"], "S0477": ["https://attack.mitre.org/software/S0477", "Goopy", "Goopy has the ability to exfiltrate documents from infected systems.[66]"], "S0237": ["https://attack.mitre.org/software/S0237", "GravityRAT", "GravityRAT steals files with the following extensions: .docx, .doc, .pptx, .ppt, .xlsx, .xls, .rtf, and .pdf.[67]"], "S0690": ["https://attack.mitre.org/software/S0690", "Green Lambert", "Green Lambert can collect data from a compromised host.[68]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can collect data and files from a compromised host.[69]"], "S0009": ["https://attack.mitre.org/software/S0009", "Hikit", "Hikit can upload files from compromised machines.[16]"], "G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Honeybee collects data from the local victim system.[70]"], "S0203": ["https://attack.mitre.org/software/S0203", "Hydraq", "Hydraq creates a backdoor through which remote attackers can read data from files.[71][72]"], "G0100": ["https://attack.mitre.org/groups/G0100", "Inception", "Inception used a file hunting plugin to collect .txt, .pdf, .xls or .doc files from the infected host.[73]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can collect data from the system, and can monitor changes in specified directories.[74]"], "S0015": ["https://attack.mitre.org/software/S0015", "Ixeshe", "Ixeshe can collect data from a local system.[75]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar uploads files from a specified directory to the C2 server.[76]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang gathered information and files from local directories for exfiltration.[77][78]"], "S0526": ["https://attack.mitre.org/software/S0526", "KGH_SPY", "KGH_SPY can send a file containing victim system information to C2.[79]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has collected Office, PDF, and HWP documents from its victims.[80][81]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can download files off the target system to send back to the server.[82][83]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has stored collected information and discovered processes in a tmp file.[84]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has collected data and files from compromised networks.[85][86][87][88][47][89]"], "S0395": ["https://attack.mitre.org/software/S0395", "LightNeuron", "LightNeuron can collect files from a local system.[90]"], "S0211": ["https://attack.mitre.org/software/S0211", "Linfo", "Linfo creates a backdoor through which remote attackers can obtain data from local systems.[91]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete searches the File system for files of interest.[92]"], "S0652": ["https://attack.mitre.org/software/S0652", "MarkiRAT", "MarkiRAT can upload data from the victim's machine to the C2 server.[93]"], "S0500": ["https://attack.mitre.org/software/S0500", "MCMD", "MCMD has the ability to upload files from an infected device.[94]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has collected various files from the compromised computers.[95][96]"], "S0079": ["https://attack.mitre.org/software/S0079", "MobileOrder", "MobileOrder exfiltrates data collected from the victim mobile device.[97]"], "S0630": ["https://attack.mitre.org/software/S0630", "Nebulae", "Nebulae has the capability to upload collected files to C2.[98]"], "S0691": ["https://attack.mitre.org/software/S0691", "Neoichor", "Neoichor can upload files from a victim's machine.[78]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT can collect data from a local system.[99]"], "S0340": ["https://attack.mitre.org/software/S0340", "Octopus", "Octopus can exfiltrate files from the system using a documents collector tool.[100]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has exfiltrated files and directories of interest from the targeted system.[101]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D has the ability to upload files from a compromised host.[102]"], "S0594": ["https://attack.mitre.org/software/S0594", "Out1", "Out1 can copy files and Registry data from compromised hosts.[103]"], "S0598": ["https://attack.mitre.org/software/S0598", "P.A.S. Webshell", "P.A.S. Webshell has the ability to copy files on a compromised host.[104]"], "S0208": ["https://attack.mitre.org/software/S0208", "Pasam", "Pasam creates a backdoor through which remote attackers can retrieve files.[105]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork collected and exfiltrated files from the infected system.[106]"], "S0517": ["https://attack.mitre.org/software/S0517", "Pillowmint", "Pillowmint has collected credit card data using native API functions.[107]"], "S0048": ["https://attack.mitre.org/software/S0048", "PinchDuke", "PinchDuke collects user files from the compromised host based on predefined file extensions.[108]"], "S0012": ["https://attack.mitre.org/software/S0012", "PoisonIvy", "PoisonIvy creates a backdoor through which remote attackers can steal system information.[109]"], "S0194": ["https://attack.mitre.org/software/S0194", "PowerSploit", "PowerSploit contains a collection of Exfiltration modules that can access data from local files, volumes, and processes.[110][111]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS can upload files from compromised hosts.[112]"], "S0238": ["https://attack.mitre.org/software/S0238", "Proxysvc", "Proxysvc searches the local system and gathers data.[113]"], "S0197": ["https://attack.mitre.org/software/S0197", "PUNCHTRACK", "PUNCHTRACK scrapes memory for properly formatted payment card data.[114][115]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use a variety of commands, including esentutl.exe to steal sensitive data from Internet Explorer and Microsoft Edge, to acquire information that is subsequently exfiltrated.[116][117]"], "S0686": ["https://attack.mitre.org/software/S0686", "QuietSieve", "QuietSieve can collect files from a compromised host.[118]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay can use a file exfiltration tool to collect recently changed files on a compromised host.[98]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can collect Microsoft Word documents from the target's file system, as well as .txt, .doc, and .xls files from the Internet Explorer cache.[119][120]"], "S0169": ["https://attack.mitre.org/software/S0169", "RawPOS", "RawPOS dumps memory from specific processes on a victim system, parses the dumped files, and scrapes them for credit card data.[121][122][123]"], "S0662": ["https://attack.mitre.org/software/S0662", "RCSession", "RCSession can collect data from a compromised host.[124][36]"], "S0240": ["https://attack.mitre.org/software/S0240", "ROKRAT", "ROKRAT can collect host data and specific file types.[125][126][127]"], "S0090": ["https://attack.mitre.org/software/S0090", "Rover", "Rover searches for files on local drives based on a predefined list of file extensions.[128]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has exfiltrated internal documents, files, and other data from compromised hosts.[129]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has the ability to access the file system on a compromised host.[130]"], "S0444": ["https://attack.mitre.org/software/S0444", "ShimRat", "ShimRat has the capability to upload collected files to a C2.[131]"], "S0610": ["https://attack.mitre.org/software/S0610", "SideTwist", "SideTwist has the ability to upload files from a compromised host.[132]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA has uploaded files and information from victim machines.[133]"], "S0615": ["https://attack.mitre.org/software/S0615", "SombRAT", "SombRAT has collected data and files from a compromised host.[134][135]"], "S0646": ["https://attack.mitre.org/software/S0646", "SpicyOmelette", "SpicyOmelette has collected data and other information from a compromised host.[136]"], "G0038": ["https://attack.mitre.org/groups/G0038", "Stealth Falcon", "Stealth Falcon malware gathers data from the local victim system.[137]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST collected information from a compromised host.[138][139]"], "S0011": ["https://attack.mitre.org/software/S0011", "Taidoor", "Taidoor can upload data and files from a victim's machine.[140]"], "S0467": ["https://attack.mitre.org/software/S0467", "TajMahal", "TajMahal has the ability to steal documents from the local system including the print spooler queue.[141]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 ran a command to compile an archive of file types of interest from the victim user's directories.[142]"], "S0665": ["https://attack.mitre.org/software/S0665", "ThreatNeedle", "ThreatNeedle can collect data and files from a compromised host.[88]"], "S0668": ["https://attack.mitre.org/software/S0668", "TinyTurla", "TinyTurla can upload files from a compromised host.[143]"], "S0671": ["https://attack.mitre.org/software/S0671", "Tomiris", "Tomiris has the ability to collect recent files matching a hardcoded list of extensions prior to exfiltration.[144]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot collects local files and information from the victim’s local machine.[145]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla RPC backdoors can upload files from victim machines.[146]"], "S0386": ["https://attack.mitre.org/software/S0386", "Ursnif", "Ursnif has collected files from victim machines, including certificates and cookies.[147]"], "S0452": ["https://attack.mitre.org/software/S0452", "USBferry", "USBferry can collect information from an air-gapped host machine.[148]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT can collect data from a compromised host.[149]"], "S0515": ["https://attack.mitre.org/software/S0515", "WellMail", "WellMail can exfiltrate files from the victim machine.[150]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess can send files from the victim machine to C2.[151][152]"], "S0645": ["https://attack.mitre.org/software/S0645", "Wevtutil", "Wevtutil can be used to export events from a specific log.[153][154]"], "G0124": ["https://attack.mitre.org/groups/G0124", "Windigo", "Windigo has used a script to gather credentials in files left on disk by OpenSSH backdoors.[155]"], "S0653": ["https://attack.mitre.org/software/S0653", "xCaon", "xCaon has uploaded files from victims' machines.[27]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET collects contacts and application data from files in Desktop, Documents, Downloads, Dropbox, and WeChat folders.[156]"], "S0248": ["https://attack.mitre.org/software/S0248", "yty", "yty collects files with the following extensions: .ppt, .pptx, .pdf, .doc, .docx, .xls, .xlsx, .docm, .rtf, .inp, .xlsm, .csv, .odt, .pps, .vcf and sends them back to the C2 server.[157]"], "S0672": ["https://attack.mitre.org/software/S0672", "Zox", "Zox has the ability to upload files from a targeted system.[16]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell can transfer files from a compromised host.[158]"]}, "Mitigation": {"M1057": ["https://attack.mitre.org/mitigations/M1057", "Data Loss Prevention", "Data loss prevention can restrict access to sensitive data and detect sensitive data that is unencrypted."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may search and collect local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration. Remote access tools with built-in features may interact directly with the Windows API to gather data. Data may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor for unexpected/abnormal access to files that may be malicious collection of local data, such as user files (pdf, .docx, .jpg, etc.) or local databases.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "OS API Execution": ["Monitor for API calls that may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for newly executed processes that may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to Exfiltration.", "", "", ""], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Data may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
