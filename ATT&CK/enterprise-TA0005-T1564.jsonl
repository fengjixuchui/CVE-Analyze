{"TTP_id": "enterprise-TA0005-T1564", "TTP_name": "Hide Artifacts", "Description": "Adversaries may attempt to hide artifacts associated with their behaviors to evade detection. Operating systems may have features to hide various artifacts, such as important system files and administrative task execution, to avoid disrupting user work environments and prevent users from changing files or features on the system. Adversaries may abuse these features to hide artifacts such as files, directories, user accounts, or other system activity to evade detection.[1][2][3]Adversaries may also attempt to hide artifacts associated with malicious behavior by creating computing regions that are isolated from common security instrumentation, such as through the use of virtualization technology.[4]", "Property": {"ID": "T1564", "Sub-techniques": "T1564.001, T1564.002, T1564.003, T1564.004, T1564.005, T1564.006, T1564.007, T1564.008, T1564.009, T1564.010", "Tactic": "Defense Evasion", "Platforms": "Linux, Office 365, Windows, macOS", "Version": "1.1", "Created": "26 February 2020", "Last Modified": "25 March 2022"}, "Examples": {"S0482": ["https://attack.mitre.org/software/S0482", "Bundlore", "Bundlore uses the mktemp utility to make unique file and directory names for payloads, such as TMP_DIR=`mktemp -d -t x.[5]"], "S0402": ["https://attack.mitre.org/software/S0402", "OSX/Shlayer", "OSX/Shlayer uses the mktemp utility to make random and unique filenames for payloads, such as export tmpDir=\"$(mktemp -d /tmp/XXXXXXXXXXXX)\" or mktemp -t Installer.[6][5][7]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT can masquerade the Process Environment Block on a compromised host to hide it's attempts to elevate privileges through IFileOperation.[8]"]}, "Mitigation": {}, "Detection": {"Application Log Content": ["Monitor for third-party application logging, messaging, and/or other artifacts that may attempt to hide artifacts associated with their behaviors to evade detection.", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "Command Execution": ["Monitor executed commands and arguments that may attempt to hide artifacts associated with their behaviors to evade detection.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Creation": ["Monitor for newly constructed files that may attempt to hide artifacts associated with their behaviors to evade detection.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Metadata": ["Monitor for contextual data about a file, which may include information such as name, the content (ex: signature, headers, or data/media), user/ower, permissions that may attempt to hide artifacts associated with their behaviors to evade detection.", "", "", ""], "File Modification": ["Monitor for changes made to files that may attempt to hide artifacts associated with their behaviors to evade detection.", "", "", ""], "Firmware Modification": ["Monitor for changes made to firewall rules for unexpected modifications to allow/block specific network traffic that may attempt to hide artifacts associated with their behaviors to evade detection.", "DS0001", "https://attack.mitre.org/datasources/DS0001", "Firmware"], "OS API Execution": ["Monitor for API calls that may attempt to hide artifacts associated with their behaviors to evade detection.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor newly executed processes that may attempt to hide artifacts associated with their behaviors to evade detection.", "", "", ""], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"], "Service Creation": ["Monitor for newly constructed services/daemons that may attempt to hide artifacts associated with their behaviors to evade detection.", "DS0019", "https://attack.mitre.org/datasources/DS0019", "Service"], "User Account Creation": ["Monitor for newly constructed user accounts that may attempt to hide artifacts associated with their behaviors to evade detection.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"], "User Account Metadata": ["Monitor for contextual data about an account, which may include a username, user ID, environmental data that may attempt to hide artifacts associated with their behaviors to evade detection.", "", "", ""], "Windows Registry Key Modification": ["Monitor for changes made to windows registry keys and/or values that may attempt to hide artifacts associated with their behaviors to evade detection.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
