{"TTP_id": "enterprise-TA0003-T1556", "TTP_name": "Modify Authentication Process", "Description": "Adversaries may modify authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts. The authentication process is handled by mechanisms, such as the Local Security Authentication Server (LSASS) process and the Security Accounts Manager (SAM) on Windows, pluggable authentication modules (PAM) on Unix-based systems, and authorization plugins on MacOS systems, responsible for gathering, storing, and validating credentials. By modifying an authentication process, an adversary may be able to authenticate to a service or system without using Valid Accounts.Adversaries may maliciously modify a part of this process to either reveal credentials or bypass authentication mechanisms. Compromised credentials or access may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop.", "Property": {"ID": "T1556", "Sub-techniques": "T1556.001, T1556.002, T1556.003, T1556.004, T1556.005", "Tactics": "Credential Access, Defense Evasion, Persistence", "Platforms": "Linux, Network, Windows, macOS", "Contributors": "Chris Ross @xorrior", "Version": "2.1", "Created": "11 February 2020", "Last Modified": "10 February 2022"}, "Examples": {"S0377": ["https://attack.mitre.org/software/S0377", "Ebury", "Ebury can intercept private keys using a trojanized ssh-add function.[1]"], "S0487": ["https://attack.mitre.org/software/S0487", "Kessel", "Kessel has trojanized the ssh_login and user-auth_pubkey functions to steal plaintext credentials.[2]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can create a backdoor in KeePass using a malicious config file and in TortoiseSVN using a registry hook.[3]"]}, "Mitigation": {"M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Integrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information. MFA can also be used to restrict access to cloud resources and APIs."], "M1028": ["https://attack.mitre.org/mitigations/M1028", "Operating System Configuration", "Ensure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (C:\\Windows\\System32\\ by default) of a domain controller and/or local computer with a corresponding entry in HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages."], "M1027": ["https://attack.mitre.org/mitigations/M1027", "Password Policies", "Ensure that AllowReversiblePasswordEncryption property is set to disabled unless there are application requirements.[4]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Audit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. [5] [6] These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. [7]Limit access to the root account and prevent users from modifying protected components through proper privilege separation (ex SELinux, grsecurity, AppArmor, etc.) and limiting Privilege Escalation opportunities."], "M1025": ["https://attack.mitre.org/mitigations/M1025", "Privileged Process Integrity", "Enabled features, such as Protected Process Light (PPL), for LSA.[8]"], "M1022": ["https://attack.mitre.org/mitigations/M1022", "Restrict File and Directory Permissions", "Restrict write access to the /Library/Security/SecurityAgentPlugins directory."]}, "Detection": {"File Creation": ["Monitor for suspicious additions to the /Library/Security/SecurityAgentPlugins directory.[9]", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Modification": ["Monitor PAM configuration and module paths (ex: /etc/pam.d/) for changes. Use system-integrity tools such as AIDE and monitoring tools such as auditd to monitor PAM files.", "", "", ""], "Logon Session Creation": ["Monitor for newly constructed logon behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times (ex: when the user is not present) or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access). Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services.[10]", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "Module Load": ["Monitor for new, unfamiliar DLL files written to a domain controller and/or local computer. Password filters will also show up as an autorun and loaded DLL in lsass.exe.[11]", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "OS API Execution": ["Monitor for calls to OpenProcess that can be used to manipulate lsass.exe running on a domain controller as well as for malicious modifications to functions exported from authentication-related system DLLs (such as cryptdll.dll and samsrv.dll).[12]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Access": ["Monitor for unexpected processes interacting with authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts.", "", "", ""], "Windows Registry Key Modification": ["Monitor for changes to Registry entries for password filters (ex: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages) and correlate then investigate the DLL files these files reference.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
