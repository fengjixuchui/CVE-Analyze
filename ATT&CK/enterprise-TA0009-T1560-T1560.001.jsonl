{"TTP_id": "enterprise-TA0009-T1560-T1560.001", "TTP_name": "Archive via Utility", "Description": "Adversaries may use utilities to compress and/or encrypt collected data prior to exfiltration. Many utilities include functionalities to compress, encrypt, or otherwise package data into a format that is easier/more secure to transport.Adversaries may abuse various utilities to compress or encrypt data before exfiltration. Some third party utilities may be preinstalled, such as tar on Linux and macOS or zip on Windows systems. On Windows, diantz or makecab may be used to package collected files into a cabinet (.cab) file. diantz may also be used to download and compress files from remote locations (i.e. Remote Data Staging).[1] Additionally, xcopy on Windows can copy files and directories with a variety of options.Adversaries may use also third party utilities, such as 7-Zip, WinRAR, and WinZip, to perform similar activities.[2][3][4]", "Property": {"ID": "T1560.001", "Sub-technique of": "T1560", "Tactic": "Collection", "Platforms": "Linux, Windows, macOS", "Contributors": "Mayan Arora aka Mayan Mohan", "Version": "1.1", "Created": "20 February 2020", "Last Modified": "20 April 2022"}, "Examples": {"S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed can zip and encrypt data collected on a target system.[5]"], "G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 has used RAR to compress files before moving them outside of the victim network.[6]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has used a variety of utilities, including WinRAR, to archive collected data with password protection.[7]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 used 7-Zip to compress stolen emails into password-protected archives prior to exfiltration.[8][9][10]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has used tools to compress data before exfilling it.[11]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has used WinRAR to compress data prior to exfil.[12]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used WinRAR and 7-Zip to compress an archive stolen data.[13]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 created a RAR archive of targeted files for exfiltration.[14]"], "G0143": ["https://attack.mitre.org/groups/G0143", "Aquatic Panda", "Aquatic Panda has used WinRAR to compress memory dumps prior to exfiltration.[15]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has compressed data into password-protected RAR archives prior to exfiltration.[16][17]"], "S0274": ["https://attack.mitre.org/software/S0274", "Calisto", "Calisto uses the zip -r command to compress the data collected on the local system.[18][19]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used gzip for Linux OS and a modified RAR software to archive data on Windows hosts.[20][21]"], "G0052": ["https://attack.mitre.org/groups/G0052", "CopyKittens", "CopyKittens uses ZPP, a .NET console program, to compress files with ZIP.[22]"], "S0212": ["https://attack.mitre.org/software/S0212", "CORALDECK", "CORALDECK has created password-protected RAR, WinImage, and zip archives to be exfiltrated.[23]"], "S0538": ["https://attack.mitre.org/software/S0538", "Crutch", "Crutch has used the WinRAR utility to compress and encrypt stolen files.[24]"], "S0187": ["https://attack.mitre.org/software/S0187", "Daserf", "Daserf hides collected data in password-protected .rar archives.[25]"], "S0062": ["https://attack.mitre.org/software/S0062", "DustySky", "DustySky can compress files via RAR while staging data to be exfiltrated.[26]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has used RAR to compress collected data before exfiltration.[27]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used 7-Zip to archive data.[28]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used WinRAR to compress and encrypt stolen data prior to exfiltration.[29][30]"], "G0084": ["https://attack.mitre.org/groups/G0084", "Gallmaker", "Gallmaker has used WinZip, likely to archive data prior to exfiltration.[31]"], "G0125": ["https://attack.mitre.org/groups/G0125", "HAFNIUM", "HAFNIUM has used 7-Zip and WinRAR to compress stolen files for exfiltration.[32][33]"], "S0278": ["https://attack.mitre.org/software/S0278", "iKitten", "iKitten will zip up the /Library/Keychains directory before exfiltrating it.[34]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole uses WinRAR to compress data that is intended to be exfiltrated.[35]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang is known to use 7Zip and RAR with passwords to encrypt data prior to exfiltration.[36][37]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used QuickZip to archive stolen files before exfiltration.[38]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound has used RAR to stage and compress local folders.[39]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has compressed files before exfiltration using TAR and RAR.[40][41][42]"], "S0339": ["https://attack.mitre.org/software/S0339", "Micropsia", "Micropsia creates a RAR archive based on collected files on the victim's machine.[43]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used the native Windows cabinet creation tool, makecab.exe, likely to compress stolen data to be uploaded.[44]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has used RAR to create password-protected archives of collected documents prior to exfiltration.[45][46]"], "S0340": ["https://attack.mitre.org/software/S0340", "Octopus", "Octopus has compressed data before exfiltrating it using a tool called Abbrevia.[47]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum was seen using a RAR archiver tool to compress/decompress data.[48]"], "S0264": ["https://attack.mitre.org/software/S0264", "OopsIE", "OopsIE compresses collected files with GZipStream before sending them to its C2 server.[49]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has archived collected files with WinRAR, prior to exfiltration.[50]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT has the ability to compress files with zip.[51]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 contains a module for compressing data using ZIP.[52]"], "S0441": ["https://attack.mitre.org/software/S0441", "PowerShower", "PowerShower has used 7Zip to compress .txt, .pdf, .xls or .doc files prior to exfiltration.[53]"], "S0196": ["https://attack.mitre.org/software/S0196", "PUNCHBUGGY", "PUNCHBUGGY has Gzipped information and saved it to a random temp file before exfil.[54]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy can compress data with Zip before sending it over C2.[55]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can compress and archive collected files using WinRAR.[56][57]"], "G0054": ["https://attack.mitre.org/groups/G0054", "Sowbug", "Sowbug extracted documents and bundled them into a RAR archive.[58]"], "S0647": ["https://attack.mitre.org/software/S0647", "Turian", "Turian can use WinRAR to create a password-protected archive for files of interest.[59]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has encrypted files stolen from connected USB drives into a RAR file before exfiltration.[60]"], "S0466": ["https://attack.mitre.org/software/S0466", "WindTail", "WindTail has the ability to use the macOS built-in zip utility to archive files.[61]"]}, "Mitigation": {"M1047": ["https://attack.mitre.org/mitigations/M1047", "Audit", "System scans can be performed to identify unauthorized archival utilities."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments for actions that will aid in compression or encrypting data that is collected prior to exfiltration, such as tar.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Creation": ["Monitor newly constructed files being written with extensions and/or headers associated with compressed or encrypted file types. Detection efforts may focus on follow-on exfiltration activity, where compressed or encrypted files can be detected in transit with a network intrusion detection or data loss prevention system analyzing file headers.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Process Creation": ["Monitor for newly constructed processes and/or command-lines that aid in compression or encrypting data that is collected prior to exfiltration, such as 7-Zip, WinRAR, and WinZip.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
