{"TTP_id": "enterprise-TA0005-T1564-T1564.001", "TTP_name": "Hidden Files and Directories", "Description": "Adversaries may set files and directories to be hidden to evade detection mechanisms. To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a ‘hidden’ file. These files don’t show up when a user browses the file system with a GUI or when using normal commands on the command line. Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (dir /a for Windows and ls –a for Linux and macOS).On Linux and Mac, users can mark specific files as hidden simply by putting a \".\" as the first character in the file or folder name [1] [2]. Files and folders that start with a period, ‘.’, are by default hidden from being viewed in the Finder application and standard command-line utilities like \"ls\". Users must specifically change settings to have these files viewable.Files on macOS can also be marked with the UF_HIDDEN flag which prevents them from being seen in Finder.app, but still allows them to be seen in Terminal.app [3]. On Windows, users can mark specific files as hidden by using the attrib.exe binary. Many applications create these hidden files and folders to store information so that it doesn’t clutter up the user’s workspace. For example, SSH utilities create a .ssh folder that’s hidden and contains the user’s known hosts and keys.Adversaries can use this to their advantage to hide files and folders anywhere on the system and evading a typical user or system analysis that does not incorporate investigation of hidden files.", "Property": {"ID": "T1564.001", "Sub-technique of": "T1564", "Tactic": "Defense Evasion", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Defense Bypassed": "Host forensic analysis", "Version": "1.0", "Created": "26 February 2020", "Last Modified": "29 March 2020"}, "Examples": {"S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla has created hidden folders.[4]"], "S0584": ["https://attack.mitre.org/software/S0584", "AppleJeus", "AppleJeus has added a leading . to plist filenames, unlisting them from the Finder app and default Terminal directory listings.[5]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has saved files with hidden file attributes.[6][6]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32's macOS backdoor hides the clientID file via a chflags function.[7]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor can set attributes of log files and directories to HIDDEN, SYSTEM, ARCHIVE, or a combination of those.[8]"], "S0475": ["https://attack.mitre.org/software/S0475", "BackConfig", "BackConfig has the ability to set folders or files to be hidden from the Windows Explorer default view.[9]"], "S0274": ["https://attack.mitre.org/software/S0274", "Calisto", "Calisto uses a hidden directory named .calisto to store data from the victim’s machine before exfiltration.[10][11]"], "S0484": ["https://attack.mitre.org/software/S0484", "Carberp", "Carberp has created a hidden file in the Startup folder of the current user.[12]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling has the ability to set its file attributes to hidden.[13]"], "S0369": ["https://attack.mitre.org/software/S0369", "CoinTicker", "CoinTicker downloads the following hidden files to evade detection and maintain persistence: /private/tmp/.info.enc, /private/tmp/.info.py, /private/tmp/.server.sh, ~/Library/LaunchAgents/.espl.plist, ~/Library/Containers/.[random string]/[random string].[14]"], "S0497": ["https://attack.mitre.org/software/S0497", "Dacls", "Dacls has had its payload named with a dot prefix to make it hidden from view in the Finder application.[15][16]"], "S0634": ["https://attack.mitre.org/software/S0634", "EnvyScout", "EnvyScout can use hidden directories and files to hide malicious executables.[17]"], "S0569": ["https://attack.mitre.org/software/S0569", "Explosive", "Explosive has commonly set file and path attributes to hidden.[18]"], "S0277": ["https://attack.mitre.org/software/S0277", "FruitFly", "FruitFly saves itself with a leading \".\" to make it a hidden file.[19]"], "S0278": ["https://attack.mitre.org/software/S0278", "iKitten", "iKitten saves itself with a leading \".\" so that it's hidden from users by default.[19]"], "S0434": ["https://attack.mitre.org/software/S0434", "Imminent Monitor", "Imminent Monitor has a dynamic debugging feature to set the file attribute to hidden.[20]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can create hidden system directories.[21]"], "S0015": ["https://attack.mitre.org/software/S0015", "Ixeshe", "Ixeshe sets its own executable file's attributes to hidden.[22]"], "S0162": ["https://attack.mitre.org/software/S0162", "Komplex", "The Komplex payload is stored in a hidden directory at /Users/Shared/.local/kextd.[1]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used a VBA Macro to set its file attributes to System and Hidden and has named files with a dot prefix to hide them from the Finder application.[23][15][16][24]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot has the ability to copy itself to a hidden file and directory.[25]"], "S0451": ["https://attack.mitre.org/software/S0451", "LoudMiner", "LoudMiner has set the attributes of the VirtualBox directory and VBoxVmService parent directory to \"hidden\".[26]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete has the capability to exfiltrate stolen data to a hidden folder on a removable drive.[27]"], "S0282": ["https://attack.mitre.org/software/S0282", "MacSpy", "MacSpy stores itself in ~/Library/.DS_Stores/ [28]"], "S0339": ["https://attack.mitre.org/software/S0339", "Micropsia", "Micropsia creates a new hidden directory to store all components' outputs in a dedicated sub-folder for each.[29]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda's PlugX variant has created a hidden folder on USB drives named RECYCLE.BIN to store malicious executables and collected data.[30]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE can copy itself to and launch itself from hidden folders.[31]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Before exfiltration, Okrum's backdoor has used hidden files to store logs and outputs from backdoor commands.[32]"], "S0402": ["https://attack.mitre.org/software/S0402", "OSX/Shlayer", "OSX/Shlayer executes a .command script from a hidden directory in a mounted DMG.[33]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D sets the main loader file’s attributes to hidden.[34]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX can modify the characteristics of folders to hide them from the compromised user.[35]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT has the ability to hide and unhide files.[36]"], "S0448": ["https://attack.mitre.org/software/S0448", "Rising Sun", "Rising Sun can modify file attributes to hide files.[37]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke downloaded a file \"libprocesshider\", which could hide files on the target system.[38][39]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA has been created with a hidden attribute to insure it's not visible to the victim.[40]"], "S0663": ["https://attack.mitre.org/software/S0663", "SysUpdate", "SysUpdate has the ability to set file attributes to hidden.[41]"], "S0595": ["https://attack.mitre.org/software/S0595", "ThiefQuest", "ThiefQuest hides a copy of itself in the user's ~/Library directory by using a . at the beginning of the file name followed by 9 random characters.[42]"], "G0134": ["https://attack.mitre.org/groups/G0134", "Transparent Tribe", "Transparent Tribe can hide legitimate directories and replace them with malicious copies of the same name.[43]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper has created a hidden directory under C:\\ProgramData\\Apple\\Updates\\ and C:\\Users\\Public\\Documents\\Flash\\.[44][45]"], "S0366": ["https://attack.mitre.org/software/S0366", "WannaCry", "WannaCry uses attrib +h to make some of its files hidden.[46]"], "S0612": ["https://attack.mitre.org/software/S0612", "WastedLocker", "WastedLocker has copied a random file from the Windows System32 folder to the %APPDATA% location under a different hidden filename.[47]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET uses a hidden folder named .xcassets and .git to embed itself in Xcode.[48]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor the file system and shell commands for files being created with a leading \".\" and the Windows command-line use of attrib.exe to add the hidden attribute.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Creation": ["Monitor the file system and shell commands for files being created with a leading \".\"", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Metadata": ["Monitor for contextual data about a file, which may include information such as name, the content (ex: signature, headers, or data/media), user/ower, permissions may set files and directories to be hidden to evade detection mechanisms.", "", "", ""], "Process Creation": ["Monitor newly executed processes that may set files and directories to be hidden to evade detection mechanisms.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
