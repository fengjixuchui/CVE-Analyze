{"TTP_id": "enterprise-TA0005-T1027-T1027.002", "TTP_name": "Software Packing", "Description": "Adversaries may perform software packing or virtual machine software protection to conceal their code. Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code.[1]Utilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available, but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.[2]", "Property": {"ID": "T1027.002", "Sub-technique of": "T1027", "Tactic": "Defense Evasion", "Platforms": "Linux, Windows, macOS", "Defense Bypassed": "Anti-virus, Heuristic detection, Signature-based detection", "CAPEC ID": "CAPEC-570", "Contributors": "Filip Kafka, ESET", "Version": "1.2", "Created": "05 February 2020", "Last Modified": "19 April 2022"}, "Examples": {"S0504": ["https://attack.mitre.org/software/S0504", "Anchor", "Anchor has come with a packed payload.[3]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed has used UPX packers for its payload DLL.[4]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 used UPX to pack files.[5]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has been known to pack their tools.[6][7]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has used several code packing methods such as Themida, Enigma, VMProtect, and Obsidium, to pack their implants.[8]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has packed tools with UPX, and has repacked a modified version of Mimikatz to thwart anti-virus detection.[9][10]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth uses a software packer called Pe123\\RPolyCryptor.[11]"], "S0638": ["https://attack.mitre.org/software/S0638", "Babuk", "Versions of Babuk have been packed.[12][13][14]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar has a variant with a packed payload.[15][16]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has used the MPRESS packer and similar tools for obfuscation.[17]"], "S0520": ["https://attack.mitre.org/software/S0520", "BLINDINGCAN", "BLINDINGCAN has been packed with the UPX packer.[18]"], "S0020": ["https://attack.mitre.org/software/S0020", "China Chopper", "China Chopper's client component is packed with UPX.[19]"], "S0611": ["https://attack.mitre.org/software/S0611", "Clop", "Clop has been packed to help avoid detection.[20][21]"], "S0614": ["https://attack.mitre.org/software/S0614", "CostaBricks", "CostaBricks can implement a custom-built virtual machine mechanism to obfuscate its code.[22]"], "S0527": ["https://attack.mitre.org/software/S0527", "CSPY Downloader", "CSPY Downloader has been packed with UPX.[23]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba has a packed payload when delivered.[24]"], "G0070": ["https://attack.mitre.org/groups/G0070", "Dark Caracal", "Dark Caracal has used UPX to pack Bandook.[25]"], "S0334": ["https://attack.mitre.org/software/S0334", "DarkComet", "DarkComet has the option to compress its payload using UPX or MPRESS.[26]"], "S0187": ["https://attack.mitre.org/software/S0187", "Daserf", "A version of Daserf uses the MPRESS packer.[27]"], "S0281": ["https://attack.mitre.org/software/S0281", "Dok", "Dok is packed with an UPX executable packer.[28]"], "S0695": ["https://attack.mitre.org/software/S0695", "Donut", "Donut can generate packed code modules.[29]"], "S0694": ["https://attack.mitre.org/software/S0694", "DRATzarus", "DRATzarus's dropper can be packed with UPX.[30]"], "S0024": ["https://attack.mitre.org/software/S0024", "Dyre", "Dyre has been delivered with encrypted resources and must be unpacked for execution.[31]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor's payloads are custom-packed, archived and encrypted to prevent analysis.[32][33]"], "G0066": ["https://attack.mitre.org/groups/G0066", "Elderwood", "Elderwood has packed malware payloads before delivery to victims.[34]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet has used custom packers to protect its payloads.[35]"], "S0512": ["https://attack.mitre.org/software/S0512", "FatDuke", "FatDuke has been regularly repacked by its operators to create large binaries and evade detection.[36]"], "S0182": ["https://attack.mitre.org/software/S0182", "FinFisher", "A FinFisher variant uses a custom packer.[37][38]"], "S0628": ["https://attack.mitre.org/software/S0628", "FYAnti", "FYAnti has used ConfuserEx to pack its .NET module.[39]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM packed some payloads using different types of packers, both known and custom.[40]"], "S0588": ["https://attack.mitre.org/software/S0588", "GoldMax", "GoldMax has been packed for obfuscation.[41]"], "S0342": ["https://attack.mitre.org/software/S0342", "GreyEnergy", "GreyEnergy is packed for obfuscation.[42]"], "S0132": ["https://attack.mitre.org/software/S0132", "H1N1", "H1N1 uses a custom packing algorithm.[43]"], "S0601": ["https://attack.mitre.org/software/S0601", "Hildegard", "Hildegard has packed ELF files into other binaries.[44]"], "S0431": ["https://attack.mitre.org/software/S0431", "HotCroissant", "HotCroissant has used the open source UPX executable packer.[45]"], "S0398": ["https://attack.mitre.org/software/S0398", "HyperBro", "HyperBro has the ability to pack its payload.[46]"], "S0483": ["https://attack.mitre.org/software/S0483", "IcedID", "IcedID has packed and encrypted its loader module.[47]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT payloads have been packed.[48]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has packed malware with UPX.[4]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has been packed for obfuscation.[49]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used Themida to pack malicious DLLs and other files.[30][50]"], "S0513": ["https://attack.mitre.org/software/S0513", "LiteDuke", "LiteDuke has been packed with multiple layers of encryption.[36]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot has used several packing methods for obfuscation.[51]"], "S0532": ["https://attack.mitre.org/software/S0532", "Lucifer", "Lucifer has used UPX packed binaries.[52]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete has been packed with NSIS.[53]"], "S0530": ["https://attack.mitre.org/software/S0530", "Melcoz", "Melcoz has been packed with VMProtect and Themida.[54]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has used VMProtect to pack and protect files.[55]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE has used .NET packer tools to evade detection.[56]"], "G0014": ["https://attack.mitre.org/groups/G0014", "Night Dragon", "Night Dragon is known to use software packing in its tools.[57]"], "S0264": ["https://attack.mitre.org/software/S0264", "OopsIE", "OopsIE uses the SmartAssembly obfuscator to pack an embedded .Net Framework assembly used for C2.[58]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D has a variant that is packed with UPX.[59]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "A Patchwork payload was packed with UPX.[60]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can encrypt and pack malicious payloads.[61]"], "S0565": ["https://attack.mitre.org/software/S0565", "Raindrop", "Raindrop used a custom packer for its Cobalt Strike payload, which was compressed using the LZMA algorithm.[62][63]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke's miner has created UPX-packed files in the Windows Start Menu Folder.[64][65][66]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team used UPX to pack a copy of Mimikatz.[67]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has used a packed installer file.[68]"], "S0053": ["https://attack.mitre.org/software/S0053", "SeaDuke", "SeaDuke has been packed with the UPX packer.[69]"], "S0444": ["https://attack.mitre.org/software/S0444", "ShimRat", "ShimRat's loader has been packed with the compressed ShimRat core DLL and the legitimate DLL for it to hijack.[70]"], "S0543": ["https://attack.mitre.org/software/S0543", "Spark", "Spark has been packed with Enigma Protector to obfuscate its contents.[71]"], "S0663": ["https://attack.mitre.org/software/S0663", "SysUpdate", "SysUpdate can use packed binaries.[46]"], "G0092": ["https://attack.mitre.org/groups/G0092", "TA505", "TA505 has used UPX to obscure malicious code.[68]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has used UPX and Ezuri packer to pack its binaries.[72]"], "G0089": ["https://attack.mitre.org/groups/G0089", "The White Company", "The White Company has obfuscated their payloads through packing.[73]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has packed malware and tools.[74]"], "S0671": ["https://attack.mitre.org/software/S0671", "Tomiris", "Tomiris has been packed with UPX.[75]"], "S0678": ["https://attack.mitre.org/software/S0678", "Torisma", "Torisma has been packed with Iz4 compression.[50]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot leverages a custom packer to obfuscate its functionality.[76]"], "S0094": ["https://attack.mitre.org/software/S0094", "Trojan.Karagany", "Trojan.Karagany samples sometimes use common binary packers such as UPX and Aspack on top of a custom Delphi binary packer.[77][78]"], "S0022": ["https://attack.mitre.org/software/S0022", "Uroburos", "Uroburos uses a custom packer.[79]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak has used packed DLL payloads.[80]"], "S0257": ["https://attack.mitre.org/software/S0257", "VERMIN", "VERMIN is initially packed.[81]"], "S0248": ["https://attack.mitre.org/software/S0248", "yty", "yty packs a plugin with UPX.[82]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy's Delphi variant was packed with UPX.[83][84]"], "S0230": ["https://attack.mitre.org/software/S0230", "ZeroT", "Some ZeroT DLL files have been packed with UPX.[85]"], "G0128": ["https://attack.mitre.org/groups/G0128", "ZIRCONIUM", "ZIRCONIUM has used multi-stage packers for exploit code.[86]"]}, "Mitigation": {"M1049": ["https://attack.mitre.org/mitigations/M1049", "Antivirus/Antimalware", "Employ heuristic-based malware detection. Ensure updated virus definitions and create custom signatures for observed malware."]}, "Detection": {"File Metadata": ["Use file scanning to look for known software packers or artifacts of packing techniques. Packing is not a definitive indicator of malicious activity, because legitimate software may use packing techniques to reduce binary size or to protect proprietary code.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"]}}
