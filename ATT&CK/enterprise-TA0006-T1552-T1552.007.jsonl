{"TTP_id": "enterprise-TA0006-T1552-T1552.007", "TTP_name": "Container API", "Description": "Adversaries may gather credentials via APIs within a containers environment. APIs in these environments, such as the Docker API and Kubernetes APIs, allow a user to remotely manage their container resources and cluster components.[1][2]An adversary may access the Docker API to collect logs that contain credentials to cloud, container, and various other resources in the environment.[3] An adversary with sufficient permissions, such as via a pod's service account, may also use the Kubernetes API to retrieve credentials from the Kubernetes API server. These credentials may include those needed for Docker API authentication or secrets from Kubernetes cluster components.", "Property": {"ID": "T1552.007", "Sub-technique of": "T1552", "Tactic": "Credential Access", "Platforms": "Containers", "Permissions Required": "Administrator, User", "Contributors": "Center for Threat-Informed Defense (CTID); Jay Chen, Palo Alto Networks; Yossi Weizman, Azure Defender Research Team", "Version": "1.1", "Created": "31 March 2021", "Last Modified": "01 April 2022"}, "Examples": {"S0683": ["https://attack.mitre.org/software/S0683", "Peirates", "Peirates can query the Kubernetes API for secrets.[4]"]}, "Mitigation": {"M1035": ["https://attack.mitre.org/mitigations/M1035", "Limit Access to Resource Over Network", "Limit communications with the container service to local Unix sockets or remote access via SSH. Require secure port access to communicate with the APIs over TLS by disabling unauthenticated access to the Docker API and Kubernetes API Server.[5][6]"], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Use the principle of least privilege for privileged accounts such as the service account in Kubernetes."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Enforce authentication and role-based access control on the container API to restrict users to the least privileges required.[7]"]}, "Detection": {"Command Execution": ["Establish centralized logging for the activity of container and Kubernetes cluster components. Monitor logs for actions that could be taken to gather credentials to container and cloud infrastructure, including the use of discovery API calls by new or unexpected users and APIs that access Docker logs.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "User Account Authentication": ["It may be possible to detect adversary use of credentials they have obtained such as in Valid Accounts.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"]}}
