{"TTP_id": "enterprise-TA0011-T1102", "TTP_name": "Web Service", "Description": "Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.Use of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).", "Property": {"ID": "T1102", "Sub-techniques": "T1102.001, T1102.002, T1102.003", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Contributors": "Anastasios Pingios", "Version": "1.1", "Created": "31 May 2017", "Last Modified": "26 March 2020"}, "Examples": {"G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has used Dropbox, Amazon S3, and Google Drive to host malicious downloads.[1]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar downloads have been hosted on Google Docs.[2][3]"], "S0635": ["https://attack.mitre.org/software/S0635", "BoomBox", "BoomBox can download files from Dropbox using a hardcoded access token.[4]"], "S0335": ["https://attack.mitre.org/software/S0335", "Carbon", "Carbon can use Pastebin to receive C2 commands.[5]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower can download additional modules from actor-controlled Amazon S3 buckets.[6]"], "S0600": ["https://attack.mitre.org/software/S0600", "Doki", "Doki has used the dogechain.info API to generate a C2 address.[7]"], "S0547": ["https://attack.mitre.org/software/S0547", "DropBook", "DropBook can communicate with its operators by exploiting the Simplenote, DropBox, and the social media platform, Facebook, where it can create fake accounts to control the backdoor and receive instructions.[8][9]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has used Pastebin and Google Storage to host content for their operations.[10]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has used sslip.io, a free IP to domain mapping service that also makes SSL certificate generation easier for traffic encryption, as part of their command and control.[11]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used Amazon Web Services to host C2.[12]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has used GitHub repositories for downloaders which will be obtained by the group's .NET executable on the compromised system.[13]"], "S0561": ["https://attack.mitre.org/software/S0561", "GuLoader", "GuLoader has the ability to download malware from Google Drive.[14]"], "S0601": ["https://attack.mitre.org/software/S0601", "Hildegard", "Hildegard has downloaded scripts from GitHub.[15]"], "G0100": ["https://attack.mitre.org/groups/G0100", "Inception", "Inception has incorporated at least five different cloud service providers into their C2 infrastructure including CloudMe.[16][17]"], "G0140": ["https://attack.mitre.org/groups/G0140", "LazyScripter", "LazyScripter has used GitHub to host its payloads to operate spam campaigns.[18]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has used DropBox URLs to deliver variants of PlugX.[19]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE has used web services including Paste.ee to host payloads.[20]"], "S0508": ["https://attack.mitre.org/software/S0508", "Ngrok", "Ngrok has been used by threat actors to proxy C2 connections to ngrok service subdomains.[21]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke has used Pastebin, Gitee, and GitLab for Command and Control.[22][23]"], "S0546": ["https://attack.mitre.org/software/S0546", "SharpStage", "SharpStage has used a legitimate web service for evading detection.[8]"], "S0589": ["https://attack.mitre.org/software/S0589", "Sibot", "Sibot has used a legitimate compromised website to download DLLs to the victim's machine.[24]"], "S0649": ["https://attack.mitre.org/software/S0649", "SMOKEDHAM", "SMOKEDHAM has used Google Drive and Dropbox to host files downloaded by victims via malicious links.[25]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has leveraged iplogger.org to send collected data back to C2.[26]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has used legitimate web services including Pastebin, Dropbox, and GitHub for C2 communications.[5][27]"], "S0689": ["https://attack.mitre.org/software/S0689", "WhisperGate", "WhisperGate can download additional payloads hosted on a Discord channel.[28][29][30][31][32]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."], "M1021": ["https://attack.mitre.org/mitigations/M1021", "Restrict Web-Based Content", "Web proxies can be used to enforce external network communication policy that prevents use of unauthorized external services."]}, "Detection": {"Network Connection Creation": ["Monitor for newly constructed network connections that are sent or received by untrusted hosts.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
