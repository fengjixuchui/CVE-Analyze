{"TTP_id": "enterprise-TA0007-T1087", "TTP_name": "Account Discovery", "Description": "Adversaries may attempt to get a listing of accounts on a system or within an environment. This information can help adversaries determine which accounts exist to aid in follow-on behavior.", "Property": {"ID": "T1087", "Sub-techniques": "T1087.001, T1087.002, T1087.003, T1087.004", "Tactic": "Discovery", "Platforms": "Azure AD, Google Workspace, IaaS, Linux, Office 365, SaaS, Windows, macOS", "Permissions Required": "User", "CAPEC ID": "CAPEC-575", "Contributors": "Daniel Stepanic, Elastic; Microsoft Threat Intelligence Center (MSTIC); Travis Smith, Tripwire", "Version": "2.3", "Created": "31 May 2017", "Last Modified": "13 October 2021"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 obtained a list of users and their roles from an Exchange server using Get-ManagementRoleAssignment.[1]"], "S0445": ["https://attack.mitre.org/software/S0445", "ShimRatReporter", "ShimRatReporter listed all non-privileged and privileged accounts available on the machine.[2]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET attempts to discover accounts from various locations such as a user's Evernote, AppleID, Telegram, Skype, and WeChat data.[3]"]}, "Mitigation": {"M1028": ["https://attack.mitre.org/mitigations/M1028", "Operating System Configuration", "Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: E numerate administrator accounts on elevation. [4]"]}, "Detection": {"Command Execution": ["Monitor logs and other sources of command execution history for actions that could be taken to gather information about accounts, including the use of calls to cloud APIs that perform account discovery.System and network discovery techniques normally occur throughout an operation as an adversary learns the environment, and also to an extent in normal network operations. Therefore discovery data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor access to file resources that contain local accounts and groups information such as /etc/passwd, /Users directories, and the SAM database.If access requires high privileges, look for non-admin objects (such as users or processes) attempting to access restricted file resources.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Process Creation": ["Monitor for processes that can be used to enumerate user accounts and groups such as net.exe and net1.exe, especially when executed in quick succession.[5] Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
