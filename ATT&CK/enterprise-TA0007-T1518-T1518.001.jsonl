{"TTP_id": "enterprise-TA0007-T1518-T1518.001", "TTP_name": "Security Software Discovery", "Description": "Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment. This may include things such as firewall rules and anti-virus. Adversaries may use the information from Security Software Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.Example commands that can be used to obtain security software information are netsh, reg query with Reg, dir with cmd, and Tasklist, but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for. It is becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.Adversaries may also utilize cloud APIs to discover the configurations of firewall rules within an environment.[1] For example, the permitted IP ranges, ports or user accounts for the inbound/outbound rules of security groups, virtual firewalls established within AWS for EC2 and/or VPC instances, can be revealed by the DescribeSecurityGroups action with various request parameters. [2]", "Property": {"ID": "T1518.001", "Sub-technique of": "T1518", "Tactic": "Discovery", "Platforms": "Azure AD, Google Workspace, IaaS, Linux, Office 365, SaaS, Windows, macOS", "CAPEC ID": "CAPEC-581", "Contributors": "Isif Ibrahima, Mandiant", "Version": "1.3", "Created": "21 February 2020", "Last Modified": "11 April 2022"}, "Examples": {"S0469": ["https://attack.mitre.org/software/S0469", "ABK", "ABK has the ability to identify the installed anti-virus product on the compromised host.[3]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has identified security software, configurations, defensive tools, and sensors installed on a compromised system.[4]"], "G0143": ["https://attack.mitre.org/groups/G0143", "Aquatic Panda", "Aquatic Panda has attempted to discover third party endpoint detection and response (EDR) tools on compromised systems.[5]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth checks for the presence of Avast antivirus in the C:\\Program\\Files\\ folder. [6]"], "S0473": ["https://attack.mitre.org/software/S0473", "Avenger", "Avenger has the ability to identify installed anti-virus products on a compromised host.[3]"], "S0337": ["https://attack.mitre.org/software/S0337", "BadPatch", "BadPatch uses WMI to enumerate installed security products in the victim’s environment.[7]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can identify the installed antivirus engine.[8]"], "S0657": ["https://attack.mitre.org/software/S0657", "BLUELIGHT", "BLUELIGHT can collect a list of anti-virus products installed on a machine.[9]"], "S0471": ["https://attack.mitre.org/software/S0471", "build_downer", "build_downer has the ability to detect if the infected host is running an anti-virus process.[3]"], "S0484": ["https://attack.mitre.org/software/S0484", "Carberp", "Carberp has queried the infected system's registry searching for specific registry keys associated with antivirus products.[10]"], "S0023": ["https://attack.mitre.org/software/S0023", "CHOPSTICK", "CHOPSTICK checks for antivirus and forensics software.[11]"], "S0611": ["https://attack.mitre.org/software/S0611", "Clop", "Clop can search for processes with antivirus and antimalware product names.[12][13]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group used a JavaScript backdoor that is capable of collecting a list of the security solutions installed on the victim's machine.[14]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie attempts to detect several anti-virus products.[15]"], "S0492": ["https://attack.mitre.org/software/S0492", "CookieMiner", "CookieMiner has checked for the presence of \"Little Snitch\", macOS network monitoring and application firewall software, stopping and exiting if it is found.[16]"], "S0046": ["https://attack.mitre.org/software/S0046", "CozyCar", "The main CozyCar dropper checks whether the victim has an anti-virus product installed. If the installed product is on a predetermined list, the dropper will exit.[17]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson contains a command to collect information about anti-virus software on the victim.[18][19]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel has searched for anti-malware strings and anti-virus processes running on the system.[20][21]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can search for anti-virus products on the system.[22]"], "S0472": ["https://attack.mitre.org/software/S0472", "down_new", "down_new has the ability to detect anti-virus products and processes on a compromised host.[3]"], "S0062": ["https://attack.mitre.org/software/S0062", "DustySky", "DustySky checks for the existence of anti-virus.[23]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can enumerate antivirus software on the target.[24]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic searches for anti-malware services running on the victim’s machine and terminates itself if it finds them.[25]"], "S0396": ["https://attack.mitre.org/software/S0396", "EvilBunny", "EvilBunny has been observed querying installed antivirus software.[26]"], "S0568": ["https://attack.mitre.org/software/S0568", "EVILNUM", "EVILNUM can search for anti-virus products on the system.[27]"], "S0171": ["https://attack.mitre.org/software/S0171", "Felismus", "Felismus checks for processes associated with anti-virus vendors.[28]"], "S0267": ["https://attack.mitre.org/software/S0267", "FELIXROOT", "FELIXROOT checks for installed security software like antivirus and firewall.[29]"], "S0679": ["https://attack.mitre.org/software/S0679", "Ferocious", "Ferocious has checked for AV software as part of its persistence process.[30]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has used Registry keys to detect and avoid executing in potential sandboxes.[31]"], "S0182": ["https://attack.mitre.org/software/S0182", "FinFisher", "FinFisher probes the system to check for antimalware processes.[32][33]"], "S0143": ["https://attack.mitre.org/software/S0143", "Flame", "Flame identifies security software such as antivirus through the Security module.[34][35]"], "S0381": ["https://attack.mitre.org/software/S0381", "FlawedAmmyy", "FlawedAmmyy will attempt to detect anti-virus products during the initial infection.[36]"], "G0101": ["https://attack.mitre.org/groups/G0101", "Frankenstein", "Frankenstein has used WMI queries to detect if virtualization environments or analysis tools were running on the system.[37]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium can check for the presence of specific security products.[38]"], "S0249": ["https://attack.mitre.org/software/S0249", "Gold Dragon", "Gold Dragon checks for anti-malware products and processes.[39]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can list installed security products including the Trusteer and Diebold Warsaw GAS Tecnologia online banking protections.[40][40]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can check for the presence of network sniffers, AV, and BitDefender firewall.[41]"], "S0201": ["https://attack.mitre.org/software/S0201", "JPIN", "JPIN checks for the presence of certain security-related processes and deletes its installer/uninstaller component if it identifies any of them.[42]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT can list security software, such as by using WMIC to identify anti-virus products installed on the victim’s machine and to obtain firewall details.[43][44]"], "S0088": ["https://attack.mitre.org/software/S0088", "Kasidet", "Kasidet has the ability to identify any anti-virus installed on the infected system.[45]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has checked for the presence of antivirus software with powershell Get-CimInstance -Namespace root/securityCenter2 – classname antivirusproduct.[46]"], "S0513": ["https://attack.mitre.org/software/S0513", "LiteDuke", "LiteDuke has the ability to check for the presence of Kaspersky security software.[47]"], "S0680": ["https://attack.mitre.org/software/S0680", "LitePower", "LitePower can identify installed AV software.[30]"], "S0681": ["https://attack.mitre.org/software/S0681", "Lizar", "Lizar can search for processes associated with an anti-virus product from list.[48]"], "S0652": ["https://attack.mitre.org/software/S0652", "MarkiRAT", "MarkiRAT can check for running processes on the victim’s machine to look for Kaspersky and Bitdefender antivirus products.[49]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo collects a list of installed antivirus software from the victim’s system.[50][51]"], "S0688": ["https://attack.mitre.org/software/S0688", "Meteor", "Meteor has the ability to search for Kaspersky Antivirus on a victim's machine.[52]"], "S0339": ["https://attack.mitre.org/software/S0339", "Micropsia", "Micropsia searches for anti-virus software and firewall products installed on the victim’s machine using WMI.[53][54]"], "S0553": ["https://attack.mitre.org/software/S0553", "MoleNet", "MoleNet can use WMI commands to check the system for firewall and antivirus software.[55]"], "S0284": ["https://attack.mitre.org/software/S0284", "More_eggs", "More_eggs can obtain information on installed anti-malware programs.[56]"], "S0256": ["https://attack.mitre.org/software/S0256", "Mosquito", "Mosquito's installer searches the Registry and system to see if specific antivirus tools are installed on the system.[57]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used malware to check running processes against a hard-coded list of security tools often used by malware researchers.[58]"], "G0019": ["https://attack.mitre.org/groups/G0019", "Naikon", "Naikon uses commands such as netsh advfirewall firewall to discover local firewall settings.[59]"], "S0108": ["https://attack.mitre.org/software/S0108", "netsh", "netsh can be used to discover system firewall settings.[60][61]"], "S0457": ["https://attack.mitre.org/software/S0457", "Netwalker", "Netwalker can detect and terminate active security software-related processes on infected systems.[62]"], "S0368": ["https://attack.mitre.org/software/S0368", "NotPetya", "NotPetya determines if specific antivirus programs are running on an infected host machine.[63]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used scripts to detect security software.[64]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork scanned the \"Program Files\" directories for a directory with the string \"Total Security\" (the installation path of the \"360 Total Security\" antivirus tool).[65]"], "S0501": ["https://attack.mitre.org/software/S0501", "PipeMon", "PipeMon can check for the presence of ESET and Kaspersky security software.[66]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS has detected security tools.[67]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER may collect information on the victim's anti-virus software.[68]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "A module in Prikormka collects information from the victim about installed anti-virus software.[69]"], "S0196": ["https://attack.mitre.org/software/S0196", "PUNCHBUGGY", "PUNCHBUGGY can gather AVs registered in the system.[70]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can identify the installed antivirus product on a targeted system.[71][72][72][73]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec has a plugin to detect active drivers of some security products.[74]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke used scripts which detected and uninstalled antivirus software.[75][76]"], "S0270": ["https://attack.mitre.org/software/S0270", "RogueRobin", "RogueRobin enumerates running processes to search for Wireshark and Windows Sysinternals suite.[77][78]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM can obtain information about security software on the victim.[79]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has used the Windows service winmgmts:\\.\\root\\SecurityCenter2 to check installed antivirus products.[80]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can determine if an anti-virus product is installed through the resolution of the service's virtual SID.[81]"], "S0468": ["https://attack.mitre.org/software/S0468", "Skidmap", "Skidmap has the ability to check if /usr/sbin/setenforce exists. This file controls what mode SELinux is in.[82]"], "S0646": ["https://attack.mitre.org/software/S0646", "SpicyOmelette", "SpicyOmelette can check for the presence of 29 different antivirus tools.[83]"], "S0380": ["https://attack.mitre.org/software/S0380", "StoneDrill", "StoneDrill can check for antivirus and antimalware programs.[84]"], "S0142": ["https://attack.mitre.org/software/S0142", "StreamEx", "StreamEx has the ability to scan for security tools such as firewalls and antivirus tools.[85]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity can identify if ESET or BitDefender antivirus are installed before dropping its payload.[86]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet enumerates the currently running processes related to a variety of security products.[87]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST checked for a variety of antivirus/endpoint detection agents prior to execution.[88][89]"], "S0098": ["https://attack.mitre.org/software/S0098", "T9000", "T9000 performs checks for various antivirus and security products during installation.[90]"], "S0467": ["https://attack.mitre.org/software/S0467", "TajMahal", "TajMahal has the ability to identify which anti-virus products, firewalls, and anti-spyware products are in use.[91]"], "S0057": ["https://attack.mitre.org/software/S0057", "Tasklist", "Tasklist can be used to enumerate security software currently running on a system by process name of known products.[92]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has searched for security products on infected machines.[93]"], "G0089": ["https://attack.mitre.org/groups/G0089", "The White Company", "The White Company has checked for specific antivirus products on the target’s computer, including Kaspersky, Quick Heal, AVG, BitDefender, Avira, Sophos, Avast!, and ESET.[94]"], "S0595": ["https://attack.mitre.org/software/S0595", "ThiefQuest", "ThiefQuest uses the kill_unwanted function to get a list of running processes, compares each process with an encrypted list of \"unwanted\" security related programs, and kills the processes for security related programs.[95]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper can search for anti-virus software running on the system.[96]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has obtained information on security software, including security logging information that may indicate whether their malware has been detected.[97]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak can determine if a compromised host has security products installed.[98]"], "S0257": ["https://attack.mitre.org/software/S0257", "VERMIN", "VERMIN uses WMI to check for anti-virus software installed on the system.[99]"], "S0579": ["https://attack.mitre.org/software/S0579", "Waterbear", "Waterbear can find the presence of a specific security software.[100]"], "S0689": ["https://attack.mitre.org/software/S0689", "WhisperGate", "WhisperGate can recognize the presence of monitoring tools on a target system.[101]"], "G0112": ["https://attack.mitre.org/groups/G0112", "Windshift", "Windshift has used malware to identify installed AV and commonly used forensic and malware analysis tools.[102]"], "S0176": ["https://attack.mitre.org/software/S0176", "Wingbird", "Wingbird checks for the presence of Bitdefender security software.[103]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used WMI to identify anti-virus products installed on a victim's machine.[104]"], "S0653": ["https://attack.mitre.org/software/S0653", "xCaon", "xCaon has checked for the existence of Kaspersky antivirus software on the system.[105]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET searches firewall configuration files located in /Library/Preferences/ and uses csrutil status to determine if System Integrity Protection is enabled.[106]"], "S0388": ["https://attack.mitre.org/software/S0388", "YAHOYAH", "YAHOYAH checks for antimalware solution processes on the system.[107]"], "S0330": ["https://attack.mitre.org/software/S0330", "Zeus Panda", "Zeus Panda checks to see if anti-virus, anti-spyware, or firewall products are installed in the victim’s environment.[108][109]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Firewall Enumeration": ["Monitor for an extracted list of available firewalls and/or their associated settings/rules (ex: Azure Network Firewall CLI Show commands)", "DS0018", "https://attack.mitre.org/datasources/DS0018", "Firewall"], "Firewall Metadata": ["Monitor for contextual data about a firewall and activity around it such as name, policy, or status", "", "", ""], "OS API Execution": ["Monitor for API calls that may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor newly executed processes that may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on a system or in a cloud environment.", "", "", ""]}}
