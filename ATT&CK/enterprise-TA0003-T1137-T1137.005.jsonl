{"TTP_id": "enterprise-TA0003-T1137-T1137.005", "TTP_name": "Outlook Rules", "Description": "Adversaries may abuse Microsoft Outlook rules to obtain persistence on a compromised system. Outlook rules allow a user to define automated behavior to manage email messages. A benign rule might, for example, automatically move an email to a particular folder in Outlook if it contains specific words from a specific sender. Malicious Outlook rules can be created that can trigger code execution when an adversary sends a specifically crafted email to that user.[1]Once malicious rules have been added to the userâ€™s mailbox, they will be loaded when Outlook is started. Malicious rules will execute when an adversary sends a specifically crafted email to the user.[1]", "Property": {"ID": "T1137.005", "Sub-technique of": "T1137", "Tactic": "Persistence", "Platforms": "Office 365, Windows", "Permissions Required": "Administrator, User", "Contributors": "Microsoft Security", "Version": "1.1", "Created": "07 November 2019", "Last Modified": "15 October 2021"}, "Examples": {"S0358": ["https://attack.mitre.org/software/S0358", "Ruler", "Ruler can be used to automate the abuse of Outlook Rules to establish persistence.[2]"]}, "Mitigation": {"M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. [3]"], "M1051": ["https://attack.mitre.org/mitigations/M1051", "Update Software", "For the Outlook methods, blocking macros may be ineffective as the Visual Basic engine used for these features is separate from the macro scripting engine.[4] Microsoft has released patches to try to address each issue. Ensure KB3191938 which blocks Outlook Visual Basic and displays a malicious code warning, KB4011091 which disables custom forms by default, and KB4011162 which removes the legacy Home Page feature, are applied to systems.[5]"]}, "Detection": {"Application Log Content": ["Monitor for third-party application logging, messaging, and/or other artifacts that may abuse Microsoft Outlook rules to obtain persistence on a compromised system. SensePost, whose tool Ruler can be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage.[6]", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "Command Execution": ["Monitor executed commands and arguments that may abuse Microsoft Outlook rules to obtain persistence on a compromised system. Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output.[7] This PowerShell script is ineffective in gathering rules with modified PR_RULE_MSG_NAME and PR_RULE_MSG_PROVIDER properties caused by adversaries using a Microsoft Exchange Server Messaging API Editor (MAPI Editor), so only examination with the Exchange Administration tool MFCMapi can reveal these mail forwarding rules.[8]", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes that may abuse Microsoft Outlook rules to obtain persistence on a compromised system.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
