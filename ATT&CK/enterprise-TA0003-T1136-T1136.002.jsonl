{"TTP_id": "enterprise-TA0003-T1136-T1136.002", "TTP_name": "Domain Account", "Description": "Adversaries may create a domain account to maintain access to victim systems. Domain accounts are those managed by Active Directory Domain Services where access and permissions are configured across systems and services that are part of that domain. Domain accounts can cover user, administrator, and service accounts. With a sufficient level of access, the net user /add /domain command can be used to create a domain account.Such accounts may be used to establish secondary credentialed access that do not require persistent remote access tools to be deployed on the system.", "Property": {"ID": "T1136.002", "Sub-technique of": "T1136", "Tactic": "Persistence", "Platforms": "Linux, Windows, macOS", "Permissions Required": "Administrator", "Version": "1.0", "Created": "28 January 2020", "Last Modified": "23 March 2020"}, "Examples": {"S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire has a module for creating a new domain user if permissions allow.[1]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM created high-privileged domain user accounts to maintain access to victim networks.[2][3]"], "G0125": ["https://attack.mitre.org/groups/G0125", "HAFNIUM", "HAFNIUM has created and granted privileges to domain accounts.[4]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "The net user username \\password \\domain commands in Net can be used to create a domain account.[5]"], "S0029": ["https://attack.mitre.org/software/S0029", "PsExec", "PsExec has the ability to remotely create accounts on target systems.[6]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy can user PowerView to execute \"net user\" commands and create domain accounts.[7]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has created new domain accounts on an ICS access server.[8]"]}, "Mitigation": {"M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Use multi-factor authentication for user and privileged accounts."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Configure access controls and firewalls to limit access to domain controllers and systems used to create and manage accounts."], "M1028": ["https://attack.mitre.org/mitigations/M1028", "Operating System Configuration", "Protect domain controllers by ensuring proper security configuration for critical servers."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Do not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments for actions that are associated with local account creation, such as net user /add /domain.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes associated with account creation, such as net.exe", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "User Account Creation": ["Monitor for newly constructed user accounts through account audits to detect suspicious accounts that may have been created by an adversary. Collect data on account creation within a network or Windows Event ID 4720 (for when a user account is created on a Windows system and domain controller).", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"]}}
