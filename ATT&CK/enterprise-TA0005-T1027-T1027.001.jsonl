{"TTP_id": "enterprise-TA0005-T1027-T1027.001", "TTP_name": "Binary Padding", "Description": "Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This can be done without affecting the functionality or behavior of a binary, but can increase the size of the binary beyond what some security tools are capable of handling due to file size limitations.Binary padding effectively changes the checksum of the file and can also be used to avoid hash-based blocklists and static anti-virus signatures.[1] The padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware.[2] Increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files. This may also reduce the likelihood of being collected for analysis. Public file scanning services, such as VirusTotal, limits the maximum size of an uploaded file to be analyzed.[3]", "Property": {"ID": "T1027.001", "Sub-technique of": "T1027", "Tactic": "Defense Evasion", "Platforms": "Linux, Windows, macOS", "Defense Bypassed": "Anti-virus, Signature-based detection", "CAPEC ID": "CAPEC-572, CAPEC-655", "Contributors": "Martin Jirkal, ESET", "Version": "1.2", "Created": "05 February 2020", "Last Modified": "15 October 2021"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used large file sizes to avoid detection.[4]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 includes garbage code to mislead anti-malware software and researchers.[1][5]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has appended random binary data to the end of itself to generate a large binary.[6]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER downloader code has included \"0\" characters at the end of the file to inflate the file size in a likely attempt to evade anti-virus detection.[7][8]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie appends a total of 64MB of garbage data to a file to deter any security products in place that may be scanning files on disk.[9]"], "S0137": ["https://attack.mitre.org/software/S0137", "CORESHELL", "CORESHELL contains unused machine instructions in a likely attempt to hinder analysis.[10]"], "S0614": ["https://attack.mitre.org/software/S0614", "CostaBricks", "CostaBricks has added the entire unobfuscated code of the legitimate open source application Blink to its code.[11]"], "S0082": ["https://attack.mitre.org/software/S0082", "Emissary", "A variant of Emissary appends junk data to the end of its DLL file to create a large file that may exceed the maximum size that anti-virus programs can scan.[12]"], "S0512": ["https://attack.mitre.org/software/S0512", "FatDuke", "FatDuke has been packed with junk code and strings.[13]"], "S0182": ["https://attack.mitre.org/software/S0182", "FinFisher", "FinFisher contains junk code in its functions in an effort to confuse disassembly programs.[14][15]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has obfuscated .NET executables by inserting junk code.[16]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium can use junk code to hide functions and evade detection.[17]"], "S0477": ["https://attack.mitre.org/software/S0477", "Goopy", "Goopy has had null characters padded in its malicious DLL payload.[18]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro has added BMP images to the resources section of its Portable Executable (PE) file increasing each binary to at least 300MB in size.[19]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent has the ability to add bytes to change the file hash.[20]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa performed padding with null bytes before calculating its hash.[21]"], "S0528": ["https://attack.mitre.org/software/S0528", "Javali", "Javali can use large obfuscated libraries to hinder detection and analysis.[22]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Before writing to disk, Kwampirs inserts a randomly generated string into the middle of the decrypted payload in an attempt to evade hash-based detections.[23]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has inserted garbage characters into code, presumably to avoid anti-virus detection.[24]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "Maze has inserted large blocks of junk code, including some components to decrypt strings and other important information for later in the encryption process.[25]"], "G0002": ["https://attack.mitre.org/groups/G0002", "Moafee", "Moafee has been known to employ binary padding.[26]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has used junk code within their DLL files to hinder analysis.[27]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork apparently altered NDiskMonitor samples by adding four bytes of random letters in a likely attempt to change the file hashes.[28]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS has used useless code blocks to counter analysis.[29]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use large file sizes to evade detection.[30][31]"], "S0433": ["https://attack.mitre.org/software/S0433", "Rifdoor", "Rifdoor has added four additional bytes of data upon launching, then saved the changed version as C:\\ProgramData\\Initech\\Initech.exe.[32]"], "S0370": ["https://attack.mitre.org/software/S0370", "SamSam", "SamSam has used garbage code to pad some of its malware components.[33]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "TAINTEDSCRIBE can execute FileRecvWriteRand to append random bytes to the end of a file received from C2.[34]"], "S0612": ["https://attack.mitre.org/software/S0612", "WastedLocker", "WastedLocker contains junk code to increase its entropy and hide the actual code.[35]"], "S0117": ["https://attack.mitre.org/software/S0117", "XTunnel", "A version of XTunnel introduced in July 2015 inserted junk code into the binary in a likely attempt to obfuscate it and bypass security products.[36]"], "S0248": ["https://attack.mitre.org/software/S0248", "yty", "yty contains junk code in its binary, likely to confuse malware analysts.[37]"], "S0230": ["https://attack.mitre.org/software/S0230", "ZeroT", "ZeroT has obfuscated DLLs and functions using dummy API calls inserted between real instructions.[38]"]}, "Mitigation": {}, "Detection": {"File Metadata": ["Depending on the method used to pad files, a file-based signature may be capable of detecting padding using a scanning or on-access based tool. When executed, the resulting process from padded files may also exhibit other behavior characteristics of being used to conduct an intrusion such as system and network information Discovery or Lateral Movement, which could be used as event indicators that point to the source file.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"]}}
