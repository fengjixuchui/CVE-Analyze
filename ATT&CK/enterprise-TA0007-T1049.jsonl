{"TTP_id": "enterprise-TA0007-T1049", "TTP_name": "System Network Connections Discovery", "Description": "Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.An adversary who gains access to a system that is part of a cloud-based environment may map out Virtual Private Clouds or Virtual Networks in order to determine what systems and services are connected. The actions performed are likely the same types of discovery techniques depending on the operating system, but the resulting information may include details about the networked cloud environment relevant to the adversary's goals. Cloud providers may have different ways in which their virtual networks operate.[1][2][3] Similarly, adversaries who gain access to network devices may also perform similar discovery activities to gather information about connected systems and services.Utilities and commands that acquire this information include netstat, \"net use,\" and \"net session\" with Net. In Mac and Linux, netstat and lsof can be used to list current connections. who -a and w can be used to show which users are currently logged in, similar to \"net session\". Additionally, built-in features native to network devices and Network Device CLI may be used.[4]", "Property": {"ID": "T1049", "Sub-techniques": "No sub-techniques", "Tactic": "Discovery", "Platforms": "IaaS, Linux, Network, Windows, macOS", "Contributors": "Austin Clark, @c2defense; Praetorian", "Version": "2.3", "Created": "31 May 2017", "Last Modified": "20 April 2022"}, "Examples": {"G0018": ["https://attack.mitre.org/groups/G0018", "admin@338", "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to display network connections: netstat -ano >> %temp%\\download[5]"], "G0138": ["https://attack.mitre.org/groups/G0138", "Andariel", "Andariel has used the netstat -naop tcp command to display TCP connections on a victim's machine.[6]"], "G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 used the net use command to get a listing on network connections.[7]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has a tool that can enumerate current network connections.[8][9][10]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 used the netstat -anpo tcp command to display TCP connections on the victim's machine.[11]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 installed a port monitoring tool, MAPMAKER, to print the active TCP connections on the local system.[12]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 has enumerated IP addresses of network resources and used the netstat command as part of network reconnaissance. The group has also used a malware variant, HIGHNOON, to enumerate active RDP sessions.[13][14]"], "S0456": ["https://attack.mitre.org/software/S0456", "Aria-body", "Aria-body has the ability to gather TCP and UDP table status listings.[15]"], "S0638": ["https://attack.mitre.org/software/S0638", "Babuk", "Babuk can use \"WNetOpenEnumW\" and \"WNetEnumResourceW\" to enumerate files in network resources for encryption.[16]"], "G0135": ["https://attack.mitre.org/groups/G0135", "BackdoorDiplomacy", "BackdoorDiplomacy has used NetCat and PortQry to enumerate network connections and display the status of related TCP and UDP ports.[17]"], "S0089": ["https://attack.mitre.org/software/S0089", "BlackEnergy", "BlackEnergy has gathered information about local network connections using netstat.[18][19]"], "S0335": ["https://attack.mitre.org/software/S0335", "Carbon", "Carbon uses the netstat -r and netstat -an commands.[20]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower can use netsh wlan show profiles to list specific Wi-Fi profile details.[21]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used netstat -ano | findstr EST to discover network connections.[22]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can produce a sessions report from compromised hosts.[23]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie executes the netstat -ano command.[24]"], "S0575": ["https://attack.mitre.org/software/S0575", "Conti", "Conti can enumerate routine network connections from a compromised host.[25]"], "S0488": ["https://attack.mitre.org/software/S0488", "CrackMapExec", "CrackMapExec can discover active sessions for a targeted system.[26]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba can use the function GetIpNetTable to recover the last connections to the victim's machine.[27]"], "S0567": ["https://attack.mitre.org/software/S0567", "Dtrack", "Dtrack can collect network and active connection information.[28]"], "S0038": ["https://attack.mitre.org/software/S0038", "Duqu", "The discovery modules used with Duqu can collect information on network connections.[29]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor can enumerate all connected drives.[30]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can enumerate the current network connections of a host.[31]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic uses the net use, net session, and netstat commands to gather information on network connections.[32][33]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro has been used to execute netstat -ano on a compromised host.[34]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used netstat -oan to obtain information about the victim network connections.[35]"], "S0237": ["https://attack.mitre.org/software/S0237", "GravityRAT", "GravityRAT uses the netstat command to find open ports on the victimâ€™s machine.[36]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT can list network connections.[37]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang performs local network connection discovery using netstat.[38][39]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has used net session on the victim's machine.[40]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs collects a list of active and listening connections by using the command netstat -nao as well as a list of available network mappings with net use.[41]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used net use to identify and establish a network connection with a remote host.[42]"], "S0681": ["https://attack.mitre.org/software/S0681", "Lizar", "Lizar has a plugin to retrieve information about all active network sessions on the infected server.[43]"], "S0532": ["https://attack.mitre.org/software/S0532", "Lucifer", "Lucifer can identify the IP and port numbers for all remote connections from the compromised host.[44]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete uses the netsh wlan show networks mode=bssid and netsh wlan show interfaces commands to list all nearby WiFi networks and connected interfaces.[45]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "Maze has used the \"WNetOpenEnumW\", \"WNetEnumResourceW\", \"WNetCloseEnum\" and \"WNetAddConnection2W\" functions to enumerate the network resources on the infected machine.[46]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used net use to conduct connectivity checks to machines.[47]"], "S0443": ["https://attack.mitre.org/software/S0443", "MESSAGETAP", "After loading the keyword and phone data files, MESSAGETAP begins monitoring all network connections to and from the victim server. [48]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used a PowerShell backdoor to check for Skype connections on the target machine.[49]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has used netstat -ano to determine network connection information.[50]"], "S0102": ["https://attack.mitre.org/software/S0102", "nbtstat", "nbtstat can be used to discover current NetBIOS sessions."], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "Commands such as net use and net session can be used in Net to gather information about network connections from a particular host.[51]"], "S0104": ["https://attack.mitre.org/software/S0104", "netstat", "netstat can be used to enumerate local network connections, including active TCP connections and other network statistics.[52]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE can capture session logon details from a compromised host.[53]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used netstat -an on a victim to get a listing of network connections.[54]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum was seen using NetSess to discover NetBIOS sessions.[55]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has collected a list of open connections on the infected system using netstat and checks whether it has an internet connection.[56]"], "S0165": ["https://attack.mitre.org/software/S0165", "OSInfo", "OSInfo enumerates the current network connections similar to net use .[8]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX has a module for enumerating TCP and UDP network connections and associated processes using the netstat command.[57]"], "G0033": ["https://attack.mitre.org/groups/G0033", "Poseidon Group", "Poseidon Group obtains and saves information about victim network interfaces and addresses.[58]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 contains an implementation of netstat to enumerate TCP and UDP connections.[59]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER may collect active network connections by running netstat -an on a victim.[60]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy has a built-in utility command for netstat, can do net session through PowerView, and has an interactive shell which can be used to discover additional information.[61]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use netstat to enumerate current network connections.[62]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can use netstat to enumerate network connections.[63]"], "S0241": ["https://attack.mitre.org/software/S0241", "RATANKBA", "RATANKBA uses netstat -ano to search for specific IP address ranges.[64]"], "S0153": ["https://attack.mitre.org/software/S0153", "RedLeaves", "RedLeaves can enumerate drives and Remote Desktop sessions.[65]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec can obtain a list of active connections and open ports.[66]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team had gathered user, IP address, and server data related to RDP sessions on a compromised host. It has also accessed network diagram files useful for understanding how a host's network was configured.[67][68]"], "S0445": ["https://attack.mitre.org/software/S0445", "ShimRatReporter", "ShimRatReporter used the Windows function GetExtendedUdpTable to detect connected UDP endpoints.[69]"], "S0063": ["https://attack.mitre.org/software/S0063", "SHOTPUT", "SHOTPUT uses netstat to list TCP connection status.[70]"], "S0589": ["https://attack.mitre.org/software/S0589", "Sibot", "Sibot has retrieved a GUID associated with a present LAN connection on a compromised machine.[71]"], "S0633": ["https://attack.mitre.org/software/S0633", "Sliver", "Sliver can collect network connection information.[72]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA can enumerate open ports on a victim machine.[73]"], "S0374": ["https://attack.mitre.org/software/S0374", "SpeakUp", "SpeakUp uses the arp -a command. [74]"], "S0018": ["https://attack.mitre.org/software/S0018", "Sykipot", "Sykipot may use netstat -ano to display active network connections.[75]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT runs netstat -anp to search for rival malware connections.[76] TeamTNT has also used libprocesshider to modify /etc/ld.so.preload.[77]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used net use and netstat to conduct internal discovery of systems. The group has also used quser.exe to identify existing RDP sessions on a victim.[78]"], "S0678": ["https://attack.mitre.org/software/S0678", "Torisma", "Torisma can use WTSEnumerateSessionsW to monitor remote desktop connections.[79]"], "S0094": ["https://attack.mitre.org/software/S0094", "Trojan.Karagany", "Trojan.Karagany can use netstat to collect a list of network connections.[80]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper has tested if the localhost network is available and other connection capability on an infected system using command scripts.[81]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla surveys a system upon check-in to discover active local network connections using the netstat -an, net use, net file, and net session commands.[32][82] Turla RPC backdoors have also enumerated the IPv4 TCP connection table via the GetTcpTable2 API call.[83]"], "S0452": ["https://attack.mitre.org/software/S0452", "USBferry", "USBferry can use netstat and nbtstat to detect active network connections.[81]"], "S0180": ["https://attack.mitre.org/software/S0180", "Volgmer", "Volgmer can gather information about TCP connection state.[84]"], "S0579": ["https://attack.mitre.org/software/S0579", "Waterbear", "Waterbear can use API hooks on GetExtendedTcpTable to retrieve a table containing a list of TCP endpoints available to the application.[85]"], "S0689": ["https://attack.mitre.org/software/S0689", "WhisperGate", "WhisperGate can enumerate connected remote logical drives.[86]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy uses netstat -aon to gather network connection information.[87]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "OS API Execution": ["Monitor for API calls that may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for executed processes that may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.", "", "", ""]}}
