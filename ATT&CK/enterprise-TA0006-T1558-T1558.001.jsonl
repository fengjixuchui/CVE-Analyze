{"TTP_id": "enterprise-TA0006-T1558-T1558.001", "TTP_name": "Golden Ticket", "Description": "Adversaries who have the KRBTGT account password hash may forge Kerberos ticket-granting tickets (TGT), also known as a golden ticket.[1] Golden tickets enable adversaries to generate authentication material for any account in Active Directory.[2]Using a golden ticket, adversaries are then able to request ticket granting service (TGS) tickets, which enable access to specific resources. Golden tickets require adversaries to interact with the Key Distribution Center (KDC) in order to obtain TGS.[3]The KDC service runs all on domain controllers that are part of an Active Directory domain. KRBTGT is the Kerberos Key Distribution Center (KDC) service account and is responsible for encrypting and signing all Kerberos tickets.[4] The KRBTGT password hash may be obtained using OS Credential Dumping and privileged access to a domain controller.", "Property": {"ID": "T1558.001", "Sub-technique of": "T1558", "Tactic": "Credential Access", "Platforms": "Windows", "Permissions Required": "User", "Contributors": "Itamar Mizrahi, Cymptom", "Version": "1.1", "Created": "11 February 2020", "Last Modified": "05 November 2020"}, "Examples": {"S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can leverage its implementation of Mimikatz to obtain and use golden tickets.[5]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has used Mimikatz to generate Kerberos golden tickets.[6]"], "S0002": ["https://attack.mitre.org/software/S0002", "Mimikatz", "Mimikatz's kerberos module can create golden tickets.[7][8]"]}, "Mitigation": {"M1015": ["https://attack.mitre.org/mitigations/M1015", "Active Directory Configuration", "For containing the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days.[9]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Limit domain admin account permissions to domain controllers and limited servers. Delegate other admin functions to separate accounts."]}, "Detection": {"Active Directory Credential Request": ["Monitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4769, 4768), RC4 encryption within TGTs, and TGS requests without preceding TGT requests. Monitor the lifetime of TGT tickets for values that differ from the default domain duration. Monitor for indications of Pass the Ticket being used to move laterally.", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"], "Logon Session Metadata": ["Monitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4624, 4634, 4672). Correlate other security systems with login information (e.g., a user has the KRBTGT account password hash and forges Kerberos ticket-granting tickets).", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"]}}
