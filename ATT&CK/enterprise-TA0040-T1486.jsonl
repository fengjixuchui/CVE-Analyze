{"TTP_id": "enterprise-TA0040-T1486", "TTP_name": "Data Encrypted for Impact", "Description": "Adversaries may encrypt data on target systems or on large numbers of systems in a network to interrupt availability to system and network resources. They can attempt to render stored data inaccessible by encrypting files or data on local and remote drives and withholding access to a decryption key. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.[1][2][3][4]In the case of ransomware, it is typical that common user files like Office documents, PDFs, images, videos, audio, text, and source code files will be encrypted (and often renamed and/or tagged with specific file markers). Adversaries may need to first employ other behaviors, such as File and Directory Permissions Modification or System Shutdown/Reboot, in order to unlock and/or gain access to manipulate these files.[5] In some cases, adversaries may encrypt critical system files, disk partitions, and the MBR.[3]To maximize impact on the target organization, malware designed for encrypting data may have worm-like features to propagate across a network by leveraging other attack techniques like Valid Accounts, OS Credential Dumping, and SMB/Windows Admin Shares.[2][3] Encryption malware may also leverage Internal Defacement, such as changing victim wallpapers, or otherwise intimidate victims by sending ransom notes or other messages to connected printers (known as \"print bombing\").[6]In cloud environments, storage objects within compromised accounts may also be encrypted.[7]", "Property": {"ID": "T1486", "Sub-techniques": "No sub-techniques", "Tactic": "Impact", "Platforms": "IaaS, Linux, Windows, macOS", "Impact Type": "Availability", "Contributors": "Harshal Tupsamudre, Qualys; Mayuresh Dani, Qualys; Oleg Kolesnikov, Securonix; Travis Smith, Qualys", "Version": "1.3", "Created": "15 March 2019", "Last Modified": "19 April 2022"}, "Examples": {"G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has used Hermes ransomware to encrypt files with AES256.[8]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used a ransomware called Encryptor RaaS to encrypt files on the targeted systems and provide a ransom note to the user.[9]"], "S0640": ["https://attack.mitre.org/software/S0640", "Avaddon", "Avaddon encrypts the victim system using a combination of AES256 and RSA encryption schemes.[10]"], "S0638": ["https://attack.mitre.org/software/S0638", "Babuk", "Babuk can use ChaCha8 and ECDH to encrypt data.[11][12][13][14]"], "S0606": ["https://attack.mitre.org/software/S0606", "Bad Rabbit", "Bad Rabbit has encrypted files and disks using AES-128-CBC and RSA-2048.[15]"], "S0570": ["https://attack.mitre.org/software/S0570", "BitPaymer", "BitPaymer can import a hard-coded RSA 1024-bit public key, generate a 128-bit RC4 key for each file, and encrypt the file in place, appending .locked to the filename.[16]"], "S0611": ["https://attack.mitre.org/software/S0611", "Clop", "Clop can encrypt files using AES, RSA, and RC4 and will add the \".clop\" extension to encrypted files.[17][18][19]"], "S0575": ["https://attack.mitre.org/software/S0575", "Conti", "Conti can use CreateIoCompletionPort(), PostQueuedCompletionStatus(), and GetQueuedCompletionPort() to rapidly encrypt files, excluding those with the extensions of .exe, .dll, and .lnk. It has used a different AES-256 encryption key per file with a bundled RAS-4096 public encryption key that is unique for each victim. Conti can use \"Windows Restart Manager\" to ensure files are unlocked and open for encryption.[20][5][21][22]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba has the ability to encrypt system data and add the \".cuba\" extension to encrypted files.[23]"], "S0616": ["https://attack.mitre.org/software/S0616", "DEATHRANSOM", "DEATHRANSOM can use public and private key pair encryption to encrypt files for ransom payment.[24]"], "S0659": ["https://attack.mitre.org/software/S0659", "Diavol", "Diavol has encrypted files using an RSA key though the CryptEncrypt API and has appended filenames with \".lock64\". [25]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor can encrypt all non-system files using a hybrid AES-RSA algorithm prior to displaying a ransom note.[6][26]"], "S0605": ["https://attack.mitre.org/software/S0605", "EKANS", "EKANS uses standard encryption library functions to encrypt files.[27][28]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 has encrypted virtual disk volumes on ESXi servers using a version of Darkside ransomware.[29]"], "S0618": ["https://attack.mitre.org/software/S0618", "FIVEHANDS", "FIVEHANDS can use an embedded NTRU public key to encrypt data for ransom.[24][30][31]"], "S0617": ["https://attack.mitre.org/software/S0617", "HELLOKITTY", "HELLOKITTY can use an embedded RSA-2048 public key to encrypt victim data for ransom.[24]"], "G0119": ["https://attack.mitre.org/groups/G0119", "Indrik Spider", "Indrik Spider has encrypted domain-controlled systems using BitPaymer.[16]"], "S0389": ["https://attack.mitre.org/software/S0389", "JCry", "JCry has encrypted files and demanded Bitcoin to decrypt those files. [32]"], "S0607": ["https://attack.mitre.org/software/S0607", "KillDisk", "KillDisk has a ransomware component that encrypts files with an AES key that is also RSA-1028 encrypted.[33]"], "S0372": ["https://attack.mitre.org/software/S0372", "LockerGoga", "LockerGoga has encrypted files, including core Windows OS files, using RSA-OAEP MGF1 and then demanded Bitcoin be paid for the decryption key.[34][35][36]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "Maze has disrupted systems by encrypting files on targeted machines, claiming to decrypt files if a ransom payment is made. Maze has used the ChaCha algorithm, based on Salsa20, and an RSA algorithm to encrypt files.[37]"], "S0576": ["https://attack.mitre.org/software/S0576", "MegaCortex", "MegaCortex has used the open-source library, Mbed Crypto, and generated AES keys to carry out the file encryption process.[38][39]"], "S0457": ["https://attack.mitre.org/software/S0457", "Netwalker", "Netwalker can encrypt files on infected machines to extort victims.[40]"], "S0368": ["https://attack.mitre.org/software/S0368", "NotPetya", "NotPetya encrypts user files and disk structures like the MBR with 2048-bit RSA.[41][3][42]"], "S0556": ["https://attack.mitre.org/software/S0556", "Pay2Key", "Pay2Key can encrypt data on victim's machines using RSA and AES algorithms in order to extort a ransom payment for decryption.[43][44]"], "S0654": ["https://attack.mitre.org/software/S0654", "ProLock", "ProLock can encrypt files on a compromised host with RC6, and encrypts the key with RSA-1024.[45]"], "S0583": ["https://attack.mitre.org/software/S0583", "Pysa", "Pysa has used RSA and AES-CBC encryption algorithm to encrypt a list of targeted file extensions.[46]"], "S0481": ["https://attack.mitre.org/software/S0481", "Ragnar Locker", "Ragnar Locker encrypts files on the local machine and mapped drives prior to displaying a note demanding a ransom.[47][48]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil can encrypt files on victim systems and demands a ransom to decrypt the files.[49][50][51][52][53][54][55][56]"], "S0400": ["https://attack.mitre.org/software/S0400", "RobbinHood", "RobbinHood will search for an RSA encryption key and then perform its encryption process on the system files.[57]"], "S0446": ["https://attack.mitre.org/software/S0446", "Ryuk", "Ryuk has used a combination of symmetric (AES) and asymmetric (RSA) encryption to encrypt files. Files have been encrypted with their own AES key and given a file extension of .RYK. Encrypted directories have had a ransom note of RyukReadMe.txt written to the directory.[58][22]"], "S0370": ["https://attack.mitre.org/software/S0370", "SamSam", "SamSam encrypts victim files using RSA-2048 encryption and demands a ransom be paid in Bitcoin to decrypt those files.[59]"], "S0639": ["https://attack.mitre.org/software/S0639", "Seth-Locker", "Seth-Locker can encrypt files on a targeted system, appending them with the suffix .seth.[14]"], "S0140": ["https://attack.mitre.org/software/S0140", "Shamoon", "Shamoon has an operational mode for encrypting data instead of overwriting it.[60][61]"], "S0242": ["https://attack.mitre.org/software/S0242", "SynAck", "SynAck encrypts the victims machine followed by asking the victim to pay a ransom. [62]"], "G0092": ["https://attack.mitre.org/groups/G0092", "TA505", "TA505 has used a wide variety of ransomware, such as Locky, Jaff, Bart, Philadelphia, and GlobeImposter, to encrypt victim files and demand a ransom payment.[63]"], "S0595": ["https://attack.mitre.org/software/S0595", "ThiefQuest", "ThiefQuest encrypts a set of file extensions on a host, deletes the original files, and provides a ransom note with no contact information.[64]"], "S0366": ["https://attack.mitre.org/software/S0366", "WannaCry", "WannaCry encrypts user files and demands that a ransom be paid in Bitcoin to decrypt those files.[65][2][66]"], "S0612": ["https://attack.mitre.org/software/S0612", "WastedLocker", "WastedLocker can encrypt data and leave a ransom note.[67][68][69]"], "S0341": ["https://attack.mitre.org/software/S0341", "Xbash", "Xbash has maliciously encrypted victim's database systems and demanded a cryptocurrency ransom be paid.[70]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET performs AES-CBC encryption on files under ~/Documents, ~/Downloads, and~/Desktop with a fixed key and renames files to give them a .enc extension. Only files with sizes less than 500MB are encrypted.[71]"]}, "Mitigation": {"M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable cloud-delivered protection and Attack Surface Reduction (ASR) rules to block the execution of files that resemble ransomware. [72]"], "M1053": ["https://attack.mitre.org/mitigations/M1053", "Data Backup", "Consider implementing IT disaster recovery plans that contain procedures for regularly taking and testing data backups that can be used to restore organizational data.[73] Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery. Consider enabling versioning in cloud environments to maintain backup copies of storage objects.[74]"]}, "Detection": {"Cloud Storage Modification": ["Monitor for changes made in cloud environments for events that indicate storage objects have been anomalously modified.", "DS0010", "https://attack.mitre.org/datasources/DS0010", "Cloud Storage"], "Command Execution": ["Monitor executed commands and arguments for actions involved in data destruction activity, such as vssadmin, wbadmin, and bcdedit", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Creation": ["Monitor for newly constructed files in user directories.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Modification": ["Monitor for changes made to files in user directories.", "", "", ""], "Process Creation": ["Monitor for newly constructed processes and/or command-lines involved in data destruction activity, such as vssadmin, wbadmin, and bcdedit.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
