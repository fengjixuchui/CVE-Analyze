{"TTP_id": "enterprise-TA0008-T1021-T1021.001", "TTP_name": "Remote Desktop Protocol", "Description": "Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).[1]Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the Accessibility Features or Terminal Services DLL for Persistence.[2]", "Property": {"ID": "T1021.001", "Sub-technique of": "T1021", "Tactic": "Lateral Movement", "Platforms": "Windows", "System Requirements": "RDP service enabled, account in the Remote Desktop Users group", "Permissions Required": "Remote Desktop Users, User", "CAPEC ID": "CAPEC-555", "Contributors": "Matthew Demaske, Adaptforward", "Version": "1.1", "Created": "11 February 2020", "Last Modified": "28 March 2022"}, "Examples": {"G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "The APT1 group is known to have used RDP during operations.[3]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used RDP sessions from public-facing systems to internal servers.[4]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 enables the Remote Desktop Protocol for persistence.[5] APT3 has also interacted with compromised systems to browse and copy files through RDP sessions.[6]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has been seen using RDP for lateral movement and persistence, in some cases employing the rdpwinst tool for mangement of multiple sessions.[7][8]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used RDP for lateral movement.[9][10]"], "G0001": ["https://attack.mitre.org/groups/G0001", "Axiom", "Axiom has used RDP during operations.[11]"], "G0108": ["https://attack.mitre.org/groups/G0108", "Blue Mockingbird", "Blue Mockingbird has used Remote Desktop to log on to servers interactively and manually copy files to remote hosts.[12]"], "S0030": ["https://attack.mitre.org/software/S0030", "Carbanak", "Carbanak enables concurrent Remote Desktop Protocol (RDP) sessions.[13]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used RDP to access targeted systems.[14]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has used Remote Desktop Protocol to conduct lateral movement.[15]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can start a VNC-based remote desktop server and tunnel the connection through the already established C2 channel.[16]"], "S0334": ["https://attack.mitre.org/software/S0334", "DarkComet", "DarkComet can open an active screen of the victimâ€™s machine and take control of the mouse and keyboard.[17]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has moved laterally via RDP.[18]"], "G0051": ["https://attack.mitre.org/groups/G0051", "FIN10", "FIN10 has used RDP to move laterally to systems in the victim environment.[19]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 used RDP to move laterally in victim networks.[20][21]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 has used RDP to move laterally in victim environments.[22]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has used RDP for lateral movement.[23]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used RDP to log in and move laterally in the target environment.[24][25]"], "S0434": ["https://attack.mitre.org/software/S0434", "Imminent Monitor", "Imminent Monitor has a module for performing remote desktop access.[26]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT can support RDP control.[27]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used RDP for direct remote point-and-click access.[28]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can enable remote desktop on the victim's machine.[29]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware SierraCharlie uses RDP for propagation.[30][31]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has targeted RDP credentials and used it to move through the victim environment.[32]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used RDP connections to move across the victim network.[33][34]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT has a module for performing remote desktop access.[35]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used Remote Desktop Protocol for lateral movement. The group has also used tunneling tools to tunnel RDP into the environment.[36][37][10]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork attempted to use RDP to move laterally.[38]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy can enable/disable RDP connection and can start a remote desktop session using a browser web socket client.[39]"], "S0583": ["https://attack.mitre.org/software/S0583", "Pysa", "Pysa has laterally moved using RDP connections.[40]"], "S0262": ["https://attack.mitre.org/software/S0262", "QuasarRAT", "QuasarRAT has a module for performing remote desktop access.[41][42]"], "S0379": ["https://attack.mitre.org/software/S0379", "Revenge RAT", "Revenge RAT has a plugin to perform RDP access.[43]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has the ability to use RDP to connect to victim's machines.[44]"], "S0382": ["https://attack.mitre.org/software/S0382", "ServHelper", "ServHelper has commands for adding a remote desktop user and sending RDP traffic to the attacker through a reverse SSH tunnel.[45]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used RDP for lateral movement.[46]"], "G0088": ["https://attack.mitre.org/groups/G0088", "TEMP.Veles", "TEMP.Veles utilized RDP throughout an operation.[47]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT has the ability to control an infected PC using RDP.[48]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used RDP for lateral movement.[49][50][51]"], "S0350": ["https://attack.mitre.org/software/S0350", "zwShell", "zwShell has used RDP for lateral movement.[52]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell has remote desktop functionality.[53]"]}, "Mitigation": {"M1047": ["https://attack.mitre.org/mitigations/M1047", "Audit", "Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups."], "M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Disable the RDP service if it is unnecessary."], "M1035": ["https://attack.mitre.org/mitigations/M1035", "Limit Access to Resource Over Network", "Use remote desktop gateways."], "M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Use multi-factor authentication for remote logins.[54]"], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Do not leave RDP accessible from the internet. Enable firewall rules to block RDP traffic between network security zones within a network."], "M1028": ["https://attack.mitre.org/mitigations/M1028", "Operating System Configuration", "Change GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.[55]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Consider removing the local Administrators group from the list of groups allowed to log in through RDP."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Limit remote user permissions if remote access is necessary."]}, "Detection": {"Logon Session Creation": ["Monitor for user accounts logged into systems associated with RDP (ex: Windows EID 4624 Logon Type 10). Other factors, such as access patterns (ex: multiple systems over a relatively short period of time) and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP.", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "Network Connection Creation": ["Monitor for newly constructed network connections (typically over port 3389) that may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network traffic for uncommon data flows that may use /techniques/T1078 to log into a computer using the Remote Desktop Protocol (RDP).", "", "", ""], "Process Creation": ["Monitor for newly executed processes (such as mstsc.exe) that may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions that spawn additional processes as the logged-on user.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
