{"TTP_id": "enterprise-TA0011-T1102-T1102.002", "TTP_name": "Bidirectional Communication", "Description": "Adversaries may use an existing, legitimate external Web service as a means for sending commands to and receiving output from a compromised system over the Web service channel. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet.Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.", "Property": {"ID": "T1102.002", "Sub-technique of": "T1102", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Version": "1.0", "Created": "14 March 2020", "Last Modified": "26 March 2020"}, "Examples": {"G0005": ["https://attack.mitre.org/groups/G0005", "APT12", "APT12 has used blogs and WordPress for C2 infrastructure.[1]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has used Google Drive for C2.[2]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used social media platforms to hide communications to C2 servers.[3]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 leverages social networking sites and cloud platforms (AOL, Twitter, Yandex, Mediafire, pCloud, Dropbox, and Box) for C2.[4][5]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has communicated with C2 through files uploaded to and downloaded from DropBox.[6]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "BADNEWS can use multiple C2 channels, including RSS feeds, Github, forums, and blogs.[7][8][9]"], "S0069": ["https://attack.mitre.org/software/S0069", "BLACKCOFFEE", "BLACKCOFFEE has also obfuscated its C2 traffic as normal traffic to sites such as Github.[10][11]"], "S0657": ["https://attack.mitre.org/software/S0657", "BLUELIGHT", "BLUELIGHT can use different cloud providers for its C2.[12]"], "S0651": ["https://attack.mitre.org/software/S0651", "BoxCaon", "BoxCaon has used DropBox for C2 communications.[13]"], "S0025": ["https://attack.mitre.org/software/S0025", "CALENDAR", "The CALENDAR malware communicates through the use of events in Google Calendar.[14][15]"], "G0008": ["https://attack.mitre.org/groups/G0008", "Carbanak", "Carbanak has used a VBScript named \"ggldr\" that uses Google Apps Script, Sheets, and Forms services for C2.[16]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling can use Dropbox to download malicious payloads, send commands, and receive information.[17][18]"], "S0054": ["https://attack.mitre.org/software/S0054", "CloudDuke", "One variant of CloudDuke uses a Microsoft OneDrive account to exchange commands and stolen data with its operators.[19]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie uses blogs and third-party sites (GitHub, tumbler, and BlogSpot) to avoid DNS-based blocking of their communication to the command and control server.[20]"], "S0126": ["https://attack.mitre.org/software/S0126", "ComRAT", "ComRAT has the ability to use the Gmail web UI to receive commands and exfiltrate information.[21][22]"], "S0046": ["https://attack.mitre.org/software/S0046", "CozyCar", "CozyCar uses Twitter as a backup C2 channel to Twitter accounts specified in its configuration file.[23]"], "S0538": ["https://attack.mitre.org/software/S0538", "Crutch", "Crutch can use Dropbox to receive commands and upload stolen data.[24]"], "S0213": ["https://attack.mitre.org/software/S0213", "DOGCALL", "DOGCALL is capable of leveraging cloud storage APIs such as Cloud, Box, Dropbox, and Yandex for C2.[4][25]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can use Dropbox and GitHub for C2.[26]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 used legitimate services like Google Docs, Google Scripts, and Pastebin for C2.[27]"], "S0026": ["https://attack.mitre.org/software/S0026", "GLOOXMAIL", "GLOOXMAIL communicates to servers operated by Google using the Jabber/XMPP protocol.[14][28]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can utilize web services including Google sites to send and receive C2 data.[29][30]"], "S0215": ["https://attack.mitre.org/software/S0215", "KARAE", "KARAE can use public cloud-based storage providers for command and control.[4]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar has used compromised WordPress blogs as C2 servers.[31]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used Blogspot pages for C2.[32]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used GitHub as C2, pulling hosted image payloads then committing command execution output to files in specific directories.[33]"], "S0042": ["https://attack.mitre.org/software/S0042", "LOWBALL", "LOWBALL uses the Dropbox cloud storage service for command and control.[34]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound malware can use a SOAP Web service to communicate with its C2 server.[35]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used web services including OneHub to distribute remote access tools.[36]"], "S0229": ["https://attack.mitre.org/software/S0229", "Orz", "Orz has used Technet and Pastebin web pages for command and control.[37]"], "S0216": ["https://attack.mitre.org/software/S0216", "POORAIM", "POORAIM has used AOL Instant Messenger for C2.[4]"], "S0393": ["https://attack.mitre.org/software/S0393", "PowerStallion", "PowerStallion uses Microsoft OneDrive as a C2 server via a network drive mapped with net use.[38]"], "S0511": ["https://attack.mitre.org/software/S0511", "RegDuke", "RegDuke can use Dropbox as its C2 server.[3]"], "S0379": ["https://attack.mitre.org/software/S0379", "Revenge RAT", "Revenge RAT used blogpost.com as its primary command and control server during a campaign.[39]"], "S0270": ["https://attack.mitre.org/software/S0270", "RogueRobin", "RogueRobin has used Google Drive as a Command and Control channel. [40]"], "S0240": ["https://attack.mitre.org/software/S0240", "ROKRAT", "ROKRAT has used legitimate social networking sites and cloud platforms (including but not limited to Twitter, Yandex, Dropbox, and Mediafire) for C2 communications.[41][42][43]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has used the Telegram Bot API from Telegram Messenger to send and receive commands to its Python backdoor. Sandworm Team also used legitimate M.E.Doc software update check requests for sending and receiving commands and hosted malicious payloads on putdrive.com.[44][45]"], "S0218": ["https://attack.mitre.org/software/S0218", "SLOWDRIFT", "SLOWDRIFT uses cloud based services for C2.[4]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "A Turla JavaScript backdoor has used Google Apps Script as its C2 server.[46][47]"], "S0333": ["https://attack.mitre.org/software/S0333", "UBoatRAT", "UBoatRAT has used GitHub and a public blog service in Hong Kong for C2 communications.[48]"], "S0248": ["https://attack.mitre.org/software/S0248", "yty", "yty communicates to the C2 server by retrieving a Google Doc.[49]"], "G0128": ["https://attack.mitre.org/groups/G0128", "ZIRCONIUM", "ZIRCONIUM has used Dropbox for C2 allowing upload and download of files as well as execution of arbitrary commands.[50][51]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."], "M1021": ["https://attack.mitre.org/mitigations/M1021", "Restrict Web-Based Content", "Web proxies can be used to enforce external network communication policy that prevents use of unauthorized external services."]}, "Detection": {"Network Connection Creation": ["Monitor for newly constructed network connections that are sent or received by untrusted hosts.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
