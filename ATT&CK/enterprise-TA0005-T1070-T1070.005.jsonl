{"TTP_id": "enterprise-TA0005-T1070-T1070.005", "TTP_name": "Network Share Connection Removal", "Description": "Adversaries may remove share connections that are no longer useful in order to clean up traces of their operation. Windows shared drive and SMB/Windows Admin Shares connections can be removed when no longer needed. Net is an example utility that can be used to remove network share connections with the net use \\system\\share /delete command. [1]", "Property": {"ID": "T1070.005", "Sub-technique of": "T1070", "Tactic": "Defense Evasion", "Platforms": "Windows", "System Requirements": "Established network share connection to a remote system. Level of access depends on permissions of the account used.", "Permissions Required": "Administrator, User", "Defense Bypassed": "Host forensic analysis", "Version": "1.0", "Created": "31 January 2020", "Last Modified": "09 February 2021"}, "Examples": {"S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can disconnect previously connected remote drives.[2]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "The net use \\system\\share /delete command can be used in Net to remove an established connection to a network share.[1]"], "S0400": ["https://attack.mitre.org/software/S0400", "RobbinHood", "RobbinHood disconnects all network shares from the computer with the command net use * /DELETE /Y.[3]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has detached network shares after exfiltrating files, likely to evade detection.[4]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments of net use commands associated with establishing and removing remote shares over SMB, including following best practices for detection of Windows Admin Shares.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Network Traffic Content": ["Monitoring for SMB traffic between systems may also be captured and decoded to look for related network share session and file transfer activity.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Process Creation": ["Monitor for newly constructed processes and/or command line execution that can be used to remove network share connections via the net.exe process.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "User Account Authentication": ["Monitoring for Windows authentication logs are also useful in determining when authenticated network shares are established and by which account, and can be used to correlate network share activity to other events to investigate potentially malicious activity.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"]}}
