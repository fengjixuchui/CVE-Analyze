{"TTP_id": "enterprise-TA0007-T1016", "TTP_name": "System Network Configuration Discovery", "Description": "Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include Arp, ipconfig/ifconfig, nbtstat, and route.Adversaries may also leverage a Network Device CLI on network devices to gather information about configurations and settings, such as IP addresses of configured interfaces and static/dynamic routes.[1][2]Adversaries may use the information from System Network Configuration Discovery during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next.", "Property": {"ID": "T1016", "Sub-techniques": "T1016.001", "Tactic": "Discovery", "Platforms": "Linux, Network, Windows, macOS", "CAPEC ID": "CAPEC-309", "Contributors": "Austin Clark, @c2defense", "Version": "1.4", "Created": "31 May 2017", "Last Modified": "20 May 2022"}, "Examples": {"S0552": ["https://attack.mitre.org/software/S0552", "AdFind", "AdFind can extract subnet information from Active Directory.[3][4][5]"], "G0018": ["https://attack.mitre.org/groups/G0018", "admin@338", "admin@338 actors used the following command after exploiting a machine with LOWBALL malware to acquire information about local networks: ipconfig /all >> %temp%\\download[6]"], "S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla can collect the IP address of the victim machine and spawn instances of netsh.exe to enumerate wireless settings.[7][8]"], "S0092": ["https://attack.mitre.org/software/S0092", "Agent.btz", "Agent.btz collects the network adapter’s IP and MAC address as well as IP addresses of the network adapter’s default gateway, primary/secondary WINS, DHCP, and DNS servers, and saves them into a log file.[9]"], "S0504": ["https://attack.mitre.org/software/S0504", "Anchor", "Anchor can determine the public IP and location of a compromised host.[10]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed can identify the IP of a targeted system.[11]"], "G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 used the ipconfig /all command to gather network configuration information.[12]"], "G0073": ["https://attack.mitre.org/groups/G0073", "APT19", "APT19 used an HTTP malware variant and a Port 22 malware variant to collect the MAC address and IP address from the victim’s machine.[13]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "A keylogging tool used by APT3 gathers network information from the victim, including the MAC address, IP address, WINS, DHCP server, and gateway.[14][15]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 used the ipconfig /all command to gather the IP address from the system.[16]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 collected MAC addresses from victim machines.[17][18]"], "S0456": ["https://attack.mitre.org/software/S0456", "Aria-body", "Aria-body has the ability to identify the location, public IP address, and domain name on a compromised host.[19]"], "S0099": ["https://attack.mitre.org/software/S0099", "Arp", "Arp can be used to display ARP configuration information on the host.[20]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth collects the external IP address from the system. [21]"], "S0640": ["https://attack.mitre.org/software/S0640", "Avaddon", "Avaddon can collect the external IP address of the victim.[22]"], "S0473": ["https://attack.mitre.org/software/S0473", "Avenger", "Avenger can identify the domain of the compromised host.[23]"], "S0344": ["https://attack.mitre.org/software/S0344", "Azorult", "Azorult can collect host IP information from the victim’s machine.[24]"], "S0414": ["https://attack.mitre.org/software/S0414", "BabyShark", "BabyShark has executed the ipconfig /all command.[25]"], "S0093": ["https://attack.mitre.org/software/S0093", "Backdoor.Oldrea", "Backdoor.Oldrea collects information about the Internet adapter configuration.[26][27]"], "S0245": ["https://attack.mitre.org/software/S0245", "BADCALL", "BADCALL collects the network adapter information.[28]"], "S0642": ["https://attack.mitre.org/software/S0642", "BADFLICK", "BADFLICK has captured victim IP address details.[29]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook has a command to get the public IP address from a system.[30]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can collect the IP address and NetBIOS name of an infected machine.[31]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal can execute ipconfig on the victim’s machine.[32][33][34]"], "S0089": ["https://attack.mitre.org/software/S0089", "BlackEnergy", "BlackEnergy has gathered information about network IP configurations using ipconfig.exe and about routing tables using route.exe.[35][36]"], "S0520": ["https://attack.mitre.org/software/S0520", "BLINDINGCAN", "BLINDINGCAN has collected the victim machine's local IP address information and MAC address.[37]"], "S0657": ["https://attack.mitre.org/software/S0657", "BLUELIGHT", "BLUELIGHT can collect IP information from the victim’s machine.[38]"], "S0486": ["https://attack.mitre.org/software/S0486", "Bonadan", "Bonadan can find the external IP address of the infected host.[39]"], "S0651": ["https://attack.mitre.org/software/S0651", "BoxCaon", "BoxCaon can collect the victim's MAC address by using the GetAdaptersInfo API.[40]"], "S0252": ["https://attack.mitre.org/software/S0252", "Brave Prince", "Brave Prince gathers network configuration information as well as the ARP cache.[41]"], "S0274": ["https://attack.mitre.org/software/S0274", "Calisto", "Calisto runs the ifconfig command to obtain the IP address from the victim’s machine.[42]"], "S0335": ["https://attack.mitre.org/software/S0335", "Carbon", "Carbon can collect the IP address of the victims and other computers on the network using the commands: ipconfig -all nbtstat -n, and nbtstat -s.[43][44]"], "S0261": ["https://attack.mitre.org/software/S0261", "Catchamas", "Catchamas gathers the Mac address, IP address, and the network adapter information from the victim’s machine.[45]"], "S0572": ["https://attack.mitre.org/software/S0572", "Caterpillar WebShell", "Caterpillar WebShell can gather the IP address from the victim's machine using the IP config command.[46]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower has the ability to use ipconfig to enumerate system network settings.[47]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used ipconfig, Ping, and tracert to enumerate the IP address and network environment and settings of the local host.[48]"], "S0667": ["https://attack.mitre.org/software/S0667", "Chrommme", "Chrommme can enumerate the IP address of a compromised host.[49]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling can enumerate the IP address of a compromised machine.[50][51]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can determine the NetBios name and the IP addresses of targets machines including domain controllers.[52][53]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie uses ipconfig /all and route PRINT to identify network adapter and interface information.[54]"], "S0575": ["https://attack.mitre.org/software/S0575", "Conti", "Conti can retrieve the ARP cache from the local system by using the GetIpNetTable() API call and check to ensure IP addresses it connects to are for local, non-Internet, systems.[55]"], "S0488": ["https://attack.mitre.org/software/S0488", "CrackMapExec", "CrackMapExec can collect DNS information from the targeted system.[56]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson contains a command to collect the victim MAC address and LAN IP.[57][58]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba can retrieve the ARP cache from the local system by using GetIpNetTable.[59]"], "S0687": ["https://attack.mitre.org/software/S0687", "Cyclops Blink", "Cyclops Blink can use the Linux API if_nameindex to gather network interface names.[60][61]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel has collected the IP address and network adapter information from the victim’s machine.[62][63]"], "S0354": ["https://attack.mitre.org/software/S0354", "Denis", "Denis uses ipconfig to gather the IP address from the system.[16]"], "S0659": ["https://attack.mitre.org/software/S0659", "Diavol", "Diavol can enumerate victims' local and external IPs when registering with C2.[64]"], "S0472": ["https://attack.mitre.org/software/S0472", "down_new", "down_new has the ability to identify the MAC address of a compromised host.[23]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has used batch scripts to enumerate network information, including information about trusts, zones, and the domain.[65]"], "S0567": ["https://attack.mitre.org/software/S0567", "Dtrack", "Dtrack can collect the host's IP addresses using the ipconfig command.[66][67]"], "S0038": ["https://attack.mitre.org/software/S0038", "Duqu", "The reconnaissance modules used with Duqu can collect information on network configuration.[68]"], "S0024": ["https://attack.mitre.org/software/S0024", "Dyre", "Dyre has the ability to identify network settings on a compromised host.[69]"], "S0605": ["https://attack.mitre.org/software/S0605", "EKANS", "EKANS can determine the domain of a compromised host.[70]"], "S0081": ["https://attack.mitre.org/software/S0081", "Elise", "Elise executes ipconfig /all after initial communication is made to the remote server.[71][72]"], "S0082": ["https://attack.mitre.org/software/S0082", "Emissary", "Emissary has the capability to execute the command ipconfig /all.[73]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can acquire network configuration information like DNS servers and network proxies used by a host.[74]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic uses the nbtstat -n and nbtstat -s commands on the victim’s machine.[75]"], "S0569": ["https://attack.mitre.org/software/S0569", "Explosive", "Explosive has collected the MAC address from the victim's machine.[76]"], "S0181": ["https://attack.mitre.org/software/S0181", "FALLCHILL", "FALLCHILL collects MAC address and local IP address information from the victim.[77]"], "S0512": ["https://attack.mitre.org/software/S0512", "FatDuke", "FatDuke can identify the MAC address on the target computer.[78]"], "S0171": ["https://attack.mitre.org/software/S0171", "Felismus", "Felismus collects the victim LAN IP address and sends it to the C2 server.[79]"], "S0267": ["https://attack.mitre.org/software/S0267", "FELIXROOT", "FELIXROOT collects information about the network including the IP address and DHCP server.[80]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro has been used to execute the ipconfig /all command on a victim system.[81]"], "G0101": ["https://attack.mitre.org/groups/G0101", "Frankenstein", "Frankenstein has enumerated hosts, looking for the public IP address of the system.[82]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used ipconfig /all to obtain information about the victim network configuration. The group also ran a modified version of NBTscan to identify available NetBIOS name servers.[83]"], "S0049": ["https://attack.mitre.org/software/S0049", "GeminiDuke", "GeminiDuke collects information on network settings and Internet proxy settings from the victim.[84]"], "S0588": ["https://attack.mitre.org/software/S0588", "GoldMax", "GoldMax retrieved a list of the system's network interface after execution.[85]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can determine the IP and physical location of the compromised host via IPinfo.[86]"], "S0237": ["https://attack.mitre.org/software/S0237", "GravityRAT", "GravityRAT collects the victim IP address, MAC address, as well as the victim account domain name.[87]"], "S0690": ["https://attack.mitre.org/software/S0690", "Green Lambert", "Green Lambert can obtain proxy information from a victim's machine using system environment variables.[88][89]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can enumerate the IP and domain of a target system.[90]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa used ipconfig to gather network configuration information.[91][92]"], "S0431": ["https://attack.mitre.org/software/S0431", "HotCroissant", "HotCroissant has the ability to identify the IP address of the compromised machine.[93]"], "S0203": ["https://attack.mitre.org/software/S0203", "Hydraq", "Hydraq creates a backdoor through which remote attackers can retrieve IP addresses of compromised machines.[94][95]"], "S0101": ["https://attack.mitre.org/software/S0101", "ifconfig", "ifconfig can be used to display adapter configuration on Unix systems, including information for TCP/IP, DNS, and DHCP."], "S0278": ["https://attack.mitre.org/software/S0278", "iKitten", "iKitten will look for the current IP address.[96]"], "S0604": ["https://attack.mitre.org/software/S0604", "Industroyer", "Industroyer’s 61850 payload component enumerates connected network adapters and their corresponding IP addresses.[97]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole gathers information on the IP forwarding table, MAC address, configured proxy, and network SSID.[98][99]"], "S0100": ["https://attack.mitre.org/software/S0100", "ipconfig", "ipconfig can be used to display adapter configuration on Windows systems, including information for TCP/IP, DNS, and DHCP."], "S0015": ["https://attack.mitre.org/software/S0015", "Ixeshe", "Ixeshe enumerates the IP address, network proxy settings, and domain name from a victim's system.[100]"], "S0044": ["https://attack.mitre.org/software/S0044", "JHUHUGIT", "A JHUHUGIT variant gathers network interface card information.[101]"], "S0201": ["https://attack.mitre.org/software/S0201", "JPIN", "JPIN can obtain network information, including DNS, IP, and proxies.[102]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT can gather victim internal and external IPs.[103]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar gathers information about network adapters.[104]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has performed local network configuration discovery using ipconfig.[105][106][107]"], "S0487": ["https://attack.mitre.org/software/S0487", "Kessel", "Kessel has collected the DNS address of the infected host.[39]"], "S0387": ["https://attack.mitre.org/software/S0387", "KeyBoy", "KeyBoy can determine the public or WAN IP address for the system.[108]"], "S0271": ["https://attack.mitre.org/software/S0271", "KEYMARBLE", "KEYMARBLE gathers the MAC address of the victim’s machine.[109]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used ipconfig/all to gather network configuration information.[110]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can retrieve the contents of the IP routing table as well as information about the Windows domain.[111][112]"], "S0641": ["https://attack.mitre.org/software/S0641", "Kobalos", "Kobalos can record the IP address of the target machine.[113]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI can collect the IP address from the victim’s machine.[114]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs collects network adapter and interface information by using the commands ipconfig /all, arp -a and route print. It also collects the system's MAC address with getmac and domain configuration with net config workstation.[115]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware IndiaIndia obtains and sends to its C2 server information about the first network interface card’s configuration, including IP address, gateways, subnet mask, DHCP information, and whether WINS is available.[116][117]"], "S0395": ["https://attack.mitre.org/software/S0395", "LightNeuron", "LightNeuron gathers information about network adapters using the Win32 API call GetAdaptersInfo.[118]"], "S0513": ["https://attack.mitre.org/software/S0513", "LiteDuke", "LiteDuke has the ability to discover the proxy configuration of Firefox and/or Opera.[78]"], "S0681": ["https://attack.mitre.org/software/S0681", "Lizar", "Lizar can retrieve network information from a compromised host.[119]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot has the ability to discover the domain name of the infected host.[120]"], "S0451": ["https://attack.mitre.org/software/S0451", "LoudMiner", "LoudMiner used a script to gather the IP address of the infected machine before sending to the C2.[121]"], "S0532": ["https://attack.mitre.org/software/S0532", "Lucifer", "Lucifer can collect the IP address of a compromised host.[122]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete collects the MAC address of the target computer and other network configuration information.[123][124]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound malware gathers the victim's local IP address, MAC address, and external IP address.[125]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used several tools to scan for open NetBIOS nameservers and enumerate NetBIOS sessions.[126]"], "S0084": ["https://attack.mitre.org/software/S0084", "Mis-Type", "Mis-Type may create a file containing the results of the command cmd.exe /c ipconfig /all.[127]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind obtains the victim IP address.[128]"], "S0284": ["https://attack.mitre.org/software/S0284", "More_eggs", "More_eggs has the capability to gather the IP address from the victim's machine.[129]"], "S0256": ["https://attack.mitre.org/software/S0256", "Mosquito", "Mosquito uses the ipconfig command.[130]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used malware to collect the victim’s IP address and domain name.[131]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has used ipconfig and arp to determine network configuration information.[132]"], "S0205": ["https://attack.mitre.org/software/S0205", "Naid", "Naid collects the domain name from a compromised host.[133]"], "G0019": ["https://attack.mitre.org/groups/G0019", "Naikon", "Naikon uses commands such as netsh interface show to discover network interface settings.[134]"], "S0228": ["https://attack.mitre.org/software/S0228", "NanHaiShu", "NanHaiShu can gather information about the victim proxy server.[135]"], "S0336": ["https://attack.mitre.org/software/S0336", "NanoCore", "NanoCore gathers the IP address from the victim’s machine.[136]"], "S0590": ["https://attack.mitre.org/software/S0590", "NBTscan", "NBTscan can be used to collect MAC addresses.[137][138]"], "S0102": ["https://attack.mitre.org/software/S0102", "nbtstat", "nbtstat can be used to discover local NetBIOS domain names."], "S0691": ["https://attack.mitre.org/software/S0691", "Neoichor", "Neoichor can gather the IP address from an infected host.[107]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE can collect the IP address of a compromised host.[139][140]"], "S0359": ["https://attack.mitre.org/software/S0359", "Nltest", "Nltest may be used to enumerate the parent domain of a local machine using /parentdomain.[141]"], "S0353": ["https://attack.mitre.org/software/S0353", "NOKKI", "NOKKI can gather information on the victim IP address.[142]"], "S0346": ["https://attack.mitre.org/software/S0346", "OceanSalt", "OceanSalt can collect the victim’s IP address.[143]"], "S0340": ["https://attack.mitre.org/software/S0340", "Octopus", "Octopus can collect the host IP address from the victim’s machine.[144]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has run ipconfig /all on a victim.[145][146]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum can collect network information, including the host IP address, DNS, and proxy information.[147]"], "S0365": ["https://attack.mitre.org/software/S0365", "Olympic Destroyer", "Olympic Destroyer uses API calls to enumerate the infected system's ARP table.[148]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has discovered the local network configuration with ipconfig.[149]"], "S0229": ["https://attack.mitre.org/software/S0229", "Orz", "Orz can gather victim proxy information.[135]"], "S0165": ["https://attack.mitre.org/software/S0165", "OSInfo", "OSInfo discovers the current domain information.[14]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D can collect the network interface MAC address on the infected host.[150][151]"], "S0556": ["https://attack.mitre.org/software/S0556", "Pay2Key", "Pay2Key can identify the IP and MAC addresses of the compromised host.[152]"], "S0587": ["https://attack.mitre.org/software/S0587", "Penquin", "Penquin can report the IP of the compromised host to attacker controlled infrastructure.[153]"], "S0501": ["https://attack.mitre.org/software/S0501", "PipeMon", "PipeMon can collect and send the local IP address, RDP information, and the network adapter physical address as a part of its C2 beacon.[154]"], "S0124": ["https://attack.mitre.org/software/S0124", "Pisloader", "Pisloader has a command to collect the victim's IP address.[155]"], "S0254": ["https://attack.mitre.org/software/S0254", "PLAINTEE", "PLAINTEE uses the ipconfig /all command to gather the victim’s IP address.[156]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 can enumerate network adapter information.[157]"], "S0139": ["https://attack.mitre.org/software/S0139", "PowerDuke", "PowerDuke has a command to get the victim's domain and NetBIOS name.[158]"], "S0441": ["https://attack.mitre.org/software/S0441", "PowerShower", "PowerShower has the ability to identify the current Windows domain of the infected host.[159]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS can retrieve IP, network adapter configuration information, and domain from compromised hosts.[160][161]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER may collect network configuration data by running ipconfig /all on a victim.[162]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "A module in Prikormka collects information from the victim about its IP addresses and MAC addresses.[163]"], "S0238": ["https://attack.mitre.org/software/S0238", "Proxysvc", "Proxysvc collects the network adapter information and domain/username information based on current remote sessions.[164]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy has built in commands to identify a host’s IP address and find out other network configuration settings by viewing connected sessions.[165]"], "S0583": ["https://attack.mitre.org/software/S0583", "Pysa", "Pysa can perform network reconnaissance using the Advanced IP Scanner tool.[166]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use net config workstation, arp -a, and ipconfig /all to gather network configuration information.[167][168][169]"], "S0269": ["https://attack.mitre.org/software/S0269", "QUADAGENT", "QUADAGENT gathers the current domain the victim system belongs to.[170]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can use ipconfig and Arp to collect network configuration information, including routing information and ARP tables.[171]"], "S0241": ["https://attack.mitre.org/software/S0241", "RATANKBA", "RATANKBA gathers the victim’s IP address via the ipconfig -all command.[172][173]"], "S0172": ["https://attack.mitre.org/software/S0172", "Reaver", "Reaver collects the victim's IP address.[174]"], "S0153": ["https://attack.mitre.org/software/S0153", "RedLeaves", "RedLeaves can obtain information about network parameters.[126]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec can obtain information about network configuration, including the routing table, ARP cache, and DNS cache.[175]"], "S0379": ["https://attack.mitre.org/software/S0379", "Revenge RAT", "Revenge RAT collects the IP address and MAC address from the system.[176]"], "S0433": ["https://attack.mitre.org/software/S0433", "Rifdoor", "Rifdoor has the ability to identify the IP address of the compromised host.[177]"], "S0448": ["https://attack.mitre.org/software/S0448", "Rising Sun", "Rising Sun can detect network adapter and IP address information.[178]"], "S0270": ["https://attack.mitre.org/software/S0270", "RogueRobin", "RogueRobin gathers the IP address and domain from the victim’s machine.[179]"], "S0103": ["https://attack.mitre.org/software/S0103", "route", "route can be used to discover routing configuration information."], "S0446": ["https://attack.mitre.org/software/S0446", "Ryuk", "Ryuk has called GetIpNetTable in attempt to identify all mounted drives and hosts that have Address Resolution Protocol (ARP) entries.[180][181]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team checks for connectivity to other resources in the network.[182]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has the ability to determine the domain name and whether a proxy is configured on a compromised host.[183]"], "S0596": ["https://attack.mitre.org/software/S0596", "ShadowPad", "ShadowPad has collected the domain name of the victim system.[184]"], "S0140": ["https://attack.mitre.org/software/S0140", "Shamoon", "Shamoon obtains the target's IP address and local network segment.[185][186]"], "S0450": ["https://attack.mitre.org/software/S0450", "SHARPSTATS", "SHARPSTATS has the ability to identify the domain of the compromised host.[161]"], "S0445": ["https://attack.mitre.org/software/S0445", "ShimRatReporter", "ShimRatReporter gathered the local proxy, domain, IP, routing tables, mac address, gateway, DNS servers, and DHCP status information from an infected host.[187]"], "S0589": ["https://attack.mitre.org/software/S0589", "Sibot", "Sibot checked if the compromised system is configured to use proxies.[85]"], "S0610": ["https://attack.mitre.org/software/S0610", "SideTwist", "SideTwist has the ability to collect the domain name on a compromised host.[188]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has used malware to collect information on network interfaces, including the MAC address.[189]"], "S0633": ["https://attack.mitre.org/software/S0633", "Sliver", "Sliver has the ability to gather network configuration information.[190]"], "S0516": ["https://attack.mitre.org/software/S0516", "SoreFang", "SoreFang can collect the TCP/IP, DNS, DHCP, and network adapter configuration on a compromised host via ipconfig.exe /all.[191]"], "S0374": ["https://attack.mitre.org/software/S0374", "SpeakUp", "SpeakUp uses the ifconfig -a command. [192]"], "S0646": ["https://attack.mitre.org/software/S0646", "SpicyOmelette", "SpicyOmelette can identify the IP of a compromised system.[193]"], "G0038": ["https://attack.mitre.org/groups/G0038", "Stealth Falcon", "Stealth Falcon malware gathers the Address Resolution Protocol (ARP) table from the victim.[194]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity can identify the IP address of a compromised host.[195]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet collects the IP address of a compromised system.[196]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST collected all network interface MAC addresses that are up and not loopback devices, as well as IP address, DHCP configuration, and domain information.[197]"], "S0018": ["https://attack.mitre.org/software/S0018", "Sykipot", "Sykipot may use ipconfig /all to gather system network configuration details.[198]"], "S0060": ["https://attack.mitre.org/software/S0060", "Sys10", "Sys10 collects the local IP address of the victim and sends it to the C2.[134]"], "S0098": ["https://attack.mitre.org/software/S0098", "T9000", "T9000 gathers and beacons the MAC and IP addresses during installation.[199]"], "S0011": ["https://attack.mitre.org/software/S0011", "Taidoor", "Taidoor has collected the MAC address of a compromised host; it can also use GetAdaptersInfo to identify network adapters.[200][201]"], "S0467": ["https://attack.mitre.org/software/S0467", "TajMahal", "TajMahal has the ability to identify the MAC address on an infected host.[202]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT looks for the host machine’s IP address.[203]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 actors use NBTscan to discover vulnerable systems.[204]"], "S0678": ["https://attack.mitre.org/software/S0678", "Torisma", "Torisma can collect the local MAC address using GetAdaptersInfo as well as the system's IP address.[205]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot obtains the IP address, location, and other relevant network information from the victim’s machine.[206][207][52]"], "S0094": ["https://attack.mitre.org/software/S0094", "Trojan.Karagany", "Trojan.Karagany can gather information on the network configuration of a compromised host.[208]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper has used scripts to collect the host's network topology.[209]"], "S0436": ["https://attack.mitre.org/software/S0436", "TSCookie", "TSCookie has the ability to identify the IP of the infected host.[210]"], "S0647": ["https://attack.mitre.org/software/S0647", "Turian", "Turian can retrieve the internal IP address of a compromised host.[211]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla surveys a system upon check-in to discover network configuration details using the arp -a, nbtstat -n, net config, ipconfig /all, and route commands, as well as NBTscan.[75][212][213] Turla RPC backdoors have also retrieved registered RPC interface information from process memory.[214]"], "S0130": ["https://attack.mitre.org/software/S0130", "Unknown Logger", "Unknown Logger can obtain information about the victim's IP address.[215]"], "S0275": ["https://attack.mitre.org/software/S0275", "UPPERCUT", "UPPERCUT has the capability to gather the victim's proxy information.[216]"], "S0452": ["https://attack.mitre.org/software/S0452", "USBferry", "USBferry can detect the infected machine's network topology using ipconfig and arp.[209]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak has the ability to identify the domain and the MAC and IP addresses of an infected machine.[217]"], "S0257": ["https://attack.mitre.org/software/S0257", "VERMIN", "VERMIN gathers the local IP address.[218]"], "S0180": ["https://attack.mitre.org/software/S0180", "Volgmer", "Volgmer can gather the IP address from the victim's machine.[219]"], "S0366": ["https://attack.mitre.org/software/S0366", "WannaCry", "WannaCry will attempt to determine the local network segment it is a part of.[220]"], "S0515": ["https://attack.mitre.org/software/S0515", "WellMail", "WellMail can identify the IP address of the victim system.[221]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess can identify the IP address and user domain on the target machine.[222][223]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used \"ipconfig\" to identify the network configuration of a victim machine.[224]"], "S0341": ["https://attack.mitre.org/software/S0341", "Xbash", "Xbash can collect IP addresses and local intranet information from a victim’s machine.[225]"], "S0653": ["https://attack.mitre.org/software/S0653", "xCaon", "xCaon has used the GetAdaptersInfo() API call to get the victim's MAC address.[40]"], "S0248": ["https://attack.mitre.org/software/S0248", "yty", "yty runs ipconfig /all and collects the domain name.[226]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy runs the ipconfig /all command.[227]"], "S0230": ["https://attack.mitre.org/software/S0230", "ZeroT", "ZeroT gathers the victim's IP address and domain information, and then sends it to its C2 server.[228]"], "G0128": ["https://attack.mitre.org/groups/G0128", "ZIRCONIUM", "ZIRCONIUM has used a tool to enumerate proxy settings in the target environment.[229]"], "S0350": ["https://attack.mitre.org/software/S0350", "zwShell", "zwShell can obtain the victim IP address.[230]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "OS API Execution": ["Monitor for API calls (such as GetAdaptersInfo() and GetIpNetTable()) that may gather details about the network configuration and settings, such as IP and/or MAC addresses.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for executed processes (such as ipconfig/ifconfig and arp) with arguments that may look for details about the network configuration and settings, such as IP and/or MAC addresses.", "", "", ""], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
