{"TTP_id": "enterprise-TA0008-T1080", "TTP_name": "Taint Shared Content", "Description": "Adversaries may deliver payloads to remote systems by adding content to shared storage locations, such as network drives or internal code repositories. Content stored on network drives or in other shared locations may be tainted by adding malicious programs, scripts, or exploit code to otherwise valid files. Once a user opens the shared tainted content, the malicious portion can be executed to run the adversary's code on a remote system. Adversaries may use tainted shared content to move laterally.A directory share pivot is a variation on this technique that uses several other techniques to propagate malware when users access a shared network directory. It uses Shortcut Modification of directory .LNK files that use Masquerading to look like the real directories, which are hidden through Hidden Files and Directories. The malicious .LNK-based directories have an embedded command that executes the hidden malware file in the directory and then opens the real intended directory so that the user's expected action still occurs. When used with frequently used network directories, the technique may result in frequent reinfections and broad access to systems and potentially to new and higher privileged accounts. [1]Adversaries may also compromise shared network directories through binary infections by appending or prepending its code to the healthy binary on the shared network directory. The malware may modify the original entry point (OEP) of the healthy binary to ensure that it is executed before the legitimate code. The infection could continue to spread via the newly infected file when it is executed by a remote system. These infections may target both binary and non-binary formats that end with extensions including, but not limited to, .EXE, .DLL, .SCR, .BAT, and/or .VBS.", "Property": {"ID": "T1080", "Sub-techniques": "No sub-techniques", "Tactic": "Lateral Movement", "Platforms": "Linux, Office 365, SaaS, Windows, macOS", "System Requirements": "Access to shared folders and content with write permissions", "Permissions Required": "User", "CAPEC ID": "CAPEC-562", "Contributors": "David Routin; Michal Dida, ESET", "Version": "1.3", "Created": "31 May 2017", "Last Modified": "17 October 2021"}, "Examples": {"G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has placed malware on file shares and given it the same name as legitimate documents on the share.[2]"], "S0575": ["https://attack.mitre.org/software/S0575", "Conti", "Conti can spread itself by infecting other remote machines via network shared drives.[3][4]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel used a virus that propagates by infecting executables stored on shared drives.[5]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has injected malicious macros into all Word and Excel documents on mapped network drives.[6]"], "S0132": ["https://attack.mitre.org/software/S0132", "H1N1", "H1N1 has functionality to copy itself to network shares.[7]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can replace legitimate software or documents in the compromised network with their trojanized versions, in an attempt to propagate itself within the network.[8]"], "S0133": ["https://attack.mitre.org/software/S0133", "Miner-C", "Miner-C copies itself into the public folder of Network Attached Storage (NAS) devices and infects new victims who open the file.[9]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can spread itself by infecting other portable executable files on networks shared drives.[10]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet infects remote servers via network shares and by infecting WinCC database views with malicious code.[11]"], "S0386": ["https://attack.mitre.org/software/S0386", "Ursnif", "Ursnif has copied itself to and infected files in network drives for propagation.[12][13]"]}, "Mitigation": {"M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Identify potentially malicious software that may be used to taint content or may result from it and audit and/or block the unknown programs by using application control [14] tools, like AppLocker, [15] [16] or Software Restriction Policies [17] where appropriate. [18]"], "M1050": ["https://attack.mitre.org/mitigations/M1050", "Exploit Protection", "Use utilities that detect or mitigate common features used in exploitation, such as the Microsoft Enhanced Mitigation Experience Toolkit (EMET)."], "M1022": ["https://attack.mitre.org/mitigations/M1022", "Restrict File and Directory Permissions", "Protect shared folders by minimizing users who have write access."]}, "Detection": {"File Creation": ["Monitor for newly constructed files from files that write or overwrite many files to a network shared directory may be suspicious.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Modification": ["Monitor for files that write or overwrite many files to a network shared directory may be suspicious.", "", "", ""], "Network Share Access": ["Monitor for unexpected and abnormal accesses to network shares, especially those also associated with file activity.", "DS0033", "https://attack.mitre.org/datasources/DS0033", "Network Share"], "Process Creation": ["Monitor processes that are executed from removable media for malicious or abnormal activity such as network connections due to Command and Control and possible network Discovery techniques.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
