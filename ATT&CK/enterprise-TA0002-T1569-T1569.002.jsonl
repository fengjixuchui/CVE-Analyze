{"TTP_id": "enterprise-TA0002-T1569-T1569.002", "TTP_name": "Service Execution", "Description": "Adversaries may abuse the Windows service control manager to execute malicious commands or payloads. The Windows service control manager (services.exe) is an interface to manage and manipulate services.[1] The service control manager is accessible to users via GUI components as well as system utilities such as sc.exe and Net.PsExec can also be used to execute commands or payloads via a temporary Windows service created through the service control manager API.[2] Tools such as PsExec and sc.exe can accept remote servers as arguments and may be used to conduct remote execution.Adversaries may leverage these mechanisms to execute malicious content. This can be done by either executing a new or modified service. This technique is the execution used in conjunction with Windows Service during service persistence or privilege escalation.", "Property": {"ID": "T1569.002", "Sub-technique of": "T1569", "Tactic": "Execution", "Platforms": "Windows", "Permissions Required": "Administrator, SYSTEM", "Supports Remote": "Yes", "Version": "1.1", "Created": "10 March 2020", "Last Modified": "30 August 2021"}, "Examples": {"S0504": ["https://attack.mitre.org/software/S0504", "Anchor", "Anchor can create and execute services to load its payload.[3][4]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32's backdoor has used Windows services as a way to execute its malicious payload. [5]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has created new services or modified existing ones to run executables, commands, or scripts.[6]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used post-exploitation tools including RemCom and the Non-sucking Service Manager (NSSM) to execute processes.[7][8]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used svchost.exe and Net to execute a system service installed to launch a Cobalt Strike BEACON loader.[9][10]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor's dispatcher can be executed as a service.[11]"], "S0606": ["https://attack.mitre.org/software/S0606", "Bad Rabbit", "Bad Rabbit drops a file named infpub.datinto the Windows directory and is executed through SCManager and rundll.exe."], "S0127": ["https://attack.mitre.org/software/S0127", "BBSRAT", "BBSRAT can start, stop, or delete services.[12]"], "G0108": ["https://attack.mitre.org/groups/G0108", "Blue Mockingbird", "Blue Mockingbird has executed custom-compiled XMRIG miner DLLs by configuring them to execute via the \"wercplsupport\" service.[13]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used PsExec to deploy beacons on compromised systems.[14]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling can create and start services on a compromised host.[15]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can use PsExec to execute a payload on a remote host. It can also use Service Control Manager to start new services.[16][17][18]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can use PsExec to execute a payload on a remote host.[19]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has created Windows services to execute encoded PowerShell commands.[20]"], "S0032": ["https://attack.mitre.org/software/S0032", "gh0st RAT", "gh0st RAT can execute its service if the Service key exists. If the key does not exist, gh0st RAT will create and run the service.[21]"], "S0697": ["https://attack.mitre.org/software/S0697", "HermeticWiper", "HermeticWiper can create system services to aid in executing the payload.[22][23][24]"], "S0698": ["https://attack.mitre.org/software/S0698", "HermeticWizard", "HermeticWizard can use OpenRemoteServiceManager to create a service.[25]"], "G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Honeybee launches a DLL file that gets executed as a service using svchost.exe[26]"], "S0376": ["https://attack.mitre.org/software/S0376", "HOPLIGHT", "HOPLIGHT has used svchost.exe to execute a malicious DLL .[27]"], "S0203": ["https://attack.mitre.org/software/S0203", "Hydraq", "Hydraq uses svchost.exe to execute a malicious DLL included in a new service group.[28]"], "S0398": ["https://attack.mitre.org/software/S0398", "HyperBro", "HyperBro has the ability to start and stop a specified service.[29]"], "S0357": ["https://attack.mitre.org/software/S0357", "Impacket", "Impacket contains various modules emulating other service execution tools such as PsExec.[30]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole has used Windows services as a way to execute its malicious payload.[31]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has used a tool known as RemoteExec (similar to PsExec) to remotely execute batch scripts and binaries.[32]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can run a command on another machine using PsExec.[33]"], "S0451": ["https://attack.mitre.org/software/S0451", "LoudMiner", "LoudMiner started the cryptomining virtual machine as a service on the infected machine.[34]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "The net start and net stop commands can be used in Net to execute or stop Windows services.[35]"], "S0056": ["https://attack.mitre.org/software/S0056", "Net Crawler", "Net Crawler uses PsExec to perform remote service manipulation to execute a copy of itself as part of lateral movement.[36]"], "S0457": ["https://attack.mitre.org/software/S0457", "Netwalker", "Operators deploying Netwalker have used psexec and certutil to retrieve the Netwalker payload.[37]"], "S0368": ["https://attack.mitre.org/software/S0368", "NotPetya", "NotPetya can use PsExec to help propagate itself across a network.[38][39]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum's loader can create a new service named NtmsSvc to execute the payload.[40]"], "S0365": ["https://attack.mitre.org/software/S0365", "Olympic Destroyer", "Olympic Destroyer utilizes PsExec to help propagate itself across a network.[41]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has created services on remote systems for execution purposes.[42]"], "S0664": ["https://attack.mitre.org/software/S0664", "Pandora", "Pandora has the ability to install itself as a Windows service.[43]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 contains an implementation of PsExec for remote execution.[44]"], "S0238": ["https://attack.mitre.org/software/S0238", "Proxysvc", "Proxysvc registers itself as a service on the victimâ€™s machine to run as a standalone process.[45]"], "S0029": ["https://attack.mitre.org/software/S0029", "PsExec", "Microsoft Sysinternals PsExec is a popular administration tool that can be used to execute binaries on remote systems using a temporary Windows service.[2]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy uses PsExec to execute a payload or commands on a remote host.[46]"], "S0583": ["https://attack.mitre.org/software/S0583", "Pysa", "Pysa has used PsExec to copy and execute the ransomware.[47]"], "S0481": ["https://attack.mitre.org/software/S0481", "Ragnar Locker", "Ragnar Locker has used sc.exe to execute a service that it creates.[48]"], "S0166": ["https://attack.mitre.org/software/S0166", "RemoteCMD", "RemoteCMD can execute commands remotely by creating a new service on the remote system.[49]"], "S0140": ["https://attack.mitre.org/software/S0140", "Shamoon", "Shamoon creates a new service named \"ntssrv\" to execute the payload. Shamoon can also spread via PsExec.[50][51]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used Winexe to install a service on the remote system.[52][53]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA has the capability to start services.[54]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity can install a service to execute itself as a service.[55][56]"], "S0663": ["https://attack.mitre.org/software/S0663", "SysUpdate", "SysUpdate can manage services and processes.[43]"], "S0668": ["https://attack.mitre.org/software/S0668", "TinyTurla", "TinyTurla can install itself as a service on compromised machines.[57]"], "S0612": ["https://attack.mitre.org/software/S0612", "WastedLocker", "WastedLocker can execute itself as a service.[58]"], "S0191": ["https://attack.mitre.org/software/S0191", "Winexe", "Winexe installs a service on the remote system, executes the command, then uninstalls the service.[59]"], "S0176": ["https://attack.mitre.org/software/S0176", "Wingbird", "Wingbird uses services.exe to register a new autostart service named \"Audit Service\" using a copy of the local lsass.exe file.[60][61]"], "S0141": ["https://attack.mitre.org/software/S0141", "Winnti for Windows", "Winnti for Windows can run as a service using svchost.exe.[62]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used services.exe to execute scripts and executables during lateral movement within a victim network.[63][64]"], "S0123": ["https://attack.mitre.org/software/S0123", "xCmd", "xCmd can be used to execute binaries on remote systems by creating and starting a service.[65]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell can create a new service for execution.[66]"]}, "Mitigation": {"M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by PsExec from running. [67]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Ensure that permissions disallow services that run at a higher permissions level from being created or interacted with by a user with a lower permission level."], "M1022": ["https://attack.mitre.org/mitigations/M1022", "Restrict File and Directory Permissions", "Ensure that high permission level service binaries cannot be replaced or modified by users with a lower permission level."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may abuse the Windows service control manager to execute malicious commands or payloads.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor for newly executed processes that may abuse the Windows service control manager to execute malicious commands or payloads.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Service Creation": ["Monitor newly constructed services that abuse control manager to execute malicious commands or payloads.", "DS0019", "https://attack.mitre.org/datasources/DS0019", "Service"], "Windows Registry Key Modification": ["Monitor for changes made to windows registry keys and/or values that may abuse the Windows service control manager to execute malicious commands or payloads.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
