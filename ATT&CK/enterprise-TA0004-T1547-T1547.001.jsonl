{"TTP_id": "enterprise-TA0004-T1547-T1547.001", "TTP_name": "Registry Run Keys / Startup Folder", "Description": "Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in.[1] These programs will be executed under the context of the user and will have the account's associated permissions level.Placing a program within a startup folder will also cause that program to execute when a user logs in. There is a startup folder location for individual user accounts as well as a system-wide startup folder that will be checked regardless of which user account logs in. The startup folder path for the current user is C:\\Users\\[Username]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup. The startup folder path for all users is C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\StartUp.The following run keys are created by default on Windows systems:Run keys may exist under multiple hives.[2][3] The HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx is also available but is not created by default on Windows Vista and newer. Registry run key entries can reference programs directly or list them as a dependency.[1] For example, it is possible to load a DLL at logon using a \"Depend\" key with RunOnceEx: reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx\\0001\\Depend /v 1 /d \"C:\\temp\\evil[.]dll\" [4]The following Registry keys can be used to set startup folder items for persistence:The following Registry keys can control automatic startup of services during boot:Using policy settings to specify startup programs creates corresponding values in either of two Registry keys:The Winlogon key controls actions that occur when a user logs on to a computer running Windows 7. Most of these actions are under the control of the operating system, but you can also add custom actions here. The HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit and HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell subkeys can automatically launch programs.Programs listed in the load value of the registry key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows run when any user logs on.By default, the multistring BootExecute value of the registry key HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager is set to autocheck autochk *. This value causes Windows, at startup, to check the file-system integrity of the hard disks if the system has been shut down abnormally. Adversaries can add other programs or processes to this registry value which will automatically launch at boot.Adversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use Masquerading to make the Registry entries look as if they are associated with legitimate programs.", "Property": {"ID": "T1547.001", "Sub-technique of": "T1547", "Tactics": "Persistence, Privilege Escalation", "Platforms": "Windows", "Permissions Required": "Administrator, User", "CAPEC ID": "CAPEC-270", "Contributors": "Oddvar Moe, @oddvarmoe", "Version": "1.1", "Created": "23 January 2020", "Last Modified": "12 May 2022"}, "Examples": {"S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "ADVSTORESHELL achieves persistence by adding itself to the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.[5][6][7]"], "S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla can add itself to the Registry as a startup program to establish persistence.[8][9]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed has the ability to create the Registry key name EstsoftAutoUpdate at HKLU\\Software\\Microsoft/Windows\\CurrentVersion\\RunOnce to establish persistence.[10]"], "G0026": ["https://attack.mitre.org/groups/G0026", "APT18", "APT18 establishes persistence via the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key.[11][12]"], "G0073": ["https://attack.mitre.org/groups/G0073", "APT19", "An APT19 HTTP malware variant establishes persistence by setting the Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows Debug Tools-%LOCALAPPDATA%\\.[13]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has deployed malware that has copied itself to the startup directory for persistence.[14]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 added Registry Run keys to establish persistence.[15]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 places scripts in the startup folder for persistence.[16]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 established persistence using Registry Run keys, both to execute PowerShell and VBS scripts as well as to execute their backdoor directly.[17][18][19]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has deployed a tool known as DarkComet to the Startup folder of a victim, and used Registry run keys to gain persistence.[20][21]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37's has added persistence via the Registry key HKCU\\Software\\Microsoft\\CurrentVersion\\Run\\.[22][23]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has maintained persistence using the startup folder.[24]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 created and modified startup files for persistence.[25][26] APT41 added a registry key in HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost to establish persistence for Cobalt Strike.[27]"], "S0456": ["https://attack.mitre.org/software/S0456", "Aria-body", "Aria-body has established persistence via the Startup folder or Run Registry key.[28]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth creates a startup item for persistence. [29]"], "S0640": ["https://attack.mitre.org/software/S0640", "Avaddon", "Avaddon uses registry run keys for persistence.[30]"], "S0414": ["https://attack.mitre.org/software/S0414", "BabyShark", "BabyShark has added a Registry key to ensure all future macros are enabled for Microsoft Word and Excel as well as for additional persistence.[31][32]"], "S0093": ["https://attack.mitre.org/software/S0093", "Backdoor.Oldrea", "Backdoor.Oldrea adds Registry Run keys to achieve persistence.[33][34]"], "S0031": ["https://attack.mitre.org/software/S0031", "BACKSPACE", "BACKSPACE achieves persistence by creating a shortcut to itself in the CSIDL_STARTUP directory.[35]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "BADNEWS installs a registry Run key to establish persistence.[36]"], "S0337": ["https://attack.mitre.org/software/S0337", "BadPatch", "BadPatch establishes a foothold by adding a link to the malware executable in the startup folder.[37]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can create or add files to Registry Run Keys to establish persistence.[38][39]"], "S0127": ["https://attack.mitre.org/software/S0127", "BBSRAT", "BBSRAT has been loaded through DLL side-loading of a legitimate Citrix executable that is set to persist through the Registry Run key location HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ssonsvr.exe."], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has added itself to the Registry key HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentVersion\\Run\\ for persistence.[40][41]"], "S0570": ["https://attack.mitre.org/software/S0570", "BitPaymer", "BitPaymer has set the run key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.[42]"], "S0089": ["https://attack.mitre.org/software/S0089", "BlackEnergy", "The BlackEnergy 3 variant drops its main DLL component and then creates a .lnk shortcut to that file in the startup folder.[43]"], "S0635": ["https://attack.mitre.org/software/S0635", "BoomBox", "BoomBox can establish persistence by writing the Registry value MicroNativeCacheSvc to HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.[44]"], "S0204": ["https://attack.mitre.org/software/S0204", "Briba", "Briba creates run key Registry entries pointing to malicious DLLs dropped to disk.[45]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has used a batch script that adds a Registry Run key to establish malware persistence.[46]"], "S0471": ["https://attack.mitre.org/software/S0471", "build_downer", "build_downer has the ability to add itself to the Registry Run key for persistence.[47]"], "S0030": ["https://attack.mitre.org/software/S0030", "Carbanak", "Carbanak stores a configuration files in the startup directory to automatically execute commands in order to persist across reboots.[48]"], "S0484": ["https://attack.mitre.org/software/S0484", "Carberp", "Carberp has maintained persistence by placing itself inside the current user's startup folder.[49]"], "S0348": ["https://attack.mitre.org/software/S0348", "Cardinal RAT", "Cardinal RAT establishes Persistence by setting the HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\Load Registry key to point to its executable.[50]"], "S0631": ["https://attack.mitre.org/software/S0631", "Chaes", "Chaes has added persistence via the Registry key software\\microsoft\\windows\\currentversion\\run\\microsoft windows html help.[51]"], "S0144": ["https://attack.mitre.org/software/S0144", "ChChes", "ChChes establishes persistence by adding a Registry Run key.[52]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling can establish persistence by adding a Registry run key.[53][54]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has used Registry Run keys for persistence. The group has also set a Startup path to launch the PowerShell shell command and download Cobalt Strike.[55]"], "S0338": ["https://attack.mitre.org/software/S0338", "Cobian RAT", "Cobian RAT creates an autostart Registry key to ensure persistence.[56]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie achieves persistence by adding a shortcut of itself to the startup path in the Registry.[57]"], "S0608": ["https://attack.mitre.org/software/S0608", "Conficker", "Conficker adds Registry Run keys to establish persistence.[58]"], "G0142": ["https://attack.mitre.org/groups/G0142", "Confucius", "Confucius has dropped malicious files into the startup folder %AppData%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup on a compromised host in order to maintain persistence.[59]"], "S0137": ["https://attack.mitre.org/software/S0137", "CORESHELL", "CORESHELL has established persistence by creating autostart extensibility point (ASEP) Registry entries in the Run key and other Registry keys, as well as by creating shortcuts in the Internet Explorer Quick Start folder.[60]"], "S0046": ["https://attack.mitre.org/software/S0046", "CozyCar", "One persistence mechanism used by CozyCar is to set itself to be executed at system startup by adding a Registry value under one of the following Registry keys:\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run[61]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson can add Registry run keys for persistence.[62][63]"], "S0235": ["https://attack.mitre.org/software/S0235", "CrossRAT", "CrossRAT uses run keys for persistence on Windows"], "G0070": ["https://attack.mitre.org/groups/G0070", "Dark Caracal", "Dark Caracal's version of Bandook adds a registry key to HKEY_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.[64]"], "S0334": ["https://attack.mitre.org/software/S0334", "DarkComet", "DarkComet adds several Registry entries to enable automatic execution at every system startup.[65][66]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel has been known to establish persistence by adding programs to the Run Registry key.[67]"], "S0186": ["https://attack.mitre.org/software/S0186", "DownPaper", "DownPaper uses PowerShell to add a Registry Run key in order to establish persistence.[68]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has added the registry value ntdll to the Registry Run key to establish persistence.[69]"], "S0062": ["https://attack.mitre.org/software/S0062", "DustySky", "DustySky achieves persistence by creating a Registry entry in HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run.[70]"], "S0081": ["https://attack.mitre.org/software/S0081", "Elise", "If establishing persistence by installation as a new service fails, one variant of Elise establishes persistence for the created .exe file by setting the following Registry key: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\svchost : %APPDATA%\\Microsoft\\Network\\svchost.exe. Other variants have set the following Registry keys for persistence: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\imejp : [self] and HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\IAStorD.[71][72]"], "S0082": ["https://attack.mitre.org/software/S0082", "Emissary", "Variants of Emissary have added Run Registry keys to establish persistence.[73]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet has been observed adding the downloaded payload to the HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key to maintain persistence.[74][75][76]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can modify the registry run keys HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run and HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.[77]"], "S0396": ["https://attack.mitre.org/software/S0396", "EvilBunny", "EvilBunny has created Registry keys for persistence in [HKLM|HKCU]\\…\\CurrentVersion\\Run.[78]"], "S0152": ["https://attack.mitre.org/software/S0152", "EvilGrab", "EvilGrab adds a Registry Run key for ctfmon.exe to establish persistence.[52]"], "S0568": ["https://attack.mitre.org/software/S0568", "EVILNUM", "EVILNUM can achieve persistence through the Registry Run key.[79][80]"], "S0512": ["https://attack.mitre.org/software/S0512", "FatDuke", "FatDuke has used HKLM\\SOFTWARE\\Microsoft\\CurrentVersion\\Run to establish persistence.[81]"], "S0267": ["https://attack.mitre.org/software/S0267", "FELIXROOT", "FELIXROOT adds a shortcut file to the startup folder for persistence.[82]"], "G0051": ["https://attack.mitre.org/groups/G0051", "FIN10", "FIN10 has established persistence by using the Registry option in PowerShell Empire to add a Run key.[83][77]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has used Registry Run keys to establish persistence for its downloader tools known as HARDTACK and SHIPBREAD.[84]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 malware has created Registry Run and RunOnce keys to establish persistence, and has also added items to the Startup folder.[85][86]"], "S0355": ["https://attack.mitre.org/software/S0355", "Final1stspy", "Final1stspy creates a Registry Run key to establish persistence.[87]"], "S0182": ["https://attack.mitre.org/software/S0182", "FinFisher", "FinFisher establishes persistence by creating the Registry key HKCU\\Software\\Microsoft\\Windows\\Run.[88][89]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro has dropped an executable file to the startup directory.[90]"], "S0036": ["https://attack.mitre.org/software/S0036", "FLASHFLOOD", "FLASHFLOOD achieves persistence by making an entry in the Registry's Run key.[35]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group tools have registered Run keys in the registry to give malicious VBS files persistence.[91][92][93]"], "S0168": ["https://attack.mitre.org/software/S0168", "Gazer", "Gazer can establish persistence by creating a .lnk file in the Start menu.[94][95]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium can set persistence with a Registry run key.[96]"], "S0032": ["https://attack.mitre.org/software/S0032", "gh0st RAT", "gh0st RAT has added a Registry Run key to establish persistence.[97][98]"], "S0249": ["https://attack.mitre.org/software/S0249", "Gold Dragon", "Gold Dragon establishes persistence in the Startup folder.[99]"], "G0078": ["https://attack.mitre.org/groups/G0078", "Gorgon Group", "Gorgon Group malware can create a .lnk file and add a Registry Run key to establish persistence.[100]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can use run keys and create link files in the startup folder for persistence.[101][102]"], "S0417": ["https://attack.mitre.org/software/S0417", "GRIFFON", "GRIFFON has used a persistence module that stores the implant inside the Registry, which executes at logon.[103]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can set persistence with a Registry run key.[104]"], "S0561": ["https://attack.mitre.org/software/S0561", "GuLoader", "GuLoader can establish persistence via the Registry under HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce.[105]"], "S0499": ["https://attack.mitre.org/software/S0499", "Hancitor", "Hancitor has added Registry Run keys to establish persistence.[106]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "Helminth establishes persistence by creating a shortcut in the Start Menu folder.[107]"], "S0087": ["https://attack.mitre.org/software/S0087", "Hi-Zor", "Hi-Zor creates a Registry Run key to establish persistence.[108]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa added a spoofed binary to the start-up folder for persistence.[109][110]"], "G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Honeybee uses a batch file that configures the ComSysApp service to autostart in order to establish persistence.[111]"], "S0070": ["https://attack.mitre.org/software/S0070", "HTTPBrowser", "HTTPBrowser has established persistence by setting the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key value for wdm to the path of the executable. It has also used the Registry entry HKEY_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run vpdn \"%ALLUSERPROFILE%\\%APPDATA%\\vpdn\\VPDN_LU.exe\" to establish persistence.[112][113]"], "S0483": ["https://attack.mitre.org/software/S0483", "IcedID", "IcedID has established persistence by creating a Registry run key.[114]"], "G0100": ["https://attack.mitre.org/groups/G0100", "Inception", "Inception has maintained persistence by modifying Registry run key value HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\.[115]"], "S0259": ["https://attack.mitre.org/software/S0259", "InnaputRAT", "Some InnaputRAT variants establish persistence by modifying the Registry key HKU\\\\Software\\Microsoft\\Windows\\CurrentVersion\\Run:%appdata%\\NeutralApp\\NeutralApp.exe.[116]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can place a lnk file in the Startup Folder to achieve persistence.[117]"], "S0015": ["https://attack.mitre.org/software/S0015", "Ixeshe", "Ixeshe can achieve persistence by adding itself to the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.[118]"], "S0389": ["https://attack.mitre.org/software/S0389", "JCry", "JCry has created payloads in the Startup directory to maintain persistence. [119]"], "S0044": ["https://attack.mitre.org/software/S0044", "JHUHUGIT", "JHUHUGIT has used a Registry Run key to establish persistence by executing JavaScript code within the rundll32.exe process.[120]"], "S0088": ["https://attack.mitre.org/software/S0088", "Kasidet", "Kasidet creates a Registry Run key to establish persistence.[121][122]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar adds a sub-key under several Registry run keys.[123]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Several Ke3chang backdoors achieved persistence by adding a Run key.[124]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has placed scripts in the startup folder for persistence and modified the HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce Registry key.[125][32][126][127][128]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic has added persistence to the HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.[129]"], "S0669": ["https://attack.mitre.org/software/S0669", "KOCTOPUS", "KOCTOPUS can set the AutoRun Registry key with a PowerShell command.[129]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "A version of KONNI has dropped a Windows shortcut into the Startup folder to establish persistence.[130]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has maintained persistence by loading malicious code into a startup folder or by adding a Registry Run key.[131][132][133][134][135]"], "G0140": ["https://attack.mitre.org/groups/G0140", "LazyScripter", "LazyScripter has achieved persistence via writing a PowerShell script to the autorun registry key.[129]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has used JavaScript to create a shortcut file in the Startup folder that points to its main backdoor.[136][137]"], "S0513": ["https://attack.mitre.org/software/S0513", "LiteDuke", "LiteDuke can create persistence by adding a shortcut in the CurrentVersion\\Run Registry key.[81]"], "S0397": ["https://attack.mitre.org/software/S0397", "LoJax", "LoJax has modified the Registry key ‘HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\BootExecute’ from ‘autocheck autochk ’ to ‘autocheck autoche ’ in order to execute its payload during Windows startup.[138]"], "S0582": ["https://attack.mitre.org/software/S0582", "LookBack", "LookBack sets up a Registry Run key to establish a persistence mechanism.[139]"], "S0532": ["https://attack.mitre.org/software/S0532", "Lucifer", "Lucifer can persist by setting Registry key values HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic and HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\QQMusic.[140]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete used the startup folder for persistence.[141][142]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound malware has used Registry Run keys to establish persistence.[143]"], "S0652": ["https://attack.mitre.org/software/S0652", "MarkiRAT", "MarkiRAT can drop its payload into the Startup directory to ensure it automatically runs when the compromised system is started.[144]"], "S0167": ["https://attack.mitre.org/software/S0167", "Matryoshka", "Matryoshka can establish persistence by adding Registry Run keys.[145][146]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "Maze has created a file named \"startup_vrun.bat\" in the Startup folder of a virtual machine to establish persistence.[147]"], "S0500": ["https://attack.mitre.org/software/S0500", "MCMD", "MCMD can use Registry Run Keys for persistence.[148]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has configured persistence to the Registry ket HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, Spotify =% APPDATA%\\Spotify\\Spotify.exe and used .LNK files in the startup folder to achieve persistence.[149][150][151][152]"], "S0080": ["https://attack.mitre.org/software/S0080", "Mivast", "Mivast creates the following Registry entry: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Micromedia.[153]"], "S0553": ["https://attack.mitre.org/software/S0553", "MoleNet", "MoleNet can achieve persitence on the infected machine by setting the Registry run key.[154]"], "G0021": ["https://attack.mitre.org/groups/G0021", "Molerats", "Molerats saved malicious files within the AppData and Startup folders to maintain persistence.[155]"], "S0256": ["https://attack.mitre.org/software/S0256", "Mosquito", "Mosquito establishes persistence under the Registry key HKCU\\Software\\Run auto_update.[156]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has added Registry Run key KCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SystemTextEncoding to establish persistence.[157][158][159][160][161]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has created the registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run\\AdobelmdyU to maintain persistence.[162]"], "G0019": ["https://attack.mitre.org/groups/G0019", "Naikon", "Naikon has modified a victim's Windows Run registry to establish persistence.[163]"], "S0228": ["https://attack.mitre.org/software/S0228", "NanHaiShu", "NanHaiShu modifies the %regrun% Registry to point itself to an autostart mechanism.[164]"], "S0336": ["https://attack.mitre.org/software/S0336", "NanoCore", "NanoCore creates a RunOnce key in the Registry to execute its VBS scripts each time the user logs on to the machine.[165]"], "S0247": ["https://attack.mitre.org/software/S0247", "NavRAT", "NavRAT creates a Registry key to ensure a file gets executed upon reboot in order to establish persistence.[166]"], "S0630": ["https://attack.mitre.org/software/S0630", "Nebulae", "Nebulae can achieve persistence through a Registry Run key.[163]"], "S0034": ["https://attack.mitre.org/software/S0034", "NETEAGLE", "The \"SCOUT\" variant of NETEAGLE achieves persistence by adding itself to the HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.[35]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE creates a Registry start-up entry to establish persistence.[167][168][105][169]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT has added persistence via the Registry key HKCU\\Software\\Microsoft\\CurrentVersion\\Run\\ and dropped a shortcut in %STARTUP%.[170][171]"], "S0353": ["https://attack.mitre.org/software/S0353", "NOKKI", "NOKKI has established persistence by writing the payload to the Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.[172]"], "S0644": ["https://attack.mitre.org/software/S0644", "ObliqueRAT", "ObliqueRAT can gain persistence by a creating a shortcut in the infected user's Startup directory.[173]"], "S0340": ["https://attack.mitre.org/software/S0340", "Octopus", "Octopus achieved persistence by placing a malicious executable in the startup directory and has added the HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run key to the Registry.[174]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum establishes persistence by creating a .lnk shortcut to itself in the Startup folder.[175]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork has added the path of its second-stage malware to the startup folder to achieve persistence. One of its file stealers has also persisted by adding a Registry Run key.[176][177]"], "S0124": ["https://attack.mitre.org/software/S0124", "Pisloader", "Pisloader establishes persistence via a Registry Run key.[178]"], "S0254": ["https://attack.mitre.org/software/S0254", "PLAINTEE", "PLAINTEE gains persistence by adding the Registry key HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce.[179]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX adds Run key entries in the Registry to establish persistence.[180][52][181]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT has added a registry key in the hive for persistence.[182]"], "S0012": ["https://attack.mitre.org/software/S0012", "PoisonIvy", "PoisonIvy creates run key Registry entries pointing to a malicious executable dropped to disk.[183]"], "S0139": ["https://attack.mitre.org/software/S0139", "PowerDuke", "PowerDuke achieves persistence by using various Registry Run keys.[184]"], "S0441": ["https://attack.mitre.org/software/S0441", "PowerShower", "PowerShower sets up persistence with a Registry run key.[185]"], "S0145": ["https://attack.mitre.org/software/S0145", "POWERSOURCE", "POWERSOURCE achieves persistence by setting a Registry Run key, with the path depending on whether the victim account has user or administrator access.[186]"], "S0194": ["https://attack.mitre.org/software/S0194", "PowerSploit", "PowerSploit's New-UserPersistenceOption Persistence argument can be used to establish via the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run Registry key.[187][188]"], "S0371": ["https://attack.mitre.org/software/S0371", "POWERTON", "POWERTON can install a Registry Run key for persistence.[189]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "Prikormka adds itself to a Registry Run key with the name guidVGA or guidVSA.[190]"], "G0056": ["https://attack.mitre.org/groups/G0056", "PROMETHIUM", "PROMETHIUM has used Registry run keys to establish persistence.[191]"], "S0147": ["https://attack.mitre.org/software/S0147", "Pteranodon", "Pteranodon copies itself to the Startup folder to establish persistence.[192]"], "S0196": ["https://attack.mitre.org/software/S0196", "PUNCHBUGGY", "PUNCHBUGGY has been observed using a Registry Run key.[193][194]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy adds itself to the startup folder or adds itself to the Registry key SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.[195]"], "G0024": ["https://attack.mitre.org/groups/G0024", "Putter Panda", "A dropper used by Putter Panda installs itself into the ASEP Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run with a value named McUpdate.[196]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can maintain persistence by creating an auto-run Registry key.[197][198][199][200]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay has created Registry Run keys to establish persistence.[201]"], "S0662": ["https://attack.mitre.org/software/S0662", "RCSession", "RCSession has the ability to modify a Registry Run key to establish persistence.[53][202]"], "S0172": ["https://attack.mitre.org/software/S0172", "Reaver", "Reaver creates a shortcut file and saves it in a Startup folder to establish persistence.[203]"], "S0153": ["https://attack.mitre.org/software/S0153", "RedLeaves", "RedLeaves attempts to add a shortcut file in the Startup folder to achieve persistence. If this fails, it attempts to add Registry Run keys.[52][204]"], "S0332": ["https://attack.mitre.org/software/S0332", "Remcos", "Remcos can add itself to the Registry key HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run for persistence.[205]"], "S0375": ["https://attack.mitre.org/software/S0375", "Remexi", "Remexi utilizes Run Registry keys in the HKLM hive as a persistence mechanism.[206]"], "S0379": ["https://attack.mitre.org/software/S0379", "Revenge RAT", "Revenge RAT creates a Registry key at HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Shell to survive a system reboot.[207]"], "S0433": ["https://attack.mitre.org/software/S0433", "Rifdoor", "Rifdoor has created a new registry entry at HKEY_CURRENT_USERS\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Graphics with a value of C:\\ProgramData\\Initech\\Initech.exe /run.[208]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke's miner has created UPX-packed files in the Windows Start Menu Folder.[209]"], "S0270": ["https://attack.mitre.org/software/S0270", "RogueRobin", "RogueRobin created a shortcut in the Windows startup folder to launch a PowerShell script each time the user logs in to establish persistence.[210]"], "S0090": ["https://attack.mitre.org/software/S0090", "Rover", "Rover persists by creating a Registry entry in HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\.[211]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM tries to add a Registry Run key under the name \"Windows Update\" to establish persistence.[212]"], "G0048": ["https://attack.mitre.org/groups/G0048", "RTM", "RTM has used Registry run keys to establish persistence for the RTM Trojan and other tools, such as a modified version of TeamViewer remote desktop software.[212][213]"], "S0253": ["https://attack.mitre.org/software/S0253", "RunningRAT", "RunningRAT adds itself to the Registry key Software\\Microsoft\\Windows\\CurrentVersion\\Run to establish persistence upon reboot.[99]"], "S0446": ["https://attack.mitre.org/software/S0446", "Ryuk", "Ryuk has used the Windows command line to create a Registry entry under HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run to establish persistence.[214]"], "S0085": ["https://attack.mitre.org/software/S0085", "S-Type", "S-Type may create a .lnk file to itself that is saved in the Start menu folder. It may also create the Registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ IMJPMIJ8.1{3 characters of Unique Identifier}.[215]"], "S0074": ["https://attack.mitre.org/software/S0074", "Sakula", "Most Sakula samples maintain persistence by setting the Registry Run key SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ in the HKLM or HKCU hive, with the Registry value and file name varying by sample.[216]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has the ability to add a value to the Registry Run key to establish persistence if it detects it is running with regular user privilege. [217][218]"], "S0053": ["https://attack.mitre.org/software/S0053", "SeaDuke", "SeaDuke is capable of persisting via the Registry Run key or a .lnk file stored in the Startup directory.[219]"], "S0345": ["https://attack.mitre.org/software/S0345", "Seasalt", "Seasalt creates a Registry entry to ensure infection after reboot under HKLM\\Software\\Microsoft\\Windows\\currentVersion\\Run.[220]"], "S0382": ["https://attack.mitre.org/software/S0382", "ServHelper", "ServHelper may attempt to establish persistence via the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ run key.[221]"], "G0104": ["https://attack.mitre.org/groups/G0104", "Sharpshooter", "Sharpshooter's first-stage downloader installed Rising Sun to the startup folder %Startup%\\mssync.exe.[222]"], "S0546": ["https://attack.mitre.org/software/S0546", "SharpStage", "SharpStage has the ability to create persistence for the malware using the Registry autorun key and startup folder.[154]"], "S0444": ["https://attack.mitre.org/software/S0444", "ShimRat", "ShimRat has installed a registry based start-up key HKCU\\Software\\microsoft\\windows\\CurrentVersion\\Run to maintain persistence should other methods fail.[223]"], "S0028": ["https://attack.mitre.org/software/S0028", "SHIPSHAPE", "SHIPSHAPE achieves persistence by creating a shortcut in the Startup folder.[35]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has added paths to executables in the Registry to establish persistence.[224][225][226]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, and the Startup folder to establish persistence.[227]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can establish a LNK file in the startup folder for persistence.[228]"], "S0226": ["https://attack.mitre.org/software/S0226", "Smoke Loader", "Smoke Loader adds a Registry Run key for persistence and adds a script in the Startup folder to deploy the payload.[229]"], "S0649": ["https://attack.mitre.org/software/S0649", "SMOKEDHAM", "SMOKEDHAM has used reg.exe to create a Registry Run key.[230]"], "S0159": ["https://attack.mitre.org/software/S0159", "SNUGRIDE", "SNUGRIDE establishes persistence through a Registry Run key.[231]"], "S0035": ["https://attack.mitre.org/software/S0035", "SPACESHIP", "SPACESHIP achieves persistence by creating a shortcut in the current user's Startup folder.[35]"], "S0058": ["https://attack.mitre.org/software/S0058", "SslMM", "To establish persistence, SslMM identifies the Start Menu Startup directory and drops a link to its own executable disguised as an \"Office Start,\" \"Yahoo Talk,\" \"MSN Gaming Z0ne,\" or \"MSN Talk\" shortcut.[232]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity can use the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run Registry key for persistence.[191]"], "S0018": ["https://attack.mitre.org/software/S0018", "Sykipot", "Sykipot has been known to establish persistence by adding programs to the Run Registry key.[233]"], "S0663": ["https://attack.mitre.org/software/S0663", "SysUpdate", "SysUpdate can use a Registry Run key to establish persistence.[234]"], "S0011": ["https://attack.mitre.org/software/S0011", "Taidoor", "Taidoor has modified the HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run key for persistence.[235]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "TAINTEDSCRIBE can copy itself into the current user’s Startup folder as \"Narrator.exe\" for persistence.[236]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has added batch scripts to the startup folder.[237]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "A Threat Group-3390 tool can add the binary’s path to the Registry key Software\\Microsoft\\Windows\\CurrentVersion\\Run to add persistence.[238]"], "S0665": ["https://attack.mitre.org/software/S0665", "ThreatNeedle", "ThreatNeedle can be loaded into the Startup folder (%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\OneDrives.lnk) as a Shortcut file for persistence.[239]"], "S0131": ["https://attack.mitre.org/software/S0131", "TINYTYPHON", "TINYTYPHON installs itself under Registry Run key to establish persistence.[36]"], "S0004": ["https://attack.mitre.org/software/S0004", "TinyZBot", "TinyZBot can create a shortcut in the Windows startup folder for persistence.[240]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot establishes persistence in the Startup folder.[241]"], "S0094": ["https://attack.mitre.org/software/S0094", "Trojan.Karagany", "Trojan.Karagany can create a link to itself in the Startup folder to automatically start itself upon system restart.[33][242]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper has created shortcuts in the Startup folder to establish persistence.[243][244]"], "S0178": ["https://attack.mitre.org/software/S0178", "Truvasys", "Truvasys adds a Registry Run key to establish persistence.[245]"], "S0647": ["https://attack.mitre.org/software/S0647", "Turian", "Turian can establish persistence by adding Registry Run keys.[246]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "A Turla Javascript backdoor added a local_update_check value under the Registry key HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run to establish persistence. Additionally, a Turla custom executable containing Metasploit shellcode is saved to the Startup folder to gain persistence.[156][247]"], "S0199": ["https://attack.mitre.org/software/S0199", "TURNEDUP", "TURNEDUP is capable of writing to a Registry Run key to establish.[248]"], "S0386": ["https://attack.mitre.org/software/S0386", "Ursnif", "Ursnif has used Registry Run keys to establish automatic execution at system startup.[249][250]"], "S0136": ["https://attack.mitre.org/software/S0136", "USBStealer", "USBStealer registers itself under a Registry Run key with the name \"USB Disk Security.\"[251]"], "S0207": ["https://attack.mitre.org/software/S0207", "Vasport", "Vasport copies itself to disk and creates an associated run key Registry entry to establish.[252]"], "S0442": ["https://attack.mitre.org/software/S0442", "VBShower", "VBShower used HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\[a-f0-9A-F]{8} to maintain persistence.[253]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT can add itself to the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run and HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UIF2IS20VK Registry keys.[254]"], "G0112": ["https://attack.mitre.org/groups/G0112", "Windshift", "Windshift has created LNK files in the Startup folder to establish persistence.[255]"], "S0141": ["https://attack.mitre.org/software/S0141", "Winnti for Windows", "Winnti for Windows can add a service named wind0ws to the Registry to achieve persistence after reboot.[256]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has established persistence via the Registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run and a shortcut within the startup folder.[257][258]"], "S0341": ["https://attack.mitre.org/software/S0341", "Xbash", "Xbash can create a Startup item for persistence if it determines it is on a Windows system.[259]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy creates an entry in a Registry Run key for the malware to execute on startup.[260][261][262]"], "S0330": ["https://attack.mitre.org/software/S0330", "Zeus Panda", "Zeus Panda adds persistence by creating Registry Run keys.[263][264]"], "G0128": ["https://attack.mitre.org/groups/G0128", "ZIRCONIUM", "ZIRCONIUM has created a Registry Run key named Dropbox Update Setup to establish persistence for a malicious Python binary.[265]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Modification": ["Monitor the start folder for additions or changes. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including the startup folders. [266]", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Windows Registry Key Creation": ["Monitor for newly created windows registry keys that may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"], "Windows Registry Key Modification": ["Monitor Registry for changes to run keys that do not correlate with known software, patch cycles, etc. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the run keys' Registry locations. [266]", "", "", ""]}}
