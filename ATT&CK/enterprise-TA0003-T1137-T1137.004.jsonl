{"TTP_id": "enterprise-TA0003-T1137-T1137.004", "TTP_name": "Outlook Home Page", "Description": "Adversaries may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. Outlook Home Page is a legacy feature used to customize the presentation of Outlook folders. This feature allows for an internal or external URL to be loaded and presented whenever a folder is opened. A malicious HTML page can be crafted that will execute code when loaded by Outlook Home Page.[1]Once malicious home pages have been added to the userâ€™s mailbox, they will be loaded when Outlook is started. Malicious Home Pages will execute when the right Outlook folder is loaded/reloaded.[1]", "Property": {"ID": "T1137.004", "Sub-technique of": "T1137", "Tactic": "Persistence", "Platforms": "Office 365, Windows", "Permissions Required": "Administrator, User", "Version": "1.1", "Created": "07 November 2019", "Last Modified": "16 August 2021"}, "Examples": {"G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has abused the Outlook Home Page feature for persistence. OilRig has also used CVE-2017-11774 to roll back the initial patch designed to protect against Home Page abuse.[2]"], "S0358": ["https://attack.mitre.org/software/S0358", "Ruler", "Ruler can be used to automate the abuse of Outlook Home Pages to establish persistence.[3]"]}, "Mitigation": {"M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. [4]"], "M1051": ["https://attack.mitre.org/mitigations/M1051", "Update Software", "For the Outlook methods, blocking macros may be ineffective as the Visual Basic engine used for these features is separate from the macro scripting engine.[5] Microsoft has released patches to try to address each issue. Ensure KB3191938 which blocks Outlook Visual Basic and displays a malicious code warning, KB4011091 which disables custom forms by default, and KB4011162 which removes the legacy Home Page feature, are applied to systems.[1]"]}, "Detection": {"Application Log Content": ["Monitor for third-party application logging, messaging, and/or other artifacts that may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. SensePost, whose tool Ruler can be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage.[6]", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "Command Execution": ["Monitor executed commands and arguments that may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output.[7]", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes that may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
