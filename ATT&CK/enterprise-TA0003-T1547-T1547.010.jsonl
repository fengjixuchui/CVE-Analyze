{"TTP_id": "enterprise-TA0003-T1547-T1547.010", "TTP_name": "Port Monitors", "Description": "Adversaries may use port monitors to run an adversary supplied DLL during system boot for persistence or privilege escalation. A port monitor can be set through the AddMonitor API call to set a DLL to be loaded at startup.[1] This DLL can be located in C:\\Windows\\System32 and will be loaded by the print spooler service, spoolsv.exe, on boot. The spoolsv.exe process also runs under SYSTEM level permissions.[2] Alternatively, an arbitrary DLL can be loaded if permissions allow writing a fully-qualified pathname for that DLL to HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors.The Registry key contains entries for the following:Adversaries can use this technique to load malicious code at startup that will persist on system reboot and execute as SYSTEM.", "Property": {"ID": "T1547.010", "Sub-technique of": "T1547", "Tactics": "Persistence, Privilege Escalation", "Platforms": "Windows", "Permissions Required": "Administrator, SYSTEM", "Effective Permissions": "SYSTEM", "Contributors": "Stefan Kanthak; Travis Smith, Tripwire", "Version": "1.1", "Created": "24 January 2020", "Last Modified": "20 April 2022"}, "Examples": {}, "Mitigation": {}, "Detection": {"File Creation": ["Monitor newly constructed files that may use port monitors to run an attacker supplied DLL during system boot for persistence or privilege escalation.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Module Load": ["Monitor DLLs that are loaded by spoolsv.exe for DLLs that are abnormal. New DLLs written to the System32 directory that do not correlate with known good software or patching may be suspicious.", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "OS API Execution": ["Monitor process API calls to AddMonitor.[1]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Windows Registry Key Modification": ["Monitor Registry writes to HKLM\\SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors. Run the Autoruns utility, which checks for this Registry key as a persistence mechanism [3]", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
