{"TTP_id": "enterprise-TA0005-T1562", "TTP_name": "Impair Defenses", "Description": "Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators.Adversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components.", "Property": {"ID": "T1562", "Sub-techniques": "T1562.001, T1562.002, T1562.003, T1562.004, T1562.006, T1562.007, T1562.008, T1562.009, T1562.010", "Tactic": "Defense Evasion", "Platforms": "Containers, IaaS, Linux, Network, Office 365, Windows, macOS", "Permissions Required": "Administrator, User", "Defense Bypassed": "Anti-virus, Digital Certificate Validation, File monitoring, Firewall, Host forensic analysis, Host intrusion prevention systems, Log analysis, Signature-based detection", "Version": "1.2", "Created": "21 February 2020", "Last Modified": "08 March 2022"}, "Examples": {"S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet reduces the integrity level of objects to allow write actions.[1]"]}, "Mitigation": {"M1022": ["https://attack.mitre.org/mitigations/M1022", "Restrict File and Directory Permissions", "Ensure proper process and file permissions are in place to prevent adversaries from disabling or interfering with security/logging services."], "M1024": ["https://attack.mitre.org/mitigations/M1024", "Restrict Registry Permissions", "Ensure proper Registry permissions are in place to prevent adversaries from disabling or interfering with security/logging services."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Ensure proper user permissions are in place to prevent adversaries from disabling or interfering with security/logging services."]}, "Detection": {"Cloud Service Disable": ["Monitor logs for API calls to disable logging. In AWS, monitor for: StopLogging and DeleteTrail.[2] In GCP, monitor for: google.logging.v2.ConfigServiceV2.UpdateSink.[3] In Azure, monitor for az monitor diagnostic-settings delete.[4] Additionally, a sudden loss of a log source may indicate that it has been disabled.", "DS0025", "https://attack.mitre.org/datasources/DS0025", "Cloud Service"], "Cloud Service Modification": ["Monitor changes made to cloud services for unexpected modifications to settings and/or data.", "", "", ""], "Command Execution": ["Monitor executed commands and arguments that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Firewall Disable": ["Monitor for changes in the status of the system firewall such as Windows Security Auditing events 5025 (The Windows firewall service has been stopped) and 5034 (The Windows firewall driver was stopped).", "DS0018", "https://attack.mitre.org/datasources/DS0018", "Firewall"], "Firewall Rule Modification": ["Monitor for changes made to firewall rules for unexpected modifications to allow/block specific network traffic that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.", "", "", ""], "Process Creation": ["Monitor newly executed processes that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Termination": ["Monitor for unexpected deletions of a running process (ex: Sysmon EID 5 or Windows EID 4689) that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.", "", "", ""], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"], "Host Status": ["Monitor logging, messaging, and other artifacts highlighting the health of host sensors (ex: metrics, errors, and/or exceptions from logging applications) that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. Lack of log events may be suspicious.", "DS0013", "https://attack.mitre.org/datasources/DS0013", "Sensor Health"], "Service Metadata": ["Monitor contextual data about a service/daemon, which may include information such as name, service executable, start type that that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.", "DS0019", "https://attack.mitre.org/datasources/DS0019", "Service"], "Windows Registry Key Deletion": ["Monitor for unexpected deletion of windows registry keys that that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"], "Windows Registry Key Modification": ["Monitor Registry edits for modifications to services and startup programs that correspond to security tools.", "", "", ""]}}
