{"TTP_id": "enterprise-TA0009-T1530", "TTP_name": "Data from Cloud Storage Object", "Description": "Adversaries may access data objects from improperly secured cloud storage.Many cloud service providers offer solutions for online data storage such as Amazon S3, Azure Storage, and Google Cloud Storage. These solutions differ from other storage solutions (such as SQL or Elasticsearch) in that there is no overarching application. Data from these solutions can be retrieved directly using the cloud provider's APIs. Solution providers typically offer security guides to help end users configure systems.[1][2][3]Misconfiguration by end users is a common problem. There have been numerous incidents where cloud storage has been improperly secured (typically by unintentionally allowing public access by unauthenticated users or overly-broad access by all users), allowing open access to credit cards, personally identifiable information, medical records, and other sensitive information.[4][5][6] Adversaries may also obtain leaked credentials in source repositories, logs, or other means as a way to gain access to cloud storage objects that have access permission controls.", "Property": {"ID": "T1530", "Sub-techniques": "No sub-techniques", "Tactic": "Collection", "Platforms": "IaaS", "Permissions Required": "User", "Contributors": "Netskope; Praetorian", "Version": "1.1", "Created": "30 August 2019", "Last Modified": "08 March 2021"}, "Examples": {"G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has obtained files from the victim's cloud storage instances.[7]"], "S0683": ["https://attack.mitre.org/software/S0683", "Peirates", "Peirates can dump the contents of AWS S3 buckets. It can also retrieve service account tokens from kOps buckets in Google Cloud Storage or S3.[8]"]}, "Mitigation": {"M1047": ["https://attack.mitre.org/mitigations/M1047", "Audit", "Frequently check permissions on cloud storage to ensure proper permissions are set to deny open or unprivileged access to resources.[1]"], "M1041": ["https://attack.mitre.org/mitigations/M1041", "Encrypt Sensitive Information", "Encrypt data stored at rest in cloud storage.[1][2] Managed encryption keys can be rotated by most providers. At a minimum, ensure an incident response plan to storage breach includes rotating the keys and test for impact on client applications.[9]"], "M1037": ["https://attack.mitre.org/mitigations/M1037", "Filter Network Traffic", "Cloud service providers support IP-based restrictions when accessing cloud resources. Consider using IP allowlisting along with user account management to ensure that data access is restricted not only to valid users but only from expected IP ranges to mitigate the use of stolen credentials to access data."], "M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Consider using multi-factor authentication to restrict access to resources and cloud storage APIs.[1]"], "M1022": ["https://attack.mitre.org/mitigations/M1022", "Restrict File and Directory Permissions", "Use access control lists on storage systems and objects."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Configure user permissions groups and roles for access to cloud storage.[2] Implement strict Identity and Access Management (IAM) controls to prevent access to storage solutions except for the applications, users, and services that require access.[1] Ensure that temporary access tokens are issued rather than permanent credentials, especially when access is being granted to entities outside of the internal security boundary.[10]"]}, "Detection": {"Cloud Storage Access": ["Monitor for unusual queries to the cloud provider's storage service. Activity originating from unexpected sources may indicate improper permissions are set and are allowing access to data. Additionally, detecting failed attempts by a user for a certain object, followed by escalation of privileges by the same user, and access to the same object may be an indication of suspicious activity.", "DS0010", "https://attack.mitre.org/datasources/DS0010", "Cloud Storage"]}}
