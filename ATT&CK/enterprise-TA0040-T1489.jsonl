{"TTP_id": "enterprise-TA0040-T1489", "TTP_name": "Service Stop", "Description": "Adversaries may stop or disable services on a system to render those services unavailable to legitimate users. Stopping critical services or processes can inhibit or stop response to an incident or aid in the adversary's overall objectives to cause damage to the environment.[1][2]Adversaries may accomplish this by disabling individual services of high importance to an organization, such as MSExchangeIS, which will make Exchange content inaccessible [2]. In some cases, adversaries may stop or disable many or all services to render systems unusable.[1] Services or processes may not allow for modification of their data stores while running. Adversaries may stop services or processes in order to conduct Data Destruction or Data Encrypted for Impact on the data stores of services like Exchange and SQL Server.[3]", "Property": {"ID": "T1489", "Sub-techniques": "No sub-techniques", "Tactic": "Impact", "Platforms": "Linux, Windows, macOS", "Permissions Required": "Administrator, SYSTEM, User", "Impact Type": "Availability", "Version": "1.2", "Created": "29 March 2019", "Last Modified": "02 March 2021"}, "Examples": {"S0640": ["https://attack.mitre.org/software/S0640", "Avaddon", "Avaddon looks for and attempts to stop database processes.[4]"], "S0638": ["https://attack.mitre.org/software/S0638", "Babuk", "Babuk can stop specific services related to backups.[5][6][7]"], "S0611": ["https://attack.mitre.org/software/S0611", "Clop", "Clop can kill several processes and services related to backups and security solutions.[8][9]"], "S0575": ["https://attack.mitre.org/software/S0575", "Conti", "Conti can stop up to 146 Windows services related to security, backup, database, and email solutions through the use of net stop.[10]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba has a hardcoded list of services and processes to terminate.[11]"], "S0659": ["https://attack.mitre.org/software/S0659", "Diavol", "Diavol will terminate services using the Service Control Manager (SCM) API.[12]"], "S0605": ["https://attack.mitre.org/software/S0605", "EKANS", "EKANS stops database, data backup solution, antivirus, and ICS-related processes.[13][14][15]"], "S0697": ["https://attack.mitre.org/software/S0697", "HermeticWiper", "HermeticWiper has the ability to stop the Volume Shadow Copy service.[16]"], "S0431": ["https://attack.mitre.org/software/S0431", "HotCroissant", "HotCroissant has the ability to stop services on the infected host.[17]"], "G0119": ["https://attack.mitre.org/groups/G0119", "Indrik Spider", "Indrik Spider has used PsExec to stop services prior to the execution of ransomware.[18]"], "S0604": ["https://attack.mitre.org/software/S0604", "Industroyer", "Industroyerâ€™s data wiper module writes zeros into the registry keys in SYSTEM\\CurrentControlSet\\Services to render a system inoperable.[19]"], "S0607": ["https://attack.mitre.org/software/S0607", "KillDisk", "KillDisk terminates various processes to get the user to reboot the victim machine.[20]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has stopped the MSExchangeIS service to render Exchange contents inaccessible to users.[21]"], "S0582": ["https://attack.mitre.org/software/S0582", "LookBack", "LookBack can kill processes and delete services.[22]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "Maze has stopped SQL services to ensure it can encrypt any database.[23]"], "S0576": ["https://attack.mitre.org/software/S0576", "MegaCortex", "MegaCortex can stop and disable services on the system.[24]"], "S0688": ["https://attack.mitre.org/software/S0688", "Meteor", "Meteor can disconnect all network adapters on a compromised host using powershell -Command \"Get-WmiObject -class Win32_NetworkAdapter | ForEach { If ($.NetEnabled) { $.Disable() } }\" > NUL.[25]"], "S0457": ["https://attack.mitre.org/software/S0457", "Netwalker", "Netwalker can terminate system processes and services, some of which relate to backup software.[26]"], "S0365": ["https://attack.mitre.org/software/S0365", "Olympic Destroyer", "Olympic Destroyer uses the API call ChangeServiceConfigW to disable all services on the affected system.[1]"], "S0556": ["https://attack.mitre.org/software/S0556", "Pay2Key", "Pay2Key can stop the MS SQL service at the end of the encryption process to release files locked by the service.[27]"], "S0583": ["https://attack.mitre.org/software/S0583", "Pysa", "Pysa can stop services and processes.[28]"], "S0481": ["https://attack.mitre.org/software/S0481", "Ragnar Locker", "Ragnar Locker has attempted to stop services associated with business applications and databases to release the lock on files used by these applications so they may be encrypted.[29]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil has the capability to stop services and kill processes.[30][31]"], "S0400": ["https://attack.mitre.org/software/S0400", "RobbinHood", "RobbinHood stops 181 Windows services on the system before beginning the encryption process.[32]"], "S0446": ["https://attack.mitre.org/software/S0446", "Ryuk", "Ryuk has called kill.bat for stopping services, disabling services and killing processes.[33]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA has the capability to stop processes and services.[34]"], "S0366": ["https://attack.mitre.org/software/S0366", "WannaCry", "WannaCry attempts to kill processes associated with Exchange, Microsoft SQL Server, and MySQL to make it possible to encrypt their data stores.[35][3]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used taskkill.exe and net.exe to stop backup, catalog, cloud, and other services prior to network encryption.[36]"]}, "Mitigation": {"M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Operate intrusion detection, analysis, and response systems on a separate network from the production environment to lessen the chances that an adversary can see and interfere with critical response functions."], "M1022": ["https://attack.mitre.org/mitigations/M1022", "Restrict File and Directory Permissions", "Ensure proper process and file permissions are in place to inhibit adversaries from disabling or interfering with critical services."], "M1024": ["https://attack.mitre.org/mitigations/M1024", "Restrict Registry Permissions", "Ensure proper registry permissions are in place to inhibit adversaries from disabling or interfering with critical services."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Limit privileges of user accounts and groups so that only authorized administrators can interact with service changes and service configurations."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may stop or disable services on a system to render those services unavailable to legitimate users.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Modification": ["Monitor for changes made to files that may stop or disable services on a system to render those services unavailable to legitimate users.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "OS API Execution": ["Remote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. For example, ChangeServiceConfigW may be used by an adversary to prevent services from starting.[1]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for newly executed processes that may stop or disable services on a system to render those services unavailable to legitimate users.", "", "", ""], "Process Termination": ["Monitor processes and command-line arguments to see if critical processes are terminated or stop running.", "", "", ""], "Service Metadata": ["Alterations to the service binary path or the service startup type changed to disabled may be suspicious.", "DS0019", "https://attack.mitre.org/datasources/DS0019", "Service"], "Windows Registry Key Modification": ["Monitor for changes made to windows registry keys and/or values that may stop or disable services on a system to render those services unavailable to legitimate users.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
