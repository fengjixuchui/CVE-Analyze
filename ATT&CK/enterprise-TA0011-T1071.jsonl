{"TTP_id": "enterprise-TA0011-T1071", "TTP_name": "Application Layer Protocol", "Description": "Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP.", "Property": {"ID": "T1071", "Sub-techniques": "T1071.001, T1071.002, T1071.003, T1071.004", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Version": "2.0", "Created": "31 May 2017", "Last Modified": "21 October 2020"}, "Examples": {"S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling has the ability to use Telnet for communication.[1]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can conduct peer-to-peer communication over Windows named pipes encapsulated in the SMB protocol. All protocols use their standard assigned ports.[2][3]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has used SMB for C2.[4]"], "S0038": ["https://attack.mitre.org/software/S0038", "Duqu", "Duqu uses a custom command and control protocol that communicates over commonly used ports, and is frequently encapsulated by application layer protocols.[5]"], "S0601": ["https://attack.mitre.org/software/S0601", "Hildegard", "Hildegard has used an IRC channel for C2 communications.[6]"], "S0532": ["https://attack.mitre.org/software/S0532", "Lucifer", "Lucifer can use the Stratum protocol on port 10001 for communication between the cryptojacking bot and the mining server.[7]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound malware has used IRC for C2.[8]"], "S0034": ["https://attack.mitre.org/software/S0034", "NETEAGLE", "Adversaries can also use NETEAGLE to establish an RDP connection with a controller over TCP/7519."], "S0019": ["https://attack.mitre.org/software/S0019", "Regin", "The Regin malware platform supports many standard protocols, including SMB.[9]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke issued wget requests from infected systems to the C2.[10]"], "S0623": ["https://attack.mitre.org/software/S0623", "Siloscape", "Siloscape connects to an IRC server for C2.[11]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has used an IRC bot for C2 communications.[12]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."]}, "Detection": {"Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""]}}
