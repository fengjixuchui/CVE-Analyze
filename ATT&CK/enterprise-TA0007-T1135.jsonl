{"TTP_id": "enterprise-TA0007-T1135", "TTP_name": "Network Share Discovery", "Description": "Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.File sharing over a Windows network occurs over the SMB protocol. [1] [2] Net can be used to query a remote system for available shared drives using the net view \\\\remotesystem command. It can also be used to query shared drives on the local system using net share. For macOS, the sharing -l command lists all shared points used for smb services.", "Property": {"ID": "T1135", "Sub-techniques": "No sub-techniques", "Tactic": "Discovery", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "CAPEC ID": "CAPEC-643", "Contributors": "Praetorian", "Version": "3.1", "Created": "14 December 2017", "Last Modified": "13 October 2021"}, "Examples": {"G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 listed connected network shares.[3]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 used the net view command to show all shares available, including the administrative shares such as C$ and ADMIN$.[4]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has enumerated network shares on a compromised host.[5]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used the post exploitation tool CrackMapExec to enumerate network shares.[6]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used the net share command as part of network reconnaissance.[7][8]"], "S0640": ["https://attack.mitre.org/software/S0640", "Avaddon", "Avaddon has enumerated shared folders and mapped volumes.[9]"], "S0638": ["https://attack.mitre.org/software/S0638", "Babuk", "Babuk has the ability to enumerate network shares.[10]"], "S0606": ["https://attack.mitre.org/software/S0606", "Bad Rabbit", "Bad Rabbit enumerates open SMB shares on internal victim networks.[11]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can enumerate shared drives on the domain.[12]"], "S0570": ["https://attack.mitre.org/software/S0570", "BitPaymer", "BitPaymer can search for network shares on the domain or workgroup using net view .[13]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used net share and net view to identify network shares of interest.[14]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling has the ability to enumerate network shares.[15]"], "S0611": ["https://attack.mitre.org/software/S0611", "Clop", "Clop can enumerate network shares.[16]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can query shared drives on the local system.[17]"], "S0575": ["https://attack.mitre.org/software/S0575", "Conti", "Conti can enumerate remote open SMB network shares using NetShareEnum().[18][19]"], "S0488": ["https://attack.mitre.org/software/S0488", "CrackMapExec", "CrackMapExec can enumerate the shared folders and associated permissions for a targeted network.[20]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba can discover shared resources using the NetShareEnum API call.[21]"], "G0105": ["https://attack.mitre.org/groups/G0105", "DarkVishnya", "DarkVishnya scanned the network for public shared folders.[22]"], "S0616": ["https://attack.mitre.org/software/S0616", "DEATHRANSOM", "DEATHRANSOM has the ability to use loop operations to enumerate network resources.[23]"], "S0659": ["https://attack.mitre.org/software/S0659", "Diavol", "Diavol has a ENMDSKS command to enumerates available network shares.[24]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.[25]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can find shared drives on the local system.[26]"], "S0618": ["https://attack.mitre.org/software/S0618", "FIVEHANDS", "FIVEHANDS can enumerate network shares and mounted drives on a network.[27]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro has been used to execute net view to discover mapped network shares.[28]"], "S0617": ["https://attack.mitre.org/software/S0617", "HELLOKITTY", "HELLOKITTY has the ability to enumerate network resources.[23]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can gather network share information.[29]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can scan local network for open SMB.[30]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs collects a list of network shares with the command net share.[31]"], "S0233": ["https://attack.mitre.org/software/S0233", "MURKYTOP", "MURKYTOP has the capability to retrieve information about shares on remote hosts.[32]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "The net view \\remotesystem and net share commands in Net can be used to find shared drives and directories on remote and local systems respectively.[33]"], "S0365": ["https://attack.mitre.org/software/S0365", "Olympic Destroyer", "Olympic Destroyer will attempt to enumerate mapped network shares to later attempt to wipe all files on those shares.[34]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has discovered network disks mounted to the system using netstat.[35]"], "S0165": ["https://attack.mitre.org/software/S0165", "OSInfo", "OSInfo discovers shares on the network[36]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX has a module to enumerate network shares.[37]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy can list local and remote shared drives and folders over SMB.[38]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use net share to identify network shares for use in lateral movement.[39][40]"], "S0686": ["https://attack.mitre.org/software/S0686", "QuietSieve", "QuietSieve can identify and search networked drives for specific file name extensions.[41]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can scan for network drives which may contain documents for collection.[42][43]"], "S0444": ["https://attack.mitre.org/software/S0444", "ShimRat", "ShimRat can enumerate connected drives for infected host machines.[44]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can enumerate shares on a compromised host.[45]"], "G0054": ["https://attack.mitre.org/groups/G0054", "Sowbug", "Sowbug listed remote shared drives that were accessible from a victim.[46]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet enumerates the directories of a network resource.[47]"], "G0131": ["https://attack.mitre.org/groups/G0131", "Tonto Team", "Tonto Team has used tools such as NBTscan to enumerate network shares.[48]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot module shareDll/mshareDll discovers network shares via the WNetOpenEnumA API.[49][50]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper used netview to scan target systems for shared resources.[51]"], "S0612": ["https://attack.mitre.org/software/S0612", "WastedLocker", "WastedLocker can identify network adjacent and accessible drives.[52]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used the \"net view\" command to locate mapped network shares.[53]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy identifies network drives when they are added to victim systems.[54]"]}, "Mitigation": {"M1028": ["https://attack.mitre.org/mitigations/M1028", "Operating System Configuration", "Enable Windows Group Policy \"Do Not Allow Anonymous Enumeration of SAM Accounts and Shares\" security setting to limit users who can enumerate network shares.[55]"]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "OS API Execution": ["Monitor for API calls that may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for newly executed processes that may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.", "", "", ""]}}
