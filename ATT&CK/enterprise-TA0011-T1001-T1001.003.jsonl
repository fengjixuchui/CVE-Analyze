{"TTP_id": "enterprise-TA0011-T1001-T1001.003", "TTP_name": "Protocol Impersonation", "Description": "Adversaries may impersonate legitimate protocols or web service traffic to disguise command and control activity and thwart analysis efforts. By impersonating legitimate protocols or web services, adversaries can make their command and control traffic blend in with legitimate network traffic.Adversaries may impersonate a fake SSL/TLS handshake to make it look like subsequent traffic is SSL/TLS encrypted, potentially interfering with some security tooling, or to make the traffic look like it is related with a trusted entity.", "Property": {"ID": "T1001.003", "Sub-technique of": "T1001", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "15 March 2020", "Last Modified": "15 March 2020"}, "Examples": {"S0245": ["https://attack.mitre.org/software/S0245", "BADCALL", "BADCALL uses a FakeTLS method during C2.[1]"], "S0239": ["https://attack.mitre.org/software/S0239", "Bankshot", "Bankshot generates a false TLS handshake using a public certificate to disguise C2 network communications.[2]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can mimic the HTTP protocol for C2 communication, while hiding the actual data in either an HTTP header, URI parameter, the transaction body, or appending it to the URI.[3]"], "S0076": ["https://attack.mitre.org/software/S0076", "FakeM", "FakeM C2 traffic attempts to evade detection by resembling data generated by legitimate messenger applications, such as MSN and Yahoo! messengers. Additionally, some variants of FakeM use modified SSL code for communications back to C2 servers, making SSL decryption ineffective.[4]"], "S0181": ["https://attack.mitre.org/software/S0181", "FALLCHILL", "FALLCHILL uses fake Transport Layer Security (TLS) to communicate with its C2 server.[5]"], "S0246": ["https://attack.mitre.org/software/S0246", "HARDRAIN", "HARDRAIN uses FakeTLS to communicate with its C2 server.[6]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa used a FakeTLS session for C2 communications.[7]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can mimic HTTP protocol with custom HTTP \"verbs\" HIDE, ZVVP, and NOP.[8][9]"], "S0387": ["https://attack.mitre.org/software/S0387", "KeyBoy", "KeyBoy uses custom SSL libraries to impersonate SSL in C2 traffic.[10]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware also uses a unique form of communication encryption known as FakeTLS that mimics TLS but uses a different encryption method, potentially evading SSL traffic inspection/decryption.[11][12][13][14]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum mimics HTTP protocol for C2 communication, while hiding the actual messages in the Cookie and Set-Cookie headers of the HTTP requests.[15]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST masqueraded its network traffic as the Orion Improvement Program (OIP) protocol.[16]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "TAINTEDSCRIBE has used FakeTLS for session authentication.[17]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate some obfuscation activity at the network level."]}, "Detection": {"Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"]}}
