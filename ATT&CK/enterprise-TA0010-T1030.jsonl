{"TTP_id": "enterprise-TA0010-T1030", "TTP_name": "Data Transfer Size Limits", "Description": "An adversary may exfiltrate data in fixed size chunks instead of whole files or limit packet sizes below certain thresholds. This approach may be used to avoid triggering network data transfer threshold alerts.", "Property": {"ID": "T1030", "Sub-techniques": "No sub-techniques", "Tactic": "Exfiltration", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "31 May 2017", "Last Modified": "14 July 2020"}, "Examples": {"S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed has divided files if the size is 0x1000000 bytes or more.[1]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has split archived exfiltration files into chunks smaller than 1MB.[2]"], "S0030": ["https://attack.mitre.org/software/S0030", "Carbanak", "Carbanak exfiltrates data in compressed chunks if a message is larger than 4096 bytes .[3]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike will break large data sets into smaller chunks for exfiltration.[4]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "Helminth splits data into chunks up to 23 bytes and sends the data in DNS queries to its C2 server.[5]"], "S0487": ["https://attack.mitre.org/software/S0487", "Kessel", "Kessel can split the data to be exilftrated into chunks that will fit in subdomains of DNS queries.[6]"], "S0699": ["https://attack.mitre.org/software/S0699", "Mythic", "Mythic supports custom chunk sizes used to upload/download files.[7]"], "S0644": ["https://attack.mitre.org/software/S0644", "ObliqueRAT", "ObliqueRAT can break large files of interest into smaller chunks to prepare them for exfiltration.[8]"], "S0264": ["https://attack.mitre.org/software/S0264", "OopsIE", "OopsIE exfiltrates command output and collected files to its C2 server in 1500-byte blocks.[9]"], "S0150": ["https://attack.mitre.org/software/S0150", "POSHSPY", "POSHSPY uploads data in 2048-byte chunks.[10]"], "S0495": ["https://attack.mitre.org/software/S0495", "RDAT", "RDAT can upload a file via HTTP POST response to the C2 split into 102,400-byte portions. RDAT can also download data from the C2 which is split into 81,920-byte portions.[11]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 actors have split RAR files for exfiltration into parts.[12]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level."]}, "Detection": {"Network Connection Creation": ["Monitor for newly constructed network connections that are sent or received by untrusted hosts or uncommon data flows (e.g. unusual network communications or suspicious communications sending fixed size data packets at regular intervals as well as unusually long connection patterns). Consider analyzing packet contents to detect application layer protocols, leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, protocol port mismatch, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments (e.g. monitor anomalies in use of files that do not normally initiate network connections or unusual connections initiated", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""]}}
