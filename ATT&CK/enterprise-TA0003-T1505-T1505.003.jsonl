{"TTP_id": "enterprise-TA0003-T1505-T1505.003", "TTP_name": "Web Shell", "Description": "Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server.In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (ex: China Chopper Web shell client).[1]", "Property": {"ID": "T1505.003", "Sub-technique of": "T1505", "Tactic": "Persistence", "Platforms": "Linux, Windows, macOS", "System Requirements": "Adversary access to Web server with vulnerability or account to upload and serve the Web shell file.", "Permissions Required": "SYSTEM, User", "CAPEC ID": "CAPEC-650", "Contributors": "Arnim Rupp, Deutsche Lufthansa AG", "Version": "1.2", "Created": "13 December 2019", "Last Modified": "26 July 2021"}, "Examples": {"G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has used a modified and obfuscated version of the reGeorg web shell to maintain persistence on a target's Outlook Web Access (OWA) server.[2]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has installed web shells on exploited Microsoft Exchange servers.[3]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has used Web shells to maintain access to victim websites.[4]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has used web shells for persistence or to ensure redundant access.[5]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has installed ANTAK and ASPXSPY web shells.[6]"], "S0073": ["https://attack.mitre.org/software/S0073", "ASPXSpy", "ASPXSpy is a Web shell. The ASPXTool version used by Threat Group-3390 has been deployed to accessible servers running Internet Information Services (IIS).[7]"], "G0135": ["https://attack.mitre.org/groups/G0135", "BackdoorDiplomacy", "BackdoorDiplomacy has used web shells to establish an initial foothold and for lateral movement within a victim's system.[8]"], "S0020": ["https://attack.mitre.org/software/S0020", "China Chopper", "China Chopper's server component is a Web Shell payload.[1]"], "G0009": ["https://attack.mitre.org/groups/G0009", "Deep Panda", "Deep Panda uses Web shells on publicly accessible Web servers to access victim networks.[9]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.[10]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has installed web shells on compromised hosts to maintain access.[11][12]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used Web shells to persist in victim environments and assist in execution and exfiltration.[13][14]"], "G0125": ["https://attack.mitre.org/groups/G0125", "HAFNIUM", "HAFNIUM has deployed multiple web shells on compromised servers including SIMPLESEESHARP, SPORTSBALL, China Chopper, and ASPXSpy.[15][16][17]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used modified versions of open source PHP web shells to maintain access, often adding \"Dinosaur\" references within the code.[18]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan relies on web shells for an initial foothold as well as persistence into the victim's systems.[19][20]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used web shells, often to maintain access to a victim network.[21][22][23]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used their own web shells, as well as those previously placed on target systems by other threat actors, for reconnaissance and lateral movement.[24]"], "S0072": ["https://attack.mitre.org/software/S0072", "OwaAuth", "OwaAuth is a Web shell that appears to be exclusively used by Threat Group-3390. It is installed as an ISAPI filter on Exchange servers and shares characteristics with the China Chopper Web shell.[7]"], "S0598": ["https://attack.mitre.org/software/S0598", "P.A.S. Webshell", "P.A.S. Webshell can gain remote access and execution on target web servers.[25]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has used webshells including P.A.S. Webshell to maintain access to victim networks.[25]"], "S0185": ["https://attack.mitre.org/software/S0185", "SEASHARPEE", "SEASHARPEE is a Web shell.[22]"], "S0578": ["https://attack.mitre.org/software/S0578", "SUPERNOVA", "SUPERNOVA is a Web shell.[26][27][28]"], "G0088": ["https://attack.mitre.org/groups/G0088", "TEMP.Veles", "TEMP.Veles has planted Web shells on Outlook Exchange servers.[29]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used a variety of Web shells.[30]"], "G0131": ["https://attack.mitre.org/groups/G0131", "Tonto Team", "Tonto Team has used a first stage web shell after compromising a vulnerable Exchange server.[31]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper has started a web service in the target host and wait for the adversary to connect, acting as a web shell.[32]"], "G0123": ["https://attack.mitre.org/groups/G0123", "Volatile Cedar", "Volatile Cedar can inject web shell code into a server.[33][34]"]}, "Mitigation": {"M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Consider disabling functions from web technologies such as PHPâ€™s eval() that may be abused for web shells.[35]"], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Enforce the principle of least privilege by limiting privileges of user accounts so only authorized accounts can modify the web directory.[36]"]}, "Detection": {"Application Log Content": ["Monitor for third-party application logging, messaging, and/or other artifacts that may backdoor web servers with web shells to establish persistent access to systems. Log authentication attempts to the server and any unusual traffic patterns to or from the server and internal network. [37]", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "File Creation": ["File monitoring may be used to detect changes to files in the Web directory of a Web server that do not match with updates to the Web server's content and may indicate implantation of a Web shell script.[38]", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Modification": ["Monitor for changes made to files that may backdoor web servers with web shells to establish persistent access to systems.", "", "", ""], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""], "Process Creation": ["Web shells can be difficult to detect. Unlike other forms of persistent remote access, they do not initiate connections. The portion of the Web shell that is on the server may be small and innocuous looking. The PHP version of the China Chopper Web shell, for example, is the following short payload: [1]<?php @eval($_POST['password']);>Nevertheless, detection mechanisms exist. Process monitoring may be used to detect Web servers that perform suspicious actions such as spawning cmd.exe or accessing files that are not in the Web directory.[38]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
