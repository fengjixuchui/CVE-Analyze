{"TTP_id": "enterprise-TA0005-T1550", "TTP_name": "Use Alternate Authentication Material", "Description": "Adversaries may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls.Authentication processes generally require a valid identity (e.g., username) along with one or more authentication factors (e.g., password, pin, physical smart card, token generator, etc.). Alternate authentication material is legitimately generated by systems after a user or application successfully authenticates by providing a valid identity and the required authentication factor(s). Alternate authentication material may also be generated during the identity creation process.[1][2]Caching alternate authentication material allows the system to verify an identity has successfully authenticated without asking the user to reenter authentication factor(s). Because the alternate authentication must be maintained by the system—either in memory or on disk—it may be at risk of being stolen through Credential Access techniques. By stealing alternate authentication material, adversaries are able to bypass system access controls and authenticate to systems without knowing the plaintext password or any additional authentication factors.", "Property": {"ID": "T1550", "Sub-techniques": "T1550.001, T1550.002, T1550.003, T1550.004", "Tactics": "Defense Evasion, Lateral Movement", "Platforms": "Containers, Google Workspace, IaaS, Office 365, SaaS, Windows", "Defense Bypassed": "System Access Controls", "Version": "1.2", "Created": "30 January 2020", "Last Modified": "01 April 2022"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 used forged SAML tokens that allowed the actors to impersonate users and bypass MFA, enabling APT29 to access enterprise cloud applications and services.[3][4]"], "S0661": ["https://attack.mitre.org/software/S0661", "FoggyWeb", "FoggyWeb can allow abuse of a compromised AD FS server's SAML token.[5]"]}, "Mitigation": {"M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Limit credential overlap across systems to prevent the damage of credential compromise and reduce the adversary's ability to perform Lateral Movement between systems."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Enforce the principle of least-privilege. Do not allow a domain user to be in the local administrator group on multiple systems."]}, "Detection": {"Active Directory Credential Request": ["Monitor requests of new ticket granting ticket or service tickets to a Domain Controller, such as Windows EID 4769 or 4768, that may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls.", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"], "Application Log Content": ["Monitor for third-party application logging, messaging, and/or other artifacts that may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls.", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "Logon Session Creation": ["Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account.", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "User Account Authentication": ["Monitor for an attempt by a user to gain access to a network or computing resource, often by providing credentials that may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"], "Web Credential Usage": ["Monitor for an attempt by a user to gain access to a network or computing resource by providing web credentials (ex: Windows EID 1202) that may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls.", "DS0006", "https://attack.mitre.org/datasources/DS0006", "Web Credential"]}}
