{"TTP_id": "enterprise-TA0003-T1098", "TTP_name": "Account Manipulation", "Description": "Adversaries may manipulate accounts to maintain access to victim systems. Account manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups. These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials.In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain. However, account manipulation may also lead to privilege escalation where modifications grant access to additional roles, permissions, or higher-privileged Valid Accounts.", "Property": {"ID": "T1098", "Sub-techniques": "T1098.001, T1098.002, T1098.003, T1098.004, T1098.005", "Tactic": "Persistence", "Platforms": "Azure AD, Google Workspace, IaaS, Linux, Office 365, SaaS, Windows, macOS", "Contributors": "Jannie Li, Microsoft Threat Intelligence Center (MSTIC); Praetorian; Tim MalcomVetter; Wojciech Lesicki", "Version": "2.3", "Created": "31 May 2017", "Last Modified": "18 April 2022"}, "Examples": {"G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has been known to add created accounts to local admin groups to maintain elevated access.[1]"], "S0274": ["https://attack.mitre.org/software/S0274", "Calisto", "Calisto adds permissions and remote logins to all users.[2]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has added newly created accounts to the administrators group to maintain elevated access.[3]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has added accounts to specific groups with net localgroup.[4]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware WhiskeyDelta-Two contains a function that attempts to rename the administrator’s account.[5][6]"], "S0002": ["https://attack.mitre.org/software/S0002", "Mimikatz", "The Mimikatz credential dumper has been extended to include Skeleton Key domain controller authentication bypass functionality. The LSADUMP::ChangeNTLM and LSADUMP::SetNTLM modules can also manipulate the password hash of an account without knowing the clear text value.[7][8]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team used the sp_addlinkedsrvlogin command in MS-SQL to create a link between a created account and other servers in the network.[9]"], "S0649": ["https://attack.mitre.org/software/S0649", "SMOKEDHAM", "SMOKEDHAM has added created user accounts to local Admin groups.[10]"]}, "Mitigation": {"M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Use multi-factor authentication for user and privileged accounts."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Configure access controls and firewalls to limit access to critical systems and domain controllers. Most cloud environments support separate virtual private cloud (VPC) instances that enable further segmentation of cloud systems."], "M1028": ["https://attack.mitre.org/mitigations/M1028", "Operating System Configuration", "Protect domain controllers by ensuring proper security configuration for critical servers to limit access by potentially unnecessary protocols and services, such as SMB file sharing."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Do not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems."]}, "Detection": {"Active Directory Object Modification": ["Monitor for changes to Azure Activity Logs for unexpected modifications to Service Principal and Application.", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"], "Command Execution": ["Monitor executed commands and arguments for suspicious commands to modify accounts or account settings (including files such as the authorized_keys or /etc/ssh/sshd_config).Monitor executed commands and arguments of suspicious commands (such as Add-MailboxPermission) that may be indicative of modifying the permissions of Exchange and other related service settings.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Modification": ["Monitor for changes made to files related to account settings, such as /etc/ssh/sshd_config and the authorized_keys file for each user on a system.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Group Modification": ["Monitor events for changes to account objects and/or permissions on systems and the domain, such as event IDs 4738, 4728 and 4670.", "DS0036", "https://attack.mitre.org/datasources/DS0036", "Group"], "Process Creation": ["Monitor for newly constructed processes indicative of modifying account settings, such as those that modify authorized_keys or /etc/ssh/sshd_config files.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "User Account Modification": ["Monitor events for changes to account objects and/or permissions on systems and the domain, such as event IDs 4738, 4728 and 4670. Monitor for modification of accounts in correlation with other suspicious activity. Changes may occur at unusual times or from unusual systems. Especially flag events where the subject and target accounts differ or that include additional flags such as changing a password without knowledge of the old password.Monitor for unusual permissions changes that may indicate excessively broad permissions being granted to compromised accounts.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"]}}
