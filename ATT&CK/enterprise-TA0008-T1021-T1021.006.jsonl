{"TTP_id": "enterprise-TA0008-T1021-T1021.006", "TTP_name": "Windows Remote Management", "Description": "Adversaries may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.WinRM is the name of both a Windows service and a protocol that allows a user to interact with a remote system (e.g., run an executable, modify the Registry, modify services).[1] It may be called with the winrm command or by any number of programs such as PowerShell.[2] WinRM can be used as a method of remotely interacting with Windows Management Instrumentation.[3]", "Property": {"ID": "T1021.006", "Sub-technique of": "T1021", "Tactic": "Lateral Movement", "Platforms": "Windows", "Permissions Required": "Administrator, User", "Version": "1.1", "Created": "11 February 2020", "Last Modified": "23 June 2021"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used WinRM via PowerShell to execute command and payloads on remote hosts.[4]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used WinRM for lateral movement.[5]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can use WinRM to execute a payload on a remote host.[6][7]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY tracks TrustedHosts and can move laterally to these targets via WinRM.[8]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used WinRM to enable remote execution.[9]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used Window Remote Management to move laterally through a victim network.[10]"]}, "Mitigation": {"M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Disable the WinRM service."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "If the service is necessary, lock down critical enclaves with separate WinRM infrastructure and follow WinRM best practices on use of host firewalls to restrict WinRM access to allow communication only to/from specific devices.[11]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "If the service is necessary, lock down critical enclaves with separate WinRM accounts and permissions."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may invoke a WinRM script to correlate it with other related events.[12]", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Logon Session Creation": ["Monitor for user accounts logging into the system via Valid Accounts to interact with remote systems using Windows Remote Management (WinRM). The adversary may then perform actions as the logged-on user.", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "Network Connection Creation": ["Monitor for newly constructed network connections using Windows Remote Management (WinRM), such as remote WMI connection attempts (typically over port 5985 when using HTTP and 5986 for HTTPS).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Process Creation": ["Monitor for newly executed processes that may use Valid Accounts to interact with remote systems using Windows Remote Management (WinRM), as well as service processes such as wmiprvse.exe on destination hosts.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Service Metadata": ["Monitor use of WinRM within an environment by tracking service execution. If it is not normally used or is disabled, then this may be an indicator of suspicious behavior.", "DS0019", "https://attack.mitre.org/datasources/DS0019", "Service"]}}
