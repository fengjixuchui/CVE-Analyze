{"TTP_id": "enterprise-TA0007-T1087-T1087.002", "TTP_name": "Domain Account", "Description": "Adversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior.Commands such as net user /domain and net group /domain of the Net utility, dscacheutil -q groupon macOS, and ldapsearch on Linux can list domain users and groups.", "Property": {"ID": "T1087.002", "Sub-technique of": "T1087", "Tactic": "Discovery", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "CAPEC ID": "CAPEC-575", "Version": "1.0", "Created": "21 February 2020", "Last Modified": "13 October 2021"}, "Examples": {"S0552": ["https://attack.mitre.org/software/S0552", "AdFind", "AdFind can enumerate domain users.[1][2][3]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used PowerShell to discover domain accounts by executing Get-ADUser and Get-DGroupMember.[4][5]"], "S0239": ["https://attack.mitre.org/software/S0239", "Bankshot", "Bankshot gathers domain and account names/information through process monitoring.[6]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar has the ability to identify domain administrator accounts.[7][8]"], "S0521": ["https://attack.mitre.org/software/S0521", "BloodHound", "BloodHound can collect information about domain users, including identification of domain admin accounts.[9]"], "S0635": ["https://attack.mitre.org/software/S0635", "BoomBox", "BoomBox has the ability to execute an LDAP query to enumerate the distinguished name, SAM account name, and display name for all domain users.[10]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has used net user /domain to identify account information.[11]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has has used net user /dom and net user Administrator to enumerate domain accounts including administrator accounts.[12][13]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can determine if the user on an infected machine is in the admin or domain admin group.[14]"], "S0488": ["https://attack.mitre.org/software/S0488", "CrackMapExec", "CrackMapExec can enumerate the domain user accounts on a targeted system.[15]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has used batch scripts to enumerate users on a victim domain controller.[16]"], "S0105": ["https://attack.mitre.org/software/S0105", "dsquery", "dsquery can be used to gather information on user accounts within a domain.[17]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can acquire local and domain user account information.[18]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has used Metasploit’s PsExec NTDSGRAB module to obtain a copy of the victim's Active Directory database.[19]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used the Softerra LDAP browser to browse documentation on service accounts.[20]"], "S0483": ["https://attack.mitre.org/software/S0483", "IcedID", "IcedID can query LDAP to identify additional users on the network to infect.[21]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang performs account discovery using commands such as net localgroup administrators and net group \"REDACTED\" /domain on specific permissions groups.[22]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has queried an active directory server to obtain the list of accounts, including administrator accounts.[23]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used the Microsoft administration tool csvde.exe to export Active Directory data.[24]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used cmd.exe net user /domain to enumerate domain users.[25]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "Net commands used with the /domain flag can be used to gather information about and manipulate user accounts on the current domain.[26]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has run net user, net user /domain, net group \"domain admins\" /domain, and net group \"Exchange Trusted Subsystem\" /domain to get account listings on a victim.[27]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used the net command to retrieve information about domain accounts.[28]"], "S0165": ["https://attack.mitre.org/software/S0165", "OSInfo", "OSInfo enumerates local and domain users[29]"], "G0033": ["https://attack.mitre.org/groups/G0033", "Poseidon Group", "Poseidon Group searches for administrator accounts on both the local victim machine and the network.[30]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 can enumerate local and domain user account information.[31]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER may collect user account information by running net user /domain or a series of other commands on a victim.[32]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has used a tool to query Active Directory using LDAP, discovering information about usernames listed in AD.[33]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can use System.Security.AccessControl namespaces to retrieve domain user information.[34]"], "S0516": ["https://attack.mitre.org/software/S0516", "SoreFang", "SoreFang can enumerate domain accounts via net.exe user /domain.[35]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet enumerates user accounts of the domain.[36]"], "S0018": ["https://attack.mitre.org/software/S0018", "Sykipot", "Sykipot may use net group \"domain admins\" /domain to display accounts in the \"domain admins\" permissions group and net localgroup \"administrators\" to list local system administrator group membership.[37]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has used net user /domain to enumerate domain accounts.[38]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak has the ability to enumerate domain admin accounts.[39]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has identified domain admins through the use of \"net group ‘Domain admins’\" commands.[8]"]}, "Mitigation": {"M1028": ["https://attack.mitre.org/mitigations/M1028", "Operating System Configuration", "Prevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located at HKLM\\ SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI\\EnumerateAdministrators. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts on elevation.[40]"]}, "Detection": {"Command Execution": ["Monitor for execution of commands and arguments associated with enumeration or information gathering of domain accounts and groups, such as net user /domain and net group /domain, dscacheutil -q groupon macOS, and ldapsearch on Linux.System and network discovery techniques normally occur throughout an operation as an adversary learns the environment, and also to an extent in normal network operations. Therefore discovery data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "OS API Execution": ["Monitor for API calls that may attempt to gather information about domain accounts such as type of user, privileges and groups.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for processes that can be used to enumerate domain accounts and groups, such as net.exe and net1.exe, especially when executed in quick succession.[41] Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.", "", "", ""]}}
