{"TTP_id": "enterprise-TA0011-T1568", "TTP_name": "Dynamic Resolution", "Description": "Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. These calculations can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.Adversaries may use dynamic resolution for the purpose of Fallback Channels. When contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control.[1][2][3]", "Property": {"ID": "T1568", "Sub-techniques": "T1568.001, T1568.002, T1568.003", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Contributors": "Chris Roffe", "Version": "1.0", "Created": "10 March 2020", "Last Modified": "11 March 2022"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 used dynamic DNS resolution to construct and resolve to randomly-generated subdomains for C2.[4]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has used a dynamic DNS service for C2.[5]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has incorporated dynamic DNS domains in its infrastructure.[6]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium can use dynamic DNS domain names in C2.[7]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "Maze has forged POST strings with a random choice from a list of possibilities including \"forum\", \"php\", \"view\", etc. while making connection with the C2, hindering detection efforts.[8]"], "S0034": ["https://attack.mitre.org/software/S0034", "NETEAGLE", "NETEAGLE can use HTTP to download resources that contain an IP address and port number pair to connect to for C2.[9]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM has resolved Pony C2 server IP addresses by either converting Bitcoin blockchain transaction data to specific octets, or accessing IP addresses directly within the Namecoin blockchain.[10][11]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST dynamically resolved C2 infrastructure for randomly-generated subdomains within a parent domain.[12]"], "S0671": ["https://attack.mitre.org/software/S0671", "Tomiris", "Tomiris has connected to a signalization server that provides a URL and port, and then Tomiris sends a GET request to that URL to establish C2.[13]"], "G0134": ["https://attack.mitre.org/groups/G0134", "Transparent Tribe", "Transparent Tribe has used dynamic DNS services to set up C2.[14]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Malware researchers can reverse engineer malware variants that use dynamic resolution and determine future C2 infrastructure that the malware will attempt to contact, but this is a time and resource intensive effort.[15][16]"], "M1021": ["https://attack.mitre.org/mitigations/M1021", "Restrict Web-Based Content", "In some cases a local DNS sinkhole may be used to help prevent behaviors associated with dynamic resolution."]}, "Detection": {"Network Connection Creation": ["Monitor for newly constructed network connections that are sent or received by untrusted hosts.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
