{"TTP_id": "enterprise-TA0003-T1098-T1098.001", "TTP_name": "Additional Cloud Credentials", "Description": "Adversaries may add adversary-controlled credentials to a cloud account to maintain persistent access to victim accounts and instances within the environment.Adversaries may add credentials for Service Principals and Applications in addition to existing legitimate credentials in Azure AD.[1][2][3] These credentials include both x509 keys and passwords.[1] With sufficient permissions, there are a variety of ways to add credentials including the Azure Portal, Azure command line interface, and Azure or Az PowerShell modules.[4]In infrastructure-as-a-service (IaaS) environments, after gaining access through Cloud Accounts, adversaries may generate or import their own SSH keys using either the CreateKeyPair or ImportKeyPair API in AWS or the gcloud compute os-login ssh-keys add command in GCP.[5] This allows persistent access to instances within the cloud environment without further usage of the compromised cloud accounts.[6][7]", "Property": {"ID": "T1098.001", "Sub-technique of": "T1098", "Tactic": "Persistence", "Platforms": "Azure AD, IaaS, SaaS", "Contributors": "Expel; Jannie Li, Microsoft Threat Intelligence Center (MSTIC); Oleg Kolesnikov, Securonix; Zur Ulianitzky, XM Cyber", "Version": "2.3", "Created": "19 January 2020", "Last Modified": "19 May 2022"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has added credentials to OAuth Applications and Service Principals.[8][9]"]}, "Mitigation": {"M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Use multi-factor authentication for user and privileged accounts. Consider enforcing multi-factor authentication for the CreateKeyPair and ImportKeyPair API calls through IAM policies.[6]"], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Configure access controls and firewalls to limit access to critical systems and domain controllers. Most cloud environments support separate virtual private cloud (VPC) instances that enable further segmentation of cloud systems."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Do not allow domain administrator or root accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems."]}, "Detection": {"Active Directory Object Modification": ["Monitor for changes to Azure Activity Logs for Service Principal and Application modifications.", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"], "User Account Modification": ["Monitor Azure Activity Logs for Service Principal and Application modifications. Monitor for the usage of APIs that create or import SSH keys, particularly by unexpected users or accounts such as the root account.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"]}}
