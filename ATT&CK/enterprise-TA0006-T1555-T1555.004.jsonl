{"TTP_id": "enterprise-TA0006-T1555-T1555.004", "TTP_name": "Windows Credential Manager", "Description": "Adversaries may acquire credentials from the Windows Credential Manager. The Credential Manager stores credentials for signing into websites, applications, and/or devices that request authentication through NTLM or Kerberos in Credential Lockers (previously known as Windows Vaults).[1][2]The Windows Credential Manager separates website credentials from application or network credentials in two lockers. As part of Credentials from Web Browsers, Internet Explorer and Microsoft Edge website credentials are managed by the Credential Manager and are stored in the Web Credentials locker. Application and network credentials are stored in the Windows Credentials locker.Credential Lockers store credentials in encrypted .vcrd files, located under %Systemdrive%\\Users\\[Username]\\AppData\\Local\\Microsoft\\[Vault/Credentials]\\. The encryption key can be found in a file named Policy.vpol, typically located in the same folder as the credentials.[3][4]Adversaries may list credentials managed by the Windows Credential Manager through several mechanisms. vaultcmd.exe is a native Windows executable that can be used to enumerate credentials stored in the Credential Locker through a command-line interface. Adversaries may gather credentials by reading files located inside of the Credential Lockers. Adversaries may also abuse Windows APIs such as CredEnumerateA to list credentials managed by the Credential Manager.[5][6]Adversaries may use password recovery tools to obtain plain text passwords from the Credential Manager.[4]", "Property": {"ID": "T1555.004", "Sub-technique of": "T1555", "Tactic": "Credential Access", "Platforms": "Windows", "Contributors": "Bernaldo Penas Antelo; Mugdha Peter Bansode", "Version": "1.0", "Created": "23 November 2020", "Last Modified": "20 May 2022"}, "Examples": {"S0526": ["https://attack.mitre.org/software/S0526", "KGH_SPY", "KGH_SPY can collect credentials from the Windows Credential Manager.[7]"], "S0349": ["https://attack.mitre.org/software/S0349", "LaZagne", "LaZagne can obtain credentials from Vault files.[8]"], "S0681": ["https://attack.mitre.org/software/S0681", "Lizar", "Lizar has a plugin that can retrieve credentials from Internet Explorer and Microsoft Edge using vaultcmd.exe and another that can collect RDP access credentials using the CredEnumerateW function.[9]"], "S0002": ["https://attack.mitre.org/software/S0002", "Mimikatz", "Mimikatz contains functionality to acquire credentials from the Windows Credential Manager.[6]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used credential dumping tool named VALUEVAULT to steal credentials from the Windows Credential Manager.[10]"], "S0194": ["https://attack.mitre.org/software/S0194", "PowerSploit", "PowerSploit contains a collection of Exfiltration modules that can harvest credentials from Windows vault credential objects.[11][12]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay can use the QuarksPwDump tool to obtain local passwords and domain cached credentials.[13]"], "S0240": ["https://attack.mitre.org/software/S0240", "ROKRAT", "ROKRAT can steal credentials by leveraging the Windows Vault mechanism.[14]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can gather Windows Vault credentials.[15]"], "G0038": ["https://attack.mitre.org/groups/G0038", "Stealth Falcon", "Stealth Falcon malware gathers passwords from the Windows Credential Vault.[16]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has gathered credentials from the Windows Credential Manager tool.[17]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak can use a .NET compiled module named exchgrabber to enumerate credentials from the Credential Manager.[18]"]}, "Mitigation": {"M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Consider enabling the \"Network access: Do not allow storage of passwords and credentials for network authentication\" setting that will prevent network credentials from being stored by the Credential Manager.[19]"]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments of vaultcmd.exe for suspicious activity, such as listing credentials from the Windows Credentials locker (i.e., vaultcmd /listcreds:\"Windows Credentials\").[4]", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Consider monitoring file reads to Vault locations, %Systemdrive%\\Users\\\\[Username]\\AppData\\Local\\Microsoft\\\\[Vault/Credentials]\\, for suspicious activity.[4]", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "OS API Execution": ["Consider monitoring API calls such as CredEnumerateA that may list credentials from the Windows Credential Manager.[5][6]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor newly executed processes of vaultcmd.exe for suspicious activity, such as listing credentials from the Windows Credentials locker (i.e., vaultcmd /listcreds:\"Windows Credentials\").[4]", "", "", ""]}}
