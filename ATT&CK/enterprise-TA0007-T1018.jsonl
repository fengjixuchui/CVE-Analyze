{"TTP_id": "enterprise-TA0007-T1018", "TTP_name": "Remote System Discovery", "Description": "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as Ping or net view using Net.Adversaries may also analyze data from local host files (ex: C:\\Windows\\System32\\Drivers\\etc\\hosts or /etc/hosts) or other passive means (such as local Arp cache entries) in order to discover the presence of remote systems in an environment.Adversaries may also target discovery of network infrastructure as well as leverage Network Device CLI commands on network devices to gather detailed information about systems within a network.[1][2]", "Property": {"ID": "T1018", "Sub-techniques": "No sub-techniques", "Tactic": "Discovery", "Platforms": "Linux, Network, Windows, macOS", "CAPEC ID": "CAPEC-292", "Contributors": "Austin Clark, @c2defense; Daniel Stepanic, Elastic; RedHuntLabs, @redhuntlabs", "Version": "3.3", "Created": "31 May 2017", "Last Modified": "20 April 2022"}, "Examples": {"S0552": ["https://attack.mitre.org/software/S0552", "AdFind", "AdFind has the ability to query Active Directory for computers.[3][4][5]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used AdFind to enumerate remote systems.[6]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has a tool that can detect the existence of remote systems.[7][8]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has enumerated DC servers using the command net group \"Domain Controllers\" /domain. The group has also used the ping command.[9]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used NBTscan and custom tools to discover remote systems.[10][11][12]"], "S0099": ["https://attack.mitre.org/software/S0099", "Arp", "Arp can be used to display a host's ARP cache, which may include address resolutions for remote systems.[13][14]"], "S0093": ["https://attack.mitre.org/software/S0093", "Backdoor.Oldrea", "Backdoor.Oldrea can enumerate and map ICS-specific systems in victim environments.[15]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can enumerate remote systems using Net View.[16]"], "S0570": ["https://attack.mitre.org/software/S0570", "BitPaymer", "BitPaymer can use net view to discover remote systems.[17]"], "S0521": ["https://attack.mitre.org/software/S0521", "BloodHound", "BloodHound can enumerate and collect the properties of domain computers, including domain controllers.[18]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER typically use ping and Net to enumerate systems.[19]"], "S0335": ["https://attack.mitre.org/software/S0335", "Carbon", "Carbon uses the net view command.[20]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has utilized various scans and queries to find domain controllers and remote services in the target environment.[21]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike uses the native Windows Network Enumeration APIs to interrogate and discover targets in a Windows Active Directory network.[22][23][24]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie runs the net view command"], "S0575": ["https://attack.mitre.org/software/S0575", "Conti", "Conti has the ability to discover hosts on a target network.[25]"], "S0488": ["https://attack.mitre.org/software/S0488", "CrackMapExec", "CrackMapExec can discover active IP addresses, along with the machine name, within a targeted network.[26]"], "G0009": ["https://attack.mitre.org/groups/G0009", "Deep Panda", "Deep Panda has used ping to identify other machines of interest.[27]"], "S0659": ["https://attack.mitre.org/software/S0659", "Diavol", "Diavol can use the ARP table to find remote hosts to scan.[28]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has likely obtained a list of hosts in the victim environment.[29]"], "S0694": ["https://attack.mitre.org/software/S0694", "DRATzarus", "DRATzarus can search for other machines connected to compromised host and attempt to map the network.[30]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic uses the net view command on the victim’s machine.[31]"], "G0053": ["https://attack.mitre.org/groups/G0053", "FIN5", "FIN5 has used the open source tool Essential NetTools to map the network and build a list of targets.[32]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 used publicly available tools (including Microsoft's built-in SQL querying tool, osql.exe) to map the internal network and conduct reconnaissance against Active Directory, Structured Query Language (SQL) servers, and NetBIOS.[33]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has used dsquery and other Active Directory utilities to enumerate hosts; they have also used nltest.exe /dclist to retrieve a list of domain controllers.[34][35]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro has been used to execute net view on a targeted system.[36]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used Angry IP Scanner to detect remote systems.[37]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used a modified version of NBTscan to identify available NetBIOS name servers over the network as well as ping to identify remote systems.[38]"], "S0698": ["https://attack.mitre.org/software/S0698", "HermeticWizard", "HermeticWizard can find machines on the local network by gathering known local IP addresses through DNSGetCacheDataTable, GetIpNetTable,WNetOpenEnumW(RESOURCE_GLOBALNET, RESOURCETYPE_ANY),NetServerEnum,GetTcpTable, and GetAdaptersAddresses.[39]"], "G0119": ["https://attack.mitre.org/groups/G0119", "Indrik Spider", "Indrik Spider has used PowerView to enumerate all Windows Server, Windows Server 2003, and Windows 7 instances in the Active Directory database.[40]"], "S0604": ["https://attack.mitre.org/software/S0604", "Industroyer", "Industroyer can enumerate remote computers in the compromised network.[41]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has used network scanning and enumeration tools, including Ping.[42]"], "S0599": ["https://attack.mitre.org/software/S0599", "Kinsing", "Kinsing has used a script to parse files like /etc/hosts and SSH known_hosts to discover remote systems.[43]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs collects a list of available servers with the command net view.[44]"], "G0077": ["https://attack.mitre.org/groups/G0077", "Leafminer", "Leafminer used Microsoft’s Sysinternals tools to gather detailed information about remote systems.[45]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass uses scripts to enumerate IP ranges on the victim network. menuPass has also issued the command net view /domain to a PlugX implant to gather information about remote systems on the network.[46][47]"], "S0233": ["https://attack.mitre.org/software/S0233", "MURKYTOP", "MURKYTOP has the capability to identify remote hosts on connected networks.[48]"], "G0019": ["https://attack.mitre.org/groups/G0019", "Naikon", "Naikon has used a netbios scanner for remote machine identification.[49]"], "S0590": ["https://attack.mitre.org/software/S0590", "NBTscan", "NBTscan can list NetBIOS computer names.[50][51]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "Commands such as net view can be used in Net to gather information about available remote systems.[52]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT can identify remote hosts on connected networks.[53]"], "S0359": ["https://attack.mitre.org/software/S0359", "Nltest", "Nltest may be used to enumerate remote domain controllers using options such as /dclist and /dsgetdc.[54]"], "S0365": ["https://attack.mitre.org/software/S0365", "Olympic Destroyer", "Olympic Destroyer uses Windows Management Instrumentation to enumerate all systems in the network.[55]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao can use the ping command to discover remote systems.[56]"], "S0165": ["https://attack.mitre.org/software/S0165", "OSInfo", "OSInfo performs a connection test to discover remote systems in the network[7]"], "S0097": ["https://attack.mitre.org/software/S0097", "Ping", "Ping can be used to identify remote systems within a network.[57]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT used Nmap for remote system discovery.[58]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can identify remote systems through the net view command.[59][60]"], "S0241": ["https://attack.mitre.org/software/S0241", "RATANKBA", "RATANKBA runs the net view /domain and net view commands.[61]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec can ping or traceroute a remote host.[62]"], "S0684": ["https://attack.mitre.org/software/S0684", "ROADTools", "ROADTools can enumerate Azure AD systems and devices.[63]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke has looked for IP addresses in the known_hosts file on the infected system and attempted to SSH into them.[64]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has used a tool to query Active Directory using LDAP, discovering information about computers listed in AD.[65][66]"], "S0140": ["https://attack.mitre.org/software/S0140", "Shamoon", "Shamoon scans the C-class subnet of the IPs on the victim's interfaces.[67]"], "S0063": ["https://attack.mitre.org/software/S0063", "SHOTPUT", "SHOTPUT has a command to list all servers in the domain, as well as one to locate domain controllers on a domain.[68]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used Nmap to scan the corporate network, build a network topology, and identify vulnerable hosts.[69]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can enumerate and collect the properties of domain computers.[70]"], "S0646": ["https://attack.mitre.org/software/S0646", "SpicyOmelette", "SpicyOmelette can identify payment systems, payment gateways, and ATM systems in compromised environments.[71]"], "S0018": ["https://attack.mitre.org/software/S0018", "Sykipot", "Sykipot may use net view /domain to display hostnames of available systems on a network.[72]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "The TAINTEDSCRIBE command and execution module can perform target system enumeration.[73]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used the net view command.[74]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot can enumerate computers and network devices.[75]"], "S0609": ["https://attack.mitre.org/software/S0609", "TRITON", "TRITON’s TsLow python module pings controllers over the TriStation protocol.[76]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla surveys a system upon check-in to discover remote systems on a local network using the net view and net view /DOMAIN commands. Turla has also used net group \"Domain Computers\" /domain, net group \"Domain Controllers\" /domain, and net group \"Exchange Servers\" /domain to enumerate domain computers, including the organization's DC and Exchange Server.[31][77]"], "S0452": ["https://attack.mitre.org/software/S0452", "USBferry", "USBferry can use net view to gather information about remote systems.[78]"], "S0366": ["https://attack.mitre.org/software/S0366", "WannaCry", "WannaCry scans its local network segment for remote systems to try to exploit and copy itself to.[79]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used networkdll for network discovery and psfin specifically for financial and point of sale indicators. Wizard Spider has also used AdFind and nltest/dclist to enumerate domain computers, including the domain controller.[5][80][81][3][82]"], "S0248": ["https://attack.mitre.org/software/S0248", "yty", "yty uses the net view command for discovery.[83]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor for files (such as /etc/hosts) being accessed that may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Network Connection Creation": ["Monitor for newly constructed network connections associated with pings/scans that may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Process Creation": ["Monitor for newly executed processes that can be used to discover remote systems, such as ping.exe and tracert.exe, especially when executed in quick succession.[84]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
