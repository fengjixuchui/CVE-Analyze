{"TTP_id": "enterprise-TA0006-T1552-T1552.006", "TTP_name": "Group Policy Preferences", "Description": "Adversaries may attempt to find unsecured credentials in Group Policy Preferences (GPP). GPP are tools that allow administrators to create domain policies with embedded credentials. These policies allow administrators to set local accounts.[1]These group policies are stored in SYSVOL on a domain controller. This means that any domain user can view the SYSVOL share and decrypt the password (using the AES key that has been made public).[2]The following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files:On the SYSVOL share, adversaries may use the following command to enumerate potential GPP XML files: dir /s * .xml", "Property": {"ID": "T1552.006", "Sub-technique of": "T1552", "Tactic": "Credential Access", "Platforms": "Windows", "Permissions Required": "User", "Version": "1.0", "Created": "11 February 2020", "Last Modified": "17 June 2020"}, "Examples": {"G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has used a variety of publicly available tools like Gpppassword to gather credentials.[4][5]"], "S0194": ["https://attack.mitre.org/software/S0194", "PowerSploit", "PowerSploit contains a collection of Exfiltration modules that can harvest credentials from Group Policy Preferences.[6][7]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY has a module that can extract cached GPP passwords.[8]"]}, "Mitigation": {"M1015": ["https://attack.mitre.org/mitigations/M1015", "Active Directory Configuration", "Remove vulnerable Group Policy Preferences.[9]"], "M1047": ["https://attack.mitre.org/mitigations/M1047", "Audit", "Search SYSVOL for any existing GGPs that may contain credentials and remove them.[10]"], "M1051": ["https://attack.mitre.org/mitigations/M1051", "Update Software", "Apply patch KB2962486 which prevents credentials from being stored in GPPs.[10][11]"]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may search for SYSVOL data and/or GPP XML files, especially on compromised domain controllers.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor for attempts to access SYSVOL that involve searching for XML files.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"]}}
