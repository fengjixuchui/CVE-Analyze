{"TTP_id": "enterprise-TA0002-T1059-T1059.005", "TTP_name": "Visual Basic", "Description": "Adversaries may abuse Visual Basic (VB) for execution. VB is a programming language created by Microsoft with interoperability with many Windows technologies such as Component Object Model and the Native API through the Windows API. Although tagged as legacy with no planned future evolutions, VB is integrated and supported in the .NET Framework and cross-platform .NET Core.[1][2]Derivative languages based on VB have also been created, such as Visual Basic for Applications (VBA) and VBScript. VBA is an event-driven programming language built into Microsoft Office, as well as several third-party applications.[3][4] VBA enables documents to contain macros used to automate the execution of tasks and other functionality on the host. VBScript is a default scripting language on Windows hosts and can also be used in place of JavaScript on HTML Application (HTA) webpages served to Internet Explorer (though most modern browsers do not come with VBScript support).[5]Adversaries may use VB payloads to execute malicious commands. Common malicious usage includes automating execution of behaviors with VBScript or embedding VBA content into Spearphishing Attachment payloads (which may also involve Mark-of-the-Web Bypass to enable execution).[6]", "Property": {"ID": "T1059.005", "Sub-technique of": "T1059", "Tactic": "Execution", "Platforms": "Linux, Windows, macOS", "Permissions Required": "Administrator, SYSTEM, User", "Version": "1.3", "Created": "09 March 2020", "Last Modified": "07 March 2022"}, "Examples": {"G0099": ["https://attack.mitre.org/groups/G0099", "APT-C-36", "APT-C-36 has embedded a VBScript within a malicious Word document which is executed upon the document opening.[7]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has written malware variants in Visual Basic.[8]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has used macros, COM scriptlets, and VBS scripts.[9][10]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has used VBScript to initiate the delivery of payloads.[11]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 executes shellcode and a VBA script to decode Base64 strings.[12]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has used VBScript to execute commands and other operational tasks.[13]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has utilized malicious VBS scripts in malware.[14]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth has used malicious VBS e-mail attachments for execution.[15]"], "S0475": ["https://attack.mitre.org/software/S0475", "BackConfig", "BackConfig has used VBS to install its downloader component and malicious documents with VBA macro code.[16]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook has used malicious VBA code against the target system.[17]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal's dropper creates VBS scripts on the victim’s machine.[18][19]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has used VBS and VBE scripts for execution.[20][21]"], "S0631": ["https://attack.mitre.org/software/S0631", "Chaes", "Chaes has used VBscript to execute malicious code.[22]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has sent Word OLE compound documents with malicious obfuscated VBA macros that will run upon user execution.[23][24][25][26][27][28]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can use VBA to perform execution.[29][30][31]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie executes VBS scripts.[32]"], "G0142": ["https://attack.mitre.org/groups/G0142", "Confucius", "Confucius has used VBScript to execute malicious code.[33]"], "S0695": ["https://attack.mitre.org/software/S0695", "Donut", "Donut can generate shellcode outputs that execute via VBScript.[34]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet has sent Microsoft Word documents with embedded macros that will invoke scripts to download additional payloads. [35][36][37][38][39]"], "S0343": ["https://attack.mitre.org/software/S0343", "Exaramel for Windows", "Exaramel for Windows has a command to execute VBS scripts on the victim’s machine.[40]"], "S0679": ["https://attack.mitre.org/software/S0679", "Ferocious", "Ferocious has the ability to use Visual Basic scripts for execution.[41]"], "G0085": ["https://attack.mitre.org/groups/G0085", "FIN4", "FIN4 has used VBA macros to display a dialog box and collect victim credentials.[42][43]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 used VBS scripts to help perform tasks on the victim's machine.[44][45][46]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro can execute malicious VBA macros embedded in .xlsm files.[47]"], "G0101": ["https://attack.mitre.org/groups/G0101", "Frankenstein", "Frankenstein has used Word documents that prompts the victim to enable macros and run a Visual Basic script.[48]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has embedded malicious macros in document templates, which executed VBScript. Gamaredon Group has also delivered Microsoft Outlook VBA projects with embedded macros.[49][50][51][52][53]"], "S0477": ["https://attack.mitre.org/software/S0477", "Goopy", "Goopy has the ability to use a Microsoft Outlook backdoor macro to communicate with its C2.[10]"], "G0078": ["https://attack.mitre.org/groups/G0078", "Gorgon Group", "Gorgon Group has used macros in Spearphishing Attachments as well as executed VBScripts on victim machines.[54]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can use VBScript to execute malicious code.[15][55]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "One version of Helminth consists of VBScript scripts.[56]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa has used VBScript code on the victim's machine.[57]"], "G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Honeybee embeds a Visual Basic script within a malicious Word document as part of initial access; the script is executed when the Word document is opened.[58]"], "S0483": ["https://attack.mitre.org/software/S0483", "IcedID", "IcedID has used obfuscated VBA string expressions.[59]"], "G0100": ["https://attack.mitre.org/groups/G0100", "Inception", "Inception has used VBScript to execute malicious commands and payloads.[60][61]"], "S0528": ["https://attack.mitre.org/software/S0528", "Javali", "Javali has used embedded VBScript to download malicious payloads from C2.[15]"], "S0389": ["https://attack.mitre.org/software/S0389", "JCry", "JCry has used VBS scripts. [62]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT has been distributed as HTA files with VBScript.[63]"], "S0648": ["https://attack.mitre.org/software/S0648", "JSS Loader", "JSS Loader can download and execute VBScript files.[46]"], "S0585": ["https://attack.mitre.org/software/S0585", "Kerrdown", "Kerrdown can use a VBS base64 decoder function published by Motobit.[64]"], "S0387": ["https://attack.mitre.org/software/S0387", "KeyBoy", "KeyBoy uses VBS scripts for installing files and performing execution.[65]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used Visual Basic to download malicious payloads.[66][67][68][69] Kimsuky has also used malicious VBA macros within maldocs disguised as forms that trigger when a victim types any content into the lure.[69]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic performs most of its operations using Windows Script Host (VBScript) and runs arbitrary shellcode .[70]"], "S0669": ["https://attack.mitre.org/software/S0669", "KOCTOPUS", "KOCTOPUS has used VBScript to call wscript to execute a PowerShell command.[71]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used VBA and embedded macros in Word documents to execute malicious code.[72][73][74][75]"], "G0140": ["https://attack.mitre.org/groups/G0140", "LazyScripter", "LazyScripter has used VBScript to execute malicious code.[71]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has used VBScript.[76]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot has used VBS scripts and XLS macros for execution.[77]"], "S0582": ["https://attack.mitre.org/software/S0582", "LookBack", "LookBack has used VBA macros in Microsoft Word attachments to drop additional files to the host.[78]"], "G0095": ["https://attack.mitre.org/groups/G0095", "Machete", "Machete has embedded malicious macros within spearphishing attachments to download additional files.[79]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound malware has used VBS scripts for execution.[80]"], "S0530": ["https://attack.mitre.org/software/S0530", "Melcoz", "Melcoz can use VBS scripts to execute malicious DLLs.[15]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has used VBS code on victims’ systems.[81]"], "G0021": ["https://attack.mitre.org/groups/G0021", "Molerats", "Molerats used various implants, including those built with VBScript, on target machines.[82][83]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used VBScript files to execute its POWERSTATS payload, as well as macros.[84][85][86][87][88][89][90][91]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has embedded VBScript components in LNK files to download additional files and automate collection.[92][93][94]"], "S0228": ["https://attack.mitre.org/software/S0228", "NanHaiShu", "NanHaiShu executes additional VBScript code on the victim's machine.[95]"], "S0336": ["https://attack.mitre.org/software/S0336", "NanoCore", "NanoCore uses VBS files.[96]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE has been executed through use of VBScripts.[97][98]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used VBSscipt macros for execution on compromised hosts.[99]"], "S0264": ["https://attack.mitre.org/software/S0264", "OopsIE", "OopsIE creates and uses a VBScript as part of its persistent execution.[100][101]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used a VBScript to conduct reconnaissance on targeted systems.[102]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D uses Word macros for execution.[103]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork used Visual Basic Scripts (VBS) on victim machines.[104][105]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT has used Word documents with VBScripts to execute malicious activities.[106][107]"], "S0441": ["https://attack.mitre.org/software/S0441", "PowerShower", "PowerShower has the ability to save and execute VBScript.[60]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS can use VBScript (VBE) code for execution.[88][108]"], "S0147": ["https://attack.mitre.org/software/S0147", "Pteranodon", "Pteranodon can use a malicious VBS file for execution.[109]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use VBS to download and execute malicious files.[110][111][112][113][114][115]"], "S0269": ["https://attack.mitre.org/software/S0269", "QUADAGENT", "QUADAGENT uses VBScripts.[116]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay has included embedded Visual Basic scripts in malicious documents.[117][118]"], "G0075": ["https://attack.mitre.org/groups/G0075", "Rancor", "Rancor has used VBS scripts as well as embedded macros for execution.[119]"], "S0375": ["https://attack.mitre.org/software/S0375", "Remexi", "Remexi uses AutoIt and VBS scripts throughout its execution process.[120]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil has used obfuscated VBA macros for execution.[121][122]"], "S0240": ["https://attack.mitre.org/software/S0240", "ROKRAT", "ROKRAT has used Visual Basic for execution.[123]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has created VBScripts to run an SSH server.[124][125][126][127]"], "G0104": ["https://attack.mitre.org/groups/G0104", "Sharpshooter", "Sharpshooter's first-stage downloader was a VBA macro.[128]"], "S0589": ["https://attack.mitre.org/software/S0589", "Sibot", "Sibot executes commands using VBScript.[129]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has used VBScript to drop and execute malware loaders.[130]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used VBS scripts.[131]"], "S0226": ["https://attack.mitre.org/software/S0226", "Smoke Loader", "Smoke Loader adds a Visual Basic script in the Startup folder to deploy the payload.[132]"], "S0380": ["https://attack.mitre.org/software/S0380", "StoneDrill", "StoneDrill has several VBS scripts used throughout the malware's lifecycle.[133]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST used VBScripts to initiate the execution of payloads.[134]"], "G0062": ["https://attack.mitre.org/groups/G0062", "TA459", "TA459 has a VBScript for execution.[135]"], "G0092": ["https://attack.mitre.org/groups/G0092", "TA505", "TA505 has used VBS for code execution.[136][137][138][139]"], "G0134": ["https://attack.mitre.org/groups/G0134", "Transparent Tribe", "Transparent Tribe has crafted VBS-based malicious documents.[140][141]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has used VBS scripts throughout its operations.[142]"], "S0263": ["https://attack.mitre.org/software/S0263", "TYPEFRAME", "TYPEFRAME has used a malicious Word document for delivery with VBA macros for execution.[143]"], "S0386": ["https://attack.mitre.org/software/S0386", "Ursnif", "Ursnif droppers have used VBA macros to download and execute the malware's full executable payload.[144]"], "S0442": ["https://attack.mitre.org/software/S0442", "VBShower", "VBShower has the ability to execute VBScript files.[145]"], "S0689": ["https://attack.mitre.org/software/S0689", "WhisperGate", "WhisperGate can use a Visual Basic script to exclude the C:\\ drive from Windows Defender.[146][147]"], "G0112": ["https://attack.mitre.org/groups/G0112", "Windshift", "Windshift has used Visual Basic 6 (VB6) payloads.[148]"], "G0090": ["https://attack.mitre.org/groups/G0090", "WIRTE", "WIRTE has used VBScript in its operations.[149]"], "S0341": ["https://attack.mitre.org/software/S0341", "Xbash", "Xbash can execute malicious VBScript payloads on the victim’s machine.[150]"]}, "Mitigation": {"M1049": ["https://attack.mitre.org/mitigations/M1049", "Antivirus/Antimalware", "Anti-virus can be used to automatically quarantine suspicious files."], "M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Visual Basic scripts from executing potentially malicious downloaded content [151]."], "M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Turn off or restrict access to unneeded VB components."], "M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Use application control where appropriate. VBA macros obtained from the Internet, based on the file's Mark of the Web (MOTW) attribute, may be blocked from executing in Office applications (ex: Access, Excel, PowerPoint, Visio, and Word) by default starting in Windows Version 2203.[6]"], "M1021": ["https://attack.mitre.org/mitigations/M1021", "Restrict Web-Based Content", "Script blocking extensions can help prevent the execution of scripts and HTA files that may commonly be used during the exploitation process. For malicious code served up through ads, adblockers can help prevent that code from executing in the first place."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may abuse Visual Basic (VB) for execution.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Module Load": ["Monitor for the loading of modules associated with VB languages (ex: vbscript.dll).", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "Process Creation": ["Monitor for events associated with VB execution, such as Office applications spawning processes, usage of the Windows Script Host (typically cscript.exe or wscript.exe). VB execution is likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
