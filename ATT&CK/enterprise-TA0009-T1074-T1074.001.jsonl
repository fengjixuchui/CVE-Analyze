{"TTP_id": "enterprise-TA0009-T1074-T1074.001", "TTP_name": "Local Data Staging", "Description": "Adversaries may stage collected data in a central location or directory on the local system prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as Archive Collected Data. Interactive command shells may be used, and common functionality within cmd and bash may be used to copy data into a staging location.Adversaries may also stage collected data in various available formats/locations of a system, including local storage databases/repositories or the Windows Registry.[1]", "Property": {"ID": "T1074.001", "Sub-technique of": "T1074", "Tactic": "Collection", "Platforms": "Linux, Windows, macOS", "Contributors": "Massimiliano Romano, BT Security", "Version": "1.1", "Created": "13 March 2020", "Last Modified": "21 April 2022"}, "Examples": {"S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "ADVSTORESHELL stores output from command execution in a .dat file in the %TEMP% directory.[2]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed can stage files in a central location prior to exfiltration.[3]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has stored captured credential information in a file named pi.log.[4]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has been known to stage files for exfiltration in a single location.[5]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has utilized tools to aggregate data prior to exfiltration.[6]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth collects data in a plaintext file named r1.log before exfiltration. [7]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor has staged collected data in a central upload directory prior to exfiltration.[8]"], "G0135": ["https://attack.mitre.org/groups/G0135", "BackdoorDiplomacy", "BackdoorDiplomacy has copied files of interest to the main drive's recycle bin.[9]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "BADNEWS copies documents under 15MB found on the victim system to is the user's %temp%\\SMB\\ folder. It also copies files from USB devices to a predefined directory.[10][11]"], "S0337": ["https://attack.mitre.org/software/S0337", "BadPatch", "BadPatch stores collected data in log files before exfiltration.[12]"], "S0651": ["https://attack.mitre.org/software/S0651", "BoxCaon", "BoxCaon has created a working folder for collected files that it sends to the C2 server.[13]"], "S0274": ["https://attack.mitre.org/software/S0274", "Calisto", "Calisto uses a hidden directory named .calisto to store data from the victimâ€™s machine before exfiltration.[14][15]"], "S0335": ["https://attack.mitre.org/software/S0335", "Carbon", "Carbon creates a base directory that contains the files and folders that are collected.[16]"], "S0261": ["https://attack.mitre.org/software/S0261", "Catchamas", "Catchamas stores the gathered data from the machine in .db files and .bmp files under four separate locations.[17]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has staged stolen data locally on compromised hosts.[18]"], "S0667": ["https://attack.mitre.org/software/S0667", "Chrommme", "Chrommme can store captured system information locally prior to exfiltration.[19]"], "S0538": ["https://attack.mitre.org/software/S0538", "Crutch", "Crutch has staged stolen files in the C:\\AMD\\Temp directory.[20]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can stage local data in the Windows Registry.[1]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has created a directory named \"out\" in the user's %AppData% folder and copied files to it.[21]"], "S0567": ["https://attack.mitre.org/software/S0567", "Dtrack", "Dtrack can save collected data to disk, different file formats, and network shares.[22][23]"], "S0038": ["https://attack.mitre.org/software/S0038", "Duqu", "Modules can be pushed to and executed by Duqu that copy data to a staging area, compress it, and XOR encrypt it.[24]"], "S0062": ["https://attack.mitre.org/software/S0062", "DustySky", "DustySky created folders in temp directories to host collected files before exfiltration.[25]"], "S0024": ["https://attack.mitre.org/software/S0024", "Dyre", "Dyre has the ability to create files in a TEMP folder to act as a database to store information.[26]"], "S0593": ["https://attack.mitre.org/software/S0593", "ECCENTRICBANDWAGON", "ECCENTRICBANDWAGON has stored keystrokes and screenshots within the %temp%\\GoogleChrome, %temp%\\Downloads, and %temp%\\TrendMicroUpdate directories.[27]"], "S0081": ["https://attack.mitre.org/software/S0081", "Elise", "Elise creates a file in AppData\\Local\\Microsoft\\Windows\\Explorer and stores all harvested data in that file.[28]"], "S0343": ["https://attack.mitre.org/software/S0343", "Exaramel for Windows", "Exaramel for Windows specifies a path to store files scheduled for exfiltration.[29]"], "G0053": ["https://attack.mitre.org/groups/G0053", "FIN5", "FIN5 scripts save memory dump data into a specific directory on hosts in the victim environment.[30]"], "S0036": ["https://attack.mitre.org/software/S0036", "FLASHFLOOD", "FLASHFLOOD stages data it copies from the local system or removable drives in the \"%WINDIR%\\$NtUninstallKB885884$\\\" directory.[31]"], "S0503": ["https://attack.mitre.org/software/S0503", "FrameworkPOS", "FrameworkPOS can identifiy payment card track data on the victim and copy it to a local file in a subdirectory of C:\\Windows.[32]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM compressed and staged files in multi-part archives in the Recycle Bin prior to exfiltration.[33]"], "S0249": ["https://attack.mitre.org/software/S0249", "Gold Dragon", "Gold Dragon stores information gathered from the endpoint in a file named 1.hwp.[34]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "Helminth creates folders to store output from batch scripts prior to sending the information to its C2 server.[35]"], "G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Honeybee adds collected files to a temp.zip file saved in the %temp% folder, then base64 encodes it and uploads it to control server.[36]"], "G0119": ["https://attack.mitre.org/groups/G0119", "Indrik Spider", "Indrik Spider has stored collected date in a .tmp file.[37]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole determines a working directory where it stores all the gathered data about the compromised machine.[38][39]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar stages command output and collected data in files before exfiltration.[40]"], "S0526": ["https://attack.mitre.org/software/S0526", "KGH_SPY", "KGH_SPY can save collected system information to a file named \"info\" before exfiltration.[41]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has staged collected data files under C:\\Program Files\\Common Files\\System\\Ole DB\\.[42][43]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is saved in the %TEMP% directory, then compressed, encrypted, and uploaded to a C2 server.[44][45]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has used C:\\Windows\\Debug and C:\\Perflogs as staging directories.[46][47]"], "S0395": ["https://attack.mitre.org/software/S0395", "LightNeuron", "LightNeuron can store email data in files and directories specified in its configuration, such as C:\\Windows\\ServiceProfiles\\NetworkService\\appdata\\Local\\Temp\\.[48]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete stores files and logs in a folder on the local drive.[49][50]"], "S0652": ["https://attack.mitre.org/software/S0652", "MarkiRAT", "MarkiRAT can store collected data locally in a created .nfo file.[51]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass stages data prior to exfiltration in multi-part archives, often saved in the Recycle Bin.[52]"], "S0443": ["https://attack.mitre.org/software/S0443", "MESSAGETAP", "MESSAGETAP stored targeted SMS messages that matched its target list in CSV files on the compromised system.[53]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind saves information from its keylogging routine as a .zip file in the present working directory.[54]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has stored collected credential files in c:\\windows\\temp prior to exfiltration. Mustang Panda has also stored documents for exfiltration in a hidden folder on USB drives.[55][56]"], "S0247": ["https://attack.mitre.org/software/S0247", "NavRAT", "NavRAT writes multiple outputs to a TMP file using the >> method.[57]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE has the ability to write collected data to a file created in the ./LOGS directory.[58]"], "S0353": ["https://attack.mitre.org/software/S0353", "NOKKI", "NOKKI can collect data from the victim and stage it in LOCALAPPDATA%\\MicroSoft Updatea\\uplog.tmp.[59]"], "S0644": ["https://attack.mitre.org/software/S0644", "ObliqueRAT", "ObliqueRAT can copy specific files, webcam captures, and screenshots to local directories.[60]"], "S0340": ["https://attack.mitre.org/software/S0340", "Octopus", "Octopus has stored collected information in the Application Data directory on a compromised host.[61][62]"], "S0264": ["https://attack.mitre.org/software/S0264", "OopsIE", "OopsIE stages the output from command execution and collected files in specific folders before exfiltration.[63]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has staged archived files in a temporary directory prior to exfiltration.[64]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork copied all targeted files to a directory called index that was eventually uploaded to the C&C server.[11]"], "S0012": ["https://attack.mitre.org/software/S0012", "PoisonIvy", "PoisonIvy stages collected data in a text file.[65]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "Prikormka creates a directory, %USERPROFILE%\\AppData\\Local\\SKC\\, which is used to store collected log files.[66]"], "S0147": ["https://attack.mitre.org/software/S0147", "Pteranodon", "Pteranodon creates various subdirectories under %Temp%\\reports\\% and copies files to those subdirectories. It also creates a folder at C:\\Users\\\\AppData\\Roaming\\Microsoft\\store to store screenshot JPEG files.[67]"], "S0196": ["https://attack.mitre.org/software/S0196", "PUNCHBUGGY", "PUNCHBUGGY has saved information to a random temp file before exfil.[68]"], "S0197": ["https://attack.mitre.org/software/S0197", "PUNCHTRACK", "PUNCHTRACK aggregates collected data in a tmp file.[69]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot has stored stolen emails and other data into new folders prior to exfiltration.[70]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay can use a file exfiltration tool to copy files to C:\\ProgramData\\Adobe\\temp prior to exfiltration.[71]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can stage data prior to exfiltration in %APPDATA%\\Microsoft\\UserSetting and %APPDATA%\\Microsoft\\UserSetting\\MediaCache.[72][73]"], "S0169": ["https://attack.mitre.org/software/S0169", "RawPOS", "Data captured by RawPOS is placed in a temporary file under a directory named \"memdump\".[74]"], "S0090": ["https://attack.mitre.org/software/S0090", "Rover", "Rover copies files from removable drives to C:\\system.[75]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has collected stolen files in a temporary folder in preparation for exfiltration.[76]"], "S0615": ["https://attack.mitre.org/software/S0615", "SombRAT", "SombRAT can store harvested data in a custom database under the %TEMP% directory.[77]"], "S0035": ["https://attack.mitre.org/software/S0035", "SPACESHIP", "SPACESHIP identifies files with certain extensions and copies them to a directory in the user's profile.[31]"], "G0088": ["https://attack.mitre.org/groups/G0088", "TEMP.Veles", "TEMP.Veles has created staging folders in directories that were infrequently used by legitimate users or processes.[78]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has locally staged encrypted archives for later exfiltration efforts.[79]"], "S0094": ["https://attack.mitre.org/software/S0094", "Trojan.Karagany", "Trojan.Karagany can create directories to store plugin output and stage data for exfiltration.[80][81]"], "S0647": ["https://attack.mitre.org/software/S0647", "Turian", "Turian can store copied files in a specific directory prior to exfiltration.[9]"], "S0386": ["https://attack.mitre.org/software/S0386", "Ursnif", "Ursnif has used tmp files to stage gathered information.[82]"], "S0136": ["https://attack.mitre.org/software/S0136", "USBStealer", "USBStealer collects files matching certain criteria from the victim and stores them in a local directory for later exfiltration.[83][84]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy stores all collected information in a single file before exfiltration.[85]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments arguments for actions that could be taken to collect and combine files. Remote access tools with built-in features may interact directly with the Windows API to gather and copy to a location. Data may also be acquired and staged through Windows system management tools such as Windows Management Instrumentation and PowerShell.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor processes that appear to be reading files from disparate locations and writing them to the same directory or file may be an indication of data being staged, especially if they are suspected of performing encryption or compression on the files, such as 7zip, RAR, ZIP, or zlib.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Creation": ["Monitor publicly writeable directories, central locations, and commonly used staging directories (recycle bin, temp folders, etc.) to regularly check for compressed or encrypted data that may be indicative of staging.", "", "", ""], "Windows Registry Key Modification": ["Consider monitoring accesses and modifications to local storage repositories (such as the Windows Registry), especially from suspicious processes that could be related to malicious data collection.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
