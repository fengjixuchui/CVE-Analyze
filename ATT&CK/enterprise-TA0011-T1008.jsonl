{"TTP_id": "enterprise-TA0011-T1008", "TTP_name": "Fallback Channels", "Description": "Adversaries may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds.", "Property": {"ID": "T1008", "Sub-techniques": "No sub-techniques", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "31 May 2017", "Last Modified": "14 July 2020"}, "Examples": {"S0504": ["https://attack.mitre.org/software/S0504", "Anchor", "Anchor can use secondary C2 servers for communication after establishing connectivity and relaying victim information to primary C2 servers.[1]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed can use a second channel for C2 when the primary channel is in upload mode.[2]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used the Steam community page as a fallback mechanism for C2.[3]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar has the ability to use an alternative C2 server if the primary server fails.[4]"], "S0017": ["https://attack.mitre.org/software/S0017", "BISCUIT", "BISCUIT malware contains a secondary fallback command and control server that is contacted after the primary command and control server.[5][6]"], "S0089": ["https://attack.mitre.org/software/S0089", "BlackEnergy", "BlackEnergy has the capability to communicate over a backup channel via plus.google.com.[7]"], "S0348": ["https://attack.mitre.org/software/S0348", "Cardinal RAT", "Cardinal RAT can communicate over multiple C2 host and port combinations.[8]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower can change its C2 channel once every 360 loops by retrieving a new domain from the actorsâ€™ S3 bucket.[9]"], "S0023": ["https://attack.mitre.org/software/S0023", "CHOPSTICK", "CHOPSTICK can switch to a new C2 channel if the current one is broken.[10]"], "S0538": ["https://attack.mitre.org/software/S0538", "Crutch", "Crutch has used a hardcoded GitHub repository as a fallback channel.[11]"], "S0021": ["https://attack.mitre.org/software/S0021", "Derusbi", "Derusbi uses a backup communication method with an HTTP beacon.[12]"], "S0062": ["https://attack.mitre.org/software/S0062", "DustySky", "DustySky has two hard-coded domains for C2 servers; if the first does not respond, it will try the second.[13]"], "S0377": ["https://attack.mitre.org/software/S0377", "Ebury", "Ebury has implemented a fallback mechanism to begin using a DGA when the attacker hasn't connected to the infected system for three days.[14]"], "S0401": ["https://attack.mitre.org/software/S0401", "Exaramel for Linux", "Exaramel for Linux can attempt to find a new C2 server if it receives an error.[15]"], "S0512": ["https://attack.mitre.org/software/S0512", "FatDuke", "FatDuke has used several C2 servers per targeted organization.[16]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7's Harpy backdoor malware can use DNS as a backup channel for C2 if HTTP fails.[17]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium can use multiple domains and protocols in C2.[18]"], "S0376": ["https://attack.mitre.org/software/S0376", "HOPLIGHT", "HOPLIGHT has multiple C2 channels in place in case one fails.[19]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole has been configured with several servers available for alternate C2 communications.[20][21]"], "S0044": ["https://attack.mitre.org/software/S0044", "JHUHUGIT", "JHUHUGIT tests if it can reach its C2 server by first attempting a direct connection, and if it fails, obtaining proxy settings and sending the connection through a proxy, and finally injecting code into a running browser if the proxy method fails.[22]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar can accept multiple URLs for C2 servers.[23]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs uses a large list of C2 servers that it cycles through until a successful connection is established.[24]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware SierraAlfa sends data to one of the hard-coded C2 servers chosen at random, and if the transmission fails, chooses a new C2 server to attempt the transmission again.[25][26]"], "S0211": ["https://attack.mitre.org/software/S0211", "Linfo", "Linfo creates a backdoor through which remote attackers can change C2 servers.[27]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete has sent data over HTTP if FTP failed, and has also used a fallback server.[28]"], "S0051": ["https://attack.mitre.org/software/S0051", "MiniDuke", "MiniDuke uses Google Search to identify C2 servers if its primary C2 method via Twitter is not working.[29]"], "S0084": ["https://attack.mitre.org/software/S0084", "Mis-Type", "Mis-Type first attempts to use a Base64-encoded network protocol over a raw TCP socket for C2, and if that method fails, falls back to a secondary HTTP-based protocol to communicate to an alternate C2 server.[30]"], "S0699": ["https://attack.mitre.org/software/S0699", "Mythic", "Mythic can use a list of C2 URLs as fallback mechanisms in case one IP or domain gets blocked.[31]"], "S0034": ["https://attack.mitre.org/software/S0034", "NETEAGLE", "NETEAGLE will attempt to detect if the infected host is configured to a proxy. If so, NETEAGLE will send beacons via an HTTP POST request; otherwise it will send beacons via UDP/6000.[32]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig malware ISMAgent falls back to its DNS tunneling mechanism if it is unable to reach the C2 server over HTTP.[33]"], "S0501": ["https://attack.mitre.org/software/S0501", "PipeMon", "PipeMon can switch to an alternate C2 domain when a particular date has been reached.[34]"], "S0269": ["https://attack.mitre.org/software/S0269", "QUADAGENT", "QUADAGENT uses multiple protocols (HTTPS, HTTP, DNS) for its C2 server as fallback channels if communication with one is unsuccessful.[35]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay has the ability to switch between TCP and HTTP for C2 if one method is not working.[36]"], "S0495": ["https://attack.mitre.org/software/S0495", "RDAT", "RDAT has used HTTP if DNS C2 communications were not functioning.[37]"], "S0085": ["https://attack.mitre.org/software/S0085", "S-Type", "S-Type primarily uses port 80 for C2, but falls back to ports 443 or 8080 if initial communication fails.[30]"], "S0444": ["https://attack.mitre.org/software/S0444", "ShimRat", "ShimRat has used a secondary C2 location if the first was unavailable.[38]"], "S0610": ["https://attack.mitre.org/software/S0610", "SideTwist", "SideTwist has primarily used port 443 for C2 but can use port 80 as a fallback.[39]"], "S0058": ["https://attack.mitre.org/software/S0058", "SslMM", "SslMM has a hard-coded primary and backup C2 string.[40]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet has the ability to generate new C2 domains.[41]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "TAINTEDSCRIBE can randomly pick one of five hard-coded IP addresses for C2 communication; if one of the IP fails, it will wait 60 seconds and then try another IP address.[42]"], "S0668": ["https://attack.mitre.org/software/S0668", "TinyTurla", "TinyTurla can go through a list of C2 server IPs and will try to register with each until one responds.[43]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot can use secondary C2 servers for communication after establishing connectivity and relaying victim information to primary C2 servers.[1]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak can communicate over multiple C2 hosts.[44]"], "S0059": ["https://attack.mitre.org/software/S0059", "WinMM", "WinMM is usually configured with primary and backup domains for C2 communications.[40]"], "S0117": ["https://attack.mitre.org/software/S0117", "XTunnel", "The C2 server used by XTunnel provides a port number to the victim to use as a fallback in case the connection closes on the currently used port.[10]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. [45]"]}, "Detection": {"Network Connection Creation": ["Monitor for newly constructed network connections that may use fallback or alternate communication channels if the primary channel is compromised or inaccessible in order to maintain reliable command and control and to avoid data transfer thresholds. Processes utilizing the network that do not normally have network communication or have never been seen before may be suspicious.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data for uncommon data flows, such as unexpected surges or other abnormal inbound/outbound patterns.", "", "", ""]}}
