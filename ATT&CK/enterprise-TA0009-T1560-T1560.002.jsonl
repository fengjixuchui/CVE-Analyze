{"TTP_id": "enterprise-TA0009-T1560-T1560.002", "TTP_name": "Archive via Library", "Description": "An adversary may compress or encrypt data that is collected prior to exfiltration using 3rd party libraries. Many libraries exist that can archive data, including Python rarfile [1], libzip [2], and zlib [3]. Most libraries include functionality to encrypt and/or compress data.Some archival libraries are preinstalled on systems, such as bzip2 on macOS and Linux, and zip on Windows. Note that the libraries are different from the utilities. The libraries can be linked against when compiling, while the utilities require spawning a subshell, or a similar execution mechanism.", "Property": {"ID": "T1560.002", "Sub-technique of": "T1560", "Tactic": "Collection", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "20 February 2020", "Last Modified": "29 March 2020"}, "Examples": {"S0642": ["https://attack.mitre.org/software/S0642", "BADFLICK", "BADFLICK has compressed data using the aPLib compression library.[4]"], "S0127": ["https://attack.mitre.org/software/S0127", "BBSRAT", "BBSRAT can compress data with ZLIB prior to sending it back to the C2 server.[5]"], "S0348": ["https://attack.mitre.org/software/S0348", "Cardinal RAT", "Cardinal RAT applies compression to C2 traffic using the ZLIB library.[6]"], "S0354": ["https://attack.mitre.org/software/S0354", "Denis", "Denis compressed collected data using zlib.[7]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic compresses the collected data with bzip2 before sending it to the C2 server.[8]"], "S0661": ["https://attack.mitre.org/software/S0661", "FoggyWeb", "FoggyWeb can invoke the Common.Compress method to compress data with the C# GZipStream compression class.[9]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can use zlib to compress and decompress data.[10][11]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware IndiaIndia saves information gathered about the victim to a file that is compressed with Zlib, encrypted, and uploaded to a C2 server.[12][13]"], "S0053": ["https://attack.mitre.org/software/S0053", "SeaDuke", "SeaDuke compressed data with zlib prior to sending it over C2.[14]"], "S0467": ["https://attack.mitre.org/software/S0467", "TajMahal", "TajMahal has the ability to use the open source libraries XZip/Xunzip and zlib to compress files.[15]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used RAR to compress, encrypt, and password-protect files prior to exfiltration.[16]"], "S0086": ["https://attack.mitre.org/software/S0086", "ZLib", "The ZLib backdoor compresses communications using the standard Zlib compression library.[17]"]}, "Mitigation": {}, "Detection": {"File Creation": ["Monitor newly constructed files being written with extensions and/or headers associated with compressed or encrypted file types. Detection efforts may focus on follow-on exfiltration activity, where compressed or encrypted files can be detected in transit with a network intrusion detection or data loss prevention system analyzing file headers.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
