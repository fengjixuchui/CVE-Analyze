{"TTP_id": "enterprise-TA0009-T1560", "TTP_name": "Archive Collected Data", "Description": "An adversary may compress and/or encrypt data that is collected prior to exfiltration. Compressing the data can help to obfuscate the collected data and minimize the amount of data sent over the network. Encryption can be used to hide information that is being exfiltrated from detection or make exfiltration less conspicuous upon inspection by a defender.Both compression and encryption are done prior to exfiltration, and can be performed using a utility, 3rd party library, or custom method.", "Property": {"ID": "T1560", "Sub-techniques": "T1560.001, T1560.002, T1560.003", "Tactic": "Collection", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "20 February 2020", "Last Modified": "04 January 2022"}, "Examples": {"S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "ADVSTORESHELL encrypts with the 3DES algorithm and a hardcoded key prior to exfiltration.[1]"], "S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla can encrypt data with 3DES before sending it over to a C2 server.[2]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed has compressed collected data before exfiltration.[3]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 used a publicly available tool to gather and compress multiple documents on the DCCC and DNC networks.[4]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32's backdoor has used LZMA compression and RC4 encryption before exfiltration.[5]"], "S0456": ["https://attack.mitre.org/software/S0456", "Aria-body", "Aria-body has used ZIP to compress data gathered on a compromised host.[6]"], "G0001": ["https://attack.mitre.org/groups/G0001", "Axiom", "Axiom has compressed and encrypted data prior to exfiltration.[7]"], "S0093": ["https://attack.mitre.org/software/S0093", "Backdoor.Oldrea", "Backdoor.Oldrea writes collected data to a temporary file in an encrypted form before exfiltration to a C2 server.[8]"], "S0521": ["https://attack.mitre.org/software/S0521", "BloodHound", "BloodHound can compress data collected by its SharpHound ingestor into a ZIP file to be written to disk.[9]"], "S0657": ["https://attack.mitre.org/software/S0657", "BLUELIGHT", "BLUELIGHT can zip files before exfiltration.[10]"], "S0454": ["https://attack.mitre.org/software/S0454", "Cadelspy", "Cadelspy has the ability to compress stolen data into a .cab file.[11]"], "S0667": ["https://attack.mitre.org/software/S0667", "Chrommme", "Chrommme can encrypt and store on disk collected data before exfiltration.[12]"], "S0187": ["https://attack.mitre.org/software/S0187", "Daserf", "Daserf hides collected data in password-protected .rar archives.[13]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has compressed data into .zip files prior to exfiltration.[14]"], "S0567": ["https://attack.mitre.org/software/S0567", "Dtrack", "Dtrack packs collected data into a password protected archive.[15]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet has been observed encrypting the data it collects before sending it to the C2 server. [16]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can ZIP directories on the target system.[17]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic encrypts collected data using a public key framework before sending it over the C2 channel.[18] Some variants encrypt the collected data with AES and encode it with base64 before transmitting it to the C2 server.[19]"], "S0343": ["https://attack.mitre.org/software/S0343", "Exaramel for Windows", "Exaramel for Windows automatically encrypts files before sending them to the C2 server.[20]"], "S0267": ["https://attack.mitre.org/software/S0267", "FELIXROOT", "FELIXROOT encrypts collected data with AES and Base64 and then sends it to the C2 server.[21]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "Following data collection, FIN6 has compressed log files into a ZIP archive prior to staging and exfiltration.[22]"], "S0249": ["https://attack.mitre.org/software/S0249", "Gold Dragon", "Gold Dragon encrypts data using Base64 before being sent to the command and control server.[23]"], "G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Honeybee adds collected files to a temp.zip file saved in the %temp% folder, then base64 encodes it and uploads it to control server.[24]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "The Ke3chang group has been known to compress data before exfiltration.[25]"], "S0487": ["https://attack.mitre.org/software/S0487", "Kessel", "Kessel can RC4-encrypt credentials before sending to the C2.[26]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has encrypted data and files prior to exfiltration.[27]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has compressed exfiltrated data with RAR and used RomeoDelta malware to archive specified directories in .zip format, encrypt the .zip file, and upload it to C2. [28][29][30][31]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has archived victim's data prior to exfiltration.[32]"], "S0395": ["https://attack.mitre.org/software/S0395", "LightNeuron", "LightNeuron contains a function to encrypt and store emails that it collects.[33]"], "S0681": ["https://attack.mitre.org/software/S0681", "Lizar", "Lizar has encrypted data before sending it to the server.[34]"], "S0010": ["https://attack.mitre.org/software/S0010", "Lurid", "Lurid can compress data before sending it.[35]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete stores zipped files with profile data from installed web browsers.[36]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has encrypted files and information before exfiltration.[37][38]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE has the ability to compress archived screenshots.[39]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork encrypted the collected files' path with AES and then encoded them with base64.[40]"], "S0517": ["https://attack.mitre.org/software/S0517", "Pillowmint", "Pillowmint has encrypted stolen credit card information with AES and further encoded it with Base64.[41]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "After collecting documents from removable media, Prikormka compresses the collected files, and encrypts it with Blowfish.[42]"], "S0279": ["https://attack.mitre.org/software/S0279", "Proton", "Proton zips up files before exfiltrating them.[43]"], "S0375": ["https://attack.mitre.org/software/S0375", "Remexi", "Remexi encrypts and adds all gathered browser data into files for upload to C2.[44]"], "S0253": ["https://attack.mitre.org/software/S0253", "RunningRAT", "RunningRAT contains code to compress files.[23]"], "S0445": ["https://attack.mitre.org/software/S0445", "ShimRatReporter", "ShimRatReporter used LZ compression to compress initial reconnaissance reports before sending to the C2.[45]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "TAINTEDSCRIBE has used FileReadZipSend to compress a file and send to C2.[46]"], "S0257": ["https://attack.mitre.org/software/S0257", "VERMIN", "VERMIN encrypts the collected files using 3-DES.[47]"], "S0515": ["https://attack.mitre.org/software/S0515", "WellMail", "WellMail can archive files on the compromised host.[48]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET will compress entire ~/Desktop folders excluding all .git folders, but only if the total data size is under 200MB.[49]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy has used a method similar to RC4 as well as AES for encryption and hexadecimal for encoding data before exfiltration. [50][51][52]"]}, "Mitigation": {"M1047": ["https://attack.mitre.org/mitigations/M1047", "Audit", "System scans can be performed to identify unauthorized archival utilities."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments for actions that will aid in compression or encrypting data that is collected prior to exfiltration, such as tar.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Creation": ["Monitor newly constructed files being written with extensions and/or headers associated with compressed or encrypted file types. Detection efforts may focus on follow-on exfiltration activity, where compressed or encrypted files can be detected in transit with a network intrusion detection or data loss prevention system analyzing file headers.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Process Creation": ["Monitor for newly constructed processes and/or command-lines that aid in compression or encrypting data that is collected prior to exfiltration, such as 7-Zip, WinRAR, and WinZip.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
