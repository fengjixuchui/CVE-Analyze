{"TTP_id": "enterprise-TA0003-T1137-T1137.003", "TTP_name": "Outlook Forms", "Description": "Adversaries may abuse Microsoft Outlook forms to obtain persistence on a compromised system. Outlook forms are used as templates for presentation and functionality in Outlook messages. Custom Outlook forms can be created that will execute code when a specifically crafted email is sent by an adversary utilizing the same custom Outlook form.[1]Once malicious forms have been added to the userâ€™s mailbox, they will be loaded when Outlook is started. Malicious forms will execute when an adversary sends a specifically crafted email to the user.[1]", "Property": {"ID": "T1137.003", "Sub-technique of": "T1137", "Tactic": "Persistence", "Platforms": "Office 365, Windows", "Permissions Required": "Administrator, User", "Version": "1.1", "Created": "07 November 2019", "Last Modified": "16 August 2021"}, "Examples": {"S0358": ["https://attack.mitre.org/software/S0358", "Ruler", "Ruler can be used to automate the abuse of Outlook Forms to establish persistence.[2]"]}, "Mitigation": {"M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. [3]"], "M1051": ["https://attack.mitre.org/mitigations/M1051", "Update Software", "For the Outlook methods, blocking macros may be ineffective as the Visual Basic engine used for these features is separate from the macro scripting engine.[1] Microsoft has released patches to try to address each issue. Ensure KB3191938 which blocks Outlook Visual Basic and displays a malicious code warning, KB4011091 which disables custom forms by default, and KB4011162 which removes the legacy Home Page feature, are applied to systems.[4]"]}, "Detection": {"Application Log Content": ["Monitor for third-party application logging, messaging, and/or other artifacts that may abuse Microsoft Outlook forms to obtain persistence on a compromised system. SensePost, whose tool Ruler can be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage.[5]", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "Command Execution": ["Monitor executed commands and arguments that may abuse Microsoft Outlook forms to obtain persistence on a compromised system. Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output.[6]", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes that may abuse Microsoft Outlook forms to obtain persistence on a compromised system.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
