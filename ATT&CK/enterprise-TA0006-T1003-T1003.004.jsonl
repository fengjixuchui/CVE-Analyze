{"TTP_id": "enterprise-TA0006-T1003-T1003.004", "TTP_name": "LSA Secrets", "Description": "Adversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts.[1][2][3] LSA secrets are stored in the registry at HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets. LSA secrets can also be dumped from memory.[4]Reg can be used to extract from the Registry. Mimikatz can be used to extract secrets from memory.[4]", "Property": {"ID": "T1003.004", "Sub-technique of": "T1003", "Tactic": "Credential Access", "Platforms": "Windows", "Permissions Required": "SYSTEM", "Contributors": "Ed Williams, Trustwave, SpiderLabs", "Version": "1.0", "Created": "21 February 2020", "Last Modified": "21 April 2021"}, "Examples": {"S0677": ["https://attack.mitre.org/software/S0677", "AADInternals", "AADInternals can dump secrets from the Local Security Authority.[5]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has used a variety of publicly available tools like LaZagne to gather credentials.[6][7]"], "S0050": ["https://attack.mitre.org/software/S0050", "CosmicDuke", "CosmicDuke collects LSA secrets.[8]"], "S0488": ["https://attack.mitre.org/software/S0488", "CrackMapExec", "CrackMapExec can dump hashed passwords from LSA secrets for the targeted system.[9]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has dropped and executed SecretsDump to dump password hashes.[10][11]"], "S0008": ["https://attack.mitre.org/software/S0008", "gsecdump", "gsecdump can dump LSA secrets.[12]"], "S0357": ["https://attack.mitre.org/software/S0357", "Impacket", "SecretsDump and Mimikatz modules within Impacket can perform credential dumping to obtain account and password information.[13]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has dumped credentials, including by using gsecdump.[14][15]"], "S0349": ["https://attack.mitre.org/software/S0349", "LaZagne", "LaZagne can perform credential dumping from LSA secrets to obtain account and password information.[16]"], "G0077": ["https://attack.mitre.org/groups/G0077", "Leafminer", "Leafminer used several tools for retrieving login and password information, including LaZagne.[17]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.[18][19]"], "S0002": ["https://attack.mitre.org/software/S0002", "Mimikatz", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA.[20][21][22][23]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has performed credential dumping with LaZagne.[24][25]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used credential dumping tools such as LaZagne to steal credentials to accounts logged into the compromised system and to Outlook Web Access.[26][27][28][29]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy can use Lazagne for harvesting credentials.[30]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 actors have used gsecdump to dump credentials. They have also dumped credentials from domain controllers.[31][32]"]}, "Mitigation": {"M1027": ["https://attack.mitre.org/mitigations/M1027", "Password Policies", "Ensure that local administrator accounts have complex, unique passwords across all systems on the network."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.[3]"], "M1017": ["https://attack.mitre.org/mitigations/M1017", "User Training", "Limit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may access to a host may attempt to access Local Security Authority (LSA) secrets. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,[33] which may require additional logging features to be configured in the operating system to collect necessary information for analysis.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Windows Registry Key Access": ["Monitor for the LSA secrets are stored in the registry at HKEY_LOCAL_MACHINE\\SECURITY\\Policy\\Secrets being accessed", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
