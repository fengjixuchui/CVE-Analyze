{"TTP_id": "enterprise-TA0011-T1132-T1132.001", "TTP_name": "Standard Encoding", "Description": "Adversaries may encode data with a standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a standard data encoding system that adheres to existing protocol specifications. Common data encoding schemes include ASCII, Unicode, hexadecimal, Base64, and MIME.[1] [2] Some data encoding systems may also result in data compression, such as gzip.", "Property": {"ID": "T1132.001", "Sub-technique of": "T1132", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Version": "1.0", "Created": "14 March 2020", "Last Modified": "14 March 2020"}, "Examples": {"S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "C2 traffic from ADVSTORESHELL is encrypted, then encoded with Base64 encoding.[3]"], "G0073": ["https://attack.mitre.org/groups/G0073", "APT19", "An APT19 HTTP malware variant used Base64 to encode communications to the C2 server.[4]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has used base64 to encode command and control traffic.[5]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth encodes data using Base64 before sending it to the C2 server. [6]"], "S0129": ["https://attack.mitre.org/software/S0129", "AutoIt backdoor", "AutoIt backdoor has sent a C2 response that was base64-encoded.[7]"], "S0414": ["https://attack.mitre.org/software/S0414", "BabyShark", "BabyShark has encoded data using certutil before exfiltration.[8]"], "S0093": ["https://attack.mitre.org/software/S0093", "Backdoor.Oldrea", "Some Backdoor.Oldrea samples use standard Base64 + bzip2, and some use standard Base64 + reverse XOR + RSA-2048 to decrypt data received from C2 servers.[9]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "BADNEWS encodes C2 traffic with base64.[7][10][11]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has encoded binary data with Base64 and ASCII.[12][13]"], "S0520": ["https://attack.mitre.org/software/S0520", "BLINDINGCAN", "BLINDINGCAN has encoded its C2 traffic with Base64.[14]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "Several BRONZE BUTLER tools encode data with base64 when posting it to a C2 server.[15]"], "S0014": ["https://attack.mitre.org/software/S0014", "BS2005", "BS2005 uses Base64 encoding for communication in the message body of an HTTP request.[16]"], "S0030": ["https://attack.mitre.org/software/S0030", "Carbanak", "Carbanak encodes the message body of HTTP traffic with Base64.[17][18]"], "S0631": ["https://attack.mitre.org/software/S0631", "Chaes", "Chaes has used Base64 to encode C2 communications.[19]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower can send additional modules over C2 encoded with base64.[20]"], "S0144": ["https://attack.mitre.org/software/S0144", "ChChes", "ChChes can encode C2 data with a custom technique that utilizes Base64.[21][22]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can use Base64, URL-safe Base64, or NetBIOS encoding in its C2 traffic.[23]"], "S0338": ["https://attack.mitre.org/software/S0338", "Cobian RAT", "Cobian RAT obfuscates communications with the C2 server using Base64 encoding.[24]"], "S0137": ["https://attack.mitre.org/software/S0137", "CORESHELL", "CORESHELL C2 messages are Base64-encoded.[25]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman encodes data using hexadecimal representation before sending it to the C2 server.[26]"], "S0187": ["https://attack.mitre.org/software/S0187", "Daserf", "Daserf uses custom base64 encoding to obfuscate HTTP traffic.[15]"], "S0354": ["https://attack.mitre.org/software/S0354", "Denis", "Denis encodes the data sent to the server in Base64.[27]"], "S0200": ["https://attack.mitre.org/software/S0200", "Dipsind", "Dipsind encodes C2 traffic with base64.[28]"], "S0472": ["https://attack.mitre.org/software/S0472", "down_new", "down_new has the ability to base64 encode C2 communications.[29]"], "S0377": ["https://attack.mitre.org/software/S0377", "Ebury", "Ebury has encoded C2 traffic in hexadecimal format.[30]"], "S0081": ["https://attack.mitre.org/software/S0081", "Elise", "Elise exfiltrates data using cookie values that are Base64-encoded.[31]"], "S0171": ["https://attack.mitre.org/software/S0171", "Felismus", "Some Felismus samples use a custom method for C2 traffic that utilizes Base64.[32]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro has encoded bidirectional data communications between a target system and C2 server using Base64.[33]"], "S0410": ["https://attack.mitre.org/software/S0410", "Fysbis", "Fysbis can use Base64 to encode its C2 traffic.[34]"], "S0032": ["https://attack.mitre.org/software/S0032", "gh0st RAT", "gh0st RAT has used Zlib to compress C2 communications data before encrypting it.[35]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can base64 encode C2 replies.[36]"], "G0125": ["https://attack.mitre.org/groups/G0125", "HAFNIUM", "HAFNIUM has used ASCII encoding for C2 traffic.[37]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "For C2 over HTTP, Helminth encodes data with base64 and sends it via the \"Cookie\" field of HTTP requests. For C2 over DNS, Helminth converts ASCII characters into their hexadecimal values and sends the data in cleartext.[38]"], "S0376": ["https://attack.mitre.org/software/S0376", "HOPLIGHT", "HOPLIGHT has utilized Zlib compression to obfuscate the communications payload. [39]"], "S0015": ["https://attack.mitre.org/software/S0015", "Ixeshe", "Ixeshe uses custom Base64 encoding schemes to obfuscate command and control traffic in the message body of HTTP requests.[40][41]"], "S0044": ["https://attack.mitre.org/software/S0044", "JHUHUGIT", "A JHUHUGIT variant encodes C2 POST data base64.[42]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar encodes communications to the C2 server in Base64.[43]"], "S0487": ["https://attack.mitre.org/software/S0487", "Kessel", "Kessel has exfiltrated data via hexadecimal-encoded subdomain fields of DNS queries.[44]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has used a custom base64 key to encode stolen data before exfiltration.[45]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "A Lazarus Group malware sample encodes data with base64.[46]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete has used base64 encoding.[47]"], "S0459": ["https://attack.mitre.org/software/S0459", "MechaFlounder", "MechaFlounder has the ability to use base16 encoded strings in C2.[48]"], "S0084": ["https://attack.mitre.org/software/S0084", "Mis-Type", "Mis-Type uses Base64 encoding for C2 traffic.[49]"], "S0083": ["https://attack.mitre.org/software/S0083", "Misdat", "Misdat network traffic is Base64-encoded plaintext.[49]"], "S0284": ["https://attack.mitre.org/software/S0284", "More_eggs", "More_eggs has used basE91 encoding, along with encryption, for C2 communication.[50]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used tools to encode C2 communications including Base64 encoding.[51][52]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT uses Base64 encoding for C2 traffic.[53]"], "S0340": ["https://attack.mitre.org/software/S0340", "Octopus", "Octopus has encoded C2 communications in Base64.[54]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum has used base64 to encode C2 communication.[55]"], "S0264": ["https://attack.mitre.org/software/S0264", "OopsIE", "OopsIE encodes data in hexadecimal format over the C2 channel.[56]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork used Base64 to encode C2 traffic.[57]"], "S0124": ["https://attack.mitre.org/software/S0124", "Pisloader", "Responses from the Pisloader C2 server are base32-encoded.[58]"], "S0441": ["https://attack.mitre.org/software/S0441", "PowerShower", "PowerShower has the ability to encode C2 communications with base64 encoding.[59][60]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS encoded C2 traffic with base64.[61]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER can use base64 encoded C2 communications.[62]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "Prikormka encodes C2 traffic with Base64.[63]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can Base64 encode system information sent to C2.[64][65]"], "S0269": ["https://attack.mitre.org/software/S0269", "QUADAGENT", "QUADAGENT encodes C2 communications with base64.[66]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay has used base64 to encode its C2 traffic.[67]"], "S0495": ["https://attack.mitre.org/software/S0495", "RDAT", "RDAT can communicate with the C2 via base32-encoded subdomains.[68]"], "S0379": ["https://attack.mitre.org/software/S0379", "Revenge RAT", "Revenge RAT uses Base64 to encode information sent to the C2 server.[69]"], "S0270": ["https://attack.mitre.org/software/S0270", "RogueRobin", "RogueRobin base64 encodes strings that are sent to the C2 over its DNS tunnel.[70]"], "S0085": ["https://attack.mitre.org/software/S0085", "S-Type", "S-Type uses Base64 encoding for C2 traffic.[49]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team's BCS-server tool uses base64 encoding and HTML tags for the communication traffic between the C2 server.[71]"], "S0053": ["https://attack.mitre.org/software/S0053", "SeaDuke", "SeaDuke C2 traffic is base64-encoded.[72]"], "S0610": ["https://attack.mitre.org/software/S0610", "SideTwist", "SideTwist has used Base64 for encoded C2 traffic.[73]"], "S0633": ["https://attack.mitre.org/software/S0633", "Sliver", "Sliver can use standard encoding techniques like gzip and hex to ASCII to encode the C2 communication payload.[74]"], "S0649": ["https://attack.mitre.org/software/S0649", "SMOKEDHAM", "SMOKEDHAM has encoded its C2 traffic with Base64.[75]"], "S0543": ["https://attack.mitre.org/software/S0543", "Spark", "Spark has encoded communications with the C2 server with base64.[76]"], "S0374": ["https://attack.mitre.org/software/S0374", "SpeakUp", "SpeakUp encodes C&C communication using Base64. [77]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet transforms encrypted binary data into an ASCII string in order to use it as a URL parameter value.[78]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST used Base64 encoding in its C2 traffic.[79]"], "G0127": ["https://attack.mitre.org/groups/G0127", "TA551", "TA551 has used encoded ASCII text for initial C2 communications.[80]"], "S0678": ["https://attack.mitre.org/software/S0678", "Torisma", "Torisma has encoded C2 communications with Base64.[81]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot can Base64-encode C2 commands.[82]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper has used base64 encoding to hide command strings delivered from the C2.[83]"], "S0476": ["https://attack.mitre.org/software/S0476", "Valak", "Valak has returned C2 data as encoded ASCII.[80]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess has used Base64 encoding to uniquely identify communication to and from the C2.[84]"], "S0653": ["https://attack.mitre.org/software/S0653", "xCaon", "xCaon has used Base64 to encode its C2 traffic.[85]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy has used URL/Percent Encoding on data exfiltrated via HTTP POST requests.[86]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific obfuscation technique used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools."]}, "Detection": {"Network Traffic Content": ["Monitor for network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"]}}
