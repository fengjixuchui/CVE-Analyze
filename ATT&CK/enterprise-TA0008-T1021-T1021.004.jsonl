{"TTP_id": "enterprise-TA0008-T1021-T1021.004", "TTP_name": "SSH", "Description": "Adversaries may use Valid Accounts to log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user.SSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user’s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user.", "Property": {"ID": "T1021.004", "Sub-technique of": "T1021", "Tactic": "Lateral Movement", "Platforms": "Linux, macOS", "System Requirements": "An SSH server is configured and running.", "CAPEC ID": "CAPEC-555", "Version": "1.1", "Created": "11 February 2020", "Last Modified": "15 October 2021"}, "Examples": {"G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 used secure shell (SSH) to move laterally among their targets.[1]"], "G0098": ["https://attack.mitre.org/groups/G0098", "BlackTech", "BlackTech has used Putty for remote access.[2]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can SSH to a remote service.[3][4]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire contains modules for executing commands over SSH as well as in-memory VNC agent injection.[5]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 has used SSH to move laterally through victim environments.[6]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used the PuTTY and Plink tools for lateral movement.[7]"], "G0036": ["https://attack.mitre.org/groups/G0036", "GCMAN", "GCMAN uses Putty for lateral movement.[8]"], "S0599": ["https://attack.mitre.org/software/S0599", "Kinsing", "Kinsing has used SSH for lateral movement.[9]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group used SSH and the PuTTy PSCP utility to gain access to a restricted segment of a compromised network.[10]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan used ssh for internal reconnaissance.[11]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used Putty Secure Copy Client (PSCP) to transfer data.[12]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used Putty to access compromised systems.[13]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke has spread its coinminer via SSH.[14]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has used SSH to connect back to victim machines.[15]"], "G0088": ["https://attack.mitre.org/groups/G0088", "TEMP.Veles", "TEMP.Veles has relied on encrypted SSH-based tunnels to transfer tools and for remote command/program execution.[16]"]}, "Mitigation": {"M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Disable the SSH daemon on systems that do not require it. For macOS ensure Remote Login is disabled under Sharing Preferences.[17]"], "M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Require multi-factor authentication for SSH connections wherever possible, such as password protected SSH keys."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Limit which user accounts are allowed to login via SSH."]}, "Detection": {"Logon Session Creation": ["Monitor for user accounts logged into systems that may use Valid Accounts to log into remote machines using Secure Shell (SSH). For example, on Linux systems SSH logon activity can be found in the logs located in /var/log/auth.log or /var/log/secure depending on the distro you are using.", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "Network Connection Creation": ["Monitor for newly constructed network connections (typically port 22) that may use Valid Accounts to log into remote machines using Secure Shell (SSH). Use of SSH may be legitimate depending on the environment and how it’s used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with SSH.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Process Creation": ["Monitor for newly executed processes that may use Valid Accounts to log into remote machines using Secure Shell (SSH). For example, on macOS systems log show --predicate 'process = \"sshd\"' can be used to review incoming SSH connection attempts for suspicious activity. The command log show --info --predicate 'process = \"ssh\" or eventMessage contains \"ssh\"' can be used to review outgoing SSH connection activity.[17]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
