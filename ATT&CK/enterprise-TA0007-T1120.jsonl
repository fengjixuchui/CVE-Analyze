{"TTP_id": "enterprise-TA0007-T1120", "TTP_name": "Peripheral Device Discovery", "Description": "Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system.[1][2] Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.", "Property": {"ID": "T1120", "Sub-techniques": "No sub-techniques", "Tactic": "Discovery", "Platforms": "Linux, Windows, macOS", "Permissions Required": "Administrator, SYSTEM, User", "CAPEC ID": "CAPEC-646", "Version": "1.3", "Created": "31 May 2017", "Last Modified": "11 March 2022"}, "Examples": {"S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "ADVSTORESHELL can list connected devices.[3]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 uses a module to receive a notification every time a USB mass storage device is inserted into a victim.[4]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 has a Bluetooth device harvester, which uses Windows Bluetooth APIs to find information on connected Bluetooth devices. [5]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor has a plugin that collects information about inserted storage devices, modems, and phone devices.[6]"], "G0135": ["https://attack.mitre.org/groups/G0135", "BackdoorDiplomacy", "BackdoorDiplomacy has used an executable to detect removable media, such as USB flash drives.[7]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "BADNEWS checks for new hard drives on the victim, such as USB devices, by listening for the WM_DEVICECHANGE window message.[8][9]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook can detect USB devices.[10]"], "S0089": ["https://attack.mitre.org/software/S0089", "BlackEnergy", "BlackEnergy can gather very specific information about attached USB devices, to include device instance ID and drive geometry.[11]"], "S0454": ["https://attack.mitre.org/software/S0454", "Cadelspy", "Cadelspy has the ability to steal information about printers and the documents sent to printers.[12]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson has the ability to discover pluggable/removable drives to extract files from.[13][14]"], "S0538": ["https://attack.mitre.org/software/S0538", "Crutch", "Crutch can monitor for removable drives being plugged into the compromised machine.[15]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can list signed PnP drivers for smartcard readers.[16]"], "S0062": ["https://attack.mitre.org/software/S0062", "DustySky", "DustySky can detect connected USB devices.[17]"], "G0020": ["https://attack.mitre.org/groups/G0020", "Equation", "Equation has used tools with the functionality to search for specific information about the attached hard drive that could be used to identify and overwrite the firmware.[18]"], "S0679": ["https://attack.mitre.org/software/S0679", "Ferocious", "Ferocious can run GET.WORKSPACE in Microsoft Excel to check if a mouse is present.[19]"], "S0381": ["https://attack.mitre.org/software/S0381", "FlawedAmmyy", "FlawedAmmyy will attempt to detect if a usable smart card is current inserted into a card reader.[20]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group tools have contained an application to check performance of USB flash drives. Gamaredon Group has also used malware to scan for removable drives.[21][22]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT can map UPnP ports.[23]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete detects the insertion of new devices by listening for the WM_DEVICECHANGE window message.[24]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind obtains the number of removable drives from the victim.[25]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT will attempt to detect if the victim system has a camera during the initial infection. njRAT can also detect any removable drives connected to the system.[26][27]"], "S0644": ["https://attack.mitre.org/software/S0644", "ObliqueRAT", "ObliqueRAT can discover pluggable/removable drives to extract files from.[28]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used tools to identify if a mouse is connected to a targeted system.[29]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has discovered removable disks attached to a system.[30]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "A module in Prikormka collects information on available printers and disk drives.[31]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can identify peripheral devices on targeted systems.[32]"], "S0686": ["https://attack.mitre.org/software/S0686", "QuietSieve", "QuietSieve can identify and search removable drives for specific file name extensions.[33]"], "S0481": ["https://attack.mitre.org/software/S0481", "Ragnar Locker", "Ragnar Locker may attempt to connect to removable drives and mapped network drives.[34]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can scan for removable media which may contain documents for collection.[35][36]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM can obtain a list of smart card readers attached to the victim.[37][38]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet enumerates removable drives for infection.[39]"], "S0098": ["https://attack.mitre.org/software/S0098", "T9000", "T9000 searches through connected drives for removable storage devices.[40]"], "S0467": ["https://attack.mitre.org/software/S0467", "TajMahal", "TajMahal has the ability to identify connected Apple devices.[41]"], "S0647": ["https://attack.mitre.org/software/S0647", "Turian", "Turian can scan for removable media to collect data.[7]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has used fsutil fsinfo drives to list connected drives.[42]"], "S0452": ["https://attack.mitre.org/software/S0452", "USBferry", "USBferry can check for connected USB devices.[43]"], "S0136": ["https://attack.mitre.org/software/S0136", "USBStealer", "USBStealer monitors victims for insertion of removable drives. When dropped onto a second victim, it also enumerates drives connected to the system.[44]"], "S0366": ["https://attack.mitre.org/software/S0366", "WannaCry", "WannaCry contains a thread that will attempt to scan for new attached drives every few seconds. If one is identified, it will encrypt the files on the attached device.[45]"], "S0612": ["https://attack.mitre.org/software/S0612", "WastedLocker", "WastedLocker can enumerate removable drives prior to the encryption process.[46]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy enumerates information about connected storage devices.[47]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may attempt to gather information about attached peripheral devices and components connected to a computer system.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "OS API Execution": ["Monitor for API calls that may attempt to gather information about attached peripheral devices and components connected to a computer system.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for newly executed processes that may attempt to gather information about attached peripheral devices and components connected to a computer system.", "", "", ""]}}
