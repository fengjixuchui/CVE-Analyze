{"TTP_id": "enterprise-TA0005-T1564-T1564.003", "TTP_name": "Hidden Window", "Description": "Adversaries may use hidden windows to conceal malicious activity from the plain sight of users. In some cases, windows that would typically be displayed when an application carries out an operation can be hidden. This may be utilized by system administrators to avoid disrupting user work environments when carrying out administrative tasks.On Windows, there are a variety of features in scripting languages in Windows, such as PowerShell, Jscript, and Visual Basic to make windows hidden. One example of this is powershell.exe -WindowStyle Hidden. [1]Similarly, on macOS the configurations for how applications run are listed in property list (plist) files. One of the tags in these files can be apple.awt.UIElement, which allows for Java applications to prevent the application's icon from appearing in the Dock. A common use for this is when applications run in the system tray, but don't also want to show up in the Dock.Adversaries may abuse these functionalities to hide otherwise visible windows from users so as not to alert the user to adversary activity on the system.[2]", "Property": {"ID": "T1564.003", "Sub-technique of": "T1564", "Tactic": "Defense Evasion", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Contributors": "Travis Smith, Tripwire", "Version": "1.1", "Created": "13 March 2020", "Last Modified": "15 March 2022"}, "Examples": {"S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla has used ProcessWindowStyle.Hidden to hide windows.[3]"], "G0073": ["https://attack.mitre.org/groups/G0073", "APT19", "APT19 used -W Hidden to conceal PowerShell windows by setting the WindowStyle parameter to hidden. [4]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has used the WindowStyle parameter to conceal PowerShell windows.[5] [6]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has been known to use -WindowStyle Hidden to conceal PowerShell windows.[7]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has used the WindowStyle parameter to conceal PowerShell windows. [8] [9]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth loads its module with the XSL script parameter vShow set to zero, which opens the application with a hidden window. [10]"], "S0360": ["https://attack.mitre.org/software/S0360", "BONDUPDATER", "BONDUPDATER uses -windowstyle hidden to conceal a PowerShell window that downloads a payload.[11]"], "G0052": ["https://attack.mitre.org/groups/G0052", "CopyKittens", "CopyKittens has used -w hidden and -windowstyle hidden to conceal PowerShell windows. [12]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba has executed hidden PowerShell windows.[13]"], "G0079": ["https://attack.mitre.org/groups/G0079", "DarkHydrus", "DarkHydrus has used -WindowStyle Hidden to conceal PowerShell windows. [14]"], "G0009": ["https://attack.mitre.org/groups/G0009", "Deep Panda", "Deep Panda has used -w hidden to conceal PowerShell windows by setting the WindowStyle parameter to hidden. [15]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has used hidcon to run batch files in a hidden console window.[16]"], "G0078": ["https://attack.mitre.org/groups/G0078", "Gorgon Group", "Gorgon Group has used -W Hidden to conceal PowerShell windows by setting the WindowStyle parameter to hidden. [17]"], "S0037": ["https://attack.mitre.org/software/S0037", "HAMMERTOSS", "HAMMERTOSS has used -WindowStyle hidden to conceal PowerShell windows.[18]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa used a payload that creates a hidden window.[19]"], "S0431": ["https://attack.mitre.org/software/S0431", "HotCroissant", "HotCroissant has the ability to hide the window for operations performed on a given file.[20]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole has executed legitimate tools in hidden windows.[21]"], "S0387": ["https://attack.mitre.org/software/S0387", "KeyBoy", "KeyBoy uses -w Hidden to conceal a PowerShell window that downloads a payload. [22]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used an information gathering module that will hide an AV software window from the victim.[23]"], "S0437": ["https://attack.mitre.org/software/S0437", "Kivars", "Kivars has the ability to conceal its activity through hiding active windows.[24]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic has used the command Powershell.exe -ExecutionPolicy Bypass -WindowStyle Hidden to hide its window.[25]"], "S0669": ["https://attack.mitre.org/software/S0669", "KOCTOPUS", "KOCTOPUS has used -WindowsStyle Hidden to hide the command window.[25]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound malware has a function to determine whether the C2 server wishes to execute the newly dropped file in a hidden window.[26]"], "S0500": ["https://attack.mitre.org/software/S0500", "MCMD", "MCMD can modify processes to prevent them from being visible on the desktop.[27]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has hidden its GUI using the ShowWindow() WINAPI call.[28]"], "S0688": ["https://attack.mitre.org/software/S0688", "Meteor", "Meteor can hide its console window upon execution to decrease its visibility to a victim.[29]"], "G0133": ["https://attack.mitre.org/groups/G0133", "Nomadic Octopus", "Nomadic Octopus executed PowerShell in a hidden window.[30]"], "S0441": ["https://attack.mitre.org/software/S0441", "PowerShower", "PowerShower has added a registry key so future powershell.exe instances are spawned with coordinates for a window position off-screen by default.[31]"], "S0686": ["https://attack.mitre.org/software/S0686", "QuietSieve", "QuietSieve has the ability to execute payloads in a hidden window.[32]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY has the ability to set its window state to hidden.[33]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity has the ability to hide the console window for its document search module from the user.[34]"], "S0386": ["https://attack.mitre.org/software/S0386", "Ursnif", "Ursnif droppers have used COM properties to execute malware in hidden windows.[35]"], "S0466": ["https://attack.mitre.org/software/S0466", "WindTail", "WindTail can instruct the OS to execute an application without a dock icon or menu.[36]"]}, "Mitigation": {"M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Limit or restrict program execution using anti-virus software. On MacOS, allowlist programs that are allowed to have the plist tag. All other programs should be considered suspicious."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may use hidden windows to conceal malicious activity from the plain sight of users. In Windows, enable and configure event logging and PowerShell logging to check for the hidden window style.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Modification": ["Monitor for changes made to files that may use hidden windows to conceal malicious activity from the plain sight of users. In MacOS, plist files are ASCII text files with a specific format, so they're relatively easy to parse. File monitoring can check for the apple.awt.UIElement or any other suspicious plist tag in plist files and flag them.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Process Creation": ["Monitor newly executed processes that may use hidden windows to conceal malicious activity from the plain sight of users.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
