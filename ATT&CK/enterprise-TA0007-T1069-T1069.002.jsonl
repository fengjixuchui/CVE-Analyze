{"TTP_id": "enterprise-TA0007-T1069-T1069.002", "TTP_name": "Domain Groups", "Description": "Adversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.Commands such as net group /domain of the Net utility, dscacheutil -q group on macOS, and ldapsearch on Linux can list domain-level groups.", "Property": {"ID": "T1069.002", "Sub-technique of": "T1069", "Tactic": "Discovery", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Version": "1.0", "Created": "21 February 2020", "Last Modified": "12 March 2020"}, "Examples": {"S0552": ["https://attack.mitre.org/software/S0552", "AdFind", "AdFind can enumerate domain groups.[1][2][3]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used AdFind to enumerate domain groups.[4]"], "S0521": ["https://attack.mitre.org/software/S0521", "BloodHound", "BloodHound can collect information about domain groups and members.[5]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can identify targets by querying account groups on a domain contoller.[6]"], "S0488": ["https://attack.mitre.org/software/S0488", "CrackMapExec", "CrackMapExec can gather the user accounts within domain groups.[7]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has used batch scripts to enumerate administrators and users in the domain.[8]"], "S0105": ["https://attack.mitre.org/software/S0105", "dsquery", "dsquery can be used to gather information on permission groups within a domain.[9]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor can conduct Active Directory reconnaissance using tools such as Sharphound or AdFind.[10]"], "S0417": ["https://attack.mitre.org/software/S0417", "GRIFFON", "GRIFFON has used a reconnaissance module that can be used to retrieve Windows domain membership information.[11]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "Helminth has checked for the domain admin group and Exchange Trusted Subsystem groups using the commands net group Exchange Trusted Subsystem /domain and net group domain admins /domain.[12]"], "G0100": ["https://attack.mitre.org/groups/G0100", "Inception", "Inception has used specific malware modules to gather domain membership.[13]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang performs discovery of permission groups net group /domain.[14]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs collects a list of domain groups with the command net localgroup /domain.[15]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "Commands such as net group /domain can be used in Net to gather information about and manipulate groups.[16]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used net group /domain, net group \"domain admins\" /domain, and net group \"Exchange Trusted Subsystem\" /domain to find domain group permission settings.[17]"], "S0165": ["https://attack.mitre.org/software/S0165", "OSInfo", "OSInfo specifically looks for Domain Admins and power users within the domain.[18]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER may collect domain group information by running net group /domain or a series of other commands on a victim.[19]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil can identify the domain membership of a compromised host.[20][21][22]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can use System.DirectoryServices namespace to retrieve domain group information.[23]"], "S0516": ["https://attack.mitre.org/software/S0516", "SoreFang", "SoreFang can enumerate domain groups by executing net.exe group /domain.[24]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has used net group \"Domain Admins\" /domain to identify domain administrators.[25]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess can identify domain group membership for the current user.[26]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor for executed commands and arguments that may attempt to find domain-level groups and permission settings.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes that may attempt to find domain-level groups and permission settings.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
