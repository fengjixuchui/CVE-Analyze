{"TTP_id": "enterprise-TA0002-T1059-T1059.004", "TTP_name": "Unix Shell", "Description": "Adversaries may abuse Unix shell commands and scripts for execution. Unix shells are the primary command prompt on Linux and macOS systems, though many variations of the Unix shell exist (e.g. sh, bash, zsh, etc.) depending on the specific OS or distribution.[1][2] Unix shells can control every aspect of a system, with certain commands requiring elevated privileges.Unix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops. Common uses of shell scripts include long or repetitive tasks, or the need to run the same set of commands on multiple systems.Adversaries may abuse Unix shells to execute various commands or payloads. Interactive shells may be accessed through command and control channels or during lateral movement such as with SSH. Adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence.", "Property": {"ID": "T1059.004", "Sub-technique of": "T1059", "Tactic": "Execution", "Platforms": "Linux, macOS", "Permissions Required": "User, root", "Supports Remote": "Yes", "Version": "1.1", "Created": "09 March 2020", "Last Modified": "26 July 2021"}, "Examples": {"S0504": ["https://attack.mitre.org/software/S0504", "Anchor", "Anchor can execute payloads via shell scripting.[3]"], "S0584": ["https://attack.mitre.org/software/S0584", "AppleJeus", "AppleJeus has used shell scripts to execute commands after installation and set persistence mechanisms.[4]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 executed file /bin/pwd in activity exploiting CVE-2019-19781 against Citrix devices.[5]"], "S0482": ["https://attack.mitre.org/software/S0482", "Bundlore", "Bundlore has leveraged /bin/sh and /bin/bash to execute commands on the victim machine.[6]"], "S0077": ["https://attack.mitre.org/software/S0077", "CallMe", "CallMe has the capability to create a reverse shell on victims.[7]"], "S0220": ["https://attack.mitre.org/software/S0220", "Chaos", "Chaos provides a reverse shell connection on 8338/TCP, encrypted via AES.[8]"], "S0369": ["https://attack.mitre.org/software/S0369", "CoinTicker", "CoinTicker executes a bash script to establish a reverse shell.[9]"], "S0492": ["https://attack.mitre.org/software/S0492", "CookieMiner", "CookieMiner has used a Unix shell script to run a series of commands targeting macOS.[10]"], "S0021": ["https://attack.mitre.org/software/S0021", "Derusbi", "Derusbi is capable of creating a remote Bash shell and executing commands.[11][12]"], "S0600": ["https://attack.mitre.org/software/S0600", "Doki", "Doki has executed shell scripts with /bin/sh.[13]"], "S0502": ["https://attack.mitre.org/software/S0502", "Drovorub", "Drovorub can execute arbitrary commands as root on a compromised system.[14]"], "S0401": ["https://attack.mitre.org/software/S0401", "Exaramel for Linux", "Exaramel for Linux has a command to execute a shell command on the system.[15][16]"], "S0410": ["https://attack.mitre.org/software/S0410", "Fysbis", "Fysbis has the ability to create and execute commands in a remote shell for CLI.[17]"], "S0690": ["https://attack.mitre.org/software/S0690", "Green Lambert", "Green Lambert can use shell scripts for execution, such as /bin/sh -c.[18][19]"], "S0601": ["https://attack.mitre.org/software/S0601", "Hildegard", "Hildegard has used shell scripts for execution.[20]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar uses /bin/bash to execute commands on the victimâ€™s machine.[21]"], "S0599": ["https://attack.mitre.org/software/S0599", "Kinsing", "Kinsing has used Unix shell scripts to execute commands in the victim environment.[22]"], "S0641": ["https://attack.mitre.org/software/S0641", "Kobalos", "Kobalos can spawn a new pseudo-terminal and execute arbitrary commands at the command prompt.[23]"], "S0451": ["https://attack.mitre.org/software/S0451", "LoudMiner", "LoudMiner used shell scripts to launch various services and to start/stop the QEMU virtualization.[24]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE has the ability to use /bin/bash and /bin/sh to execute commands.[25][26]"], "S0402": ["https://attack.mitre.org/software/S0402", "OSX/Shlayer", "OSX/Shlayer can use bash scripts to check the macOS version, download payloads, and extract bytes from files. OSX/Shlayer uses the command sh -c tail -c +1381... to extract bytes at an offset from a specified file. OSX/Shlayer uses the curl -fsL \"$url\" >$tmp_path command to download malicious payloads into a temporary directory.[27][28][29][30]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D uses a shell script as the main executable inside an app bundle and drops an embedded base64-encoded payload to the /tmp folder.[31][32]"], "S0587": ["https://attack.mitre.org/software/S0587", "Penquin", "Penquin can execute remote commands using bash scripts.[33]"], "S0279": ["https://attack.mitre.org/software/S0279", "Proton", "Proton uses macOS' .command file type to script actions.[34]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke used shell scripts to run commands which would obtain persistence and execute the cryptocurrency mining malware.[35]"], "S0468": ["https://attack.mitre.org/software/S0468", "Skidmap", "Skidmap has used pm.sh to download and install its main payload.[36]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has used shell scripts for execution.[37]"], "S0647": ["https://attack.mitre.org/software/S0647", "Turian", "Turian has the ability to use /bin/sh to execute commands.[38]"], "S0466": ["https://attack.mitre.org/software/S0466", "WindTail", "WindTail can use the open command to execute an application.[39]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET uses a shell script to execute Mach-o files and osacompile commands such as, osacompile -x -o xcode.app main.applescript.[40]"]}, "Mitigation": {"M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Use application control where appropriate."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may abuse Unix shell commands and scripts for execution. Unix shell usage may be common on administrator, developer, or power user systems, depending on job function. If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor for newly executed processes that may abuse Unix shell commands and scripts for execution.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
