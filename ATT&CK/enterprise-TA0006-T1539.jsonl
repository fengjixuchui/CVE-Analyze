{"TTP_id": "enterprise-TA0006-T1539", "TTP_name": "Steal Web Session Cookie", "Description": "An adversary may steal web application or service session cookies and use them to gain access to web applications or Internet services as an authenticated user without needing credentials. Web applications and services often use session cookies as an authentication token after a user has authenticated to a website.Cookies are often valid for an extended period of time, even if the web application is not actively used. Cookies can be found on disk, in the process memory of the browser, and in network traffic to remote systems. Additionally, other applications on the targets machine might store sensitive authentication cookies in memory (e.g. apps which authenticate to cloud services). Session cookies can be used to bypasses some multi-factor authentication protocols.[1]There are several examples of malware targeting cookies from web browsers on the local system.[2][3] There are also open source frameworks such as Evilginx 2 and Muraena that can gather session cookies through a malicious proxy (ex: Adversary-in-the-Middle) that can be set up by an adversary and used in phishing campaigns.[4][5]After an adversary acquires a valid cookie, they can then perform a Web Session Cookie technique to login to the corresponding web application.", "Property": {"ID": "T1539", "Sub-techniques": "No sub-techniques", "Tactic": "Credential Access", "Platforms": "Google Workspace, Linux, Office 365, SaaS, Windows, macOS", "Permissions Required": "User", "Contributors": "Johann Rehberger; Microsoft Threat Intelligence Center (MSTIC)", "Version": "1.2", "Created": "08 October 2019", "Last Modified": "28 July 2021"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has stolen Chrome browser cookies by copying the Chrome profile directories of targeted users.[6]"], "S0657": ["https://attack.mitre.org/software/S0657", "BLUELIGHT", "BLUELIGHT can harvest cookies from Internet Explorer, Edge, Chrome, and Naver Whale browsers.[7]"], "S0631": ["https://attack.mitre.org/software/S0631", "Chaes", "Chaes has used a script that extracts the web session cookie and sends it to the C2 server.[8]"], "S0492": ["https://attack.mitre.org/software/S0492", "CookieMiner", "CookieMiner can steal Google Chrome and Apple Safari browser cookies from the victimâ€™s machine. [9]"], "S0568": ["https://attack.mitre.org/software/S0568", "EVILNUM", "EVILNUM can harvest cookies and upload them to the C2 server.[10]"], "G0120": ["https://attack.mitre.org/groups/G0120", "Evilnum", "Evilnum can steal cookies and session information from browsers.[11]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can steal the victim's cookies to use for duplicating the active session from another device.[12]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot has the ability to capture web session cookies.[13][14]"], "S0467": ["https://attack.mitre.org/software/S0467", "TajMahal", "TajMahal has the ability to steal web session cookies from Internet Explorer, Netscape Navigator, FireFox and RealNetworks applications.[2]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET uses scp to access the ~/Library/Cookies/Cookies.binarycookies file.[15]"]}, "Mitigation": {"M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "A physical second factor key that uses the target login domain as part of the negotiation protocol will prevent session cookie theft through proxy methods.[16]"], "M1054": ["https://attack.mitre.org/mitigations/M1054", "Software Configuration", "Configure browsers or tasks to regularly delete persistent cookies."], "M1017": ["https://attack.mitre.org/mitigations/M1017", "User Training", "Train users to identify aspects of phishing attempts where they're asked to enter credentials into a site that has the incorrect domain for the application they are logging into."]}, "Detection": {"File Access": ["Monitor for an attempt by a user to gain access to a network or computing resource, often by providing credentials to cloud service management consoles. Some cloud providers, such as AWS, provide distinct log events for login attempts to the management console.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Process Access": ["Monitor for attempts by programs to inject into or dump browser process memory.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
