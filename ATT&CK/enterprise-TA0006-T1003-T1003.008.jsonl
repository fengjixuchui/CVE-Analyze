{"TTP_id": "enterprise-TA0006-T1003-T1003.008", "TTP_name": "/etc/passwd and /etc/shadow", "Description": "Adversaries may attempt to dump the contents of /etc/passwd and /etc/shadow to enable offline password cracking. Most modern Linux operating systems use a combination of /etc/passwd and /etc/shadow to store user account information including password hashes in /etc/shadow. By default, /etc/shadow is only readable by the root user.[1]The Linux utility, unshadow, can be used to combine the two files in a format suited for password cracking utilities such as John the Ripper:[2] # /usr/bin/unshadow /etc/passwd /etc/shadow > /tmp/crack.password.db", "Property": {"ID": "T1003.008", "Sub-technique of": "T1003", "Tactic": "Credential Access", "Platforms": "Linux", "Permissions Required": "root", "Version": "1.0", "Created": "11 February 2020", "Last Modified": "20 March 2020"}, "Examples": {"S0349": ["https://attack.mitre.org/software/S0349", "LaZagne", "LaZagne can obtain credential information from /etc/shadow using the shadow.py module.[3]"]}, "Mitigation": {"M1027": ["https://attack.mitre.org/mitigations/M1027", "Password Policies", "Ensure that root accounts have complex, unique passwords across all systems on the network."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Follow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive information."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may attempt to dump the contents of /etc/passwd and /etc/shadow to enable offline password cracking.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor for files being accessed that may attempt to dump the contents of /etc/passwd and /etc/shadow to enable offline password cracking. The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes attempting to access /etc/passwd and /etc/shadow, alerting on the pid, process name, and arguments of such programs.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"]}}
