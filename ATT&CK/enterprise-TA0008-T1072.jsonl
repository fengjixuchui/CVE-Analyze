{"TTP_id": "enterprise-TA0008-T1072", "TTP_name": "Software Deployment Tools", "Description": "Adversaries may gain access to and use third-party software suites installed within an enterprise network, such as administration, monitoring, and deployment systems, to move laterally through the network. Third-party applications and software deployment systems may be in use in the network environment for administration purposes (e.g., SCCM, HBSS, Altiris, etc.).Access to a third-party network-wide or enterprise-wide software system may enable an adversary to have remote code execution on all systems that are connected to such a system. The access may be used to laterally move to other systems, gather information, or cause a specific effect, such as wiping the hard drives on all endpoints.The permissions required for this action vary by system configuration; local credentials may be sufficient with direct access to the third-party system, or specific domain credentials may be required. However, the system may require an administrative account to log in or to perform it's intended purpose.", "Property": {"ID": "T1072", "Sub-techniques": "No sub-techniques", "Tactics": "Execution, Lateral Movement", "Platforms": "Linux, Windows, macOS", "Permissions Required": "Administrator, SYSTEM, User", "Supports Remote": "Yes", "CAPEC ID": "CAPEC-187", "Contributors": "Shane Tully, @securitygypsy", "Version": "2.1", "Created": "31 May 2017", "Last Modified": "11 December 2020"}, "Examples": {"G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 compromised McAfee ePO to move laterally by distributing malware as a software deployment task.[1]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used RAdmin, a remote software tool used to remotely control workstations and ATMs.[2]"], "G0028": ["https://attack.mitre.org/groups/G0028", "Threat Group-1314", "Threat Group-1314 actors used a victim's endpoint management platform, Altiris, for lateral movement.[3]"], "S0041": ["https://attack.mitre.org/software/S0041", "Wiper", "It is believed that a patch management system for an anti-virus product commonly installed among targeted companies was used to distribute the Wiper malware.[4]"]}, "Mitigation": {"M1015": ["https://attack.mitre.org/mitigations/M1015", "Active Directory Configuration", "Ensure proper system and access isolation for critical network systems through use of group policy."], "M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Ensure proper system and access isolation for critical network systems through use of multi-factor authentication."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Ensure proper system isolation for critical network systems through use of firewalls."], "M1027": ["https://attack.mitre.org/mitigations/M1027", "Password Policies", "Verify that account credentials that may be used to access deployment systems are unique and not used throughout the enterprise network."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Grant access to application deployment systems only to a limited number of authorized administrators."], "M1029": ["https://attack.mitre.org/mitigations/M1029", "Remote Data Storage", "If the application deployment system can be configured to deploy only signed binaries, then ensure that the trusted signing certificates are not co-located with the application deployment system and are instead located on a system that cannot be accessed remotely or to which remote access is tightly controlled."], "M1051": ["https://attack.mitre.org/mitigations/M1051", "Update Software", "Patch deployment systems regularly to prevent potential remote access through Exploitation for Privilege Escalation."], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Ensure that any accounts used by third-party providers to access these systems are traceable to the third-party and are not used throughout the network or used by other third-party providers in the same environment. Ensure there are regular reviews of accounts provisioned to these systems to verify continued business need, and ensure there is governance to trace de-provisioning of access that is no longer required. Ensure proper system and access isolation for critical network systems through use of account privilege separation."], "M1017": ["https://attack.mitre.org/mitigations/M1017", "User Training", "Have a strict approval policy for use of deployment systems."]}, "Detection": {"Application Log Content": ["Often these third-party applications will have logs of their own that can be collected and correlated with other data from the environment. Ensure that third-party application logs are on-boarded to the enterprise logging system and the logs are regularly reviewed. Audit software deployment logs and look for suspicious or unauthorized activity. A system not typically used to push software to clients that suddenly is used for such a task outside of a known admin function may be suspicious. Monitor account login activity on these applications to detect suspicious/abnormal usage.Perform application deployment at regular times so that irregular deployment activity stands out.", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "Process Creation": ["Monitor for newly executed processes that does not correlate to known good software. Analyze the process execution trees, historical activities from the third-party application (such as what types of files are usually pushed), and the resulting activities or events from the file/binary/script pushed to systems.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
