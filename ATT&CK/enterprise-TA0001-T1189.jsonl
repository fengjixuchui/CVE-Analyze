{"TTP_id": "enterprise-TA0001-T1189", "TTP_name": "Drive-by Compromise", "Description": "Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user's web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring Application Access Token.Multiple ways of delivering exploit code to a browser exist, including:Often the website used by an adversary is one visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted campaign is often referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.[1]Typical drive-by compromise process:Unlike Exploit Public-Facing Application, the focus of this technique is to exploit software on a client endpoint upon visiting a website. This will commonly give an adversary access to systems on the internal network instead of external systems that may be in a DMZ.Adversaries may also use compromised websites to deliver a user to a malicious application designed to Steal Application Access Tokens, like OAuth tokens, to gain access to protected applications and information. These malicious applications have been delivered through popups on legitimate websites.[2]", "Property": {"ID": "T1189", "Sub-techniques": "No sub-techniques", "Tactic": "Initial Access", "Platforms": "Linux, SaaS, Windows, macOS", "Permissions Required": "User", "Contributors": "Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services); Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)", "Version": "1.4", "Created": "18 April 2018", "Last Modified": "08 March 2022"}, "Examples": {"G0138": ["https://attack.mitre.org/groups/G0138", "Andariel", "Andariel has used watering hole attacks, often with zero-day exploits, to gain initial access to victims within a specific IP range.[3][4]"], "G0073": ["https://attack.mitre.org/groups/G0073", "APT19", "APT19 performed a watering hole attack on forbes.com in 2014 to compromise targets.[5]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has compromised targets via strategic web compromise utilizing custom exploit kits.[6]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has infected victims by tricking them into visiting compromised watering hole websites.[7][8]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 has used strategic web compromises, particularly of South Korean websites, to distribute malware. The group has also used torrent file-sharing sites to more indiscriminately disseminate malware to victims. As part of their compromises, the group has used a Javascript based profiler called RICECURRY to profile a victim's web browser and deliver malicious code accordingly.[9][10][11]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has conducted watering holes schemes to gain initial access to victims.[12][13]"], "G0001": ["https://attack.mitre.org/groups/G0001", "Axiom", "Axiom has used watering hole attacks to gain access.[14]"], "S0606": ["https://attack.mitre.org/software/S0606", "Bad Rabbit", "Bad Rabbit spread through watering holes on popular sites by injecting JavaScript into the HTML body or a .js file.[15][16]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER compromised three Japanese websites using a Flash exploit to perform watering hole attacks.[17]"], "S0482": ["https://attack.mitre.org/software/S0482", "Bundlore", "Bundlore has been spread through malicious advertisements on websites.[18]"], "G0070": ["https://attack.mitre.org/groups/G0070", "Dark Caracal", "Dark Caracal leveraged a watering hole to serve up malicious code.[19]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel used embedded iframes on hotel login portals to redirect selected victims to download malware.[20]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has compromised targets via strategic web compromise (SWC) utilizing a custom exploit kit.[21][22][23]"], "G0066": ["https://attack.mitre.org/groups/G0066", "Elderwood", "Elderwood has delivered zero-day exploits and malware to victims by injecting malicious code into specific public Web pages visited by targets within a particular sector.[24][25][26]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro has used compromised websites and Google Ads to bait victims into downloading its installer.[27][28]"], "S0215": ["https://attack.mitre.org/software/S0215", "KARAE", "KARAE was distributed through torrent file-sharing websites to South Korean victims, using a YouTube video downloader application as a lure.[10]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group delivered RATANKBA and other malicious code to victims via a compromised legitimate website.[29][30]"], "G0077": ["https://attack.mitre.org/groups/G0077", "Leafminer", "Leafminer has infected victims using watering holes.[31]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has infected victims using watering holes.[32]"], "S0451": ["https://attack.mitre.org/software/S0451", "LoudMiner", "LoudMiner is typically bundled with pirated copies of Virtual Studio Technology (VST) for Windows and macOS.[33]"], "G0095": ["https://attack.mitre.org/groups/G0095", "Machete", "Machete has distributed Machete through a fake blog website.[34]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound has conducted watering-hole attacks through media and magazine websites.[35]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork has used watering holes to deliver files with exploits to initial victims.[36][37]"], "G0068": ["https://attack.mitre.org/groups/G0068", "PLATINUM", "PLATINUM has sometimes used drive-by attacks against vulnerable browser plugins.[38]"], "S0216": ["https://attack.mitre.org/software/S0216", "POORAIM", "POORAIM has been delivered through compromised sites acting as watering holes.[10]"], "G0056": ["https://attack.mitre.org/groups/G0056", "PROMETHIUM", "PROMETHIUM has used watering hole attacks to deliver malicious versions of legitimate installers.[39]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil has infected victim machines through compromised websites and exploit kits.[40][41][42][43]"], "G0048": ["https://attack.mitre.org/groups/G0048", "RTM", "RTM has distributed its malware via the RIG and SUNDOWN exploit kits, as well as online advertising network Yandex.Direct.[44][45]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has extensively used strategic web compromises to target victims.[46][47]"], "G0134": ["https://attack.mitre.org/groups/G0134", "Transparent Tribe", "Transparent Tribe has used websites with malicious hyperlinks and iframes to infect targeted victims with Crimson, njRAT, and other malicious tools.[48][49][50]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla has infected victims using watering holes.[51][52]"], "G0124": ["https://attack.mitre.org/groups/G0124", "Windigo", "Windigo has distributed Windows malware via drive-by downloads.[53]"], "G0112": ["https://attack.mitre.org/groups/G0112", "Windshift", "Windshift has used compromised websites to register custom URL schemes on a remote system.[54]"]}, "Mitigation": {"M1048": ["https://attack.mitre.org/mitigations/M1048", "Application Isolation and Sandboxing", "Browser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist.[55][56]Other types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist for these types of systems.[56]"], "M1050": ["https://attack.mitre.org/mitigations/M1050", "Exploit Protection", "Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. [57] Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. [58] Many of these protections depend on the architecture and target application binary for compatibility."], "M1021": ["https://attack.mitre.org/mitigations/M1021", "Restrict Web-Based Content", "For malicious code served up through ads, adblockers can help prevent that code from executing in the first place.Script blocking extensions can help prevent the execution of JavaScript that may commonly be used during the exploitation process."], "M1051": ["https://attack.mitre.org/mitigations/M1051", "Update Software", "Ensure all browsers and plugins kept updated can help prevent the exploit phase of this technique. Use modern browsers with security features turned on."]}, "Detection": {"Application Log Content": ["Firewalls and proxies can inspect URLs for potentially known-bad domains or parameters. They can also do reputation-based analytics on websites and their requested resources such as how old a domain is, who it's registered to, if it's on a known bad list, or how many other users have connected to it before.", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "File Creation": ["Monitor for newly constructed files written to disk to gain access to a system through a user visiting a website over the normal course of browsing.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Network Connection Creation": ["Monitor for newly constructed network connections that are sent or received by untrusted hosts.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Content": ["Monitor for networks that solicits and obtains the configuration information of the queried device", "", "", ""], "Process Creation": ["Monitor for newly executed processes to gain access to a system through a user visiting a website over the normal course of browsing.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
