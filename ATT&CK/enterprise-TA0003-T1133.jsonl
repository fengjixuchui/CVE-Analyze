{"TTP_id": "enterprise-TA0003-T1133", "TTP_name": "External Remote Services", "Description": "Adversaries may leverage external-facing remote services to initially access and/or persist within a network. Remote services such as VPNs, Citrix, and other access mechanisms allow users to connect to internal enterprise network resources from external locations. There are often remote service gateways that manage connections and credential authentication for these services. Services such as Windows Remote Management and VNC can also be used externally.[1]Access to Valid Accounts to use the service is often a requirement, which could be obtained through credential pharming or by obtaining the credentials from users after compromising the enterprise network.[2] Access to remote services may be used as a redundant or persistent access mechanism during an operation.Access may also be gained through an exposed service that doesnâ€™t require authentication. In containerized environments, this may include an exposed Docker API, Kubernetes API server, kubelet, or web application such as the Kubernetes dashboard.[3][4]", "Property": {"ID": "T1133", "Sub-techniques": "No sub-techniques", "Tactics": "Persistence, Initial Access", "Platforms": "Containers, Linux, Windows, macOS", "Permissions Required": "User", "CAPEC ID": "CAPEC-555", "Contributors": "Alfredo Oliveira, Trend Micro; Ariel Shuper, Cisco; Brad Geesaman, @bradgeesaman; Daniel Oakley; David Fiser, @anu4is, Trend Micro; ExtraHop; Idan Frimark, Cisco; Jay Chen, Palo Alto Networks; Magno Logan, @magnologan, Trend Micro; Rory McCune, Aqua Security; Travis Smith, Tripwire; Vishwas Manral, McAfee; Yossi Weizman, Azure Defender Research Team; Yuval Avrahami, Palo Alto Networks", "Version": "2.3", "Created": "31 May 2017", "Last Modified": "19 August 2021"}, "Examples": {"G0026": ["https://attack.mitre.org/groups/G0026", "APT18", "APT18 actors leverage legitimate credentials to log into external remote services.[5]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has used Tor and a variety of commercial VPN services to route brute force authentication attempts.[6]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used compromised identities to access networks via SSH, VPNs, and other remote access tools.[7][8][9]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 compromised an online billing/payment service using VPN access between a third-party service provider and the targeted payment service.[10]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used legitimate credentials to login to an external VPN, Citrix, SSH, and other remote services.[11][12]"], "S0600": ["https://attack.mitre.org/software/S0600", "Doki", "Doki was executed through an open Docker daemon API port.[13]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.[14][15]"], "G0053": ["https://attack.mitre.org/groups/G0053", "FIN5", "FIN5 has used legitimate VPN, Citrix, or VNC credentials to maintain access to a victim environment.[16][17][18]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM has used VPN services, including SoftEther VPN, to access and maintain persistence in victim environments.[19][20]"], "G0115": ["https://attack.mitre.org/groups/G0115", "GOLD SOUTHFIELD", "GOLD SOUTHFIELD has used publicly-accessible RDP and remote management and monitoring (RMM) servers to gain access to victim machines.[21]"], "S0601": ["https://attack.mitre.org/software/S0601", "Hildegard", "Hildegard was executed through an unsecure kubelet that allowed anonymous access to the victim environment.[4]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has gained access through VPNs including with compromised accounts and stolen VPN certificates.[22][23]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used RDP to establish persistence.[24]"], "S0599": ["https://attack.mitre.org/software/S0599", "Kinsing", "Kinsing was executed in an Ubuntu container deployed via an open Docker daemon API.[25]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has used external remote services such as virtual private networks (VPN) to gain initial access.[26]"], "S0362": ["https://attack.mitre.org/software/S0362", "Linux Rabbit", "Linux Rabbit attempts to gain access to the server via SSH.[27]"], "G0014": ["https://attack.mitre.org/groups/G0014", "Night Dragon", "Night Dragon has used compromised VPN accounts to gain access to victim systems.[28]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig uses remote services such as VPN, Citrix, or OWA to persist in an environment.[29]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used stolen credentials to connect to the victim's network via VPN.[30]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has used Dropbear SSH with a hardcoded backdoor password to maintain persistence within the target network. Sandworm Team has also used VPN tunnels established in legitimate software company infrastructure to gain access to internal networks of that software company's users.[31][32][33]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has used open-source tools such as Weave Scope to target exposed Docker API ports and gain initial access to victim environments.[34] TeamTNT has also targeted exposed kubelets for Kubernetes environments.[4]"], "G0088": ["https://attack.mitre.org/groups/G0088", "TEMP.Veles", "TEMP.Veles has used a VPN to persist in the victim environment.[35]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 actors look for and use VPN profiles during an operation to access the network using external VPN services.[36] Threat Group-3390 has also obtained OWA account credentials during intrusions that it subsequently used to attempt to regain access when evicted from a victim network.[37]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has accessed victim networks by using stolen credentials to access the corporate VPN infrastructure.[38]"]}, "Mitigation": {"M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Disable or block remotely available services that may be unnecessary."], "M1035": ["https://attack.mitre.org/mitigations/M1035", "Limit Access to Resource Over Network", "Limit access to remote services through centrally managed concentrators such as VPNs and other managed remote access systems."], "M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Use strong two-factor or multi-factor authentication for remote service accounts to mitigate an adversary's ability to leverage stolen credentials, but be aware of Multi-Factor Authentication Interception techniques for some two-factor authentication implementations."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Deny direct remote access to internal systems through the use of network proxies, gateways, and firewalls."]}, "Detection": {"Application Log Content": ["When authentication is not required to access an exposed remote service, monitor for follow-on activities such as anomalous external use of the exposed API or application.", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "Logon Session Metadata": ["Follow best practices for detecting adversary use of Valid Accounts for authenticating to remote services. Collect authentication logs and analyze for unusual access patterns, windows of activity, and access outside of normal business hours.", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "Network Traffic Flow": ["Monitor for network traffic originating from unknown/unexpected hardware devices. Local network traffic metadata (such as source MAC addressing) as well as usage of network management protocols such as DHCP may be helpful in identifying hardware.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"]}}
