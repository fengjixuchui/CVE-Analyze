{"TTP_id": "enterprise-TA0007-T1124", "TTP_name": "System Time Discovery", "Description": "An adversary may gather the system time and/or time zone from a local or remote system. The system time is set and stored by the Windows Time Service within a domain to maintain time synchronization between systems and services in an enterprise network. [1] [2]System time information may be gathered in a number of ways, such as with Net on Windows by performing net time \\hostname to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using w32tm /tz. [2]This information could be useful for performing other techniques, such as executing a file with a Scheduled Task/Job [3], or to discover locality information based on time zone to assist in victim targeting (i.e. System Location Discovery). Adversaries may also use knowledge of system time as part of a time bomb, or delaying execution until a specified date/time.[4]", "Property": {"ID": "T1124", "Sub-techniques": "No sub-techniques", "Tactic": "Discovery", "Platforms": "Windows", "Permissions Required": "User", "CAPEC ID": "CAPEC-295", "Contributors": "FIRST.ORG's Cyber Threat Intelligence SIG", "Version": "1.2", "Created": "31 May 2017", "Last Modified": "22 April 2021"}, "Examples": {"S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla can collect the timestamp from the victim’s machine.[5]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed can pull a timestamp from the victim's machine.[6]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth collects the timestamp from the infected machine. [7]"], "S0344": ["https://attack.mitre.org/software/S0344", "Azorult", "Azorult can collect the time zone information from the system.[8][9]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can collect the time on the compromised host.[10][11]"], "S0574": ["https://attack.mitre.org/software/S0574", "BendyBear", "BendyBear has the ability to determine local time on a compromised host.[12]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal can check the system time set on the infected host.[13]"], "S0657": ["https://attack.mitre.org/software/S0657", "BLUELIGHT", "BLUELIGHT can collect the local time on a compromised host.[14]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has used net time to check the local time on a target system.[15]"], "S0471": ["https://attack.mitre.org/software/S0471", "build_downer", "build_downer has the ability to determine the local time to ensure malware installation only happens during the hours that the infected system is active.[16]"], "S0351": ["https://attack.mitre.org/software/S0351", "Cannon", "Cannon can collect the current time zone information from the victim’s machine.[17]"], "S0335": ["https://attack.mitre.org/software/S0335", "Carbon", "Carbon uses the command net time \\127.0.0.1 to get information the system’s time.[18]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used time /t and net time \\ip/hostname for system time discovery.[19]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling can determine the current time.[20]"], "S0126": ["https://attack.mitre.org/software/S0126", "ComRAT", "ComRAT has checked the victim system's date and time to perform tasks during business hours (9 to 5, Monday to Friday).[21]"], "S0608": ["https://attack.mitre.org/software/S0608", "Conficker", "Conficker uses the current UTC victim system date for domain generation and connects to time servers to determine the current date.[22][23]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson has the ability to determine the date and time on a compromised host.[24]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel malware can obtain system time from a compromised host.[25]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can collect the time zone information from the system.[26]"], "S0694": ["https://attack.mitre.org/software/S0694", "DRATzarus", "DRATzarus can use the GetTickCount and GetSystemTimeAsFileTime API calls to inspect system time.[27]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor contains functionality to query the local/system time.[28]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic uses the net time command to get the system time from the machine and collect the current date and time zone information.[29]"], "S0396": ["https://attack.mitre.org/software/S0396", "EvilBunny", "EvilBunny has used the API calls NtQuerySystemTime, GetSystemTimeAsFileTime, and GetTickCount to gather time metrics as part of its checks to see if the malware is running in a sandbox.[30]"], "S0267": ["https://attack.mitre.org/software/S0267", "FELIXROOT", "FELIXROOT gathers the time zone information from the victim’s machine.[31]"], "S0588": ["https://attack.mitre.org/software/S0588", "GoldMax", "GoldMax can check the current date-time value of the compromised system, comparing it to the hardcoded execution trigger and can send the current timestamp to the C2 server.[32][33]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can determine the time on the victim machine via IPinfo.[34]"], "S0237": ["https://attack.mitre.org/software/S0237", "GravityRAT", "GravityRAT can obtain the date and time of a system.[35]"], "S0690": ["https://attack.mitre.org/software/S0690", "Green Lambert", "Green Lambert can collect the date and time from a compromised host.[36][37]"], "S0417": ["https://attack.mitre.org/software/S0417", "GRIFFON", "GRIFFON has used a reconnaissance module that can be used to retrieve the date and time of the system.[38]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa used a function to gather the current time.[39]"], "S0376": ["https://attack.mitre.org/software/S0376", "HOPLIGHT", "HOPLIGHT has been observed collecting system time from victim machines.[40]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole gathers the local system time from the victim’s machine.[41][42]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "A Destover-like implant used by Lazarus Group can obtain the current system time and send it to the C2 server.[43]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo uses JavaScript to get the system time.[44]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind obtains the victim's current time.[45]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "The net time command can be used in Net to determine the local or remote system time.[46]"], "S0353": ["https://attack.mitre.org/software/S0353", "NOKKI", "NOKKI can collect the current timestamp of the victim's machine.[47]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum can obtain the date and time of the compromised system.[48]"], "S0264": ["https://attack.mitre.org/software/S0264", "OopsIE", "OopsIE checks to see if the system is configured with \"Daylight\" time and checks for a specific region to be set for the timezone.[49]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used the time command to retrieve the current time of a compromised system.[50]"], "S0501": ["https://attack.mitre.org/software/S0501", "PipeMon", "PipeMon can send time zone information from a compromised host to C2.[51]"], "S0139": ["https://attack.mitre.org/software/S0139", "PowerDuke", "PowerDuke has commands to get the time the machine was built, the time, and the time zone.[52]"], "S0238": ["https://attack.mitre.org/software/S0238", "Proxysvc", "As part of the data reconnaissance phase, Proxysvc grabs the system time to send back to the control server.[43]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can identify the system time on a targeted host.[53]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM can obtain the victim time zone.[54]"], "S0596": ["https://attack.mitre.org/software/S0596", "ShadowPad", "ShadowPad has collected the current date and time of the victim system.[55]"], "S0140": ["https://attack.mitre.org/software/S0140", "Shamoon", "Shamoon obtains the system time and will only activate if it is greater than a preset date.[56][57]"], "S0450": ["https://attack.mitre.org/software/S0450", "SHARPSTATS", "SHARPSTATS has the ability to identify the current date and time on the compromised host.[58]"], "G0121": ["https://attack.mitre.org/groups/G0121", "Sidewinder", "Sidewinder has used tools to obtain the current system time.[59]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can collect start time information from a compromised host.[60]"], "S0615": ["https://attack.mitre.org/software/S0615", "SombRAT", "SombRAT can execute getinfo to discover the current time on a compromised host.[61][62]"], "S0380": ["https://attack.mitre.org/software/S0380", "StoneDrill", "StoneDrill can obtain the current date and time of the victim machine.[63]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet collects the time and date of a system when it is infected.[64]"], "S0098": ["https://attack.mitre.org/software/S0098", "T9000", "T9000 gathers and beacons the system time during installation.[65]"], "S0011": ["https://attack.mitre.org/software/S0011", "Taidoor", "Taidoor can use GetLocalTime and GetSystemTime to collect system time.[66]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "TAINTEDSCRIBE can execute GetLocalTime for time discovery.[67]"], "S0467": ["https://attack.mitre.org/software/S0467", "TajMahal", "TajMahal has the ability to determine local time on a compromised host.[68]"], "G0089": ["https://attack.mitre.org/groups/G0089", "The White Company", "The White Company has checked the current date on the victim system.[69]"], "S0678": ["https://attack.mitre.org/software/S0678", "Torisma", "Torisma can collect the current time on a victim machine.[70]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla surveys a system upon check-in to discover the system time by using the net time command.[29]"], "S0275": ["https://attack.mitre.org/software/S0275", "UPPERCUT", "UPPERCUT has the capability to obtain the time zone information and current timestamp of the victim’s machine.[71]"], "S0466": ["https://attack.mitre.org/software/S0466", "WindTail", "WindTail has the ability to generate the current date and time.[72]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy gathers the current time zone and date information from the system.[73][74]"], "S0330": ["https://attack.mitre.org/software/S0330", "Zeus Panda", "Zeus Panda collects the current system time (UTC) and sends it back to the C2 server.[75]"], "G0128": ["https://attack.mitre.org/groups/G0128", "ZIRCONIUM", "ZIRCONIUM has used a tool to capture the time on a compromised host in order to register it with C2.[76]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments for actions that may gather the system time and/or time zone from a local or remote system.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "OS API Execution": ["Monitor for API calls that may gather the system time and/or time zone from a local or remote system. Remote access tools with built-in features may interact directly with the Windows API to gather information.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for newly executed processes that may gather the system time and/or time zone from a local or remote system.", "", "", ""]}}
