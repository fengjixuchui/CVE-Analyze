{"TTP_id": "enterprise-TA0011-T1090-T1090.002", "TTP_name": "External Proxy", "Description": "Adversaries may use an external proxy to act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including HTRAN, ZXProxy, and ZXPortMap. [1] Adversaries use these types of proxies to manage command and control communications, to provide resiliency in the face of connection loss, or to ride over existing trusted communications paths to avoid suspicion.External connection proxies are used to mask the destination of C2 traffic and are typically implemented with port redirectors. Compromised systems outside of the victim environment may be used for these purposes, as well as purchased infrastructure such as cloud-based resources or virtual private servers. Proxies may be chosen based on the low likelihood that a connection to them from a compromised system would be investigated. Victim systems would communicate directly with the external proxy on the Internet and then the proxy would forward communications to the C2 server.", "Property": {"ID": "T1090.002", "Sub-technique of": "T1090", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "14 March 2020", "Last Modified": "27 March 2020"}, "Examples": {"G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 used other victims as proxies to relay command traffic, for instance using a compromised Georgian military email server as a hop point to NATO victims. The group has also used a tool that acts as a proxy to allow C2 even if the victim is behind a router. APT28 has also used a machine to relay and obscure communications between CHOPSTICK and their server.[2][3][4]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "An APT3 downloader establishes SOCKS5 connections for its initial C2.[5]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used various tools to proxy C2 communications.[6]"], "G0053": ["https://attack.mitre.org/groups/G0053", "FIN5", "FIN5 maintains access to victim environments by using FLIPSIDE to create a proxy for a backup RDP tunnel.[7]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used a modified version of HTRAN to redirect connections between networks.[8]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole InvisiMole can identify proxy servers used by the victim and use them for C2 communication.[9][10]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used multiple proxies to obfuscate network traffic from victims.[11][12]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used a global service provider's IP as a proxy for C2 traffic from a victim.[13][14]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has controlled POWERSTATS from behind a proxy network to obfuscate the C2 location.[15] MuddyWater has used a series of compromised websites that victims connected to randomly to relay information to command and control (C2).[16][17]"], "S0699": ["https://attack.mitre.org/software/S0699", "Mythic", "Mythic can leverage a modified SOCKS5 proxy to tunnel egress C2 traffic.[18]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum can identify proxy servers configured and used by the victim, and use it to make HTTP requests to C2 its server.[19]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS has connected to C2 servers through proxies.[20]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot has a module that can proxy C2 communications.[21]"], "S0019": ["https://attack.mitre.org/software/S0019", "Regin", "Regin leveraged several compromised universities as proxies to obscure its origin.[22]"], "S0444": ["https://attack.mitre.org/software/S0444", "ShimRat", "ShimRat can use pre-configured HTTP proxies.[23]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used ProxyBot, which allows the attacker to redirect traffic from the current node to the backconnect server via Sock4\\Socks5.[24]"], "G0131": ["https://attack.mitre.org/groups/G0131", "Tonto Team", "Tonto Team has routed their traffic through an external server in order to obfuscate their location.[25]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot has been known to reach a command and control server via one of nine proxy IP addresses. [26] [27]"], "S0141": ["https://attack.mitre.org/software/S0141", "Winnti for Windows", "The Winnti for Windows HTTP/S C2 mode can make use of an external proxy.[28]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.[29]"]}, "Detection": {"Network Connection Creation": ["Monitor for newly constructed network connections that are sent or received by untrusted hosts.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
