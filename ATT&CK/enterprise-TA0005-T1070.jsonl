{"TTP_id": "enterprise-TA0005-T1070", "TTP_name": "Indicator Removal on Host", "Description": "Adversaries may delete or modify artifacts generated on a host system to remove evidence of their presence or hinder defenses. Various artifacts may be created by an adversary or something that can be attributed to an adversaryâ€™s actions. Typically these artifacts are used as defensive indicators related to monitored events, such as strings from downloaded files, logs that are generated from user actions, and other data analyzed by defenders. Location, format, and type of artifact (such as command or login history) are often specific to each platform.Removal of these indicators may interfere with event collection, reporting, or other processes used to detect intrusion activity. This may compromise the integrity of security solutions by causing notable events to go unreported. This activity may also impede forensic analysis and incident response, due to lack of sufficient data to determine what occurred.", "Property": {"ID": "T1070", "Sub-techniques": "T1070.001, T1070.002, T1070.003, T1070.004, T1070.005, T1070.006", "Tactic": "Defense Evasion", "Platforms": "Containers, Linux, Network, Windows, macOS", "Defense Bypassed": "Anti-virus, Host intrusion prevention systems, Log analysis", "CAPEC ID": "CAPEC-93", "Contributors": "Brad Geesaman, @bradgeesaman; Ed Williams, Trustwave, SpiderLabs", "Version": "1.3", "Created": "31 May 2017", "Last Modified": "01 April 2022"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 removed evidence of email export requests using Remove-MailboxExportRequest.[1] They temporarily replaced legitimate utilities with their own, executed their payload, and then restored the original file.[2]"], "S0239": ["https://attack.mitre.org/software/S0239", "Bankshot", "Bankshot deletes all artifacts associated with the malware from the infected machine.[3]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar's loader can delete scheduled tasks created by a previous instance of the malware.[4]"], "S0089": ["https://attack.mitre.org/software/S0089", "BlackEnergy", "BlackEnergy has removed the watermark associated with enabling the TESTSIGNING boot configuration option by removing the relevant strings in the user32.dll.mui of the system.[5]"], "S0527": ["https://attack.mitre.org/software/S0527", "CSPY Downloader", "CSPY Downloader has the ability to remove values it writes to the Registry.[6]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can uninstall malicious components from the Registry, stop processes, and clear the browser history.[7]"], "S0695": ["https://attack.mitre.org/software/S0695", "Donut", "Donut can erase file references to payloads in-memory after being reflectively loaded and executed.[8]"], "S0568": ["https://attack.mitre.org/software/S0568", "EVILNUM", "EVILNUM has a function called \"DeleteLeftovers\" to remove certain artifacts of the attack.[9]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro can close specific Windows Security and Internet Explorer dialog boxes to mask external connections.[10]"], "S0477": ["https://attack.mitre.org/software/S0477", "Goopy", "Goopy has the ability to delete emails used for C2 once the content has been copied.[11]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can delete previously created tasks on a compromised host.[12]"], "S0697": ["https://attack.mitre.org/software/S0697", "HermeticWiper", "HermeticWiper can disable pop-up information about folders and desktop items and delete Registry keys to hide malicious services.[13][14]"], "S0669": ["https://attack.mitre.org/software/S0669", "KOCTOPUS", "KOCTOPUS can delete created registry keys as part of its cleanup procedure.[15]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has restored malicious KernelCallbackTable code to its original state after the process execution flow has been hijacked.[16]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "Maze has used the \"Wow64RevertWow64FsRedirection\" function following attempts to delete the shadow volumes, in order to leave the system in the same state as it was prior to redirection.[17]"], "S0500": ["https://attack.mitre.org/software/S0500", "MCMD", "MCMD has the ability to remove set Registry Keys.[18]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has a command to delete a Registry key it uses, \\Software\\Microsoft\\Internet Explorer\\notes.[19]"], "S0083": ["https://attack.mitre.org/software/S0083", "Misdat", "Misdat is capable of deleting Registry keys used for persistence.[20]"], "S0691": ["https://attack.mitre.org/software/S0691", "Neoichor", "Neoichor can clear the browser history on a compromised host by changing the ClearBrowsingHistoryOnExit value to 1 in the HKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Privacy Registry key.[21]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT is capable of manipulating and deleting registry keys.[22]"], "S0229": ["https://attack.mitre.org/software/S0229", "Orz", "Orz can overwrite Registry settings to reduce its visibility on the victim.[23]"], "S0517": ["https://attack.mitre.org/software/S0517", "Pillowmint", "Pillowmint can uninstall the malicious service from an infected machine.[24]"], "S0448": ["https://attack.mitre.org/software/S0448", "Rising Sun", "Rising Sun can clear process memory by overwriting it with junk bytes.[25]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM has the ability to remove Registry entries that it created during execution.[26]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has the ability to clean up and remove data structures from a compromised host.[27]"], "S0596": ["https://attack.mitre.org/software/S0596", "ShadowPad", "ShadowPad has deleted arbitrary Registry values.[28]"], "S0589": ["https://attack.mitre.org/software/S0589", "Sibot", "Sibot will delete an associated registry key if a certain server response is received.[29]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can remove artifacts from the compromised host, including created Registry keys.[30]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet can delete OLE Automation and SQL stored procedures used to store malicious payloads.[31]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST removed IFEO and HTTP proxy registry values to clean up traces of execution. SUNBURST also removed the firewall rules it created during execution.[32]"]}, "Mitigation": {"M1041": ["https://attack.mitre.org/mitigations/M1041", "Encrypt Sensitive Information", "Obfuscate/encrypt event files locally and in transit to avoid giving feedback to an adversary."], "M1029": ["https://attack.mitre.org/mitigations/M1029", "Remote Data Storage", "Automatically forward events to a log server or data repository to prevent conditions in which the adversary can locate and manipulate data on the local system. When possible, minimize time delay on event reporting to avoid prolonged storage on the local system."], "M1022": ["https://attack.mitre.org/mitigations/M1022", "Restrict File and Directory Permissions", "Protect generated event files that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Deletion": ["Monitor for a file that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Metadata": ["Monitor for contextual file data that may show signs of deletion or alter generated artifacts on a host system, including logs or captured files such as quarantined malware.", "", "", ""], "File Modification": ["Monitor for changes made to a file may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware.", "", "", ""], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "OS API Execution": ["Monitor for API calls that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for newly executed processes that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware.", "", "", ""], "User Account Authentication": ["Monitor for an attempt by a user to gain access to a network or computing resource, often by providing credentials that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"], "Windows Registry Key Deletion": ["Monitor windows registry keys that may be deleted or alter generated artifacts on a host system, including logs or captured files such as quarantined malware.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"], "Windows Registry Key Modification": ["Monitor for changes made to windows registry keys or values that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined malware.", "", "", ""]}}
