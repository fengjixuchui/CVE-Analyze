{"TTP_id": "enterprise-TA0005-T1070-T1070.006", "TTP_name": "Timestomp", "Description": "Adversaries may modify file time attributes to hide new or changes to existing files. Timestomping is a technique that modifies the timestamps of a file (the modify, access, create, and change times), often to mimic files that are in the same folder. This is done, for example, on files that have been modified or created by the adversary so that they do not appear conspicuous to forensic investigators or file analysis tools.Timestomping may be used along with file name Masquerading to hide malware and tools.[1]", "Property": {"ID": "T1070.006", "Sub-technique of": "T1070", "Tactic": "Defense Evasion", "Platforms": "Linux, Windows, macOS", "Permissions Required": "SYSTEM, User, root", "Defense Bypassed": "Host forensic analysis", "Contributors": "Romain Dumont, ESET", "Version": "1.0", "Created": "31 January 2020", "Last Modified": "29 March 2020"}, "Examples": {"S0066": ["https://attack.mitre.org/software/S0066", "3PARA RAT", "3PARA RAT has a command to set certain attributes such as creation/modification timestamps on files.[2]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has performed timestomping on victim files.[3]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 modified timestamps of backdoors to match legitimate Windows files.[4]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has used scheduled task raw XML with a backdated timestamp of June 2, 2016. The group has also set the creation time of the files dropped by the second stage of the exploit to match the creation time of kernel32.dll. Additionally, APT32 has used a random value to modify the timestamp of the file storing the clientID.[5][6][7]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has modified data timestamps to mimic files that are in the same folder on a compromised host.[8]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor has manipulated the time of last access to files and registry keys after they have been created or modified.[9]"], "S0239": ["https://attack.mitre.org/software/S0239", "Bankshot", "Bankshot modifies the time of a file as specified by the control server.[10]"], "S0570": ["https://attack.mitre.org/software/S0570", "BitPaymer", "BitPaymer can modify the timestamp of an executable so that it can be identified and restored by the decryption tool.[11]"], "S0520": ["https://attack.mitre.org/software/S0520", "BLINDINGCAN", "BLINDINGCAN has modified file and directory timestamps.[12][13]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used a Windows version of the Linux touch command to modify the date and time stamp on DLLs.[14]"], "S0020": ["https://attack.mitre.org/software/S0020", "China Chopper", "China Chopper's server component can change the timestamp of files.[15][16][17]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can timestomp any files or payloads placed on a target machine to help them blend in.[18][19]"], "S0687": ["https://attack.mitre.org/software/S0687", "Cyclops Blink", "Cyclops Blink has the ability to use the Linux API function utime to change the timestamps of modified firmware update images.[20]"], "S0021": ["https://attack.mitre.org/software/S0021", "Derusbi", "The Derusbi malware supports timestomping.[21][22]"], "S0081": ["https://attack.mitre.org/software/S0081", "Elise", "Elise performs timestomping of a CAB file it creates.[23]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can timestomp any files or payloads placed on a target machine to help them blend in.[24]"], "S0568": ["https://attack.mitre.org/software/S0568", "EVILNUM", "EVILNUM has changed the creation date of files.[25]"], "S0181": ["https://attack.mitre.org/software/S0181", "FALLCHILL", "FALLCHILL can modify file or directory timestamps.[26]"], "S0168": ["https://attack.mitre.org/software/S0168", "Gazer", "For early Gazer versions, the compilation timestamp was faked.[27]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium has the ability to perform timestomping of files on targeted systems.[28]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole samples were timestomped by the authors by setting the PE timestamps to all zero values. InvisiMole also has a built-in command to modify file times.[29]"], "S0387": ["https://attack.mitre.org/software/S0387", "KeyBoy", "KeyBoy time-stomped its DLL in order to evade detection.[30]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has manipulated timestamps for creation or compilation dates to defeat anti-forensics.[31]"], "S0641": ["https://attack.mitre.org/software/S0641", "Kobalos", "Kobalos can modify timestamps of replaced files, such as ssh with the added credential stealer or sshd used to deploy Kobalos.[32]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Several Lazarus Group malware families use timestomping, including modifying the last write timestamp of a specified Registry key to a random date, as well as copying the timestamp for legitimate .exe files (such as calc.exe or mspaint.exe) to its dropped files.[33][34][35][36]"], "S0083": ["https://attack.mitre.org/software/S0083", "Misdat", "Many Misdat samples were programmed using Borland Delphi, which will mangle the default PE compile timestamp of a file.[37]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D can use the touch -t command to change timestamps.[38][39]"], "S0072": ["https://attack.mitre.org/software/S0072", "OwaAuth", "OwaAuth has a command to timestop a file or directory.[40]"], "S0150": ["https://attack.mitre.org/software/S0150", "POSHSPY", "POSHSPY modifies timestamps of all downloaded executables to match a randomly selected file created prior to 2013.[41]"], "S0393": ["https://attack.mitre.org/software/S0393", "PowerStallion", "PowerStallion modifies the MAC times of its local log files to match that of the victim's desktop.ini file.[42]"], "S0078": ["https://attack.mitre.org/software/S0078", "Psylo", "Psylo has a command to conduct timestomping by setting a specified fileâ€™s timestamps to match those of a system file in the System32 directory.[43]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke has changed the time stamp of certain files.[44]"], "S0185": ["https://attack.mitre.org/software/S0185", "SEASHARPEE", "SEASHARPEE can timestomp files on victims using a Web shell.[45]"], "S0140": ["https://attack.mitre.org/software/S0140", "Shamoon", "Shamoon can change the modified time for files to evade forensic detection.[46]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet extracts and writes driver files that match the times of other legitimate files.[47]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "TAINTEDSCRIBE can change the timestamp of specified filenames.[48]"], "S0164": ["https://attack.mitre.org/software/S0164", "TDTESS", "After creating a new service for persistence, TDTESS sets the file creation time for the service to the creation time of the victim's legitimate svchost.exe file.[49]"], "G0088": ["https://attack.mitre.org/groups/G0088", "TEMP.Veles", "TEMP.Veles used timestomping to modify the $STANDARD_INFORMATION attribute on tools.[50]"], "S0136": ["https://attack.mitre.org/software/S0136", "USBStealer", "USBStealer sets the timestamps of its dropper files to the last-access and last-write timestamps of a standard Windows library chosen on the system.[51]"], "S0141": ["https://attack.mitre.org/software/S0141", "Winnti for Windows", "Winnti for Windows can set the timestamps for its worker and service components to match that of cmd.exe.[52]"]}, "Mitigation": {}, "Detection": {"File Metadata": ["Monitor for file modifications that collects information on file handle opens and can compare timestamp values", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Modification": ["Monitor for unexpected modifications to file timestamps", "", "", ""]}}
