{"TTP_id": "enterprise-TA0005-T1218-T1218.004", "TTP_name": "InstallUtil", "Description": "Adversaries may use InstallUtil to proxy execution of code through a trusted Windows utility. InstallUtil is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries. [1] The InstallUtil binary may also be digitally signed by Microsoft and located in the .NET directories on a Windows system: C:\\Windows\\Microsoft.NET\\Framework\\v\\InstallUtil.exe and C:\\Windows\\Microsoft.NET\\Framework64\\v\\InstallUtil.exe.InstallUtil may also be used to bypass application control through use of attributes within the binary that execute the class decorated with the attribute [System.ComponentModel.RunInstaller(true)]. [2]", "Property": {"ID": "T1218.004", "Sub-technique of": "T1218", "Tactic": "Defense Evasion", "Platforms": "Windows", "Permissions Required": "User", "Defense Bypassed": "Application control, Digital Certificate Validation", "Contributors": "Casey Smith; Travis Smith, Tripwire", "Version": "2.0", "Created": "23 January 2020", "Last Modified": "11 March 2022"}, "Examples": {"S0631": ["https://attack.mitre.org/software/S0631", "Chaes", "Chaes has used Installutill to download content.[3]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used InstallUtil.exe to execute malicious software.[4]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has used InstallUtil.exe to execute a malicious Beacon stager.[5]"], "S0689": ["https://attack.mitre.org/software/S0689", "WhisperGate", "WhisperGate has used InstallUtil.exe as part of its process to disable Windows Defender.[6]"]}, "Mitigation": {"M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "InstallUtil may not be necessary within a given environment."], "M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Use application control configured to block execution of InstallUtil.exe if it is not required for a given system or network to prevent potential misuse by adversaries."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments used before and after the InstallUtil.exe invocation may also be useful in determining the origin and purpose of the binary being executed.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Use process monitoring to monitor the execution and arguments of InstallUtil.exe. Compare recent invocations of InstallUtil.exe with prior history of known good arguments and executed binaries to determine anomalous and potentially adversarial activity", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
