{"TTP_id": "enterprise-TA0006-T1621", "TTP_name": "Multi-Factor Authentication Request Generation", "Description": "Adversaries may attempt to bypass multi-factor authentication (MFA) mechanisms and gain access to accounts by generating MFA requests sent to users.Adversaries in possession credentials to Valid Accounts may be unable to complete the login process if they lack access to the 2FA or MFA mechanisms required as an additional credential and security control. To circumvent this, adversaries may abuse the automatic generation of push notifications to MFA services such as Duo Push, Microsoft Authenticator, Okta, or similar services to have the user grant access to their account.In some cases, adversaries may continuously repeat login attempts in order to bombard users with MFA push notifications, SMS messages, and phone calls, potentially resulting in the user finally accepting the authentication request in response to \"MFA fatigue.\"[1][2][3]", "Property": {"ID": "T1621", "Sub-techniques": "No sub-techniques", "Tactic": "Credential Access", "Platforms": "Azure AD, Google Workspace, IaaS, Linux, Office 365, SaaS, Windows, macOS", "Contributors": "Jon Sternstein, Stern Security; Pawel Partyka, Microsoft 365 Defender", "Version": "1.0", "Created": "01 April 2022", "Last Modified": "20 April 2022"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used repeated MFA requests to gain access to victim accounts.[3]"]}, "Mitigation": {"M1036": ["https://attack.mitre.org/mitigations/M1036", "Account Use Policies", "Enable account restrictions to prevent login attempts, and the subsequent 2FA/MFA service requests, from being initiated from suspicious locations or when the source of the login attempts do not match the location of the 2FA/MFA smart device."], "M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Implement more secure 2FA/MFA mechanisms in replacement of simple push or one-click 2FA/MFA options. For example, having users enter a one-time code provided by the login screen into the 2FA/MFA application or utilizing other out-of-band 2FA/MFA mechanisms (such as rotating code-based hardware tokens providing rotating codes that need an accompanying user pin) may be more secure. Furthermore, change default configurations and implement limits upon the maximum number of 2FA/MFA request prompts that can be sent to users in period of time.[2]"], "M1017": ["https://attack.mitre.org/mitigations/M1017", "User Training", "Train users to only accept 2FA/MFA requests from login attempts they initiated, to review source location of the login attempt prompting the 2FA/MFA requests, and to report suspicious/unsolicited prompts."]}, "Detection": {"Application Log Content": ["Monitor application logs for suspicious events including repeated MFA failures that may indicate user's primary credentials have been compromised.", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "Logon Session Creation": ["Monitor 2FA/MFA application logs for suspicious events such as rapid login attempts with valid credentials.", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "Logon Session Metadata": ["Monitor 2FA/MFA application logs for suspicious events such as unusual login attempt source location, mismatch in location of login attempt and smart device approving 2FA/MFA request prompts.", "", "", ""], "User Account Authentication": ["Monitor user account logs for suspicious events: unusual login attempt source location, mismatch in location of login attempt and smart device receiving 2FA/MFA request prompts, and high volume of repeated login attempts, all of which may indicate user's primary credentials have been compromised minus 2FA/MFA mechanism.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"]}}
