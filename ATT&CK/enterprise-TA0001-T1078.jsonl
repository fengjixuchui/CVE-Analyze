{"TTP_id": "enterprise-TA0001-T1078", "TTP_name": "Valid Accounts", "Description": "Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.In some cases, adversaries may abuse inactive accounts: for example, those belonging to individuals who are no longer part of an organization. Using these accounts may allow the adversary to evade detection, as the original account user will not be present to identify any anomalous activity taking place on their account.[1]The overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise.[2]", "Property": {"ID": "T1078", "Sub-techniques": "T1078.001, T1078.002, T1078.003, T1078.004", "Tactics": "Defense Evasion, Persistence, Privilege Escalation, Initial Access", "Platforms": "Azure AD, Containers, Google Workspace, IaaS, Linux, Office 365, SaaS, Windows, macOS", "Permissions Required": "Administrator, User", "Effective Permissions": "Administrator, User", "Defense Bypassed": "Anti-virus, Application Control, Firewall, Host Intrusion Prevention Systems, Network Intrusion Detection System, System Access Controls", "CAPEC ID": "CAPEC-560", "Contributors": "Jon Sternstein, Stern Security; Mark Wee; Netskope; Praetorian; Prasad Somasamudram, McAfee; Sekhar Sarukkai, McAfee ; Syed Ummar Farooqh, McAfee; Yossi Weizman, Azure Defender Research Team", "Version": "2.4", "Created": "31 May 2017", "Last Modified": "05 May 2022"}, "Examples": {"G0026": ["https://attack.mitre.org/groups/G0026", "APT18", "APT18 actors leverage legitimate credentials to log into external remote services.[3]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has used legitimate credentials to gain initial access, maintain access, and exfiltrate data from a victim network. The group has specifically used credentials stolen through a spearphishing email to login to the DCCC network. The group has also leveraged default manufacturer's passwords to gain initial access to corporate networks via IoT devices such as a VOIP phone, printer, and video decoder.[4][5][6][7]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 used different compromised credentials for remote access and to move laterally.[8][9][10]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has used valid accounts for initial access and privilege escalation.[11][12]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used stolen credentials to compromise Outlook Web Access (OWA).[13]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used compromised credentials to log on to other systems.[14][15]"], "G0001": ["https://attack.mitre.org/groups/G0001", "Axiom", "Axiom has used previously compromised administrative accounts to escalate privileges.[16]"], "G0008": ["https://attack.mitre.org/groups/G0008", "Carbanak", "Carbanak actors used legitimate credentials of banking employees to perform operations that sent them millions of dollars.[17]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used a valid account to maintain persistence via scheduled task.[18]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has compromised user credentials and used valid accounts for operations.[19][20][21]"], "S0567": ["https://attack.mitre.org/software/S0567", "Dtrack", "Dtrack used hard-coded credentials to gain access to a network share.[22]"], "S0038": ["https://attack.mitre.org/software/S0038", "Duqu", "Adversaries can instruct Duqu to spread laterally by copying itself to shares it has enumerated and for which it has obtained legitimate credentials (via keylogging or other means). The remote host is then infected by using the compromised credentials to schedule a task on remote machines that executes the malware.[23]"], "G0051": ["https://attack.mitre.org/groups/G0051", "FIN10", "FIN10 has used stolen credentials to connect remotely to victim networks using VPNs protected with only a single factor.[24]"], "G0085": ["https://attack.mitre.org/groups/G0085", "FIN4", "FIN4 has used legitimate credentials to hijack email communications.[25][26]"], "G0053": ["https://attack.mitre.org/groups/G0053", "FIN5", "FIN5 has used legitimate VPN, RDP, Citrix, or VNC credentials to maintain access to a victim environment.[27][28][29]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "To move laterally on a victim network, FIN6 has used credentials stolen from various systems on which it gathered usernames and password hashes.[30][31][32]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 has harvested valid administrative credentials for lateral movement.[33]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has used valid accounts for persistence and lateral movement.[34]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used valid credentials with various services during lateral movement.[35]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM leveraged valid accounts to maintain access to a victim network.[36]"], "S0604": ["https://attack.mitre.org/software/S0604", "Industroyer", "Industroyer can use supplied user credentials to execute processes and stop services.[37]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has used credential dumpers or stealers to obtain legitimate credentials, which they used to gain access to victim accounts.[38]"], "S0599": ["https://attack.mitre.org/software/S0599", "Kinsing", "Kinsing has used valid SSH credentials to access remote hosts.[39]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used administrator credentials to gain access to restricted network segments.[40]"], "G0065": ["https://attack.mitre.org/groups/G0065", "Leviathan", "Leviathan has obtained valid accounts to gain initial access.[41][42]"], "S0362": ["https://attack.mitre.org/software/S0362", "Linux Rabbit", "Linux Rabbit acquires valid SSH accounts through brute force. [43]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used valid accounts including shared between Managed Service Providers and clients to move between the two environments.[44][45][46][47]"], "G0014": ["https://attack.mitre.org/groups/G0014", "Night Dragon", "Night Dragon has used compromised VPN accounts to gain access to victim systems.[48]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used compromised credentials to access other systems on a victim network.[49][50][15]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used valid VPN credentials to gain initial access.[51]"], "G0011": ["https://attack.mitre.org/groups/G0011", "PittyTiger", "PittyTiger attempts to obtain legitimate credentials during operations.[52]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team have used previously acquired legitimate credentials prior to attacks.[53]"], "S0053": ["https://attack.mitre.org/software/S0053", "SeaDuke", "Some SeaDuke samples have a module to extract email from Microsoft Exchange servers using compromised credentials.[54]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used compromised credentials to log on to other systems and escalate privileges.[55]"], "G0122": ["https://attack.mitre.org/groups/G0122", "Silent Librarian", "Silent Librarian has used compromised credentials to obtain unauthorized access to online accounts.[56]"], "G0039": ["https://attack.mitre.org/groups/G0039", "Suckfly", "Suckfly used legitimate account credentials that they dumped to navigate the internal victim network as though they were the legitimate account owner.[57]"], "G0088": ["https://attack.mitre.org/groups/G0088", "TEMP.Veles", "TEMP.Veles has used compromised VPN accounts.[58]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 actors obtain legitimate credentials using a variety of methods and use them to further lateral movement on victim networks.[59]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used valid credentials for privileged accounts with the goal of accessing domain controllers.[60]"]}, "Mitigation": {"M1013": ["https://attack.mitre.org/mitigations/M1013", "Application Developer Guidance", "Ensure that applications do not store sensitive data or credentials insecurely. (e.g. plaintext credentials in code, published credentials in repositories, or credentials in public cloud storage)."], "M1027": ["https://attack.mitre.org/mitigations/M1027", "Password Policies", "Applications and appliances that utilize default username and password should be changed immediately after the installation, and before deployment to a production environment. [61] When possible, applications that use SSH keys should be updated periodically and properly secured."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Audit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account. [2] [62] These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers. [63]"], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Regularly audit user accounts for activity and deactivate or remove any that are no longer needed."], "M1017": ["https://attack.mitre.org/mitigations/M1017", "User Training", "Applications may send push notifications to verify a login as a form of multi-factor authentication (MFA). Train users to only accept valid push notifications and to report suspicious push notifications."]}, "Detection": {"Logon Session Creation": ["Monitor for newly constructed logon behavior that may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "Logon Session Metadata": ["Look for suspicious account behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account.", "", "", ""], "User Account Authentication": ["Monitor for an attempt by a user that may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"]}}
