{"TTP_id": "enterprise-TA0011-T1071-T1071.002", "TTP_name": "File Transfer Protocols", "Description": "Adversaries may communicate using application layer protocols associated with transferring files to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.Protocols such as FTP, FTPS, and TFTP that transfer files may be very common in environments. Packets produced from these protocols may have many fields and headers in which data can be concealed. Data could also be concealed within the transferred files. An adversary may abuse these protocols to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.", "Property": {"ID": "T1071.002", "Sub-technique of": "T1071", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "15 March 2020", "Last Modified": "21 August 2020"}, "Examples": {"G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used exploit payloads that initiate download via ftp.[1]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor has used FTP protocol for C2 communication.[2]"], "S0465": ["https://attack.mitre.org/software/S0465", "CARROTBALL", "CARROTBALL has the ability to use FTP in C2 communications.[3]"], "G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Honeybee uses FTP for command and control.[4]"], "S0201": ["https://attack.mitre.org/software/S0201", "JPIN", "JPIN can communicate over FTP.[5]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar uses FTP and FTPS to communicate with the C2 server.[6]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used FTP to download additional malware to the target machine.[7]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete uses FTP for Command & Control.[8][9][10]"], "S0699": ["https://attack.mitre.org/software/S0699", "Mythic", "Mythic supports SMB-based peer-to-peer C2 profiles.[11]"], "S0353": ["https://attack.mitre.org/software/S0353", "NOKKI", "NOKKI has used FTP for C2 communications.[12]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT has used FTP for C2 communications.[13]"], "S0596": ["https://attack.mitre.org/software/S0596", "ShadowPad", "ShadowPad has used FTP for C2 communications.[14]"], "G0083": ["https://attack.mitre.org/groups/G0083", "SilverTerrier", "SilverTerrier uses FTP for C2 communications.[15]"], "S0464": ["https://attack.mitre.org/software/S0464", "SYSCON", "SYSCON has the ability to use FTP in C2 communications.[16][3]"], "S0161": ["https://attack.mitre.org/software/S0161", "XAgentOSX", "XAgentOSX contains the ftpUpload function to use the FTPManager:uploadFile method to upload files from the target system.[17]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell has used FTP for C2 connections.[18]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."]}, "Detection": {"Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""]}}
