{"TTP_id": "enterprise-TA0011-T1571", "TTP_name": "Non-Standard Port", "Description": "Adversaries may communicate using a protocol and port paring that are typically not associated. For example, HTTPS over port 8088[1] or port 587[2] as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.", "Property": {"ID": "T1571", "Sub-techniques": "No sub-techniques", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "14 March 2020", "Last Modified": "26 March 2020"}, "Examples": {"G0099": ["https://attack.mitre.org/groups/G0099", "APT-C-36", "APT-C-36 has used port 4050 for C2 communications.[3]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "An APT32 backdoor can use HTTP over a non-standard TCP port (e.g 14146) which is specified in the backdoor configuration.[4]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has used HTTP over TCP ports 808 and 880 for command and control.[1]"], "S0245": ["https://attack.mitre.org/software/S0245", "BADCALL", "BADCALL communicates on ports 443 and 8000 with a FakeTLS method.[5]"], "S0239": ["https://attack.mitre.org/software/S0239", "Bankshot", "Bankshot binds and listens on port 1058 for HTTP traffic while also utilizing a FakeTLS method.[6]"], "S0574": ["https://attack.mitre.org/software/S0574", "BendyBear", "BendyBear has used a custom RC4 and XOR encrypted protocol over port 443 for C2.[7]"], "S0687": ["https://attack.mitre.org/software/S0687", "Cyclops Blink", "Cyclops Blink can use non-standard ports for C2 not typically associated with HTTP or HTTPS traffic.[8]"], "G0105": ["https://attack.mitre.org/groups/G0105", "DarkVishnya", "DarkVishnya used ports 5190 and 7900 for shellcode listeners, and 4444, 4445, 31337 for shellcode C2.[9]"], "S0021": ["https://attack.mitre.org/software/S0021", "Derusbi", "Derusbi has used unencrypted HTTP on port 443 for C2.[10]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet has used HTTP over ports such as 20, 22, 7080, and 50000, in addition to using ports commonly associated with HTTP/S.[11]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 has used port-protocol mismatches on ports such as 53, 80, 443, and 8080 during C2.[12]"], "S0493": ["https://attack.mitre.org/software/S0493", "GoldenSpy", "GoldenSpy has used HTTP over ports 9005 and 9006 for network traffic, 9002 for C2 requests, 33666 as a WebSocket, and 8090 to download files.[13]"], "S0237": ["https://attack.mitre.org/software/S0237", "GravityRAT", "GravityRAT has used HTTP over a non-standard port, such as TCP port 46769.[14]"], "S0246": ["https://attack.mitre.org/software/S0246", "HARDRAIN", "HARDRAIN binds and listens on port 443 with a FakeTLS method.[15]"], "S0376": ["https://attack.mitre.org/software/S0376", "HOPLIGHT", "HOPLIGHT has connected outbound over TCP port 443 with a FakeTLS method.[16]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Some Lazarus Group malware uses a list of ordered port numbers to choose a port for C2 traffic, creating port-protocol mismatches.[17][18]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound malware has communicated with its C2 server over TCP port 4443 using HTTP.[19]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has communicated with hosts over raw TCP on port 9999.[20]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind communicates over ports 80, 443, 53, and 8080 via raw sockets instead of the protocols usually associated with the ports.[21]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT has used port 1177 for HTTP C2 communications.[22]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT used TLS to encrypt communications over port 143[23]"], "S0153": ["https://attack.mitre.org/software/S0153", "RedLeaves", "RedLeaves can use HTTP over non-standard ports, such as 995, for C2.[24]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke's miner connects to a C2 server using port 51640.[25]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM used Port 44443 for its VNC module.[26]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has used port 6789 to accept connections on the group's SSH server.[27]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used port 444 when sending data about the system from the client to the server.[28]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity has used HTTPS over port 1402 in C2 communication.[29]"], "G0088": ["https://attack.mitre.org/groups/G0088", "TEMP.Veles", "TEMP.Veles has used port-protocol mismatches on ports such as 443, 4444, 8531, and 50501 during C2.[30]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "Some TrickBot samples have used HTTP over ports 447 and 8082 for C2.[31][32][33] Newer versions of TrickBot have been known to use a custom communication protocol which sends the data unencrypted over port 443. [34]"], "S0263": ["https://attack.mitre.org/software/S0263", "TYPEFRAME", "TYPEFRAME has used ports 443, 8080, and 8443 with a FakeTLS method.[35]"], "S0515": ["https://attack.mitre.org/software/S0515", "WellMail", "WellMail has been observed using TCP port 25, without using SMTP, to leverage an open port for secure command and control communications.[36][37]"], "G0090": ["https://attack.mitre.org/groups/G0090", "WIRTE", "WIRTE has used HTTPS over ports 2083 and 2087 for C2.[38]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell can use ports 1985 and 1986 in HTTP/S communication.[39]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports for that particular network segment."]}, "Detection": {"Network Traffic Content": ["Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data flows for unexpected patterns and metadata that may be indicative of a mismatch between protocol and utilized port.", "", "", ""]}}
