{"TTP_id": "enterprise-TA0003-T1137-T1137.006", "TTP_name": "Add-ins", "Description": "Adversaries may abuse Microsoft Office add-ins to obtain persistence on a compromised system. Office add-ins can be used to add functionality to Office programs. [1] There are different types of add-ins that can be used by the various Office products; including Word/Excel add-in Libraries (WLL/XLL), VBA add-ins, Office Component Object Model (COM) add-ins, automation add-ins, VBA Editor (VBE), Visual Studio Tools for Office (VSTO) add-ins, and Outlook add-ins. [2][3]Add-ins can be used to obtain persistence because they can be set to execute code when an Office application starts.", "Property": {"ID": "T1137.006", "Sub-technique of": "T1137", "Tactic": "Persistence", "Platforms": "Office 365, Windows", "Permissions Required": "Administrator, User", "Version": "1.1", "Created": "07 November 2019", "Last Modified": "16 August 2021"}, "Examples": {"S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has been loaded through a .wll extension added to the %APPDATA%\\microsoft\\word\\startup\\ repository.[4]"], "G0019": ["https://attack.mitre.org/groups/G0019", "Naikon", "Naikon has used the RoyalRoad exploit builder to drop a second stage loader, intel.wll, into the Word Startup folder on the compromised host.[5]"]}, "Mitigation": {"M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. [6]"]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may abuse Microsoft Office add-ins to obtain persistence on a compromised system.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Creation": ["Monitor for newly constructed files that may abuse Microsoft Office add-ins to obtain persistence on a compromised system.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Modification": ["Monitor for changes made to files that may abuse Microsoft Office add-ins to obtain persistence on a compromised system.", "", "", ""], "Process Creation": ["Monitor newly executed processes that may abuse Microsoft Office add-ins to obtain persistence on a compromised system.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Windows Registry Key Creation": ["Audit the Registry entries relevant for enabling add-ins.[7][2]", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"], "Windows Registry Key Modification": ["Audit the Registry entries relevant for enabling add-ins.[7][2]", "", "", ""]}}
