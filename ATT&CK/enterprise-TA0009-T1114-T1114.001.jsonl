{"TTP_id": "enterprise-TA0009-T1114-T1114.001", "TTP_name": "Local Email Collection", "Description": "Adversaries may target user email on local systems to collect sensitive information. Files containing email data can be acquired from a user’s local system, such as Outlook storage or cache files.Outlook stores data locally in offline data files with an extension of .ost. Outlook 2010 and later supports .ost file sizes up to 50GB, while earlier versions of Outlook support up to 20GB.[1] IMAP accounts in Outlook 2013 (and earlier) and POP accounts use Outlook Data Files (.pst) as opposed to .ost, whereas IMAP accounts in Outlook 2016 (and later) use .ost files. Both types of Outlook data files are typically stored in C:\\Users\\<username>\\Documents\\Outlook Files or C:\\Users\\<username>\\AppData\\Local\\Microsoft\\Outlook.[2]", "Property": {"ID": "T1114.001", "Sub-technique of": "T1114", "Tactic": "Collection", "Platforms": "Windows", "Permissions Required": "User", "Version": "1.0", "Created": "19 February 2020", "Last Modified": "24 March 2020"}, "Examples": {"G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 uses two utilities, GETMAIL and MAPIGET, to steal email. GETMAIL extracts emails from archived Outlook .pst files.[3]"], "S0030": ["https://attack.mitre.org/software/S0030", "Carbanak", "Carbanak searches recursively for Outlook personal storage tables (PST) files within user directories and sends them back to the C2 server.[4]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has harvested data from victim's e-mail including through execution of wmic /node: process call create \"cmd /c copy c:\\Users\\\\\\backup.pst c:\\windows\\temp\\backup.pst\" copy \"i:\\\\\\My Documents\\.pst\"copy.[5]"], "S0050": ["https://attack.mitre.org/software/S0050", "CosmicDuke", "CosmicDuke searches for Microsoft Outlook data files with extensions .pst and .ost for collection and exfiltration.[6]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson contains a command to collect and exfiltrate emails from Outlook.[7]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet has been observed leveraging a module that scrapes email data from Outlook.[8]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire has the ability to collect emails on a target system.[9]"], "S0526": ["https://attack.mitre.org/software/S0526", "KGH_SPY", "KGH_SPY can harvest data from mail clients.[10]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound has collected .PST archives.[11]"], "S0594": ["https://attack.mitre.org/software/S0594", "Out1", "Out1 can parse e-mails on a target machine.[12]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy can interact with a victim’s Outlook session and look through folders and emails.[13]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can target and steal locally stored emails to support thread hijacking phishing campaigns.[14][14][15][16]"], "S0226": ["https://attack.mitre.org/software/S0226", "Smoke Loader", "Smoke Loader searches through Outlook files and directories (e.g., inbox, sent, templates, drafts, archives, etc.).[17]"]}, "Mitigation": {"M1041": ["https://attack.mitre.org/mitigations/M1041", "Encrypt Sensitive Information", "Use of encryption provides an added layer of security to sensitive information sent over email. Encryption using public key cryptography requires the adversary to obtain the private certificate along with an encryption key to decrypt messages."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments for actions that could be taken to gather local email files. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor for unusual processes accessing local email files that may target user email on local systems to collect sensitive information.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"]}}
