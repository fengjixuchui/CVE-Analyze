{"TTP_id": "enterprise-TA0004-T1548-T1548.002", "TTP_name": "Bypass User Account Control", "Description": "Adversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action.[1]If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevated Component Object Model objects without prompting the user through the UAC notification box.[2][3] An example of this is use of Rundll32 to load a specifically crafted DLL which loads an auto-elevated Component Object Model object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user.[4]Many methods have been discovered to bypass UAC. The Github readme page for UACME contains an extensive list of methods[5] that have been discovered and implemented, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:Another bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on remote systems and default to high integrity.[8]", "Property": {"ID": "T1548.002", "Sub-technique of": "T1548", "Tactics": "Privilege Escalation, Defense Evasion", "Platforms": "Windows", "Permissions Required": "Administrator, User", "Effective Permissions": "Administrator", "Defense Bypassed": "Windows User Account Control", "Contributors": "Casey Smith; Stefan Kanthak", "Version": "2.0", "Created": "30 January 2020", "Last Modified": "19 April 2022"}, "Examples": {"S0584": ["https://attack.mitre.org/software/S0584", "AppleJeus", "AppleJeus has presented the user with a UAC prompt to elevate privileges while installing.[9]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has bypassed UAC.[10]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 has a function in the initial dropper to bypass Windows UAC in order to execute the next payload with higher privileges.[11]"], "S0129": ["https://attack.mitre.org/software/S0129", "AutoIt backdoor", "AutoIt backdoor attempts to escalate privileges by bypassing User Access Control.[12]"], "S0640": ["https://attack.mitre.org/software/S0640", "Avaddon", "Avaddon bypasses UAC using the CMSTPLUA COM interface.[13]"], "S0606": ["https://attack.mitre.org/software/S0606", "Bad Rabbit", "Bad Rabbit has attempted to bypass UAC and gain elevated administrative privileges.[14]"], "S0570": ["https://attack.mitre.org/software/S0570", "BitPaymer", "BitPaymer can suppress UAC prompts by setting the HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command registry key on Windows 10 or HKCU\\Software\\Classes\\mscfile\\shell\\open\\command on Windows 7 and launching the eventvwr.msc process, which launches BitPaymer with elevated privileges.[15]"], "S0089": ["https://attack.mitre.org/software/S0089", "BlackEnergy", "BlackEnergy attempts to bypass default User Access Control (UAC) settings by exploiting a backward-compatibility setting found in Windows 7 and later.[16]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has used a Windows 10 specific tool and xxmm to bypass UAC for privilege escalation.[17][18]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling has the ability to bypass UAC using a passuac.dll file.[19][20]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has bypassed UAC.[21]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can use a number of known techniques to bypass Windows UAC.[22][23]"], "S0527": ["https://attack.mitre.org/software/S0527", "CSPY Downloader", "CSPY Downloader can bypass UAC using the SilentCleanup task to execute the binary with elevated privileges.[24]"], "S0134": ["https://attack.mitre.org/software/S0134", "Downdelph", "Downdelph bypasses UAC to escalate privileges by using a custom \"RedirectEXE\" shim database.[25]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire includes various modules to attempt to bypass UAC for escalation of privileges.[26]"], "G0120": ["https://attack.mitre.org/groups/G0120", "Evilnum", "Evilnum has used PowerShell to bypass UAC.[27]"], "S0182": ["https://attack.mitre.org/software/S0182", "FinFisher", "FinFisher performs UAC bypass.[28][29]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium can bypass UAC to elevate process privileges on a compromised host.[30]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can bypass UAC by registering as the default handler for .MSC files.[31]"], "S0132": ["https://attack.mitre.org/software/S0132", "H1N1", "H1N1 bypasses user access control by using a DLL hijacking vulnerability in the Windows Update Standalone Installer (wusa.exe).[32]"], "G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Honeybee uses a combination of NTWDBLIB.dll and cliconfg.exe to bypass UAC protections using DLL hijacking.[33]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can use fileless UAC bypass and create an elevated COM object to escalate privileges.[34][35]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic has 2 methods for elevating integrity. It can bypass UAC through eventvwr.exe and sdclt.exe.[36]"], "S0669": ["https://attack.mitre.org/software/S0669", "KOCTOPUS", "KOCTOPUS will perform UAC bypass either through fodhelper.exe or eventvwr.exe.[37]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has bypassed UAC by performing token impersonation as well as an RPC-based method, this included bypassing UAC set to \"AlwaysNotify\".[38][39]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot has utilized multiple techniques to bypass UAC.[40]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater uses various techniques to bypass UAC.[41]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork bypassed User Access Control (UAC).[42]"], "S0501": ["https://attack.mitre.org/software/S0501", "PipeMon", "PipeMon installer can use UAC bypass techniques to install the payload.[43]"], "S0254": ["https://attack.mitre.org/software/S0254", "PLAINTEE", "An older variant of PLAINTEE performs UAC bypass.[44]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 can utilize multiple methods to bypass UAC.[45]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy can bypass Windows UAC through either DLL hijacking, eventvwr, or appPaths.[46]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can use UACMe for privilege escalation.[47][48]"], "S0662": ["https://attack.mitre.org/software/S0662", "RCSession", "RCSession can bypass UAC to escalate privileges.[19]"], "S0332": ["https://attack.mitre.org/software/S0332", "Remcos", "Remcos has a command for UAC bypassing.[49]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM can attempt to run the program as admin, then show a fake error message and a legitimate UAC bypass prompt to the user in an attempt to socially engineer the user into escalating privileges.[50]"], "S0074": ["https://attack.mitre.org/software/S0074", "Sakula", "Sakula contains UAC bypass code for both 32- and 64-bit systems.[51]"], "S0140": ["https://attack.mitre.org/software/S0140", "Shamoon", "Shamoon attempts to disable UAC remote restrictions by modifying the Registry.[52]"], "S0444": ["https://attack.mitre.org/software/S0444", "ShimRat", "ShimRat has hijacked the cryptbase.dll within migwiz.exe to escalate privileges. This prevented the User Access Control window from appearing.[53]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY contains a number of modules that can bypass UAC, including through Window's Device Manager, Manage Optional Features, and an image hijack on the .msc file extension.[54]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "A Threat Group-3390 tool can use a public UAC bypass method to elevate privileges.[55]"], "S0116": ["https://attack.mitre.org/software/S0116", "UACMe", "UACMe contains many methods for bypassing Windows User Account Control on multiple versions of the operating system.[5]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT can use sdclt.exe to bypass UAC in Windows 10 to escalate privileges; for older Windows versions WarzoneRAT can use the IFileOperation exploit to bypass the UAC module.[56][57]"], "S0612": ["https://attack.mitre.org/software/S0612", "WastedLocker", "WastedLocker can perform a UAC bypass if it is not executed with administrator rights or if the infected host runs Windows Vista or later.[58]"], "S0141": ["https://attack.mitre.org/software/S0141", "Winnti for Windows", "Winnti for Windows can use a variant of the sysprep UAC bypass.[59]"], "S0230": ["https://attack.mitre.org/software/S0230", "ZeroT", "Many ZeroT samples can perform UAC bypass by using eventvwr.exe to execute a malicious file.[60]"]}, "Mitigation": {"M1047": ["https://attack.mitre.org/mitigations/M1047", "Audit", "Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.[5]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Remove users from the local administrator group on systems."], "M1051": ["https://attack.mitre.org/mitigations/M1051", "Update Software", "Consider updating Windows to the latest version and patch level to utilize the latest protective measures against UAC bypass.[5]"], "M1052": ["https://attack.mitre.org/mitigations/M1052", "User Account Control", "Although UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such as DLL Search Order Hijacking."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may bypass UAC mechanisms to elevate process privileges on system.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor newly executed processes, such as eventvwr.exe and sdclt.exe, that may bypass UAC mechanisms to elevate process privileges on system.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Metadata": ["Monitor contextual data about a running process, which may include information such as environment variables, image name, user/owner that may bypass UAC mechanisms to elevate process privileges on system.", "", "", ""], "Windows Registry Key Modification": ["Some UAC bypass methods rely on modifying specific, user-accessible Registry settings. For example:* The eventvwr.exe bypass uses the [HKEY_CURRENT_USER]\\Software\\Classes\\mscfile\\shell\\open\\command Registry key.[6]* The sdclt.exe bypass uses the [HKEY_CURRENT_USER]\\Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\control.exe and [HKEY_CURRENT_USER]\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand Registry keys.[61][62]Analysts should monitor these Registry settings for unauthorized changes.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
