{"TTP_id": "enterprise-TA0006-T1003-T1003.006", "TTP_name": "DCSync", "Description": "Adversaries may attempt to access credentials and other sensitive information by abusing a Windows Domain Controller's application programming interface (API)[1] [2] [3] [4] to simulate the replication process from a remote domain controller using a technique called DCSync.Members of the Administrators, Domain Admins, and Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data[5] from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create a Golden Ticket for use in Pass the Ticket[6] or change an account's password as noted in Account Manipulation.[7]DCSync functionality has been included in the \"lsadump\" module in Mimikatz.[8] Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol.[9]", "Property": {"ID": "T1003.006", "Sub-technique of": "T1003", "Tactic": "Credential Access", "Platforms": "Windows", "Permissions Required": "Administrator", "Contributors": "ExtraHop; Vincent Le Toux", "Version": "1.0", "Created": "11 February 2020", "Last Modified": "22 April 2021"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 leveraged privileged accounts to replicate directory service data with domain controllers.[10][11][12]"], "S0002": ["https://attack.mitre.org/software/S0002", "Mimikatz", "Mimikatz performs credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from DCSync/NetSync.[13][8][14][15][16]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used Mimikatz's DCSync to dump credentials from the memory of the targeted system.[17]"]}, "Mitigation": {"M1015": ["https://attack.mitre.org/mitigations/M1015", "Active Directory Configuration", "Manage the access control list for \"Replicating Directory Changes\" and other permissions associated with domain controller replication.[5][18]"], "M1027": ["https://attack.mitre.org/mitigations/M1027", "Password Policies", "Ensure that local administrator accounts have complex, unique passwords across all systems on the network."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Do not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers."]}, "Detection": {"Active Directory Object Access": ["Monitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync.[1] [2] [3] Note: Domain controllers may not log replication requests originating from the default domain controller account.[19]", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
