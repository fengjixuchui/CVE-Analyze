{"TTP_id": "enterprise-TA0009-T1560-T1560.003", "TTP_name": "Archive via Custom Method", "Description": "An adversary may compress or encrypt data that is collected prior to exfiltration using a custom method. Adversaries may choose to use custom archival methods, such as encryption with XOR or stream ciphers implemented with no external library or utility references. Custom implementations of well-known compression algorithms have also been used.[1]", "Property": {"ID": "T1560.003", "Sub-technique of": "T1560", "Tactic": "Collection", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "20 February 2020", "Last Modified": "25 March 2020"}, "Examples": {"S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "ADVSTORESHELL compresses output data generated by command execution with a custom implementation of the Lempel–Ziv–Welch (LZW) algorithm.[1]"], "S0092": ["https://attack.mitre.org/software/S0092", "Agent.btz", "Agent.btz saves system information into an XML file that is then XOR-encoded.[2]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor encrypts collected data with a custom implementation of Blowfish and RSA ciphers.[3]"], "S0657": ["https://attack.mitre.org/software/S0657", "BLUELIGHT", "BLUELIGHT has encoded data into a binary blob using XOR.[4]"], "G0052": ["https://attack.mitre.org/groups/G0052", "CopyKittens", "CopyKittens encrypts data with a substitute cipher prior to exfiltration.[5]"], "S0038": ["https://attack.mitre.org/software/S0038", "Duqu", "Modules can be pushed to and executed by Duqu that copy data to a staging area, compress it, and XOR encrypt it.[6]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has encoded data gathered from the victim with a simple substitution cipher and single-byte XOR using the 0xAA key, and Base64 with character permutation.[7][8]"], "S0036": ["https://attack.mitre.org/software/S0036", "FLASHFLOOD", "FLASHFLOOD employs the same encoding scheme as SPACESHIP for data it stages. Data is compressed with zlib, and bytes are rotated four times before being XOR'ed with 0x23.[9]"], "S0661": ["https://attack.mitre.org/software/S0661", "FoggyWeb", "FoggyWeb can use a dynamic XOR key and a custom XOR methodology to encode data before exfiltration. Also, FoggyWeb can encode C2 command output within a legitimate WebP file.[10]"], "S0503": ["https://attack.mitre.org/software/S0503", "FrameworkPOS", "FrameworkPOS can XOR credit card information before exfiltration.[11]"], "S0391": ["https://attack.mitre.org/software/S0391", "HAWKBALL", "HAWKBALL has encrypted data with XOR before sending it over the C2 channel.[12]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole uses a variation of the XOR cipher to encrypt files before exfiltration.[13]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used RC4 encryption before exfil.[14]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "A Lazarus Group malware sample encrypts data using a simple byte based XOR operation prior to exfiltration.[15][16][17][18]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete's collected data is encrypted with AES before exfiltration.[19]"], "S0443": ["https://attack.mitre.org/software/S0443", "MESSAGETAP", "MESSAGETAP has XOR-encrypted and stored contents of SMS messages that matched its target list. [20]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has encrypted documents with RC4 prior to exfiltration.[21]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE has used a custom encryption algorithm to encrypt collected data.[22]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum has used a custom implementation of AES encryption to encrypt collected data.[23]"], "S0264": ["https://attack.mitre.org/software/S0264", "OopsIE", "OopsIE compresses collected files with a simple character replacement scheme before sending them to its C2 server.[24]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D scrambles and encrypts data using AES256 before sending it to the C2 server.[25][26]"], "S0072": ["https://attack.mitre.org/software/S0072", "OwaAuth", "OwaAuth DES-encrypts captured credentials using the key 12345678 before writing the credentials to a log file.[27]"], "S0458": ["https://attack.mitre.org/software/S0458", "Ramsay", "Ramsay can store collected documents in a custom container after encrypting and compressing them using RC4 and WinRAR.[28]"], "S0169": ["https://attack.mitre.org/software/S0169", "RawPOS", "RawPOS encodes credit card data it collected from the victim with XOR.[29][30][31]"], "S0172": ["https://attack.mitre.org/software/S0172", "Reaver", "Reaver encrypts collected data with an incremental XOR key prior to exfiltration.[32]"], "S0258": ["https://attack.mitre.org/software/S0258", "RGDoor", "RGDoor encrypts files with XOR before sending them back to the C2 server.[33]"], "S0448": ["https://attack.mitre.org/software/S0448", "Rising Sun", "Rising Sun can archive data using RC4 encryption and Base64 encoding prior to exfiltration.[34]"], "S0035": ["https://attack.mitre.org/software/S0035", "SPACESHIP", "Data SPACESHIP copies to the staging area is compressed with zlib. Bytes are rotated by four positions and XOR'ed with 0x23.[9]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity can compress and encrypt archived files into multiple .sft files with a repeated xor encryption scheme.[35][36]"], "S0603": ["https://attack.mitre.org/software/S0603", "Stuxnet", "Stuxnet encrypts exfiltrated data via C2 with static 31-byte long XOR keys.[37]"], "S0098": ["https://attack.mitre.org/software/S0098", "T9000", "T9000 encrypts collected data using a single byte XOR key.[38]"]}, "Mitigation": {}, "Detection": {"File Creation": ["Monitor newly constructed files being written with extensions and/or headers associated with compressed or encrypted file types. Detection efforts may focus on follow-on exfiltration activity, where compressed or encrypted files can be detected in transit with a network intrusion detection or data loss prevention system analyzing file headers.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Script Execution": ["Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0012", "https://attack.mitre.org/datasources/DS0012", "Script"]}}
