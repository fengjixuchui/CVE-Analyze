{"TTP_id": "enterprise-TA0008-T1021-T1021.003", "TTP_name": "Distributed Component Object Model", "Description": "Adversaries may use Valid Accounts to interact with remote machines by taking advantage of Distributed Component Object Model (DCOM). The adversary may then perform actions as the logged-on user.The Windows Component Object Model (COM) is a component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces. Through COM, a client object can call methods of server objects, which are typically Dynamic Link Libraries (DLL) or executables (EXE). Distributed COM (DCOM) is transparent middleware that extends the functionality of COM beyond a local computer using remote procedure call (RPC) technology.[1][2]Permissions to interact with local and remote server COM objects are specified by access control lists (ACL) in the Registry.[3] By default, only Administrators may remotely activate and launch COM objects through DCOM.[4]Through DCOM, adversaries operating in the context of an appropriately privileged user can remotely obtain arbitrary and even direct shellcode execution through Office applications[5] as well as other Windows objects that contain insecure methods.[6][7] DCOM can also execute macros in existing documents[8] and may also invoke Dynamic Data Exchange (DDE) execution directly through a COM created instance of a Microsoft Office application[9], bypassing the need for a malicious document. DCOM can be used as a method of remotely interacting with Windows Management Instrumentation. [10]", "Property": {"ID": "T1021.003", "Sub-technique of": "T1021", "Tactic": "Lateral Movement", "Platforms": "Windows", "Permissions Required": "Administrator, SYSTEM", "Version": "1.1", "Created": "11 February 2020", "Last Modified": "23 June 2021"}, "Examples": {"S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can deliver Beacon payloads for lateral movement by leveraging remote COM execution.[11]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can utilize Invoke-DCOM to leverage remote COM execution for lateral movement.[12]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can use System namespace methods to execute lateral movement using DCOM.[13]"]}, "Mitigation": {"M1048": ["https://attack.mitre.org/mitigations/M1048", "Application Isolation and Sandboxing", "Ensure all COM alerts and Protected View are enabled.[14]"], "M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Consider disabling DCOM through Dcomcnfg.exe.[15]"], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Enable Windows firewall, which prevents DCOM instantiation by default."], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Modify Registry settings (directly or using Dcomcnfg.exe) in HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{{AppID_GUID}} associated with the process-wide security of individual COM applications.[3]Modify Registry settings (directly or using Dcomcnfg.exe) in HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole associated with system-wide security defaults for all COM applications that do not set their own process-wide security.[16] [4]"]}, "Detection": {"Module Load": ["Monitor for COM objects loading DLLs and other modules not typically associated with the application.[5]", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "Network Connection Creation": ["Monitor for newly constructed network connections that may use Valid Accounts to interact with remote machines using Distributed Component Object Model (DCOM). The adversary may then perform actions as the logged-on user. Monitor for any influxes or abnormal increases in DCOM related Distributed Computing Environment/Remote Procedure Call (DCE/RPC) traffic (typically over port 135).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Process Creation": ["Monitor for newly executed processes associated with DCOM activity, especially those invoked by a user different than the one currently logged on. Enumeration of COM objects, via Query Registry or PowerShell, may also precede malicious use.[1][6]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
