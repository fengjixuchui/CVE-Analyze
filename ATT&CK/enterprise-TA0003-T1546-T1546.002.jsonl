{"TTP_id": "enterprise-TA0003-T1546-T1546.002", "TTP_name": "Screensaver", "Description": "Adversaries may establish persistence by executing malicious content triggered by user inactivity. Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension.[1] The Windows screensaver application scrnsave.scr is located in C:\\Windows\\System32\\, and C:\\Windows\\sysWOW64\\ on 64-bit Windows systems, along with screensavers included with base Windows installations.The following screensaver settings are stored in the Registry (HKCU\\Control Panel\\Desktop\\) and could be manipulated to achieve persistence:Adversaries can use screensaver settings to maintain persistence by setting the screensaver to run malware after a certain timeframe of user inactivity.[2]", "Property": {"ID": "T1546.002", "Sub-technique of": "T1546", "Tactics": "Privilege Escalation, Persistence", "Platforms": "Windows", "Permissions Required": "User", "Contributors": "Bartosz Jerzman", "Version": "1.0", "Created": "24 January 2020", "Last Modified": "20 April 2022"}, "Examples": {"S0168": ["https://attack.mitre.org/software/S0168", "Gazer", "Gazer can establish persistence through the system screensaver by configuring it to execute the malware.[2]"]}, "Mitigation": {"M1042": ["https://attack.mitre.org/mitigations/M1042", "Disable or Remove Feature or Program", "Use Group Policy to disable screensavers if they are unnecessary.[3]"], "M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Block .scr files from being executed from non-standard locations."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments of .scr files.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Creation": ["Monitor newly constructed files that may establish persistence by executing malicious content triggered by user inactivity.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "File Modification": ["Monitor for changes made to files that may establish persistence by executing malicious content triggered by user inactivity.", "", "", ""], "Process Creation": ["Monitor newly executed processes that may establish persistence by executing malicious content triggered by user inactivity.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Windows Registry Key Modification": ["Monitor changes to screensaver configuration changes in the Registry that may not correlate with typical user behavior. Tools such as Sysinternals Autoruns can be used to detect changes to the screensaver binary path in the Registry.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
