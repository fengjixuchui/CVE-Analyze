{"TTP_id": "enterprise-TA0011-T1095", "TTP_name": "Non-Application Layer Protocol", "Description": "Adversaries may use a non-application layer protocol for communication between host and C2 server or among infected hosts within a network. The list of possible protocols is extensive.[1] Specific examples include use of network layer protocols, such as the Internet Control Message Protocol (ICMP), transport layer protocols, such as the User Datagram Protocol (UDP), session layer protocols, such as Socket Secure (SOCKS), as well as redirected/tunneled protocols, such as Serial over LAN (SOL).ICMP communication between hosts is one example.[2] Because ICMP is part of the Internet Protocol Suite, it is required to be implemented by all IP-compatible hosts.[3] However, it is not as commonly monitored as other Internet Protocols such as TCP or UDP and may be used by adversaries to hide communications.", "Property": {"ID": "T1095", "Sub-techniques": "No sub-techniques", "Tactic": "Command and Control", "Platforms": "Linux, Network, Windows, macOS", "Contributors": "Ryan Becwar", "Version": "2.1", "Created": "31 May 2017", "Last Modified": "17 February 2022"}, "Examples": {"S0504": ["https://attack.mitre.org/software/S0504", "Anchor", "Anchor has used ICMP in C2 communications.[4]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 has used TCP for C2 communications.[5]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "An APT3 downloader establishes SOCKS5 connections for its initial C2.[6]"], "S0456": ["https://attack.mitre.org/software/S0456", "Aria-body", "Aria-body has used TCP in C2 communications.[7]"], "G0135": ["https://attack.mitre.org/groups/G0135", "BackdoorDiplomacy", "BackdoorDiplomacy has used EarthWorm for network tunneling with a SOCKS5 server and port transfer functionalities.[8]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook has a command built in to use a raw TCP socket.[9]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has used raw sockets for network communication.[10]"], "S0043": ["https://attack.mitre.org/software/S0043", "BUBBLEWRAP", "BUBBLEWRAP can communicate using SOCKS.[11]"], "S0335": ["https://attack.mitre.org/software/S0335", "Carbon", "Carbon uses TCP and UDP for C2.[12]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling has the ability to use TCP and UDP for communication.[13]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can be configured to use TCP, ICMP, and UDP for C2 communications.[14][15]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson uses a custom TCP protocol for C2.[16][17]"], "S0498": ["https://attack.mitre.org/software/S0498", "Cryptoistic", "Cryptoistic can use TCP in communications with C2.[18]"], "S0021": ["https://attack.mitre.org/software/S0021", "Derusbi", "Derusbi binds to a raw socket on a random source port between 31800 and 31900 for C2.[19]"], "S0502": ["https://attack.mitre.org/software/S0502", "Drovorub", "Drovorub can use TCP to communicate between its agent and client modules.[20]"], "S0076": ["https://attack.mitre.org/software/S0076", "FakeM", "Some variants of FakeM use SSL to communicate with C2 servers.[21]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has used Metasploit Bind and Reverse TCP stagers.[22]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium has the ability to use TCP and UDP in C2 communications.[23]"], "S0032": ["https://attack.mitre.org/software/S0032", "gh0st RAT", "gh0st RAT has used an encrypted protocol within TCP segments to communicate with the C2.[24]"], "G0125": ["https://attack.mitre.org/groups/G0125", "HAFNIUM", "HAFNIUM has used TCP for C2.[25]"], "S0394": ["https://attack.mitre.org/software/S0394", "HiddenWasp", "HiddenWasp communicates with a simple network protocol over TCP.[26]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole has used TCP to download additional modules.[27]"], "S0582": ["https://attack.mitre.org/software/S0582", "LookBack", "LookBack uses a custom binary protocol over sockets for C2 communications.[28]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has used raw TCP for C2.[29]"], "S0084": ["https://attack.mitre.org/software/S0084", "Mis-Type", "Mis-Type network traffic can communicate over a raw socket.[30]"], "S0083": ["https://attack.mitre.org/software/S0083", "Misdat", "Misdat network traffic communicates over a raw socket.[30]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind completes network communication via raw sockets.[31]"], "S0699": ["https://attack.mitre.org/software/S0699", "Mythic", "Mythic supports WebSocket and TCP-based C2 profiles.[32]"], "S0630": ["https://attack.mitre.org/software/S0630", "Nebulae", "Nebulae can use TCP in C2 communications.[33]"], "S0034": ["https://attack.mitre.org/software/S0034", "NETEAGLE", "If NETEAGLE does not detect a proxy configured on the infected machine, it will send beacons via UDP/6000. Also, after retrieving a C2 IP address and Port Number, NETEAGLE will initiate a TCP connection to this socket. The ensuing connection is a plaintext C2 channel in which commands are specified by DWORDs.[34]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE can use TCP in C2 communications.[35][36]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used a custom protocol for command and control.[37]"], "S0556": ["https://attack.mitre.org/software/S0556", "Pay2Key", "Pay2Key has sent its public key to the C2 server over TCP.[38]"], "S0587": ["https://attack.mitre.org/software/S0587", "Penquin", "The Penquin C2 mechanism is based on TCP and UDP packets.[39][40]"], "S0158": ["https://attack.mitre.org/software/S0158", "PHOREAL", "PHOREAL communicates via ICMP for C2.[41]"], "S0501": ["https://attack.mitre.org/software/S0501", "PipeMon", "The PipeMon communication module can use a custom protocol based on TLS over TCP.[42]"], "G0068": ["https://attack.mitre.org/groups/G0068", "PLATINUM", "PLATINUM has used the IntelÂ® Active Management Technology (AMT) Serial-over-LAN (SOL) channel for command and control.[43]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX can be configured to use raw TCP or UDP for command and control.[44]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot has the ability use TCP to send or receive C2 packets.[45]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay can use TCP in C2 communications.[33]"], "S0055": ["https://attack.mitre.org/software/S0055", "RARSTONE", "RARSTONE uses SSL to encrypt its communication with its C2 server.[46]"], "S0662": ["https://attack.mitre.org/software/S0662", "RCSession", "RCSession has the ability to use TCP and UDP in C2 communications.[13][47]"], "S0172": ["https://attack.mitre.org/software/S0172", "Reaver", "Some Reaver variants use raw TCP for C2.[48]"], "S0019": ["https://attack.mitre.org/software/S0019", "Regin", "The Regin malware platform can use ICMP to communicate between infected computers.[49]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec is capable of using ICMP, TCP, and UDP for C2.[50][51]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has the ability to communicate with C2 with TCP over port 443.[52]"], "S0596": ["https://attack.mitre.org/software/S0596", "ShadowPad", "ShadowPad has used UDP for C2 communications.[53]"], "S0615": ["https://attack.mitre.org/software/S0615", "SombRAT", "SombRAT has the ability to use TCP sockets to send data and ICMP to ping the C2 server.[54][55]"], "S0011": ["https://attack.mitre.org/software/S0011", "Taidoor", "Taidoor can use TCP for C2 communications.[56]"], "S0436": ["https://attack.mitre.org/software/S0436", "TSCookie", "TSCookie can use ICMP to receive information on the destination server.[57]"], "S0221": ["https://attack.mitre.org/software/S0221", "Umbreon", "Umbreon provides access to the system via SSH or any other protocol that uses PAM to authenticate.[58]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT can communicate with its C2 server via TCP over port 5200.[59]"], "S0515": ["https://attack.mitre.org/software/S0515", "WellMail", "WellMail can use TCP for C2 communications.[60]"], "S0155": ["https://attack.mitre.org/software/S0155", "WINDSHIELD", "WINDSHIELD C2 traffic can communicate via TCP raw sockets.[41]"], "S0430": ["https://attack.mitre.org/software/S0430", "Winnti for Linux", "Winnti for Linux has used ICMP, custom TCP, and UDP in outbound communications.[61]"], "S0141": ["https://attack.mitre.org/software/S0141", "Winnti for Windows", "Winnti for Windows can communicate using custom TCP.[62]"]}, "Mitigation": {"M1037": ["https://attack.mitre.org/mitigations/M1037", "Filter Network Traffic", "Filter network traffic to prevent use of protocols across the network boundary that are unnecessary."], "M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Properly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces."]}, "Detection": {"Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
