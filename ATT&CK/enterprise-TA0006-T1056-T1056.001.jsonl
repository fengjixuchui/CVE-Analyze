{"TTP_id": "enterprise-TA0006-T1056-T1056.001", "TTP_name": "Keylogging", "Description": "Adversaries may log user keystrokes to intercept credentials as the user types them. Keylogging is likely to be used to acquire credentials for new access opportunities when OS Credential Dumping efforts are not effective, and may require an adversary to intercept keystrokes on a system for a substantial period of time before credentials can be successfully captured.Keylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes.[1] Some methods include:", "Property": {"ID": "T1056.001", "Sub-technique of": "T1056", "Tactics": "Collection, Credential Access", "Platforms": "Linux, Network, Windows, macOS", "Permissions Required": "Administrator, SYSTEM, User, root", "CAPEC ID": "CAPEC-568", "Version": "1.1", "Created": "11 February 2020", "Last Modified": "21 October 2020"}, "Examples": {"S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "ADVSTORESHELL can perform keylogging.[3][4]"], "S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla can log keystrokes on the victim’s machine.[5][6][7][8][9]"], "G0130": ["https://attack.mitre.org/groups/G0130", "Ajax Security Team", "Ajax Security Team has used CWoolger and MPK, custom-developed malware, which recorded all keystrokes on an infected system.[10]"], "S0622": ["https://attack.mitre.org/software/S0622", "AppleSeed", "AppleSeed can use GetKeyState and GetKeyboardState to capture keystrokes on the victim’s machine.[11][12]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has used tools to perform keylogging.[13][14][15]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "APT3 has used a keylogging tool that records keystrokes in encrypted files.[16]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has abused the PasswordChangeNotify to monitor for and capture account password changes.[17]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 used a Trojan called KEYLIME to capture keystrokes from the victim’s machine.[18]"], "G0087": ["https://attack.mitre.org/groups/G0087", "APT39", "APT39 has used tools for capturing keystrokes.[19][20]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used a keylogger called GEARSHIFT on a target system.[21]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth logs keystrokes from the victim's machine. [22]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "One of Attor's plugins can collect user credentials via capturing keystrokes and can capture keystrokes pressed within the window of the injected process.[23]"], "S0414": ["https://attack.mitre.org/software/S0414", "BabyShark", "BabyShark has a PowerShell-based remote administration ability that can implement a PowerShell or C# based keylogger.[24]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "When it first starts, BADNEWS spawns a new thread to log keystrokes.[25][26][27]"], "S0337": ["https://attack.mitre.org/software/S0337", "BadPatch", "BadPatch has a keylogging capability.[28]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook contains keylogging capabilities.[29]"], "S0017": ["https://attack.mitre.org/software/S0017", "BISCUIT", "BISCUIT can capture keystrokes.[30]"], "S0089": ["https://attack.mitre.org/software/S0089", "BlackEnergy", "BlackEnergy has run a keylogger plug-in on a victim.[31]"], "S0454": ["https://attack.mitre.org/software/S0454", "Cadelspy", "Cadelspy has the ability to log keystrokes on the compromised host.[32]"], "S0030": ["https://attack.mitre.org/software/S0030", "Carbanak", "Carbanak logs key strokes for configured processes and sends them back to the C2 server.[33][34]"], "S0348": ["https://attack.mitre.org/software/S0348", "Cardinal RAT", "Cardinal RAT can log keystrokes.[35]"], "S0261": ["https://attack.mitre.org/software/S0261", "Catchamas", "Catchamas collects keystrokes from the victim’s machine.[36]"], "S0023": ["https://attack.mitre.org/software/S0023", "CHOPSTICK", "CHOPSTICK is capable of performing keylogging.[37][3][14]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling can capture keystrokes on a compromised host.[38][39]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can track key presses with a keylogger module.[40][41][42]"], "S0338": ["https://attack.mitre.org/software/S0338", "Cobian RAT", "Cobian RAT has a feature to perform keylogging on the victim’s machine.[43]"], "S0050": ["https://attack.mitre.org/software/S0050", "CosmicDuke", "CosmicDuke uses a keylogger.[44]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson can use a module to perform keylogging on compromised hosts.[45][46]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba logs keystrokes via polling by using GetKeyState and VkKeyScan functions.[47]"], "S0334": ["https://attack.mitre.org/software/S0334", "DarkComet", "DarkComet has a keylogging capability.[48]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel has used a keylogger.[49]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can track key presses with a keylogger module.[50]"], "S0187": ["https://attack.mitre.org/software/S0187", "Daserf", "Daserf can log keystrokes.[51][52]"], "S0021": ["https://attack.mitre.org/software/S0021", "Derusbi", "Derusbi is capable of logging keystrokes.[53]"], "S0213": ["https://attack.mitre.org/software/S0213", "DOGCALL", "DOGCALL is capable of logging keystrokes.[54][55]"], "S0567": ["https://attack.mitre.org/software/S0567", "Dtrack", "Dtrack’s dropper contains a keylogging executable.[56]"], "S0038": ["https://attack.mitre.org/software/S0038", "Duqu", "Duqu can track key presses with a keylogger module.[57]"], "S0062": ["https://attack.mitre.org/software/S0062", "DustySky", "DustySky contains a keylogger.[58]"], "S0593": ["https://attack.mitre.org/software/S0593", "ECCENTRICBANDWAGON", "ECCENTRICBANDWAGON can capture and store keystrokes.[59]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire includes keylogging capabilities for Windows, Linux, and macOS systems.[60]"], "S0152": ["https://attack.mitre.org/software/S0152", "EvilGrab", "EvilGrab has the capability to capture keystrokes.[61]"], "S0569": ["https://attack.mitre.org/software/S0569", "Explosive", "Explosive has leveraged its keylogging capabilities to gain access to administrator accounts on target servers.[62][63]"], "S0076": ["https://attack.mitre.org/software/S0076", "FakeM", "FakeM contains a keylogger module.[64]"], "G0085": ["https://attack.mitre.org/groups/G0085", "FIN4", "FIN4 has captured credentials via fake Outlook Web App (OWA) login pages and has also used a .NET based keylogger.[65][66]"], "S0410": ["https://attack.mitre.org/software/S0410", "Fysbis", "Fysbis can perform keylogging.[67]"], "S0032": ["https://attack.mitre.org/software/S0032", "gh0st RAT", "gh0st RAT has a keylogger.[68][69]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can log keystrokes on the victim's machine.[70]"], "S0342": ["https://attack.mitre.org/software/S0342", "GreyEnergy", "GreyEnergy has a module to harvest pressed keystrokes.[71]"], "G0043": ["https://attack.mitre.org/groups/G0043", "Group5", "Malware used by Group5 is capable of capturing keystrokes.[72]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "The executable version of Helminth has a module to log keystrokes.[73]"], "S0070": ["https://attack.mitre.org/software/S0070", "HTTPBrowser", "HTTPBrowser is capable of capturing keystrokes on victims.[74]"], "S0434": ["https://attack.mitre.org/software/S0434", "Imminent Monitor", "Imminent Monitor has a keylogging module.[75]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can capture keystrokes on a compromised host.[76]"], "S0201": ["https://attack.mitre.org/software/S0201", "JPIN", "JPIN contains a custom keylogger.[77]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT has the capability to log keystrokes from the victim’s machine, both offline and online.[78][79]"], "S0088": ["https://attack.mitre.org/software/S0088", "Kasidet", "Kasidet has the ability to initiate keylogging.[80]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has used keyloggers.[81][82]"], "S0387": ["https://attack.mitre.org/software/S0387", "KeyBoy", "KeyBoy installs a keylogger for intercepting credentials and keystrokes.[83]"], "S0526": ["https://attack.mitre.org/software/S0526", "KGH_SPY", "KGH_SPY can perform keylogging by polling the GetAsyncKeyState() function.[84]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used a PowerShell-based keylogger as well as a tool called MECHANICAL to log keystrokes.[85][86][87][88][89][12]"], "S0437": ["https://attack.mitre.org/software/S0437", "Kivars", "Kivars has the ability to initiate keylogging on the infected host.[90]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has the capability to perform keylogging.[91]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware KiloAlfa contains keylogging functionality.[92][93]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot has the ability to capture input on the compromised host via keylogging.[94]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete logs keystrokes from the victim’s machine.[95][96][97][98]"], "S0282": ["https://attack.mitre.org/software/S0282", "MacSpy", "MacSpy captures keystrokes.[99]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound malware is capable of keylogging.[100]"], "S0652": ["https://attack.mitre.org/software/S0652", "MarkiRAT", "MarkiRAT can capture all keystrokes on a compromised host.[101]"], "S0167": ["https://attack.mitre.org/software/S0167", "Matryoshka", "Matryoshka is capable of keylogging.[102][103]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass has used key loggers to steal usernames and passwords.[104]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has a command to launch a keylogger and capture keystrokes on the victim’s machine.[105][106]"], "S0339": ["https://attack.mitre.org/software/S0339", "Micropsia", "Micropsia has keylogging capabilities.[107]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind has a keylogger.[108]"], "S0336": ["https://attack.mitre.org/software/S0336", "NanoCore", "NanoCore can perform keylogging on the victim’s machine.[109]"], "S0247": ["https://attack.mitre.org/software/S0247", "NavRAT", "NavRAT logs the keystrokes on the targeted system.[110]"], "S0033": ["https://attack.mitre.org/software/S0033", "NetTraveler", "NetTraveler contains a keylogger.[111]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE can perform keylogging.[112][113][114][115][116]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT is capable of logging keystrokes.[117][118][72]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used keylogging tools called KEYPUNCH and LONGWATCH.[119][120]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum was seen using a keylogger tool to capture keystrokes. [121]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has obtained the password for the victim's password manager via a custom keylogger.[122]"], "S0072": ["https://attack.mitre.org/software/S0072", "OwaAuth", "OwaAuth captures and DES-encrypts credentials before writing the username and password to a log file, C:\\log.txt.[74]"], "S0643": ["https://attack.mitre.org/software/S0643", "Peppy", "Peppy can log keystrokes on compromised hosts.[45]"], "G0068": ["https://attack.mitre.org/groups/G0068", "PLATINUM", "PLATINUM has used several different keyloggers.[77]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX has a module for capturing keystrokes per process including window titles.[123]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT has used a Python tool named klog.exe for keylogging.[124]"], "S0012": ["https://attack.mitre.org/software/S0012", "PoisonIvy", "PoisonIvy contains a keylogger.[125][126]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 has modules for keystroke logging and capturing credentials from spoofed Outlook authentication messages.[127]"], "S0194": ["https://attack.mitre.org/software/S0194", "PowerSploit", "PowerSploit's Get-Keystrokes Exfiltration module can log keystrokes.[128][129]"], "S0113": ["https://attack.mitre.org/software/S0113", "Prikormka", "Prikormka contains a keylogger module that collects keystrokes and the titles of foreground windows.[130]"], "S0279": ["https://attack.mitre.org/software/S0279", "Proton", "Proton uses a keylogger to capture keystrokes.[99]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy uses a keylogger to capture keystrokes it then sends back to the server after it is stopped.[131]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can capture keystrokes on a compromised host.[132][133][134]"], "S0262": ["https://attack.mitre.org/software/S0262", "QuasarRAT", "QuasarRAT has a built-in keylogger.[135][136]"], "S0662": ["https://attack.mitre.org/software/S0662", "RCSession", "RCSession has the ability to capture keystrokes on a compromised host.[38][137]"], "S0019": ["https://attack.mitre.org/software/S0019", "Regin", "Regin contains a keylogger.[138]"], "S0332": ["https://attack.mitre.org/software/S0332", "Remcos", "Remcos has a command for keylogging.[139][140]"], "S0375": ["https://attack.mitre.org/software/S0375", "Remexi", "Remexi gathers and exfiltrates keystrokes from the machine.[141]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec contains a keylogger component.[142][143]"], "S0379": ["https://attack.mitre.org/software/S0379", "Revenge RAT", "Revenge RAT has a plugin for keylogging.[144][145]"], "S0240": ["https://attack.mitre.org/software/S0240", "ROKRAT", "ROKRAT can use SetWindowsHookEx and GetKeyNameText to capture keystrokes.[146][147]"], "S0090": ["https://attack.mitre.org/software/S0090", "Rover", "Rover has keylogging functionality.[148]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM can record keystrokes from both the keyboard and virtual keyboard.[149][150]"], "S0253": ["https://attack.mitre.org/software/S0253", "RunningRAT", "RunningRAT captures keystrokes and sends them back to the C2 server.[151]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has used a keylogger to capture keystrokes by using the SetWindowsHookEx function.[152]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY has a keylogging capability.[153]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA has a keylogging capability.[154]"], "S0649": ["https://attack.mitre.org/software/S0649", "SMOKEDHAM", "SMOKEDHAM can continuously capture keystrokes.[155][156]"], "G0054": ["https://attack.mitre.org/groups/G0054", "Sowbug", "Sowbug has used keylogging tools.[157]"], "S0058": ["https://attack.mitre.org/software/S0058", "SslMM", "SslMM creates a new thread implementing a keylogging facility using Windows Keyboard Accelerators.[158]"], "S0018": ["https://attack.mitre.org/software/S0018", "Sykipot", "Sykipot contains keylogging functionality to steal passwords.[159]"], "S0467": ["https://attack.mitre.org/software/S0467", "TajMahal", "TajMahal has the ability to capture keystrokes on an infected host.[160]"], "S0595": ["https://attack.mitre.org/software/S0595", "ThiefQuest", "ThiefQuest uses the CGEventTap functions to perform keylogging.[161]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 actors installed a credential logger on Microsoft Exchange servers. Threat Group-3390 also leveraged the reconnaissance framework, ScanBox, to capture keystrokes.[74][162][163]"], "S0004": ["https://attack.mitre.org/software/S0004", "TinyZBot", "TinyZBot contains keylogger functionality.[164]"], "G0131": ["https://attack.mitre.org/groups/G0131", "Tonto Team", "Tonto Team has used keylogging tools in their operations.[165]"], "S0094": ["https://attack.mitre.org/software/S0094", "Trojan.Karagany", "Trojan.Karagany can capture keystrokes on a compromised host.[166]"], "S0130": ["https://attack.mitre.org/software/S0130", "Unknown Logger", "Unknown Logger is capable of recording keystrokes.[25]"], "S0257": ["https://attack.mitre.org/software/S0257", "VERMIN", "VERMIN collects keystrokes from the victim machine.[167]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT has the capability to install a live and offline keylogger, including through the use of the GetAsyncKeyState Windows API.[168][169]"], "S0161": ["https://attack.mitre.org/software/S0161", "XAgentOSX", "XAgentOSX contains keylogging functionality that will monitor for active application windows and write them to the log, it can handle special characters, and it will buffer by default 50 characters before sending them out over the C2 infrastructure.[170]"], "S0248": ["https://attack.mitre.org/software/S0248", "yty", "yty uses a keylogger plugin to gather keystrokes.[171]"], "S0330": ["https://attack.mitre.org/software/S0330", "Zeus Panda", "Zeus Panda can perform keylogging on the victim’s machine by hooking the functions TranslateMessage and WM_KEYDOWN.[172]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell has a feature to capture a remote computer's keystrokes using a keylogger.[21][173]"]}, "Mitigation": {}, "Detection": {"Driver Load": ["Monitor for unusual kernel driver installation activity", "DS0027", "https://attack.mitre.org/datasources/DS0027", "Driver"], "OS API Execution": ["Monitor for API calls to the SetWindowsHook, GetKeyState, and GetAsyncKeyState.[1] and look for common keylogging API calls. API calls alone are not an indicator of keylogging, but may provide behavioral data that is useful when combined with other information such as new files written to disk and unusual processes.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Windows Registry Key Modification": ["Monitor for changes made to windows registry keys or values for unexpected modifications", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
