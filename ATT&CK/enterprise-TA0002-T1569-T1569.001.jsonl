{"TTP_id": "enterprise-TA0002-T1569-T1569.001", "TTP_name": "Launchctl", "Description": "Adversaries may abuse launchctl to execute commands or programs. Launchctl interfaces with launchd, the service management framework for macOS. Launchctl supports taking subcommands on the command-line, interactively, or even redirected from standard input.[1]Adversaries use launchctl to execute commands and programs as Launch Agents or Launch Daemons. Common subcommands include: launchctl load,launchctl unload, and launchctl start. Adversaries can use scripts or manually run the commands launchctl load -w \"%s/Library/LaunchAgents/%s\" or /bin/launchctl load to execute Launch Agents or Launch Daemons.[2][3]", "Property": {"ID": "T1569.001", "Sub-technique of": "T1569", "Tactic": "Execution", "Platforms": "macOS", "Permissions Required": "User, root", "Version": "1.1", "Created": "10 March 2020", "Last Modified": "15 October 2021"}, "Examples": {"S0584": ["https://attack.mitre.org/software/S0584", "AppleJeus", "AppleJeus has loaded a plist file using the launchctl command.[4]"], "S0274": ["https://attack.mitre.org/software/S0274", "Calisto", "Calisto uses launchctl to enable screen sharing on the victimâ€™s machine.[5]"], "S0451": ["https://attack.mitre.org/software/S0451", "LoudMiner", "LoudMiner launched the QEMU services in the /Library/LaunchDaemons/ folder using launchctl. It also uses launchctl to unload all Launch Daemons when updating to a newer version of LoudMiner.[6]"], "S0658": ["https://attack.mitre.org/software/S0658", "XCSSET", "XCSSET loads a system level launchdaemon using the launchctl load -w command from /System/Librarby/LaunchDaemons/ssh.plist.[7]"]}, "Mitigation": {"M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Prevent users from installing their own launch agents or launch daemons."]}, "Detection": {"Command Execution": ["Monitor command-line execution of the launchctl command immediately followed by abnormal network connections.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Modification": ["Every Launch Agent and Launch Daemon must have a corresponding plist file on disk which can be monitored. Plist files are located in the root, system, and users /Library/LaunchAgents or /Library/LaunchDaemons folders. Launch Agent or Launch Daemon with executable paths pointing to /tmp and /Shared folders locations are potentially suspicious.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Process Creation": ["Monitor for newly executed daemons that may abuse launchctl to execute commands or programs.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Service Creation": ["Monitor for newly constructed services/daemons to execute commands or programs.", "DS0019", "https://attack.mitre.org/datasources/DS0019", "Service"]}}
