{"TTP_id": "enterprise-TA0007-T1007", "TTP_name": "System Service Discovery", "Description": "Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as sc query, tasklist /svc, systemctl --type=service, and net start.Adversaries may use the information from System Service Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.", "Property": {"ID": "T1007", "Sub-techniques": "No sub-techniques", "Tactic": "Discovery", "Platforms": "Linux, Windows, macOS", "CAPEC ID": "CAPEC-574", "Version": "1.3", "Created": "31 May 2017", "Last Modified": "19 April 2022"}, "Examples": {"G0018": ["https://attack.mitre.org/groups/G0018", "admin@338", "admin@338 actors used the following command following exploitation of a machine with LOWBALL malware to obtain information about services: net start >> %temp%\\download[1]"], "G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 used the commands net start and tasklist to get a listing of the services on the system.[2]"], "G0143": ["https://attack.mitre.org/groups/G0143", "Aquatic Panda", "Aquatic Panda has attempted to discover services for third party EDR products.[3]"], "S0638": ["https://attack.mitre.org/software/S0638", "Babuk", "Babuk can enumerate all services running on a compromised host.[4]"], "S0127": ["https://attack.mitre.org/software/S0127", "BBSRAT", "BBSRAT can query service configuration information.[5]"], "S0570": ["https://attack.mitre.org/software/S0570", "BitPaymer", "BitPaymer can enumerate existing Windows services on the host that are configured to run as LocalSystem.[6]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has used TROJ_GETVERSION to discover system services.[7]"], "S0572": ["https://attack.mitre.org/software/S0572", "Caterpillar WebShell", "Caterpillar WebShell can obtain a list of the services from a system.[8]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used net start and net use for system service discovery.[9]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can enumerate services on compromised hosts.[10]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie runs the command: net start >> %TEMP%\\info.dat on a victim.[11]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba can query service status using QueryServiceStatusEx function.[12]"], "S0024": ["https://attack.mitre.org/software/S0024", "Dyre", "Dyre has the ability to identify running services on a compromised host.[13]"], "S0081": ["https://attack.mitre.org/software/S0081", "Elise", "Elise executes net start after initial communication is made to the remote server.[14]"], "S0082": ["https://attack.mitre.org/software/S0082", "Emissary", "Emissary has the capability to execute the command net start to interact with services.[15]"], "S0091": ["https://attack.mitre.org/software/S0091", "Epic", "Epic uses the tasklist /svc command to list the services on the system.[16]"], "S0049": ["https://attack.mitre.org/software/S0049", "GeminiDuke", "GeminiDuke collects information on programs and services on the victim that are configured to automatically run at startup.[17]"], "S0237": ["https://attack.mitre.org/software/S0237", "GravityRAT", "GravityRAT has a feature to list the available services on the system.[18]"], "S0342": ["https://attack.mitre.org/software/S0342", "GreyEnergy", "GreyEnergy enumerates all Windows services.[19]"], "S0431": ["https://attack.mitre.org/software/S0431", "HotCroissant", "HotCroissant has the ability to retrieve a list of services on the infected host.[20]"], "S0203": ["https://attack.mitre.org/software/S0203", "Hydraq", "Hydraq creates a backdoor through which remote attackers can monitor services.[21][22]"], "S0398": ["https://attack.mitre.org/software/S0398", "HyperBro", "HyperBro can list all services and their configurations.[23]"], "G0119": ["https://attack.mitre.org/groups/G0119", "Indrik Spider", "Indrik Spider has used the win32_service WMI class to retrieve a list of services from the system.[24]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can obtain running services on the victim.[25]"], "S0015": ["https://attack.mitre.org/software/S0015", "Ixeshe", "Ixeshe can list running services.[26]"], "S0201": ["https://attack.mitre.org/software/S0201", "JPIN", "JPIN can list running services.[27]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT can list local services.[28]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang performs service discovery using net start commands.[29]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used an instrumentor script to gather the names of all services running on a victim's system.[30]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs collects a list of running services with the command tasklist /svc.[31]"], "S0582": ["https://attack.mitre.org/software/S0582", "LookBack", "LookBack can enumerate services on the victim machine.[32]"], "S0039": ["https://attack.mitre.org/software/S0039", "Net", "The net start command can be used in Net to find information about Windows services.[33]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used sc query on a victim to gather information about services.[34]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used the tasklist command to search for one of its backdoors.[35]"], "G0033": ["https://attack.mitre.org/groups/G0033", "Poseidon Group", "After compromising a victim, Poseidon Group discovers all running services.[36]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 can enumerate service and service permission information.[37]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay can create and register a service for execution.[38]"], "S0241": ["https://attack.mitre.org/software/S0241", "RATANKBA", "RATANKBA uses tasklist /svc to display running tasks.[39]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil can enumerate active services.[40]"], "S0085": ["https://attack.mitre.org/software/S0085", "S-Type", "S-Type runs the command net start on a victim.[41]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can search for modifiable services that could be used for privilege escalation.[42]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA has the capability to enumerate services.[43]"], "S0615": ["https://attack.mitre.org/software/S0615", "SombRAT", "SombRAT can enumerate services on a victim machine.[44]"], "S0559": ["https://attack.mitre.org/software/S0559", "SUNBURST", "SUNBURST collected a list of service names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.[45]"], "S0018": ["https://attack.mitre.org/software/S0018", "Sykipot", "Sykipot may use net start to display running services.[46]"], "S0242": ["https://attack.mitre.org/software/S0242", "SynAck", "SynAck enumerates all running services.[47][48]"], "S0057": ["https://attack.mitre.org/software/S0057", "Tasklist", "Tasklist can be used to discover services running on a system.[49]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot collects a list of install programs and services on the systemâ€™s machine.[50]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla surveys a system upon check-in to discover running services and associated processes using the tasklist /svc command.[16]"], "S0386": ["https://attack.mitre.org/software/S0386", "Ursnif", "Ursnif has gathered information about running services.[51]"], "S0180": ["https://attack.mitre.org/software/S0180", "Volgmer", "Volgmer queries the system to identify existing services.[52]"], "S0219": ["https://attack.mitre.org/software/S0219", "WINERACK", "WINERACK can enumerate services.[53]"], "S0086": ["https://attack.mitre.org/software/S0086", "ZLib", "ZLib has the ability to discover and manipulate Windows services.[41]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell can check the services on the system.[54]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that could be taken to gather system information related to services. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor for newly executed processes with arguments that may try to get information about registered services. System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
