{"TTP_id": "enterprise-TA0002-T1204", "TTP_name": "User Execution", "Description": "An adversary may rely upon specific actions by a user in order to gain execution. Users may be subjected to social engineering to get them to execute malicious code by, for example, opening a malicious document file or link. These user actions will typically be observed as follow-on behavior from forms of Phishing.While User Execution frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after Internal Spearphishing.Adversaries may also deceive users into performing actions such as enabling Remote Access Software, allowing direct control of the system to the adversary, or downloading and executing malware for User Execution. For example, tech support scams can be facilitated through Phishing, vishing, or various forms of user interaction. Adversaries can use a combination of these methods, such as spoofing and promoting toll-free numbers or call centers that are used to direct victims to malicious websites, to deliver and execute payloads containing malware or Remote Access Software.[1]", "Property": {"ID": "T1204", "Sub-techniques": "T1204.001, T1204.002, T1204.003", "Tactic": "Execution", "Platforms": "Containers, IaaS, Linux, Windows, macOS", "Contributors": "Oleg Skulkin, Group-IB", "Version": "1.5", "Created": "18 April 2018", "Last Modified": "19 April 2022"}, "Examples": {}, "Mitigation": {"M1040": ["https://attack.mitre.org/mitigations/M1040", "Behavior Prevention on Endpoint", "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent executable files from running unless they meet a prevalence, age, or trusted list criteria and to prevent Office applications from creating potentially malicious executable content by blocking malicious code from being written to disk. Note: cloud-delivered protection must be enabled to use certain rules. [2]"], "M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Application control may be able to prevent the running of executables masquerading as other files."], "M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "If a link is being visited by a user, network intrusion prevention systems and systems designed to scan and remove malicious downloads can be used to block activity."], "M1021": ["https://attack.mitre.org/mitigations/M1021", "Restrict Web-Based Content", "If a link is being visited by a user, block unknown or unused files in transit by default that should not be downloaded or by policy from suspicious sites as a best practice to prevent some vectors, such as .scr, .exe, .pif, .cpl, etc. Some download scanning devices can open and analyze compressed and encrypted formats, such as zip and rar that may be used to conceal malicious files."], "M1017": ["https://attack.mitre.org/mitigations/M1017", "User Training", "Use user training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events."]}, "Detection": {"Application Log Content": ["Monitor for third-party application logging, messaging, and/or other artifacts that may rely upon specific actions by a user in order to gain execution.", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "Command Execution": ["Monitor the execution of and command-line arguments for applications that may be used by an adversary to gain Initial Access that require user interaction. This includes compression applications, such as those for zip files, that can be used to Deobfuscate/Decode Files or Information in payloads.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Container Creation": ["Monitor for newly constructed containers that may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel.", "DS0032", "https://attack.mitre.org/datasources/DS0032", "Container"], "Container Start": ["Monitor for the activation or invocation of a container (ex: docker start or docker restart)", "", "", ""], "File Creation": ["Anti-virus can potentially detect malicious documents and files that are downloaded and executed on the user's computer. Endpoint sensing or network sensing can potentially detect malicious events once the file is opened (such as a Microsoft Word document or PDF reaching out to the internet or spawning powershell.exe).", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Image Creation": ["Monitor for newly constructed image that may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel.", "DS0007", "https://attack.mitre.org/datasources/DS0007", "Image"], "Instance Creation": ["Monitor for newly constructed instances that may use an existing, legitimate external Web service to exfiltrate data rather than their primary command and control channel.", "DS0030", "https://attack.mitre.org/datasources/DS0030", "Instance"], "Instance Start": ["Monitor for the activation or invocation of an instance (ex: instance.start within GCP Audit Logs)", "", "", ""], "Network Connection Creation": ["Monitor for newly constructed web-based network connections that are sent to malicious or suspicious destinations (e.g. destinations attributed to phishing campaigns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments (e.g. monitor anomalies in use of files that do not normally initiate network connections or unusual connections initiated by regsvr32.exe, rundll.exe, .SCF, HTA, MSI, DLLs, or msiexec.exe).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated with web-based network connections that are sent to malicious or suspicious detinations (e.g. destinations attributed to phishing campaigns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments (e.g. monitor anomalies in use of files that do not normally initiate network connections or unusual connections initiated by regsvr32.exe, rundll.exe, .SCF, HTA, MSI, DLLs, or msiexec.exe).", "", "", ""], "Process Creation": ["Monitor for newly executed processes that may be used by an adversary to gain Initial Access that require user interaction. This includes compression applications, such as those for zip files, that can be used to Deobfuscate/Decode Files or Information in payloads.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
