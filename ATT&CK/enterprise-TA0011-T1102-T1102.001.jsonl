{"TTP_id": "enterprise-TA0011-T1102-T1102.001", "TTP_name": "Dead Drop Resolver", "Description": "Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers.Popular websites and social media acting as a mechanism for C2 may give a significant amount of cover due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection.Use of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis while also enabling operational resiliency (since this infrastructure may be dynamically changed).", "Property": {"ID": "T1102.001", "Sub-technique of": "T1102", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Permissions Required": "User", "Version": "1.0", "Created": "14 March 2020", "Last Modified": "26 March 2020"}, "Examples": {"G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used legitimate websites for C2 through dead drop resolvers (DDR), including GitHub, Pastebin, and Microsoft TechNet.[1]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth can store C2 information on cloud hosting services such as AWS and CloudFlare and websites like YouTube and Facebook.[2]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "BADNEWS collects C2 information via a dead drop resolver.[3][4][5]"], "S0069": ["https://attack.mitre.org/software/S0069", "BLACKCOFFEE", "BLACKCOFFEE uses Microsoftâ€™s TechNet Web portal to obtain a dead drop resolver containing an encoded tag with the IP address of a command and control server.[6][7]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER's MSGET downloader uses a dead drop resolver to access malicious payloads.[8]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower can retrieve C2 domain information from actor-controlled S3 buckets.[9]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can obtain C2 information from Google Docs.[2]"], "S0528": ["https://attack.mitre.org/software/S0528", "Javali", "Javali can read C2 information from Google Documents and YouTube.[2]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has used YouTube to store and hide C&C server domains.[10]"], "S0051": ["https://attack.mitre.org/software/S0051", "MiniDuke", "Some MiniDuke components use Twitter to initially obtain the address of a C2 server or as a backup if no hard-coded C2 server responds.[11][12][13]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork hides base64-encoded and encrypted C2 server locations in comments on legitimate websites.[14]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX uses Pastebin to store C2 addresses.[15]"], "S0518": ["https://attack.mitre.org/software/S0518", "PolyglotDuke", "PolyglotDuke can use Twitter, Reddit, Imgur and other websites to get a C2 URL.[13]"], "G0106": ["https://attack.mitre.org/groups/G0106", "Rocke", "Rocke has used Pastebin to check the version of beaconing malware and redirect to another Pastebin hosting updated malware.[16]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM has used an RSS feed on Livejournal to update a list of encrypted C2 server names. RTM has also hidden Pony C2 server IP addresses within transactions on the Bitcoin and Namecoin blockchain.[17][18][19]"], "G0048": ["https://attack.mitre.org/groups/G0048", "RTM", "RTM has used an RSS feed on Livejournal to update a list of encrypted C2 server names.[17]"], "S0341": ["https://attack.mitre.org/software/S0341", "Xbash", "Xbash can obtain a webpage hosted on Pastebin to update its C2 domain list.[20]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."], "M1021": ["https://attack.mitre.org/mitigations/M1021", "Restrict Web-Based Content", "Web proxies can be used to enforce external network communication policy that prevents use of unauthorized external services."]}, "Detection": {"Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
