{"TTP_id": "enterprise-TA0005-T1550-T1550.002", "TTP_name": "Pass the Hash", "Description": "Adversaries may \"pass the hash\" using stolen password hashes to move laterally within an environment, bypassing normal system access controls. Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash.When performing PtH, valid password hashes for the account being used are captured using a Credential Access technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems.Adversaries may also use stolen password hashes to \"overpass the hash.\" Similar to PtH, this involves using a password hash to authenticate as a user but also uses the password hash to create a valid Kerberos ticket. This ticket can then be used to perform Pass the Ticket attacks.[1]", "Property": {"ID": "T1550.002", "Sub-technique of": "T1550", "Tactics": "Defense Evasion, Lateral Movement", "Platforms": "Windows", "Defense Bypassed": "System Access Controls", "CAPEC ID": "CAPEC-644", "Contributors": "Blake Strom, Microsoft 365 Defender; Travis Smith, Tripwire", "Version": "1.1", "Created": "30 January 2020", "Last Modified": "31 August 2021"}, "Examples": {"G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "The APT1 group is known to have used pass the hash.[2]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "APT28 has used pass the hash for lateral movement.[3]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has used pass the hash for lateral movement.[4]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has dumped password hashes for use in pass the hash authentication attacks.[5]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can perform pass the hash.[6]"], "S0488": ["https://attack.mitre.org/software/S0488", "CrackMapExec", "CrackMapExec can pass the hash to authenticate via SMB.[7]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can perform pass the hash attacks.[8]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used dumped hashes to authenticate to other machines via pass the hash.[9]"], "S0376": ["https://attack.mitre.org/software/S0376", "HOPLIGHT", "HOPLIGHT has been observed loading several APIs associated with Pass the Hash.[10]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has used pass the hash for authentication to remote access software used in C2.[11]"], "S0002": ["https://attack.mitre.org/software/S0002", "Mimikatz", "Mimikatz's SEKURLSA::Pth module can impersonate a user, with only a password hash, to execute arbitrary commands.[12][13][14]"], "G0014": ["https://attack.mitre.org/groups/G0014", "Night Dragon", "Night Dragon used pass-the-hash tools to gain usernames and passwords.[15]"], "S0122": ["https://attack.mitre.org/software/S0122", "Pass-The-Hash Toolkit", "Pass-The-Hash Toolkit can perform pass the hash.[2]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 has a number of modules that leverage pass the hash for lateral movement.[16]"]}, "Mitigation": {"M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Limit credential overlap across systems to prevent the damage of credential compromise and reduce the adversary's ability to perform Lateral Movement between systems."], "M1051": ["https://attack.mitre.org/mitigations/M1051", "Update Software", "Apply patch KB2871997 to Windows 7 and higher systems to limit the default access of accounts in the local administrator group.[17]"], "M1052": ["https://attack.mitre.org/mitigations/M1052", "User Account Control", "Enable pass the hash mitigations to apply UAC restrictions to local accounts on network logon. The associated Registry key is located HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\LocalAccountTokenFilterPolicy.Through GPO: Computer Configuration > [Policies] > Administrative Templates > SCM: Pass the Hash Mitigations: Apply UAC restrictions to local accounts on network logons.[18]"], "M1018": ["https://attack.mitre.org/mitigations/M1018", "User Account Management", "Do not allow a domain user to be in the local administrator group on multiple systems."]}, "Detection": {"Active Directory Credential Request": ["Monitor requests of new ticket granting ticket or service tickets to a Domain Controller. Windows Security events such as 4768 (A Kerberos authentication ticket (TGT) was requested) and 4769 (A Kerberos service ticket was requested) combined with logon session creation information may be indicative of an overpass the hash attempt.", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"], "Logon Session Creation": ["Monitor newly created logons and credentials used in events and review for discrepancies. Unusual remote logins that correlate with other suspicious activity (such as writing and executing binaries) may indicate malicious activity.", "DS0028", "https://attack.mitre.org/datasources/DS0028", "Logon Session"], "User Account Authentication": ["Monitor for user authentication attempts. From a classic Pass-The-Hash perspective, this technique uses a hash through the NTLMv1 / NTLMv2 protocol to authenticate against a compromised endpoint. This technique does not touch Kerberos. Therefore, NTLM LogonType 3 authentications that are not associated to a domain login and are not anonymous logins are suspicious. From an Over-Pass-The-Hash perspective, an adversary wants to exchange the hash for a Kerberos authentication ticket (TGT). One way to do this is by creating a sacrificial logon session with dummy credentials (LogonType 9) and then inject the hash into that session which triggers the Kerberos authentication process.", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"]}}
