{"TTP_id": "enterprise-TA0004-T1546-T1546.009", "TTP_name": "AppCert DLLs", "Description": "Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppCert DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the AppCertDLLs Registry key under HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\ are loaded into every process that calls the ubiquitously used application programming interface (API) functions CreateProcess, CreateProcessAsUser, CreateProcessWithLoginW, CreateProcessWithTokenW, or WinExec. [1]Similar to Process Injection, this value can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. Malicious AppCert DLLs may also provide persistence by continuously being triggered by API activity.", "Property": {"ID": "T1546.009", "Sub-technique of": "T1546", "Tactics": "Privilege Escalation, Persistence", "Platforms": "Windows", "Permissions Required": "Administrator, SYSTEM", "Effective Permissions": "Administrator, SYSTEM", "Version": "1.0", "Created": "24 January 2020", "Last Modified": "10 November 2020"}, "Examples": {"G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Honeybee's service-based DLL implant can execute a downloaded file with parameters specified using CreateProcessAsUser.[2]"], "S0196": ["https://attack.mitre.org/software/S0196", "PUNCHBUGGY", "PUNCHBUGGY can establish using a AppCertDLLs Registry key.[3]"]}, "Mitigation": {"M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Adversaries install new AppCertDLL binaries to execute this technique. Identify and block potentially malicious software executed through AppCertDLLs functionality by using application control [4] tools, like Windows Defender Application Control[5], AppLocker, [6] [7] or Software Restriction Policies [8] where appropriate. [9]"]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may establish persistence and/or elevate privileges by executing malicious content triggered by AppCert DLLs loaded into processes.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Module Load": ["Monitor DLL loads by processes, specifically looking for DLLs that are not recognized or not normally loaded into a process. Tools such as Sysinternals Autoruns may overlook AppCert DLLs as an auto-starting location. [10] [11]", "DS0011", "https://attack.mitre.org/datasources/DS0011", "Module"], "OS API Execution": ["Monitor and analyze application programming interface (API) calls that are indicative of Registry edits, such as RegCreateKeyEx and RegSetValueEx. [1]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor newly executed processes that may establish persistence and/or elevate privileges by executing malicious content triggered by AppCert DLLs loaded into processes.", "", "", ""], "Windows Registry Key Modification": ["Monitor the AppCertDLLs Registry value for modifications that do not correlate with known software, patch cycles, etc.", "DS0024", "https://attack.mitre.org/datasources/DS0024", "Windows Registry"]}}
