{"TTP_id": "enterprise-TA0005-T1484-T1484.002", "TTP_name": "Domain Trust Modification", "Description": "Adversaries may add new domain trusts or modify the properties of existing domain trusts to evade defenses and/or elevate privileges. Domain trust details, such as whether or not a domain is federated, allow authentication and authorization properties to apply between domains for the purpose of accessing shared resources.[1] These trust objects may include accounts, credentials, and other authentication material applied to servers, tokens, and domains.Manipulating the domain trusts may allow an adversary to escalate privileges and/or evade defenses by modifying settings to add objects which they control. For example, this may be used to forge SAML Tokens, without the need to compromise the signing certificate to forge new credentials. Instead, an adversary can manipulate domain trusts to add their own signing certificate.", "Property": {"ID": "T1484.002", "Sub-technique of": "T1484", "Tactics": "Defense Evasion, Privilege Escalation", "Platforms": "Azure AD, Windows", "Permissions Required": "Administrator", "Contributors": "Blake Strom, Microsoft 365 Defender", "Version": "1.0", "Created": "28 December 2020", "Last Modified": "11 January 2021"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 changed domain federation trust settings using Azure AD administrative permissions to configure the domain to accept authorization tokens signed by their own SAML signing certificate.[2][3]"]}, "Mitigation": {"M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Use the principal of least privilege and protect administrative access to domain trusts."]}, "Detection": {"Active Directory Object Creation": ["Monitor for newly constructed active directory objects, such as Windows EID 5137.", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"], "Active Directory Object Modification": ["Monitor for changes made to AD settings for unexpected modifications to domain trust settings, such as when a user or application modifies the federation settings on the domain.", "", "", ""], "Command Execution": ["Monitor executed commands and arguments that updates domain authentication from Managed to Federated via ActionTypes Set federation settings on domain and Set domain authentication.[4] Monitor for PowerShell commands such as: Update-MSOLFederatedDomain –DomainName: \"Federated Domain Name\", or Update-MSOLFederatedDomain –DomainName: \"Federated Domain Name\" –supportmultipledomain.[5]", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"]}}
