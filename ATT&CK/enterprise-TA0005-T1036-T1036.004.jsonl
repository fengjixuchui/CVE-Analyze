{"TTP_id": "enterprise-TA0005-T1036-T1036.004", "TTP_name": "Masquerade Task or Service", "Description": "Adversaries may attempt to manipulate the name of a task or service to make it appear legitimate or benign. Tasks/services executed by the Task Scheduler or systemd will typically be given a name and/or description.[1][2] Windows services will have a service name as well as a display name. Many benign tasks and services exist that have commonly associated names. Adversaries may give tasks or services names that are similar or identical to those of legitimate ones.Tasks or services contain other fields, such as a description, that adversaries may attempt to make appear legitimate.[3][4]", "Property": {"ID": "T1036.004", "Sub-technique of": "T1036", "Tactic": "Defense Evasion", "Platforms": "Linux, Windows, macOS", "Permissions Required": "Administrator, SYSTEM, User", "Version": "1.1", "Created": "10 February 2020", "Last Modified": "18 October 2021"}, "Examples": {"G0099": ["https://attack.mitre.org/groups/G0099", "APT-C-36", "APT-C-36 has disguised its scheduled tasks as those used by Google.[5]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 named tasks \\Microsoft\\Windows\\SoftwareProtectionPlatform\\EventCacheManager in order to appear legitimate.[6]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has used hidden or non-printing characters to help masquerade service names, such as appending a Unicode no-break space character to a legitimate service name. APT32 has also impersonated the legitimate Flash installer file name \"install_flashplayer.exe\".[7]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 has created services to appear as benign system tools.[8]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor's dispatcher disguises itself as a legitimate task (i.e., the task name and description appear legitimate).[9]"], "G0135": ["https://attack.mitre.org/groups/G0135", "BackdoorDiplomacy", "BackdoorDiplomacy has disguised their backdoor droppers with naming conventions designed to blend into normal operations.[10]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can create a task named to appear benign.[11]"], "S0471": ["https://attack.mitre.org/software/S0471", "build_downer", "build_downer has added itself to the Registry Run key as \"NVIDIA\" to appear legitimate.[12]"], "G0008": ["https://attack.mitre.org/groups/G0008", "Carbanak", "Carbanak has copied legitimate service names to use for malicious services.[13]"], "S0261": ["https://attack.mitre.org/software/S0261", "Catchamas", "Catchamas adds a new service named NetAdapter in an apparent attempt to masquerade as a legitimate service.[14]"], "S0126": ["https://attack.mitre.org/software/S0126", "ComRAT", "ComRAT has used a task name associated with Windows SQM Consolidator.[15]"], "S0538": ["https://attack.mitre.org/software/S0538", "Crutch", "Crutch has established persistence with a scheduled task impersonating the Outlook item finder.[16]"], "S0527": ["https://attack.mitre.org/software/S0527", "CSPY Downloader", "CSPY Downloader has attempted to appear as a legitimate Windows service with a fake description claiming it is used to support packed applications.[17]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor has masqueraded the svchost.exe process to exfiltrate data.[18]"], "S0343": ["https://attack.mitre.org/software/S0343", "Exaramel for Windows", "The Exaramel for Windows dropper creates and starts a Windows service named wsmprovav with the description \"Windows Check AV\" in an apparent attempt to masquerade as a legitimate service.[19]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has renamed the \"psexec\" service name to \"mstdc\" to masquerade as a legitimate Windows service.[20]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 has created a scheduled task named \"AdobeFlashSync\" to establish persistence.[21]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has named the task for a reverse proxy lpupdate to appear legitimate.[22]"], "S0410": ["https://attack.mitre.org/software/S0410", "Fysbis", "Fysbis has masqueraded as the rsyncd and dbus-inotifier services.[4]"], "S0588": ["https://attack.mitre.org/software/S0588", "GoldMax", "GoldMax has impersonated systems management software to avoid detection.[23]"], "S0690": ["https://attack.mitre.org/software/S0690", "Green Lambert", "Green Lambert has created a new executable named Software Update Check to appear legitimate.[24][25]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa named a shellcode loader binary svchast.exe to spoof the legitimate svchost.exe.[26][27]"], "S0601": ["https://attack.mitre.org/software/S0601", "Hildegard", "Hildegard has disguised itself as a known Linux process.[28]"], "S0259": ["https://attack.mitre.org/software/S0259", "InnaputRAT", "InnaputRAT variants have attempted to appear legitimate by adding a new service named OfficeUpdateService.[29]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole has attempted to disguise itself by registering under a seemingly legitimate service name.[30]"], "S0581": ["https://attack.mitre.org/software/S0581", "IronNetInjector", "IronNetInjector has been disguised as a legitimate service using the name PythonUpdateSrvc.[31]"], "S0607": ["https://attack.mitre.org/software/S0607", "KillDisk", "KillDisk registers as a service under the Plug-And-Play Support name.[32]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has disguised services to appear as benign software or related to operating system functions.[33]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has pretended to be the xmlProv Network Provisioning service.[34]"], "S0236": ["https://attack.mitre.org/software/S0236", "Kwampirs", "Kwampirs establishes persistence by adding a new service with the display name \"WMI Performance Adapter Extension\" in an attempt to masquerade as a legitimate WMI service.[35]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group has used a scheduled task named SRCheck to mask the execution of a malicious .dll.[36]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete renamed task names to masquerade as legitimate Google Chrome, Java, Dropbox, Adobe Reader and Python tasks.[37]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "Maze operators have created scheduled tasks masquerading as \"Windows Update Security\", \"Windows Update Security Patches\", and \"Google Chrome Security Update\" designed to launch the ransomware.[38]"], "S0688": ["https://attack.mitre.org/software/S0688", "Meteor", "Meteor has been disguised as the Windows Power Efficiency Diagnostics report tool.[39]"], "G0019": ["https://attack.mitre.org/groups/G0019", "Naikon", "Naikon renamed a malicious service taskmgr to appear to be a legitimate version of Task Manager.[40]"], "S0630": ["https://attack.mitre.org/software/S0630", "Nebulae", "Nebulae has created a service named \"Windows Update Agent1\" to appear legitimate.[40]"], "S0118": ["https://attack.mitre.org/software/S0118", "Nidiran", "Nidiran can create a new service named msamger (Microsoft Security Accounts Manager), which mimics the legitimate Microsoft database by the same name.[41][42]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum can establish persistence by adding a new service NtmsSvc with the display name Removable Storage to masquerade as a legitimate Removable Storage Manager.[43]"], "S0352": ["https://attack.mitre.org/software/S0352", "OSX_OCEANLOTUS.D", "OSX_OCEANLOTUS.D has disguised its app bundle by adding special characters to the filename and using the icon for legitimate Word documents.[44]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "In one instance, menuPass added PlugX as a service with a display name of \"Corel Writing Tools Utility.\"[45]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS has created a scheduled task named \"MicrosoftEdge\" to establish persistence.[46]"], "G0056": ["https://attack.mitre.org/groups/G0056", "PROMETHIUM", "PROMETHIUM has named services to appear legitimate.[47][48]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay has named services and scheduled tasks to appear benign including \"ChromeCheck\" and \"googleupdate.\"[40]"], "S0169": ["https://attack.mitre.org/software/S0169", "RawPOS", "New services created by RawPOS are made to appear like legitimate Windows services, with names such as \"Windows Management Help Service\", \"Microsoft Support\", and \"Windows Advanced Task Manager\".[49][50][51]"], "S0495": ["https://attack.mitre.org/software/S0495", "RDAT", "RDAT has used Windows Video Service as a name for malicious services.[52]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM has named the scheduled task it creates \"Windows Update\".[53]"], "S0345": ["https://attack.mitre.org/software/S0345", "Seasalt", "Seasalt has masqueraded as a service called \"SaSaut\" with a display name of \"System Authorization Service\" in an apparent attempt to masquerade as a legitimate service.[54]"], "S0140": ["https://attack.mitre.org/software/S0140", "Shamoon", "Shamoon creates a new service named \"ntssrv\" that attempts to appear legitimate; the service's display name is \"Microsoft Network Realtime Inspection Service\" and its description is \"Helps guard against time change attempts targeting known and newly discovered vulnerabilities in network time protocols.\" Newer versions create the \"MaintenaceSrv\" service, which misspells the word \"maintenance.\"[3][55]"], "S0444": ["https://attack.mitre.org/software/S0444", "ShimRat", "ShimRat can impersonate Windows services and antivirus products to avoid detection on compromised systems.[56]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA has named a service it establishes on victim machines as \"TaskFrame\" to hide its malicious purpose.[57]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity has named services to appear legitimate.[47][48]"], "S0668": ["https://attack.mitre.org/software/S0668", "TinyTurla", "TinyTurla has mimicked an existing Windows service by being installed as Windows Time Service.[58]"], "S0178": ["https://attack.mitre.org/software/S0178", "Truvasys", "To establish persistence, Truvasys adds a Registry Run key with a value \"TaskMgr\" in an attempt to masquerade as the legitimate Windows Task Manager.[59]"], "S0647": ["https://attack.mitre.org/software/S0647", "Turian", "Turian can disguise as a legitimate service to blend into normal operations.[10]"], "S0180": ["https://attack.mitre.org/software/S0180", "Volgmer", "Some Volgmer variants add new services with display names generated by a list of hard-coded strings such as Application, Background, Security, and Windows, presumably as a way to masquerade as a legitimate service.[60][61]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used scheduled tasks to install TrickBot, using task names to appear legitimate such as WinDotNet, GoogleTask, or Sysnetsf.[62] It has also used common document file names for other malware binaries.[63]"], "G0128": ["https://attack.mitre.org/groups/G0128", "ZIRCONIUM", "ZIRCONIUM has created a run key named Dropbox Update Setup to mask a persistence mechanism for a malicious binary.[64]"]}, "Mitigation": {}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may attempt to manipulate the name of a task or service to make it appear legitimate or benign.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Scheduled Job Metadata": ["Monitor for contextual data about a scheduled job, which may include information such as name, timing, command(s), etc.", "DS0003", "https://attack.mitre.org/datasources/DS0003", "Scheduled Job"], "Scheduled Job Modification": ["Monitor for changes made to scheduled jobs for unexpected modifications to execution launch", "", "", ""], "Service Creation": ["Monitor for newly constructed services/daemons. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.", "DS0019", "https://attack.mitre.org/datasources/DS0019", "Service"], "Service Metadata": ["Monitor for changes made to services for unexpected modifications to names, descriptions, and/or start types", "", "", ""]}}
