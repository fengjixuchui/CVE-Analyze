{"TTP_id": "enterprise-TA0011-T1090", "TTP_name": "Proxy", "Description": "Adversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, including HTRAN, ZXProxy, and ZXPortMap. [1] Adversaries use these types of proxies to manage command and control communications, reduce the number of simultaneous outbound network connections, provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. Adversaries may chain together multiple proxies to further disguise the source of malicious traffic.Adversaries can also take advantage of routing schemes in Content Delivery Networks (CDNs) to proxy command and control traffic.", "Property": {"ID": "T1090", "Sub-techniques": "T1090.001, T1090.002, T1090.003, T1090.004", "Tactic": "Command and Control", "Platforms": "Linux, Network, Windows, macOS", "Contributors": "Heather Linn; Jon Sheedy; Walker Johnson", "Version": "3.1", "Created": "31 May 2017", "Last Modified": "30 August 2021"}, "Examples": {"G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used a tool called CLASSFON to covertly proxy network communications.[2]"], "S0456": ["https://attack.mitre.org/software/S0456", "Aria-body", "Aria-body has the ability to use a reverse SOCKS proxy module.[3]"], "S0347": ["https://attack.mitre.org/software/S0347", "AuditCred", "AuditCred can utilize proxy for communications.[4]"], "S0245": ["https://attack.mitre.org/software/S0245", "BADCALL", "BADCALL functions as a proxy server between the victim and C2 server.[5]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has supported use of a proxy server.[6]"], "G0108": ["https://attack.mitre.org/groups/G0108", "Blue Mockingbird", "Blue Mockingbird has used frp, ssf, and Venom to establish SOCKS proxy connections.[7]"], "S0348": ["https://attack.mitre.org/software/S0348", "Cardinal RAT", "Cardinal RAT can act as a reverse proxy.[8]"], "S0384": ["https://attack.mitre.org/software/S0384", "Dridex", "Dridex contains a backconnect module for tunneling network traffic through a victim's computer. Infected computers become part of a P2P botnet that can relay C2 traffic to other infected peers.[9][10]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used the open source reverse proxy tools including FRPC and Go Proxy to establish connections from C2 to local servers.[11][12][13]"], "S0690": ["https://attack.mitre.org/software/S0690", "Green Lambert", "Green Lambert can use proxies for C2 traffic.[14][15]"], "S0246": ["https://attack.mitre.org/software/S0246", "HARDRAIN", "HARDRAIN uses the command cmd.exe /c netsh firewall add portopening TCP 443 \"adp\" and makes the victim machine function as a proxy server.[16]"], "S0376": ["https://attack.mitre.org/software/S0376", "HOPLIGHT", "HOPLIGHT has multiple proxy options that mask traffic between the malware and the remote operators.[17]"], "S0040": ["https://attack.mitre.org/software/S0040", "HTRAN", "HTRAN can proxy TCP socket connections to obfuscate command and control infrastructure.[18][19]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT can serve as a SOCKS proxy server.[20]"], "S0487": ["https://attack.mitre.org/software/S0487", "Kessel", "Kessel can use a proxy during exfiltration if set in the configuration.[21]"], "S0669": ["https://attack.mitre.org/software/S0669", "KOCTOPUS", "KOCTOPUS has deployed a modified version of Invoke-Ngrok to expose open local ports to the Internet.[22]"], "S0108": ["https://attack.mitre.org/software/S0108", "netsh", "netsh can be used to set up a proxy tunnel to allow remote host access to an infected host.[23]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE can implement use of proxies to pivot traffic.[24]"], "S0508": ["https://attack.mitre.org/software/S0508", "Ngrok", "Ngrok can be used to proxy connections to machines located behind NAT or firewalls.[25][26]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used a custom proxy tool called \"Agent\" which has support for multiple hops.[27]"], "S0435": ["https://attack.mitre.org/software/S0435", "PLEAD", "PLEAD has the ability to proxy network communications.[28]"], "S0378": ["https://attack.mitre.org/software/S0378", "PoshC2", "PoshC2 contains modules that allow for use of proxies in command and control.[29]"], "S0262": ["https://attack.mitre.org/software/S0262", "QuasarRAT", "QuasarRAT can communicate over a reverse proxy using SOCKS5.[30][31]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay can use proxy tools including boost_proxy_client for reverse proxy functionality.[32]"], "S0332": ["https://attack.mitre.org/software/S0332", "Remcos", "Remcos uses the infected hosts as SOCKS5 proxies to allow for tunneling and proxying.[33]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team's BCS-server tool can create an internal proxy server to redirect traffic from the adversary-controlled C2 to internal servers which may not be connected to the internet, but are interconnected locally.[34]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has the ability to use port forwarding to establish a proxy between a target host and C2.[35]"], "S0273": ["https://attack.mitre.org/software/S0273", "Socksbot", "Socksbot can start SOCKS proxy threads.[36]"], "S0615": ["https://attack.mitre.org/software/S0615", "SombRAT", "SombRAT has the ability to use an embedded SOCKS proxy in C2 communications.[37]"], "S0436": ["https://attack.mitre.org/software/S0436", "TSCookie", "TSCookie has the ability to proxy communications with command and control (C2) servers.[38]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla RPC backdoors have included local UPnP RPC proxies.[39]"], "S0263": ["https://attack.mitre.org/software/S0263", "TYPEFRAME", "A TYPEFRAME variant can force the compromised system to function as a proxy server.[40]"], "S0386": ["https://attack.mitre.org/software/S0386", "Ursnif", "Ursnif has used a peer-to-peer (P2P) network for C2.[41][42]"], "S0207": ["https://attack.mitre.org/software/S0207", "Vasport", "Vasport is capable of tunneling though a proxy.[43]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT has the capability to act as a reverse proxy.[44]"], "G0124": ["https://attack.mitre.org/groups/G0124", "Windigo", "Windigo has delivered a generic Windows proxy Win32/Glubteta.M. Windigo has also used multiple reverse proxy chains as part of their C2 infrastructure.[45]"], "S0117": ["https://attack.mitre.org/software/S0117", "XTunnel", "XTunnel relays traffic between a C2 server and a victim.[46]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell can set up an HTTP or SOCKS proxy.[2][47]"]}, "Mitigation": {"M1037": ["https://attack.mitre.org/mitigations/M1037", "Filter Network Traffic", "Traffic to known anonymity networks and C2 infrastructure can be blocked through the use of network allow and block lists. It should be noted that this kind of blocking may be circumvented by other techniques like Domain Fronting."], "M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools. [48]"], "M1020": ["https://attack.mitre.org/mitigations/M1020", "SSL/TLS Inspection", "If it is possible to inspect HTTPS traffic, the captures can be analyzed for connections that appear to be domain fronting."]}, "Detection": {"Network Connection Creation": ["Monitor for newly constructed network connections that are sent or received by untrusted hosts.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
