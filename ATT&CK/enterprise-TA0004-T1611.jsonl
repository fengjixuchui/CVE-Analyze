{"TTP_id": "enterprise-TA0004-T1611", "TTP_name": "Escape to Host", "Description": "Adversaries may break out of a container to gain access to the underlying host. This can allow an adversary access to other containerized resources from the host level or to the host itself. In principle, containerized resources should provide a clear separation of application functionality and be isolated from the host environment.[1]There are multiple ways an adversary may escape to a host environment. Examples include creating a container configured to mount the host’s filesystem using the bind parameter, which allows the adversary to drop payloads and execute control utilities such as cron on the host, or utilizing a privileged container to run commands on the underlying host.[2][3][4] Adversaries may also escape via Exploitation for Privilege Escalation, such as exploiting vulnerabilities in global symbolic links in order to access the root directory of a host machine.[5]Gaining access to the host may provide the adversary with the opportunity to achieve follow-on objectives, such as establishing persistence, moving laterally within the environment, or setting up a command and control channel on the host.", "Property": {"ID": "T1611", "Sub-techniques": "No sub-techniques", "Tactic": "Privilege Escalation", "Platforms": "Containers, Linux, Windows", "Permissions Required": "Administrator, User, root", "Contributors": "Alfredo Oliveira, Trend Micro; Ariel Shuper, Cisco; Daniel Prizmant, Palo Alto Networks; David Fiser, @anu4is, Trend Micro; Idan Frimark, Cisco; Joas Antonio dos Santos, @C0d3Cr4zy, Inmetrics; Magno Logan, @magnologan, Trend Micro; Vishwas Manral, McAfee; Yossi Weizman, Azure Defender Research Team; Yuval Avrahami, Palo Alto Networks", "Version": "1.2", "Created": "30 March 2021", "Last Modified": "01 April 2022"}, "Examples": {"S0600": ["https://attack.mitre.org/software/S0600", "Doki", "Doki’s container was configured to bind the host root directory.[4]"], "S0601": ["https://attack.mitre.org/software/S0601", "Hildegard", "Hildegard has used the BOtB tool that can break out of containers. [6]"], "S0683": ["https://attack.mitre.org/software/S0683", "Peirates", "Peirates can gain a reverse shell on a host node by mounting the Kubernetes hostPath.[7]"], "S0623": ["https://attack.mitre.org/software/S0623", "Siloscape", "Siloscape maps the host’s C drive to the container by creating a global symbolic link to the host through the calling of NtSetInformationSymbolicLink.[8]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has deployed privileged containers that mount the filesystem of victim machine.[9][10]"]}, "Mitigation": {"M1048": ["https://attack.mitre.org/mitigations/M1048", "Application Isolation and Sandboxing", "Consider utilizing seccomp, seccomp-bpf, or a similar solution that restricts certain system calls such as mount. In Kubernetes environments, consider defining a Pod Security Policy that limits container access to host process namespaces, the host network, and the host file system.[11]"], "M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Use read-only containers, read-only file systems, and minimal images when possible to prevent the running of commands.[11]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Ensure containers are not running as root by default. In Kubernetes environments, consider defining a Pod Security Policy that prevents pods from running privileged containers.[11]"]}, "Detection": {"Container Creation": ["Monitor for the deployment of suspicious or unknown container images and pods in your environment, particularly containers running as root.", "DS0032", "https://attack.mitre.org/datasources/DS0032", "Container"], "OS API Execution": ["Remote access tools with built-in features may interact directly with the Windows API, such as calling GetLocaleInfoW() to gather system location information.[12]", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"], "Process Creation": ["Monitor for process activity (such as unexpected processes spawning outside a container and/or on a host) that might indicate an attempt to escape from a privileged container to host.", "", "", ""], "Volume Modification": ["Monitor cluster-level (Kubernetes) data and events associated with changing containers' volume configurations.", "DS0034", "https://attack.mitre.org/datasources/DS0034", "Volume"]}}
