{"TTP_id": "enterprise-TA0006-T1558-T1558.003", "TTP_name": "Kerberoasting", "Description": "Adversaries may abuse a valid Kerberos ticket-granting ticket (TGT) or sniff network traffic to obtain a ticket-granting service (TGS) ticket that may be vulnerable to Brute Force.[1][2]Service principal names (SPNs) are used to uniquely identify each instance of a Windows service. To enable authentication, Kerberos requires that SPNs be associated with at least one service logon account (an account specifically tasked with running a service[3]).[4][5][6][7]Adversaries possessing a valid Kerberos ticket-granting ticket (TGT) may request one or more Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC).[1][2] Portions of these tickets may be encrypted with the RC4 algorithm, meaning the Kerberos 5 TGS-REP etype 23 hash of the service account associated with the SPN is used as the private key and is thus vulnerable to offline Brute Force attacks that may expose plaintext credentials.[2][1] [7]This same behavior could be executed using service tickets captured from network traffic.[2]Cracked hashes may enable Persistence, Privilege Escalation, and Lateral Movement via access to Valid Accounts.[6]", "Property": {"ID": "T1558.003", "Sub-technique of": "T1558", "Tactic": "Credential Access", "Platforms": "Windows", "System Requirements": "Valid domain account or the ability to sniff traffic within a domain", "CAPEC ID": "CAPEC-509", "Contributors": "Praetorian", "Version": "1.2", "Created": "11 February 2020", "Last Modified": "08 March 2022"}, "Examples": {"G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 obtained Ticket Granting Service (TGS) tickets for Active Directory Service Principle Names to crack offline.[8]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire uses PowerSploit's Invoke-Kerberoast to request service tickets and return crackable ticket hashes.[9]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 has used Kerberoasting for credential access and to enable lateral movement.[10]"], "S0357": ["https://attack.mitre.org/software/S0357", "Impacket", "Impacket modules like GetUserSPNs can be used to get Service Principal Names (SPNs) for user accounts. The output is formatted to be compatible with cracking tools like John the Ripper and Hashcat.[11]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has used PowerSploit's Invoke-Kerberoast module to request encrypted service tickets and bruteforce the passwords of Windows service accounts offline.[12]"], "S0194": ["https://attack.mitre.org/software/S0194", "PowerSploit", "PowerSploit's Invoke-Kerberoast module can request service tickets and return crackable ticket hashes.[13][7]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY contains a module to conduct Kerberoasting.[14]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used Rubeus, MimiKatz Kerberos module, and the Invoke-Kerberoast cmdlet to steal AES hashes.[15][16][17][18]"]}, "Mitigation": {"M1041": ["https://attack.mitre.org/mitigations/M1041", "Encrypt Sensitive Information", "Enable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.[2]"], "M1027": ["https://attack.mitre.org/mitigations/M1027", "Password Policies", "Ensure strong password length (ideally 25+ characters) and complexity for service accounts and that these passwords periodically expire.[2] Also consider using Group Managed Service Accounts or another third party product such as password vaulting.[2]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Limit service accounts to minimal required privileges, including membership in privileged groups such as Domain Administrators.[2]"]}, "Detection": {"Active Directory Credential Request": ["Monitor for anomalous Kerberos activity, such as enabling Audit Kerberos Service Ticket Operations to log Kerberos TGS service ticket requests. Particularly investigate irregular patterns of activity (ex: accounts making numerous requests, Event ID 4769, within a small time frame, especially if they also request RC4 encryption [Type 0x17]).", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"]}}
