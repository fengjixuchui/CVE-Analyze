{"TTP_id": "enterprise-TA0010-T1048-T1048.003", "TTP_name": "Exfiltration Over Unencrypted Non-C2 Protocol", "Description": "Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.Adversaries may opt to obfuscate this data, without the use of encryption, within network protocols that are natively unencrypted (such as HTTP, FTP, or DNS). This may include custom or publicly available encoding/compression algorithms (such as base64) as well as embedding data within protocol headers and fields.", "Property": {"ID": "T1048.003", "Sub-technique of": "T1048", "Tactic": "Exfiltration", "Platforms": "Linux, Windows, macOS", "Contributors": "William Cain", "Version": "2.0", "Created": "15 March 2020", "Last Modified": "12 April 2022"}, "Examples": {"S0331": ["https://attack.mitre.org/software/S0331", "Agent Tesla", "Agent Tesla has routines for exfiltration over SMTP, FTP, and HTTP.[1][2][3]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32's backdoor can exfiltrate data by encoding it in the subdomain field of DNS packets.[4]"], "G0064": ["https://attack.mitre.org/groups/G0064", "APT33", "APT33 has used FTP to exfiltrate files (separately from the C2 channel).[5]"], "S0190": ["https://attack.mitre.org/software/S0190", "BITSAdmin", "BITSAdmin can be used to create BITS Jobs to upload files from a compromised host.[6]"], "S0252": ["https://attack.mitre.org/software/S0252", "Brave Prince", "Some Brave Prince variants have used South Korea's Daum email service to exfiltrate information, and later variants have posted the data to a web server via an HTTP post command.[7]"], "S0335": ["https://attack.mitre.org/software/S0335", "Carbon", "Carbon uses HTTP to send data to the C2 server.[8]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "CharmPower can send victim data via FTP with credentials hardcoded in the script.[9]"], "S0107": ["https://attack.mitre.org/software/S0107", "Cherry Picker", "Cherry Picker exfiltrates files over FTP.[10]"], "S0492": ["https://attack.mitre.org/software/S0492", "CookieMiner", "CookieMiner has used the curl --upload-file command to exfiltrate data over HTTP.[11]"], "S0212": ["https://attack.mitre.org/software/S0212", "CORALDECK", "CORALDECK has exfiltrated data in HTTP POST headers.[12]"], "S0050": ["https://attack.mitre.org/software/S0050", "CosmicDuke", "CosmicDuke exfiltrates collected files over FTP or WebDAV. Exfiltration servers can be separately configured from C2 servers.[13]"], "S0281": ["https://attack.mitre.org/software/S0281", "Dok", "Dok exfiltrates logs of its execution stored in the /tmp folder over FTP using the curl command.[14]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has sent stolen payment card data to remote servers via HTTP POSTs.[15]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has used FTP to exfiltrate collected data.[16]"], "S0095": ["https://attack.mitre.org/software/S0095", "ftp", "ftp may be used to exfiltrate data separate from the main command and control protocol.[17][18]"], "S0487": ["https://attack.mitre.org/software/S0487", "Kessel", "Kessel can exfiltrate credentials and other information via HTTP POST request, TCP, and DNS.[19]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has used FTP to exfiltrate reconnaissance data out.[20]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware SierraBravo-Two generates an email message via SMTP containing information about newly infected victims.[21][22]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has exfiltrated data over FTP separately from its primary C2 channel over DNS.[23]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT has used ftp for exfiltration.[24]"], "S0125": ["https://attack.mitre.org/software/S0125", "Remsec", "Remsec can exfiltrate data via a DNS tunnel or email, separately from its C2 channel.[25]"], "G0076": ["https://attack.mitre.org/groups/G0076", "Thrip", "Thrip has used WinSCP to exfiltrate data from a targeted organization over FTP.[26]"], "S0466": ["https://attack.mitre.org/software/S0466", "WindTail", "WindTail has the ability to automatically exfiltrate files using the macOS built-in utility /usr/bin/curl.[27]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has exfiltrated victim information using FTP.[28][29]"]}, "Mitigation": {"M1057": ["https://attack.mitre.org/mitigations/M1057", "Data Loss Prevention", "Data loss prevention can detect and block sensitive data being sent over unencrypted protocols."], "M1037": ["https://attack.mitre.org/mitigations/M1037", "Filter Network Traffic", "Enforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network."], "M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level."], "M1030": ["https://attack.mitre.org/mitigations/M1030", "Network Segmentation", "Follow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.[30]"]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may steal data by exfiltrating it over a symmetrically encrypted network protocol other than that of the existing command and control channel.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "File Access": ["Monitor files viewed in isolation that may steal data by exfiltrating it over a symmetrically encrypted network protocol other than that of the existing command and control channel.", "DS0022", "https://attack.mitre.org/datasources/DS0022", "File"], "Network Connection Creation": ["Monitor for newly constructed network connections that are sent or received by untrusted hosts.", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "", "", ""], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
