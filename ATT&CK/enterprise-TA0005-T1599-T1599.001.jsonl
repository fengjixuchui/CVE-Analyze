{"TTP_id": "enterprise-TA0005-T1599-T1599.001", "TTP_name": "Network Address Translation Traversal", "Description": "Adversaries may bridge network boundaries by modifying a network deviceâ€™s Network Address Translation (NAT) configuration. Malicious modifications to NAT may enable an adversary to bypass restrictions on traffic routing that otherwise separate trusted and untrusted networks.Network devices such as routers and firewalls that connect multiple networks together may implement NAT during the process of passing packets between networks. When performing NAT, the network device will rewrite the source and/or destination addresses of the IP address header. Some network designs require NAT for the packets to cross the border device. A typical example of this is environments where internal networks make use of non-Internet routable addresses.[1]When an adversary gains control of a network boundary device, they can either leverage existing NAT configurations to send traffic between two separated networks, or they can implement NAT configurations of their own design. In the case of network designs that require NAT to function, this enables the adversary to overcome inherent routing limitations that would normally prevent them from accessing protected systems behind the border device. In the case of network designs that do not require NAT, address translation can be used by adversaries to obscure their activities, as changing the addresses of packets that traverse a network boundary device can make monitoring data transmissions more challenging for defenders.Adversaries may use Patch System Image to change the operating system of a network device, implementing their own custom NAT mechanisms to further obscure their activities", "Property": {"ID": "T1599.001", "Sub-technique of": "T1599", "Tactic": "Defense Evasion", "Platforms": "Network", "Permissions Required": "Administrator", "Version": "1.0", "Created": "19 October 2020", "Last Modified": "21 October 2020"}, "Examples": {}, "Mitigation": {"M1043": ["https://attack.mitre.org/mitigations/M1043", "Credential Access Protection", "Some embedded network devices are capable of storing passwords for local accounts in either plain-text or encrypted formats. Ensure that, where available, local passwords are always encrypted, per vendor recommendations. [2]"], "M1037": ["https://attack.mitre.org/mitigations/M1037", "Filter Network Traffic", "Block Traffic Upon identifying a compromised network device being used to bridge a network boundary, block the malicious packets using an unaffected network device in path, such as a firewall or a router that has not been compromised. Continue to monitor for additional activity and to ensure that the blocks are indeed effective."], "M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Use multi-factor authentication for user and privileged accounts. Most embedded network devices support TACACS+ and/or RADIUS. Follow vendor prescribed best practices for hardening access control. [3]"], "M1027": ["https://attack.mitre.org/mitigations/M1027", "Password Policies", "Refer to NIST guidelines when creating password policies. [4]"], "M1026": ["https://attack.mitre.org/mitigations/M1026", "Privileged Account Management", "Restrict administrator accounts to as few individuals as possible, following least privilege principles. Prevent credential overlap across systems of administrator and privileged accounts, particularly between network and non-network platforms, such as servers or endpoints."]}, "Detection": {"Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"], "Network Traffic Flow": ["Monitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.", "", "", ""]}}
