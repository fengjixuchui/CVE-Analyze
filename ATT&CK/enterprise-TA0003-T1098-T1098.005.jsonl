{"TTP_id": "enterprise-TA0003-T1098-T1098.005", "TTP_name": "Device Registration", "Description": "Adversaries may register a device to an adversary-controlled account. Devices may be registered in a multifactor authentication (MFA) system, which handles authentication to the network, or in a device management system, which handles device access and compliance.MFA systems, such as Duo or Okta, allow users to associate devices with their accounts in order to complete MFA requirements. An adversary that compromises a userâ€™s credentials may enroll a new device in order to bypass initial MFA requirements and gain persistent access to a network.[1][2]Similarly, an adversary with existing access to a network may register a device to Azure AD and/or its device management system, Microsoft Intune, in order to access sensitive data or resources while bypassing conditional access policies.[3][4][5]Devices registered in Azure AD may be able to conduct Internal Spearphishing campaigns via intra-organizational emails, which are less likely to be treated as suspicious by the email client.[6] Additionally, an adversary may be able to perform a Service Exhaustion Flood on an Azure AD tenant by registering a large number of devices.[7]", "Property": {"ID": "T1098.005", "Sub-technique of": "T1098", "Tactic": "Persistence", "Platforms": "Azure AD, SaaS, Windows", "Contributors": "Mike Moran; Pawel Partyka, Microsoft 365 Defender", "Version": "1.0", "Created": "04 March 2022", "Last Modified": "25 April 2022"}, "Examples": {"S0677": ["https://attack.mitre.org/software/S0677", "AADInternals", "AADInternals can register a device to Azure AD.[8]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 registered devices in order to enable mailbox syncing via the Set-CASMailbox command.[9]"]}, "Mitigation": {"M1032": ["https://attack.mitre.org/mitigations/M1032", "Multi-factor Authentication", "Require multi-factor authentication to register devices in Azure AD.[6] Configure multi-factor authentication systems to disallow enrolling new devices for inactive accounts.[1]"]}, "Detection": {"Active Directory Object Creation": ["Monitor for the registration or joining of new device objects in Active Directory.", "DS0026", "https://attack.mitre.org/datasources/DS0026", "Active Directory"], "Application Log Content": ["Azure AD creates several log entries when new devices are enrolled, which can be monitored for unexpected device registrations.[7] Additionally, joined devices can be viewed via the Azure AD portal.[10]", "DS0015", "https://attack.mitre.org/datasources/DS0015", "Application Log"], "User Account Modification": ["Monitor user accounts for new and suspicious device associations, such as those originating from unusual sources, occurring at unusual times, or following a suspicious login.[5]", "DS0002", "https://attack.mitre.org/datasources/DS0002", "User Account"]}}
