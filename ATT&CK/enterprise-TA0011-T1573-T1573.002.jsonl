{"TTP_id": "enterprise-TA0011-T1573-T1573.002", "TTP_name": "Asymmetric Cryptography", "Description": "Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private. Due to how the keys are generated, the sender encrypts data with the receiverâ€™s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA and ElGamal.For efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as Asymmetric Cryptography.", "Property": {"ID": "T1573.002", "Sub-technique of": "T1573", "Tactic": "Command and Control", "Platforms": "Linux, Windows, macOS", "Version": "1.0", "Created": "16 March 2020", "Last Modified": "20 April 2021"}, "Examples": {"S0202": ["https://attack.mitre.org/software/S0202", "adbupd", "adbupd contains a copy of the OpenSSL library to encrypt C2 traffic.[1]"], "S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "A variant of ADVSTORESHELL encrypts some C2 with RSA.[2]"], "S0438": ["https://attack.mitre.org/software/S0438", "Attor", "Attor's Blowfish key is encrypted with a public RSA key.[3]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can use TLS in C2 communications.[4]"], "S0017": ["https://attack.mitre.org/software/S0017", "BISCUIT", "BISCUIT uses SSL for encrypting C2 communications.[5]"], "S0335": ["https://attack.mitre.org/software/S0335", "Carbon", "Carbon has used RSA encryption for C2 communications.[6]"], "S0023": ["https://attack.mitre.org/software/S0023", "CHOPSTICK", "CHOPSTICK encrypts C2 communications with TLS.[7]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has used the Plink utility to create SSH tunnels.[8]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike can use RSA asymmetric encryption with PKCS1 padding to encrypt data sent to the C2 server.[9]"], "S0126": ["https://attack.mitre.org/software/S0126", "ComRAT", "ComRAT can use SSL/TLS encryption for its HTTP-based C2 channel. ComRAT has used public key cryptography with RSA and AES encrypted email attachments for its Gmail C2 channel.[10][11]"], "S0687": ["https://attack.mitre.org/software/S0687", "Cyclops Blink", "Cyclops Blink can encrypt C2 messages with AES-256-CBC sent underneath TLS. OpenSSL library functions are also used to encrypt each message using a randomly generated key and IV, which are then encrypted using a hard-coded RSA public key.[12]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can use TLS to encrypt its C2 channel.[13]"], "S0600": ["https://attack.mitre.org/software/S0600", "Doki", "Doki has used the embedTLS library for network communications.[14]"], "S0384": ["https://attack.mitre.org/software/S0384", "Dridex", "Dridex has encrypted traffic with RSA.[15]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet is known to use RSA keys for encrypting C2 traffic. [16]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire can use TLS to encrypt its C2 channel.[17]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 used the Plink command-line utility to create SSH tunnels to C2 servers.[18]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has used the Plink utility to tunnel RDP back to C2 infrastructure.[19]"], "S0168": ["https://attack.mitre.org/software/S0168", "Gazer", "Gazer uses custom encryption for C2 that uses RSA.[20][21]"], "S0588": ["https://attack.mitre.org/software/S0588", "GoldMax", "GoldMax has RSA-encrypted its communication with the C2 server.[22]"], "S0531": ["https://attack.mitre.org/software/S0531", "Grandoreiro", "Grandoreiro can use SSL in C2 communication.[23]"], "S0342": ["https://attack.mitre.org/software/S0342", "GreyEnergy", "GreyEnergy encrypts communications using RSA-2048.[24]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can use a hardcoded server public RSA key to encrypt the first request to C2.[25]"], "S0087": ["https://attack.mitre.org/software/S0087", "Hi-Zor", "Hi-Zor encrypts C2 traffic with TLS.[26]"], "S0483": ["https://attack.mitre.org/software/S0483", "IcedID", "IcedID has used SSL and TLS in communications with C2.[27][28]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can use SSL and TLS for communications.[29]"], "S0641": ["https://attack.mitre.org/software/S0641", "Kobalos", "Kobalos's authentication and key exchange is performed using RSA-512.[30][31]"], "S0409": ["https://attack.mitre.org/software/S0409", "Machete", "Machete has used TLS-encrypted FTP to exfiltrate data.[32]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo's C2 communication has been encrypted using OpenSSL.[33]"], "S0699": ["https://attack.mitre.org/software/S0699", "Mythic", "Mythic supports SSL encrypted C2.[34]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig used the Plink utility and other tools to create tunnels to C2 servers.[35]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao's proxy implementation \"Agent\" can upgrade the socket in use to a TLS socket.[36]"], "S0556": ["https://attack.mitre.org/software/S0556", "Pay2Key", "Pay2Key has used RSA encrypted communications with C2.[37]"], "S0587": ["https://attack.mitre.org/software/S0587", "Penquin", "Penquin can encrypt communications using the BlowFish algorithm and a symmetric key exchanged with Diffie Hellman.[38]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT used TLS to encrypt command and control (C2) communications.[39]"], "S0150": ["https://attack.mitre.org/software/S0150", "POSHSPY", "POSHSPY encrypts C2 traffic with AES and RSA.[40]"], "S0223": ["https://attack.mitre.org/software/S0223", "POWERSTATS", "POWERSTATS has encrypted C2 traffic with RSA.[41]"], "S0192": ["https://attack.mitre.org/software/S0192", "Pupy", "Pupy's default encryption for its C2 communication channel is SSL, but it also has transport options for RSA and AES.[42]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil has encrypted C2 communications with the ECIES algorithm.[43]"], "S0382": ["https://attack.mitre.org/software/S0382", "ServHelper", "ServHelper may set up a reverse SSH tunnel to give the attacker access to services running on the victim, such as RDP.[44]"], "S0633": ["https://attack.mitre.org/software/S0633", "Sliver", "Sliver can use mutual TLS and RSA cryptography to exchange a session key.[45][46][47]"], "S0627": ["https://attack.mitre.org/software/S0627", "SodaMaster", "SodaMaster can use a hardcoded RSA key to encrypt some of its C2 traffic.[48]"], "S0615": ["https://attack.mitre.org/software/S0615", "SombRAT", "SombRAT can SSL encrypt C2 traffic.[49][50][51]"], "S0491": ["https://attack.mitre.org/software/S0491", "StrongPity", "StrongPity has encrypted C2 traffic using SSL/TLS.[52]"], "S0018": ["https://attack.mitre.org/software/S0018", "Sykipot", "Sykipot uses SSL for encrypting C2 communications.[53]"], "S0668": ["https://attack.mitre.org/software/S0668", "TinyTurla", "TinyTurla has the ability to encrypt C2 traffic with SSL/TLS.[54]"], "S0183": ["https://attack.mitre.org/software/S0183", "Tor", "Tor encapsulates traffic in multiple layers of encryption, using TLS by default.[55]"], "S0094": ["https://attack.mitre.org/software/S0094", "Trojan.Karagany", "Trojan.Karagany can secure C2 communications with SSL and TLS.[56]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper has used SSL to connect to C2 servers.[57][58]"], "S0180": ["https://attack.mitre.org/software/S0180", "Volgmer", "Some Volgmer variants use SSL to encrypt C2 communications.[59]"], "S0366": ["https://attack.mitre.org/software/S0366", "WannaCry", "WannaCry uses Tor for command and control traffic and routes a custom cryptographic protocol over the Tor circuit.[60]"], "S0515": ["https://attack.mitre.org/software/S0515", "WellMail", "WellMail can use hard coded client and certificate authority certificates to communicate with C2 over mutual TLS.[61][62]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess can communicate to C2 with mutual TLS where client and server mutually check certificates.[63][64][65][62]"], "S0117": ["https://attack.mitre.org/software/S0117", "XTunnel", "XTunnel uses SSL/TLS and RC4 to encrypt traffic.[66][7]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy uses SSL and AES ECB for encrypting C2 communications.[67][68][69]"]}, "Mitigation": {"M1031": ["https://attack.mitre.org/mitigations/M1031", "Network Intrusion Prevention", "Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level."], "M1020": ["https://attack.mitre.org/mitigations/M1020", "SSL/TLS Inspection", "SSL/TLS inspection can be used to see the contents of encrypted sessions to look for network-based indicators of malware communication protocols."]}, "Detection": {"Network Traffic Content": ["Monitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).", "DS0029", "https://attack.mitre.org/datasources/DS0029", "Network Traffic"]}}
