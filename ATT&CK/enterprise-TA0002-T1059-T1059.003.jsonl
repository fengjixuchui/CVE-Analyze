{"TTP_id": "enterprise-TA0002-T1059-T1059.003", "TTP_name": "Windows Command Shell", "Description": "Adversaries may abuse the Windows command shell for execution. The Windows command shell (cmd) is the primary command prompt on Windows systems. The Windows command prompt can be used to control almost any aspect of a system, with various permission levels required for different subsets of commands. The command prompt can be invoked remotely via Remote Services such as SSH.[1]Batch files (ex: .bat or .cmd) also provide the shell with a list of sequential commands to run, as well as normal scripting operations such as conditionals and loops. Common uses of batch files include long or repetitive tasks, or the need to run the same set of commands on multiple systems.Adversaries may leverage cmd to execute various commands and payloads. Common uses include cmd to execute a single command, or abusing cmd interactively with input and output forwarded over a command and control channel.", "Property": {"ID": "T1059.003", "Sub-technique of": "T1059", "Tactic": "Execution", "Platforms": "Windows", "Permissions Required": "User", "Supports Remote": "Yes", "Version": "1.2", "Created": "09 March 2020", "Last Modified": "26 July 2021"}, "Examples": {"S0065": ["https://attack.mitre.org/software/S0065", "4H RAT", "4H RAT has the capability to create a remote shell.[2]"], "S0469": ["https://attack.mitre.org/software/S0469", "ABK", "ABK has the ability to use cmd to run a Portable Executable (PE) on the compromised host.[3]"], "S0202": ["https://attack.mitre.org/software/S0202", "adbupd", "adbupd can run a copy of cmd.exe.[4]"], "G0018": ["https://attack.mitre.org/groups/G0018", "admin@338", "Following exploitation with LOWBALL malware, admin@338 actors created a file containing a list of commands to be executed on the compromised computer.[5]"], "S0045": ["https://attack.mitre.org/software/S0045", "ADVSTORESHELL", "ADVSTORESHELL can create a remote shell and run a given command.[6][7]"], "S0504": ["https://attack.mitre.org/software/S0504", "Anchor", "Anchor has used cmd.exe to run its self deletion routine.[8]"], "G0006": ["https://attack.mitre.org/groups/G0006", "APT1", "APT1 has used the Windows command shell to execute commands, and batch scripting to automate execution.[9]"], "G0026": ["https://attack.mitre.org/groups/G0026", "APT18", "APT18 uses cmd.exe to execute commands on the victim’s machine.[10][11]"], "G0007": ["https://attack.mitre.org/groups/G0007", "APT28", "An APT28 loader Trojan uses a cmd.exe and batch script to run its payload.[12] The group has also used macros to execute payloads.[13][14][15][16]"], "G0016": ["https://attack.mitre.org/groups/G0016", "APT29", "APT29 used cmd.exe to execute commands on remote machines.[17][18]"], "G0022": ["https://attack.mitre.org/groups/G0022", "APT3", "An APT3 downloader uses the Windows command \"cmd.exe\" /C whoami. The group also uses a tool to execute commands on remote computers.[19][20]"], "G0050": ["https://attack.mitre.org/groups/G0050", "APT32", "APT32 has used cmd.exe for execution.[21]"], "G0067": ["https://attack.mitre.org/groups/G0067", "APT37", "APT37 has used the command-line interface.[22][23]"], "G0082": ["https://attack.mitre.org/groups/G0082", "APT38", "APT38 has used a command-line tunneler, NACHOCHEESE, to give them shell access to a victim’s machine.[24]"], "G0096": ["https://attack.mitre.org/groups/G0096", "APT41", "APT41 used cmd.exe /c to execute commands on remote machines.[25]APT41 used a batch file to install persistence for the Cobalt Strike BEACON loader.[26]"], "G0143": ["https://attack.mitre.org/groups/G0143", "Aquatic Panda", "Aquatic Panda has attempted and failed to run Bash commands on a Windows host by passing them to cmd /C.[27]"], "S0373": ["https://attack.mitre.org/software/S0373", "Astaroth", "Astaroth spawns a CMD process to execute commands. [28]"], "S0347": ["https://attack.mitre.org/software/S0347", "AuditCred", "AuditCred can open a reverse shell on the system to execute commands.[29]"], "S0638": ["https://attack.mitre.org/software/S0638", "Babuk", "Babuk has the ability to use the command line to control execution on compromised hosts.[30][31]"], "S0414": ["https://attack.mitre.org/software/S0414", "BabyShark", "BabyShark has used cmd.exe to execute commands.[32]"], "S0475": ["https://attack.mitre.org/software/S0475", "BackConfig", "BackConfig can download and run batch files to execute commands on a compromised host.[33]"], "S0031": ["https://attack.mitre.org/software/S0031", "BACKSPACE", "Adversaries can direct BACKSPACE to execute from the command line on infected hosts, or have BACKSPACE create a reverse shell.[34]"], "S0128": ["https://attack.mitre.org/software/S0128", "BADNEWS", "BADNEWS is capable of executing commands via cmd.exe.[35][36]"], "S0234": ["https://attack.mitre.org/software/S0234", "Bandook", "Bandook is capable of spawning a Windows command shell.[37][38]"], "S0239": ["https://attack.mitre.org/software/S0239", "Bankshot", "Bankshot uses the command-line interface to execute arbitrary commands.[39][40]"], "S0534": ["https://attack.mitre.org/software/S0534", "Bazar", "Bazar can launch cmd.exe to perform reconnaissance commands.[41][42]"], "S0470": ["https://attack.mitre.org/software/S0470", "BBK", "BBK has the ability to use cmd to run a Portable Executable (PE) on the compromised host.[3]"], "S0017": ["https://attack.mitre.org/software/S0017", "BISCUIT", "BISCUIT has a command to launch a command shell on the system.[43]"], "S0268": ["https://attack.mitre.org/software/S0268", "Bisonal", "Bisonal has launched cmd.exe and used the ShellExecuteW() API function to execute commands on the system.[44][45][46]"], "S0069": ["https://attack.mitre.org/software/S0069", "BLACKCOFFEE", "BLACKCOFFEE has the capability to create a reverse shell.[47]"], "S0564": ["https://attack.mitre.org/software/S0564", "BlackMould", "BlackMould can run cmd.exe with parameters.[48]"], "S0520": ["https://attack.mitre.org/software/S0520", "BLINDINGCAN", "BLINDINGCAN has executed commands via cmd.exe.[49]"], "G0108": ["https://attack.mitre.org/groups/G0108", "Blue Mockingbird", "Blue Mockingbird has used batch script files to automate execution and deployment of payloads.[50]"], "S0360": ["https://attack.mitre.org/software/S0360", "BONDUPDATER", "BONDUPDATER can read batch commands in a file sent from its C2 server and execute them with cmd.exe.[51]"], "S0651": ["https://attack.mitre.org/software/S0651", "BoxCaon", "BoxCaon can execute arbitrary commands and utilize the \"ComSpec\" environment variable.[52]"], "G0060": ["https://attack.mitre.org/groups/G0060", "BRONZE BUTLER", "BRONZE BUTLER has used batch scripts and the command-line interface for execution.[53]"], "S0025": ["https://attack.mitre.org/software/S0025", "CALENDAR", "CALENDAR has a command to run cmd.exe to execute commands.[43]"], "S0030": ["https://attack.mitre.org/software/S0030", "Carbanak", "Carbanak has a command to create a reverse shell.[54]"], "S0348": ["https://attack.mitre.org/software/S0348", "Cardinal RAT", "Cardinal RAT can execute commands.[55]"], "S0462": ["https://attack.mitre.org/software/S0462", "CARROTBAT", "CARROTBAT has the ability to execute command line arguments on a compromised host.[56]"], "S0572": ["https://attack.mitre.org/software/S0572", "Caterpillar WebShell", "Caterpillar WebShell can run commands on the compromised asset with CMD functions.[57]"], "S0631": ["https://attack.mitre.org/software/S0631", "Chaes", "Chaes has used cmd to execute tasks on the system.[58]"], "S0674": ["https://attack.mitre.org/software/S0674", "CharmPower", "The C# implementation of the CharmPower command execution module can use cmd.[59]"], "G0114": ["https://attack.mitre.org/groups/G0114", "Chimera", "Chimera has used the Windows Command Shell and batch scripts for execution on compromised hosts.[60]"], "S0020": ["https://attack.mitre.org/software/S0020", "China Chopper", "China Chopper's server component is capable of opening a command terminal.[61][62][63]"], "S0660": ["https://attack.mitre.org/software/S0660", "Clambling", "Clambling can use cmd.exe for command execution.[64]"], "S0611": ["https://attack.mitre.org/software/S0611", "Clop", "Clop can use cmd.exe to help execute commands on the system.[65]"], "S0106": ["https://attack.mitre.org/software/S0106", "cmd", "cmd is used to execute programs and other actions at the command-line interface.[66]"], "G0080": ["https://attack.mitre.org/groups/G0080", "Cobalt Group", "Cobalt Group has used a JavaScript backdoor that is capable of launching cmd.exe to execute shell commands.[67] The group has used an exploit toolkit known as Threadkit that launches .bat files.[68][69][70][67][71][72]"], "S0154": ["https://attack.mitre.org/software/S0154", "Cobalt Strike", "Cobalt Strike uses a command-line interface to interact with systems.[73][74][75]"], "S0338": ["https://attack.mitre.org/software/S0338", "Cobian RAT", "Cobian RAT can launch a remote command shell interface for executing commands.[76]"], "S0369": ["https://attack.mitre.org/software/S0369", "CoinTicker", "CoinTicker executes a bash script to establish a reverse shell.[77]"], "S0244": ["https://attack.mitre.org/software/S0244", "Comnie", "Comnie executes BAT scripts.[78]"], "S0126": ["https://attack.mitre.org/software/S0126", "ComRAT", "ComRAT has used cmd.exe to execute commands.[79]"], "S0575": ["https://attack.mitre.org/software/S0575", "Conti", "Conti can utilize command line options to allow an attacker control over how it scans and encrypts files.[80]"], "S0046": ["https://attack.mitre.org/software/S0046", "CozyCar", "A module in CozyCar allows arbitrary commands to be executed by invoking C:\\Windows\\System32\\cmd.exe.[81]"], "S0115": ["https://attack.mitre.org/software/S0115", "Crimson", "Crimson has the ability to execute commands with the COMSPEC environment variable.[82]"], "S0625": ["https://attack.mitre.org/software/S0625", "Cuba", "Cuba has used cmd.exe /c and batch files for execution.[83]"], "G0070": ["https://attack.mitre.org/groups/G0070", "Dark Caracal", "Dark Caracal has used macros in Word documents that would download a second stage if executed.[84]"], "S0334": ["https://attack.mitre.org/software/S0334", "DarkComet", "DarkComet can launch a remote shell to execute commands on the victim’s machine.[85]"], "G0012": ["https://attack.mitre.org/groups/G0012", "Darkhotel", "Darkhotel has dropped an mspaint.lnk shortcut to disk which launches a shell script that downloads and executes a file.[86]"], "S0673": ["https://attack.mitre.org/software/S0673", "DarkWatchman", "DarkWatchman can use cmd.exe to execute commands.[87]"], "S0187": ["https://attack.mitre.org/software/S0187", "Daserf", "Daserf can execute shell commands.[88][53]"], "S0243": ["https://attack.mitre.org/software/S0243", "DealersChoice", "DealersChoice makes modifications to open-source scripts from GitHub and executes them on the victim’s machine.[89]"], "S0354": ["https://attack.mitre.org/software/S0354", "Denis", "Denis can launch a remote shell to execute arbitrary commands on the victim’s machine.[90][21]"], "S0200": ["https://attack.mitre.org/software/S0200", "Dipsind", "Dipsind can spawn remote shells.[4]"], "S0186": ["https://attack.mitre.org/software/S0186", "DownPaper", "DownPaper uses the command line.[91]"], "G0035": ["https://attack.mitre.org/groups/G0035", "Dragonfly", "Dragonfly has used various types of scripting to perform operations, including batch scripts.[92]"], "S0547": ["https://attack.mitre.org/software/S0547", "DropBook", "DropBook can execute arbitrary shell commands on the victims' machines.[93][94]"], "S0567": ["https://attack.mitre.org/software/S0567", "Dtrack", "Dtrack has used cmd.exe to add a persistent service.[95]"], "S0593": ["https://attack.mitre.org/software/S0593", "ECCENTRICBANDWAGON", "ECCENTRICBANDWAGON can use cmd to execute commands on a victim’s machine.[96]"], "S0554": ["https://attack.mitre.org/software/S0554", "Egregor", "Egregor has used batch files for execution and can launch Internet Explorer from cmd.exe.[97][98]"], "S0082": ["https://attack.mitre.org/software/S0082", "Emissary", "Emissary has the capability to create a remote shell and execute specified commands.[99]"], "S0367": ["https://attack.mitre.org/software/S0367", "Emotet", "Emotet has used cmd.exe to run a PowerShell script. [100]"], "S0363": ["https://attack.mitre.org/software/S0363", "Empire", "Empire has modules for executing scripts.[101]"], "S0634": ["https://attack.mitre.org/software/S0634", "EnvyScout", "EnvyScout can use cmd.exe to execute malicious files on compromised hosts.[102]"], "S0396": ["https://attack.mitre.org/software/S0396", "EvilBunny", "EvilBunny has an integrated scripting engine to download and execute Lua scripts.[103]"], "S0343": ["https://attack.mitre.org/software/S0343", "Exaramel for Windows", "Exaramel for Windows has a command to launch a remote shell and executes commands on the victim’s machine.[104]"], "S0171": ["https://attack.mitre.org/software/S0171", "Felismus", "Felismus uses command line for execution.[105]"], "S0267": ["https://attack.mitre.org/software/S0267", "FELIXROOT", "FELIXROOT executes batch scripts on the victim’s machine, and can launch a reverse shell for command execution.[106][107]"], "G0051": ["https://attack.mitre.org/groups/G0051", "FIN10", "FIN10 has executed malicious .bat files containing PowerShell commands.[108]"], "G0037": ["https://attack.mitre.org/groups/G0037", "FIN6", "FIN6 has used kill.bat script to disable security tools.[109]"], "G0046": ["https://attack.mitre.org/groups/G0046", "FIN7", "FIN7 used the command prompt to launch commands on the victim’s machine.[110][111]"], "G0061": ["https://attack.mitre.org/groups/G0061", "FIN8", "FIN8 has used a Batch file to automate frequently executed post compromise cleanup activities.[112] FIN8 has also executed commands remotely via cmd.[113][114]"], "S0696": ["https://attack.mitre.org/software/S0696", "Flagpro", "Flagpro can use cmd.exe to execute commands received from C2.[115]"], "G0117": ["https://attack.mitre.org/groups/G0117", "Fox Kitten", "Fox Kitten has used cmd.exe likely as a password changing mechanism.[116]"], "G0101": ["https://attack.mitre.org/groups/G0101", "Frankenstein", "Frankenstein has run a command script to set up persistence as a scheduled task named \"WinUpdate\", as well as other encoded commands from the command-line.[117]"], "G0093": ["https://attack.mitre.org/groups/G0093", "GALLIUM", "GALLIUM used the Windows command shell to execute commands.[118]"], "G0047": ["https://attack.mitre.org/groups/G0047", "Gamaredon Group", "Gamaredon Group has used various batch scripts to establish C2 and download additional files. Gamaredon Group's backdoor malware has also been written to a batch file.[119][120][121][122]"], "S0666": ["https://attack.mitre.org/software/S0666", "Gelsemium", "Gelsemium can use a batch script to delete itself.[123]"], "S0249": ["https://attack.mitre.org/software/S0249", "Gold Dragon", "Gold Dragon uses cmd.exe to execute commands for discovery.[124]"], "S0493": ["https://attack.mitre.org/software/S0493", "GoldenSpy", "GoldenSpy can execute remote commands via the command-line interface.[125]"], "S0588": ["https://attack.mitre.org/software/S0588", "GoldMax", "GoldMax can spawn a command shell, and execute native commands.[126][127]"], "S0477": ["https://attack.mitre.org/software/S0477", "Goopy", "Goopy has the ability to use cmd.exe to execute commands passed from an Outlook C2 channel.[21]"], "G0078": ["https://attack.mitre.org/groups/G0078", "Gorgon Group", "Gorgon Group malware can use cmd.exe to download and execute payloads and to execute commands on the system.[128]"], "S0237": ["https://attack.mitre.org/software/S0237", "GravityRAT", "GravityRAT executes commands remotely on the infected host.[129]"], "S0342": ["https://attack.mitre.org/software/S0342", "GreyEnergy", "GreyEnergy uses cmd.exe to execute itself in-memory.[107]"], "S0632": ["https://attack.mitre.org/software/S0632", "GrimAgent", "GrimAgent can use the Windows Command Shell to execute commands, including its own removal.[130]"], "S0132": ["https://attack.mitre.org/software/S0132", "H1N1", "H1N1 kills and disables services by using cmd.exe.[131]"], "S0246": ["https://attack.mitre.org/software/S0246", "HARDRAIN", "HARDRAIN uses cmd.exe to execute netshcommands.[132]"], "S0391": ["https://attack.mitre.org/software/S0391", "HAWKBALL", "HAWKBALL has created a cmd.exe reverse shell, executed commands, and uploaded output via the command line.[133]"], "S0071": ["https://attack.mitre.org/software/S0071", "hcdLoader", "hcdLoader provides command-line access to the compromised system.[134]"], "S0170": ["https://attack.mitre.org/software/S0170", "Helminth", "Helminth can provide a remote shell. One version of Helminth uses batch scripting.[135]"], "S0697": ["https://attack.mitre.org/software/S0697", "HermeticWiper", "HermeticWiper can use cmd.exe /Q/c move CSIDL_SYSTEM_DRIVE\\temp\\sys.tmp1 CSIDL_WINDOWS\\policydefinitions\\postgresql.exe 1> \\\\127.0.0.1\\ADMIN$\\_1636727589.6007507 2>&1 to deploy on an infected system.[136]"], "S0698": ["https://attack.mitre.org/software/S0698", "HermeticWizard", "HermeticWizard can use cmd.exe for execution on compromised hosts.[136]"], "S0087": ["https://attack.mitre.org/software/S0087", "Hi-Zor", "Hi-Zor has the ability to create a reverse shell.[137]"], "S0394": ["https://attack.mitre.org/software/S0394", "HiddenWasp", "HiddenWasp uses a script to automate tasks on the victim's machine and to assist in execution.[138]"], "G0126": ["https://attack.mitre.org/groups/G0126", "Higaisa", "Higaisa used cmd.exe for execution.[139][140][141]"], "S0009": ["https://attack.mitre.org/software/S0009", "Hikit", "Hikit has the ability to create a remote shell and run given commands.[142]"], "S0232": ["https://attack.mitre.org/software/S0232", "HOMEFRY", "HOMEFRY uses a command-line interface.[143]"], "G0072": ["https://attack.mitre.org/groups/G0072", "Honeybee", "Several commands are supported by the Honeybee's implant via the command-line interface and there’s also a utility to execute any custom command on an infected endpoint.[144] Honeybee used batch scripting.[144]"], "S0376": ["https://attack.mitre.org/software/S0376", "HOPLIGHT", "HOPLIGHT can launch cmd.exe to execute commands on the system.[145]"], "S0431": ["https://attack.mitre.org/software/S0431", "HotCroissant", "HotCroissant can remotely open applications on the infected host with the ShellExecuteA command.[146]"], "S0070": ["https://attack.mitre.org/software/S0070", "HTTPBrowser", "HTTPBrowser is capable of spawning a reverse shell on a victim.[147]"], "S0068": ["https://attack.mitre.org/software/S0068", "httpclient", "httpclient opens cmd.exe on the victim.[2]"], "G0119": ["https://attack.mitre.org/groups/G0119", "Indrik Spider", "Indrik Spider has used batch scripts on victim's machines.[148]"], "S0259": ["https://attack.mitre.org/software/S0259", "InnaputRAT", "InnaputRAT launches a shell to execute commands on the victim’s machine.[149]"], "S0260": ["https://attack.mitre.org/software/S0260", "InvisiMole", "InvisiMole can launch a remote shell to execute commands.[150][151]"], "S0015": ["https://attack.mitre.org/software/S0015", "Ixeshe", "Ixeshe is capable of executing commands via cmd.[152]"], "S0389": ["https://attack.mitre.org/software/S0389", "JCry", "JCry has used cmd.exe to launch PowerShell.[153]"], "S0044": ["https://attack.mitre.org/software/S0044", "JHUHUGIT", "JHUHUGIT uses a .bat file to execute a .dll.[13]"], "S0201": ["https://attack.mitre.org/software/S0201", "JPIN", "JPIN can use the command-line utility cacls.exe to change file permissions.[4]"], "S0283": ["https://attack.mitre.org/software/S0283", "jRAT", "jRAT has command line access.[154]"], "S0088": ["https://attack.mitre.org/software/S0088", "Kasidet", "Kasidet can execute commands using cmd.exe.[155]"], "S0265": ["https://attack.mitre.org/software/S0265", "Kazuar", "Kazuar uses cmd.exe to execute commands on the victim’s machine.[156]"], "G0004": ["https://attack.mitre.org/groups/G0004", "Ke3chang", "Ke3chang has used batch scripts in its malware to install persistence mechanisms.[157]"], "S0387": ["https://attack.mitre.org/software/S0387", "KeyBoy", "KeyBoy can launch interactive shells for communicating with the victim machine.[158][159]"], "S0271": ["https://attack.mitre.org/software/S0271", "KEYMARBLE", "KEYMARBLE can execute shell commands using cmd.exe.[160]"], "S0526": ["https://attack.mitre.org/software/S0526", "KGH_SPY", "KGH_SPY has the ability to set a Registry key to run a cmd.exe command.[161]"], "G0094": ["https://attack.mitre.org/groups/G0094", "Kimsuky", "Kimsuky has executed Windows commands by using cmd and running batch scripts.[162][163]"], "S0250": ["https://attack.mitre.org/software/S0250", "Koadic", "Koadic can open an interactive command-shell to perform command line functions on victim machines. Koadic performs most of its operations using Windows Script Host (Jscript) and to run arbitrary shellcode.[164][165]"], "S0669": ["https://attack.mitre.org/software/S0669", "KOCTOPUS", "KOCTOPUS has used cmd.exe and batch files for execution.[165]"], "S0156": ["https://attack.mitre.org/software/S0156", "KOMPROGO", "KOMPROGO is capable of creating a reverse shell.[166]"], "S0356": ["https://attack.mitre.org/software/S0356", "KONNI", "KONNI has used cmd.exe to execute arbitrary commands on the infected host across different stages of the infection chain.[167][168][169]"], "G0032": ["https://attack.mitre.org/groups/G0032", "Lazarus Group", "Lazarus Group malware uses cmd.exe to execute commands on a compromised host.[170][171][172][173][174] A Destover-like variant used by Lazarus Group uses a batch file mechanism to delete its binaries from the system.[175]"], "G0140": ["https://attack.mitre.org/groups/G0140", "LazyScripter", "LazyScripter has used batch files to deploy open-source and multi-stage RATs.[165]"], "S0395": ["https://attack.mitre.org/software/S0395", "LightNeuron", "LightNeuron is capable of executing commands via cmd.exe.[176]"], "S0211": ["https://attack.mitre.org/software/S0211", "Linfo", "Linfo creates a backdoor through which remote attackers can start a remote shell.[177]"], "S0681": ["https://attack.mitre.org/software/S0681", "Lizar", "Lizar has a command to open the command-line on the infected system.[178][179]"], "S0447": ["https://attack.mitre.org/software/S0447", "Lokibot", "Lokibot has used cmd /c commands embedded within batch scripts.[180]"], "S0582": ["https://attack.mitre.org/software/S0582", "LookBack", "LookBack executes the cmd.exe command.[181]"], "S0451": ["https://attack.mitre.org/software/S0451", "LoudMiner", "LoudMiner used a batch script to run the Linux virtual machine as a service.[182]"], "S0532": ["https://attack.mitre.org/software/S0532", "Lucifer", "Lucifer can issue shell commands to download and execute additional payloads.[183]"], "G0095": ["https://attack.mitre.org/groups/G0095", "Machete", "Machete has used batch files to initiate additional downloads of malicious files.[184]"], "G0059": ["https://attack.mitre.org/groups/G0059", "Magic Hound", "Magic Hound has used the command-line interface.[185]"], "S0652": ["https://attack.mitre.org/software/S0652", "MarkiRAT", "MarkiRAT can utilize cmd.exe to execute commands in a victim's environment.[186]"], "S0449": ["https://attack.mitre.org/software/S0449", "Maze", "The Maze encryption process has used batch scripts with various commands.[187][188]"], "S0500": ["https://attack.mitre.org/software/S0500", "MCMD", "MCMD can launch a console process (cmd.exe) with redirected standard input and output.[189]"], "S0459": ["https://attack.mitre.org/software/S0459", "MechaFlounder", "MechaFlounder has the ability to run commands on a compromised host.[190]"], "S0576": ["https://attack.mitre.org/software/S0576", "MegaCortex", "MegaCortex has used .cmd scripts on the victim's system.[191]"], "G0045": ["https://attack.mitre.org/groups/G0045", "menuPass", "menuPass executes commands using a command-line interface and reverse shell. The group has used a modified version of pentesting script wmiexec.vbs to execute commands.[192][193][194][195] menuPass has used malicious macros embedded inside Office documents to execute files.[196][195]"], "S0455": ["https://attack.mitre.org/software/S0455", "Metamorfo", "Metamorfo has used cmd.exe /c to execute files.[197]"], "S0688": ["https://attack.mitre.org/software/S0688", "Meteor", "Meteor can run set.bat, update.bat, cache.bat, bcd.bat, msrun.bat, and similar scripts.[198]"], "S0339": ["https://attack.mitre.org/software/S0339", "Micropsia", "Micropsia creates a command-line shell using cmd.exe.[199]"], "S0280": ["https://attack.mitre.org/software/S0280", "MirageFox", "MirageFox has the capability to execute commands using cmd.exe.[200]"], "S0084": ["https://attack.mitre.org/software/S0084", "Mis-Type", "Mis-Type uses cmd.exe to run commands for enumerating the host.[201]"], "S0083": ["https://attack.mitre.org/software/S0083", "Misdat", "Misdat is capable of providing shell functionality to the attacker to execute commands.[201]"], "S0080": ["https://attack.mitre.org/software/S0080", "Mivast", "Mivast has the capability to open a remote shell and run basic commands.[202]"], "S0553": ["https://attack.mitre.org/software/S0553", "MoleNet", "MoleNet can execute commands via the command line utility.[93]"], "S0149": ["https://attack.mitre.org/software/S0149", "MoonWind", "MoonWind can execute commands via an interactive command shell.[203] MoonWind uses batch scripts for various purposes, including to restart and uninstall itself.[203]"], "S0284": ["https://attack.mitre.org/software/S0284", "More_eggs", "More_eggs has used cmd.exe for execution.[204][205]"], "S0256": ["https://attack.mitre.org/software/S0256", "Mosquito", "Mosquito executes cmd.exe and uses a pipe to read the results and send back the output to the C2 server.[206]"], "G0069": ["https://attack.mitre.org/groups/G0069", "MuddyWater", "MuddyWater has used a custom tool for creating reverse shells.[207]"], "S0233": ["https://attack.mitre.org/software/S0233", "MURKYTOP", "MURKYTOP uses the command-line interface.[143]"], "G0129": ["https://attack.mitre.org/groups/G0129", "Mustang Panda", "Mustang Panda has executed HTA files via cmd.exe, and used batch scripts for collection.[208][209]"], "S0336": ["https://attack.mitre.org/software/S0336", "NanoCore", "NanoCore can open a remote command-line interface and execute commands.[210] NanoCore uses JavaScript files.[211]"], "S0247": ["https://attack.mitre.org/software/S0247", "NavRAT", "NavRAT leverages cmd.exe to perform discovery techniques.[212] NavRAT loads malicious shellcode and executes it in memory.[212]"], "S0630": ["https://attack.mitre.org/software/S0630", "Nebulae", "Nebulae can use CMD to execute a process.[213]"], "S0034": ["https://attack.mitre.org/software/S0034", "NETEAGLE", "NETEAGLE allows adversaries to execute shell commands on the infected host.[34]"], "S0457": ["https://attack.mitre.org/software/S0457", "Netwalker", "Operators deploying Netwalker have used batch scripts to retrieve the Netwalker payload.[214]"], "S0198": ["https://attack.mitre.org/software/S0198", "NETWIRE", "NETWIRE can issue commands using cmd.exe.[215][216]"], "S0385": ["https://attack.mitre.org/software/S0385", "njRAT", "njRAT can launch a command shell interface for executing commands.[217]"], "G0133": ["https://attack.mitre.org/groups/G0133", "Nomadic Octopus", "Nomadic Octopus used cmd.exe /c within a malicious macro.[218]"], "S0346": ["https://attack.mitre.org/software/S0346", "OceanSalt", "OceanSalt can create a reverse shell on the infected endpoint using cmd.exe.[219] OceanSalt has been executed via malicious macros.[219]"], "G0049": ["https://attack.mitre.org/groups/G0049", "OilRig", "OilRig has used macros to deliver malware such as QUADAGENT and OopsIE.[220][221][222][223][224] OilRig has used batch scripts.[220][221][222][223][224]"], "S0439": ["https://attack.mitre.org/software/S0439", "Okrum", "Okrum's backdoor has used cmd.exe to execute arbitrary commands as well as batch scripts to update itself to a newer version.[225]"], "S0264": ["https://attack.mitre.org/software/S0264", "OopsIE", "OopsIE uses the command prompt to execute commands on the victim's machine.[222][226]"], "G0116": ["https://attack.mitre.org/groups/G0116", "Operation Wocao", "Operation Wocao has spawned a new cmd.exe process to execute commands.[227]"], "S0229": ["https://attack.mitre.org/software/S0229", "Orz", "Orz can execute shell commands.[228] Orz can execute commands with JavaScript.[228]"], "S0594": ["https://attack.mitre.org/software/S0594", "Out1", "Out1 can use native command line for execution.[229]"], "G0040": ["https://attack.mitre.org/groups/G0040", "Patchwork", "Patchwork ran a reverse shell with Meterpreter.[230] Patchwork used JavaScript code and .SCT files on victim machines.[36][231]"], "S0643": ["https://attack.mitre.org/software/S0643", "Peppy", "Peppy has the ability to execute shell commands.[232]"], "S0158": ["https://attack.mitre.org/software/S0158", "PHOREAL", "PHOREAL is capable of creating reverse shell.[166]"], "S0124": ["https://attack.mitre.org/software/S0124", "Pisloader", "Pisloader uses cmd.exe to set the Registry Run key value. It also has a command to spawn a command shell.[233]"], "S0254": ["https://attack.mitre.org/software/S0254", "PLAINTEE", "PLAINTEE uses cmd.exe to execute commands on the victim’s machine.[234]"], "S0435": ["https://attack.mitre.org/software/S0435", "PLEAD", "PLEAD has the ability to execute shell commands on the compromised host.[235]"], "S0013": ["https://attack.mitre.org/software/S0013", "PlugX", "PlugX allows actors to spawn a reverse shell on a victim.[147][236]"], "S0428": ["https://attack.mitre.org/software/S0428", "PoetRAT", "PoetRAT has called cmd through a Word document macro.[237]"], "S0012": ["https://attack.mitre.org/software/S0012", "PoisonIvy", "PoisonIvy creates a backdoor through which remote attackers can open a command-line interface.[238]"], "S0453": ["https://attack.mitre.org/software/S0453", "Pony", "Pony has used batch scripts to delete itself after execution.[239]"], "S0139": ["https://attack.mitre.org/software/S0139", "PowerDuke", "PowerDuke runs cmd.exe /c and sends the output to its C2.[240]"], "S0184": ["https://attack.mitre.org/software/S0184", "POWRUNER", "POWRUNER can execute commands from its C2 server.[220]"], "S0238": ["https://attack.mitre.org/software/S0238", "Proxysvc", "Proxysvc executes a binary on the system and logs the results into a temp file by using: cmd.exe /c \" > %temp%\\PM* .tmp 2>&1\".[175]"], "S0147": ["https://attack.mitre.org/software/S0147", "Pteranodon", "Pteranodon can use cmd.exe for execution on victim systems.[119][241]"], "S0650": ["https://attack.mitre.org/software/S0650", "QakBot", "QakBot can use cmd.exe to launch itself and to execute multiple C2 commands.[242][243][244]"], "S0269": ["https://attack.mitre.org/software/S0269", "QUADAGENT", "QUADAGENT uses cmd.exe to execute scripts and commands on the victim’s machine.[223]"], "S0262": ["https://attack.mitre.org/software/S0262", "QuasarRAT", "QuasarRAT can launch a remote shell to execute commands on the victim’s machine.[245]"], "S0481": ["https://attack.mitre.org/software/S0481", "Ragnar Locker", "Ragnar Locker has used cmd.exe and batch scripts to execute commands.[246]"], "S0629": ["https://attack.mitre.org/software/S0629", "RainyDay", "RainyDay can use the Windows Command Shell for execution.[213]"], "G0075": ["https://attack.mitre.org/groups/G0075", "Rancor", "Rancor has used cmd.exe to execute commmands.[234]"], "S0241": ["https://attack.mitre.org/software/S0241", "RATANKBA", "RATANKBA uses cmd.exe to execute commands.[247][248]"], "S0662": ["https://attack.mitre.org/software/S0662", "RCSession", "RCSession can use cmd.exe for execution on compromised hosts.[64]"], "S0495": ["https://attack.mitre.org/software/S0495", "RDAT", "RDAT has executed commands using cmd.exe /c.[249]"], "S0153": ["https://attack.mitre.org/software/S0153", "RedLeaves", "RedLeaves can receive and execute commands with cmd.exe. It can also provide a reverse shell.[193][250]"], "S0332": ["https://attack.mitre.org/software/S0332", "Remcos", "Remcos can launch a remote command line to execute commands on the victim’s machine.[251]"], "S0375": ["https://attack.mitre.org/software/S0375", "Remexi", "Remexi silently executes received commands with cmd.exe.[252]"], "S0379": ["https://attack.mitre.org/software/S0379", "Revenge RAT", "Revenge RAT uses cmd.exe to execute commands and run scripts on the victim's machine.[253]"], "S0496": ["https://attack.mitre.org/software/S0496", "REvil", "REvil can use the Windows command line to delete volume shadow copies and disable recovery.[254][255][256][257]"], "S0258": ["https://attack.mitre.org/software/S0258", "RGDoor", "RGDoor uses cmd.exe to execute commands on the victim’s machine.[258]"], "S0448": ["https://attack.mitre.org/software/S0448", "Rising Sun", "Rising Sun executed commands using cmd.exe.[259]"], "S0400": ["https://attack.mitre.org/software/S0400", "RobbinHood", "RobbinHood uses cmd.exe on the victim's computer.[260]"], "S0270": ["https://attack.mitre.org/software/S0270", "RogueRobin", "RogueRobin uses Windows Script Components.[261][262]"], "S0148": ["https://attack.mitre.org/software/S0148", "RTM", "RTM uses the command line and rundll32.exe to execute.[263]"], "S0253": ["https://attack.mitre.org/software/S0253", "RunningRAT", "RunningRAT uses a batch file to kill a security program task and then attempts to remove itself.[124]"], "S0446": ["https://attack.mitre.org/software/S0446", "Ryuk", "Ryuk has used cmd.exe to create a Registry entry to establish persistence.[264]"], "S0074": ["https://attack.mitre.org/software/S0074", "Sakula", "Sakula calls cmd.exe to run various DLL files via rundll32 and also to perform file cleanup. Sakula also has the capability to invoke a reverse shell.[265]"], "S0370": ["https://attack.mitre.org/software/S0370", "SamSam", "SamSam uses custom batch scripts to execute some of its components.[266]"], "G0034": ["https://attack.mitre.org/groups/G0034", "Sandworm Team", "Sandworm Team has run the xp_cmdshell command in MS-SQL.[267]"], "S0461": ["https://attack.mitre.org/software/S0461", "SDBbot", "SDBbot has the ability to use the command shell to execute commands on a compromised host.[268]"], "S0053": ["https://attack.mitre.org/software/S0053", "SeaDuke", "SeaDuke is capable of executing commands.[269]"], "S0345": ["https://attack.mitre.org/software/S0345", "Seasalt", "Seasalt uses cmd.exe to create a reverse shell on the infected endpoint.[43]"], "S0185": ["https://attack.mitre.org/software/S0185", "SEASHARPEE", "SEASHARPEE can execute commands on victims.[270]"], "S0382": ["https://attack.mitre.org/software/S0382", "ServHelper", "ServHelper can execute shell commands against cmd.[271][272]"], "S0639": ["https://attack.mitre.org/software/S0639", "Seth-Locker", "Seth-Locker can execute commands via the command line shell.[273]"], "S0546": ["https://attack.mitre.org/software/S0546", "SharpStage", "SharpStage can execute arbitrary commands with the command line.[93][94]"], "S0444": ["https://attack.mitre.org/software/S0444", "ShimRat", "ShimRat can be issued a command shell function from the C2.[274]"], "S0610": ["https://attack.mitre.org/software/S0610", "SideTwist", "SideTwist can execute shell commands on a compromised host.[275]"], "G0091": ["https://attack.mitre.org/groups/G0091", "Silence", "Silence has used Windows command-line to run commands.[276][277][278]"], "S0692": ["https://attack.mitre.org/software/S0692", "SILENTTRINITY", "SILENTTRINITY can use cmd.exe to enable lateral movement using DCOM.[279]"], "S0623": ["https://attack.mitre.org/software/S0623", "Siloscape", "Siloscape can run cmd through an IRC channel.[280]"], "S0533": ["https://attack.mitre.org/software/S0533", "SLOTHFULMEDIA", "SLOTHFULMEDIA can open a command line to execute commands.[281]"], "S0159": ["https://attack.mitre.org/software/S0159", "SNUGRIDE", "SNUGRIDE is capable of executing commands and spawning a reverse shell.[250]"], "G0054": ["https://attack.mitre.org/groups/G0054", "Sowbug", "Sowbug has used command line during its intrusions.[282]"], "S0543": ["https://attack.mitre.org/software/S0543", "Spark", "Spark can use cmd.exe to run commands.[283]"], "S0390": ["https://attack.mitre.org/software/S0390", "SQLRat", "SQLRat has used SQL to execute JavaScript and VB scripts on the host system.[111]"], "S0142": ["https://attack.mitre.org/software/S0142", "StreamEx", "StreamEx has the ability to remotely execute commands.[284]"], "G0039": ["https://attack.mitre.org/groups/G0039", "Suckfly", "Several tools used by Suckfly have been command-line driven.[285]"], "S0464": ["https://attack.mitre.org/software/S0464", "SYSCON", "SYSCON has the ability to execute commands through cmd on a compromised host.[56]"], "G0092": ["https://attack.mitre.org/groups/G0092", "TA505", "TA505 has executed commands using cmd.exe.[286]"], "G0127": ["https://attack.mitre.org/groups/G0127", "TA551", "TA551 has used cmd.exe to execute commands.[287]"], "S0011": ["https://attack.mitre.org/software/S0011", "Taidoor", "Taidoor can copy cmd.exe into the system temp folder.[288]"], "S0586": ["https://attack.mitre.org/software/S0586", "TAINTEDSCRIBE", "TAINTEDSCRIBE can enable Windows CLI access and execute files.[289]"], "S0164": ["https://attack.mitre.org/software/S0164", "TDTESS", "TDTESS provides a reverse shell on the victim.[290]"], "G0139": ["https://attack.mitre.org/groups/G0139", "TeamTNT", "TeamTNT has used batch scripts to download tools and executing cryptocurrency miners.[291]"], "S0146": ["https://attack.mitre.org/software/S0146", "TEXTMATE", "TEXTMATE executes cmd.exe to provide a reverse shell to adversaries.[292][293]"], "G0028": ["https://attack.mitre.org/groups/G0028", "Threat Group-1314", "Threat Group-1314 actors spawned shells on remote systems on a victim network to execute commands.[294]"], "G0027": ["https://attack.mitre.org/groups/G0027", "Threat Group-3390", "Threat Group-3390 has used command-line interfaces for execution.[61][295]"], "S0668": ["https://attack.mitre.org/software/S0668", "TinyTurla", "TinyTurla has been installed using a .bat file.[296]"], "S0004": ["https://attack.mitre.org/software/S0004", "TinyZBot", "TinyZBot supports execution from the command-line.[297]"], "S0266": ["https://attack.mitre.org/software/S0266", "TrickBot", "TrickBot has used macros in Excel documents to download and deploy the malware on the user’s machine.[298]"], "S0094": ["https://attack.mitre.org/software/S0094", "Trojan.Karagany", "Trojan.Karagany can perform reconnaissance commands on a victim machine via a cmd.exe process.[299]"], "G0081": ["https://attack.mitre.org/groups/G0081", "Tropic Trooper", "Tropic Trooper has used Windows command scripts.[300]"], "S0436": ["https://attack.mitre.org/software/S0436", "TSCookie", "TSCookie has the ability to execute shell commands on the infected host.[301]"], "S0647": ["https://attack.mitre.org/software/S0647", "Turian", "Turian can create a remote shell and execute commands using cmd.[302]"], "G0010": ["https://attack.mitre.org/groups/G0010", "Turla", "Turla RPC backdoors have used cmd.exe to execute commands.[303][304]"], "S0199": ["https://attack.mitre.org/software/S0199", "TURNEDUP", "TURNEDUP is capable of creating a reverse shell.[305]"], "S0263": ["https://attack.mitre.org/software/S0263", "TYPEFRAME", "TYPEFRAME can uninstall malware components using a batch script.[306] TYPEFRAME can execute commands using a shell.[306]"], "S0333": ["https://attack.mitre.org/software/S0333", "UBoatRAT", "UBoatRAT can start a command shell.[307]"], "S0221": ["https://attack.mitre.org/software/S0221", "Umbreon", "Umbreon provides access using both standard facilities like SSH and additional access using its backdoor Espeon, providing a reverse shell upon receipt of a special packet[308]"], "S0275": ["https://attack.mitre.org/software/S0275", "UPPERCUT", "UPPERCUT uses cmd.exe to execute commands on the victim’s machine.[195]"], "S0452": ["https://attack.mitre.org/software/S0452", "USBferry", "USBferry can execute various Windows commands.[300]"], "S0180": ["https://attack.mitre.org/software/S0180", "Volgmer", "Volgmer can execute commands on the victim's machine.[309][310]"], "S0670": ["https://attack.mitre.org/software/S0670", "WarzoneRAT", "WarzoneRAT can use cmd.exe to execute malicious code.[311]"], "S0612": ["https://attack.mitre.org/software/S0612", "WastedLocker", "WastedLocker has used cmd to execute commands on the system.[312]"], "S0109": ["https://attack.mitre.org/software/S0109", "WEBC2", "WEBC2 can open an interactive command shell.[9]"], "S0514": ["https://attack.mitre.org/software/S0514", "WellMess", "WellMess can execute command line scripts received from C2.[313]"], "S0689": ["https://attack.mitre.org/software/S0689", "WhisperGate", "WhisperGate can use cmd.exe to execute commands.[314]"], "S0206": ["https://attack.mitre.org/software/S0206", "Wiarp", "Wiarp creates a backdoor through which remote attackers can open a command line interface.[315]"], "G0102": ["https://attack.mitre.org/groups/G0102", "Wizard Spider", "Wizard Spider has used cmd.exe to execute commands on a victim's machine.[316]"], "S0653": ["https://attack.mitre.org/software/S0653", "xCaon", "xCaon has a command to start an interactive shell.[52]"], "S0117": ["https://attack.mitre.org/software/S0117", "XTunnel", "XTunnel has been used to execute remote commands.[317]"], "S0251": ["https://attack.mitre.org/software/S0251", "Zebrocy", "Zebrocy uses cmd.exe to execute commands on the system.[318][319]"], "S0330": ["https://attack.mitre.org/software/S0330", "Zeus Panda", "Zeus Panda can launch an interface where it can execute several commands on the victim’s PC.[320]"], "G0128": ["https://attack.mitre.org/groups/G0128", "ZIRCONIUM", "ZIRCONIUM has used a tool to open a Windows Command Shell on a remote host.[321]"], "S0086": ["https://attack.mitre.org/software/S0086", "ZLib", "ZLib has the ability to execute shell commands.[201]"], "S0350": ["https://attack.mitre.org/software/S0350", "zwShell", "zwShell can launch command-line shells.[322]"], "S0412": ["https://attack.mitre.org/software/S0412", "ZxShell", "ZxShell can launch a reverse command shell.[25][323][324]"]}, "Mitigation": {"M1038": ["https://attack.mitre.org/mitigations/M1038", "Execution Prevention", "Use application control where appropriate."]}, "Detection": {"Command Execution": ["Monitor executed commands and arguments that may abuse the Windows command shell for execution. Usage of the Windows command shell may be common on administrator, developer, or power user systems depending on job function. If scripting is restricted for normal users, then any attempt to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.", "DS0017", "https://attack.mitre.org/datasources/DS0017", "Command"], "Process Creation": ["Monitor for newly executed processes that may abuse the Windows command shell for execution.", "DS0009", "https://attack.mitre.org/datasources/DS0009", "Process"]}}
